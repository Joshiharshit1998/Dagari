(()=>{function e(n){const{pluginName:i,hostname:o,backgroundColor:t,messages:r}=n,s=`sokuji-${i.toLowerCase()}-audio-guidance`,a=`sokuji-${o}-guidance-dismissed`;if(document.getElementById(s))return;const u=document.createElement("div");u.id=s,u.style.cssText=`\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: ${t};\n    color: white;\n    padding: 16px 20px;\n    border-radius: 8px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    z-index: 10000;\n    max-width: 350px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 14px;\n    line-height: 1.4;\n    border: 1px solid rgba(255, 255, 255, 0.2);\n  `,u.innerHTML=`\n    <div style="display: flex; align-items: flex-start; gap: 12px;">\n      <div style="flex-shrink: 0; margin-top: 2px;">\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M12 2L2 7l10 5 10-5-10-5z"/>\n          <path d="M2 17l10 5 10-5"/>\n          <path d="M2 12l10 5 10-5"/>\n        </svg>\n      </div>\n      <div style="flex: 1;">\n        <div style="font-weight: 600; margin-bottom: 8px; color: #fff;">\n          ${r.title}\n        </div>\n        <div style="margin-bottom: 12px; color: rgba(255, 255, 255, 0.9);">\n          ${r.guidance}\n        </div>\n        <div style="display: flex; gap: 8px; align-items: center;">\n          <button data-action="dismiss" style="\n            background: rgba(255, 255, 255, 0.2);\n            border: 1px solid rgba(255, 255, 255, 0.3);\n            color: white;\n            padding: 6px 12px;\n            border-radius: 4px;\n            font-size: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n          ">\n            ${r.gotIt}\n          </button>\n          <button data-action="remind-later" style="\n            background: transparent;\n            border: none;\n            color: rgba(255, 255, 255, 0.7);\n            padding: 6px 8px;\n            font-size: 12px;\n            cursor: pointer;\n            text-decoration: underline;\n            transition: color 0.2s ease;\n          ">\n            ${r.remindLater}\n          </button>\n        </div>\n      </div>\n    </div>\n  `;const d=u.querySelector('[data-action="dismiss"]'),c=u.querySelector('[data-action="remind-later"]');d&&(d.addEventListener("click",(()=>{u.remove();try{localStorage.setItem(a,"true")}catch(e){console.warn(`[Sokuji] [${i}] Could not store dismissal state:`,e)}})),d.addEventListener("mouseenter",(()=>{d.style.background="rgba(255, 255, 255, 0.3)"})),d.addEventListener("mouseleave",(()=>{d.style.background="rgba(255, 255, 255, 0.2)"}))),c&&(c.addEventListener("click",(()=>{u.remove(),setTimeout((()=>{e(n)}),6e5)})),c.addEventListener("mouseenter",(()=>{c.style.color="rgba(255, 255, 255, 1)"})),c.addEventListener("mouseleave",(()=>{c.style.color="rgba(255, 255, 255, 0.7)"})));const l=setTimeout((()=>{u&&u.parentNode&&u.remove()}),3e4);if(u.addEventListener("click",(()=>{clearTimeout(l)})),document.body)document.body.appendChild(u);else{if(!document.documentElement)return void console.error(`[Sokuji] [${i}] Cannot show audio guidance - no suitable parent element found`);document.documentElement.appendChild(u)}console.info(`[Sokuji] [${i}] ${i} audio guidance notification shown`)}function n(e){return{guidanceDismissed:(()=>{try{return"true"===localStorage.getItem(`sokuji-${e}-guidance-dismissed`)}catch(e){return!1}})()}}function i(e){try{return localStorage.removeItem(`sokuji-${e}-guidance-dismissed`),!0}catch(e){return!1}}window.sokujiI18nMessages=function(){try{const n=document.currentScript||document.querySelector("#sokuji-site-plugins-script")||function(){const e=document.querySelectorAll('script[src*="site-plugins.js"]');return e[e.length-1]}();if(n&&n.src){const i=new URL(n.src).searchParams;function e(e,n){if(!e)return n;try{return decodeURIComponent(escape(atob(e)))}catch(i){try{return decodeURIComponent(e)}catch(e){return console.warn("[Sokuji] [Plugins] Failed to decode i18n message, using fallback:",e),n}}}const o={title:e(i.get("title"),"Sokuji"),guidance:e(i.get("guidance"),'To use Sokuji, please select "Sokuji Virtual Microphone" in your microphone settings.'),gotIt:e(i.get("gotIt"),"Got it"),remindLater:e(i.get("remindLater"),"Remind me later")};return console.info("[Sokuji] [Plugins] i18n messages parsed from URL parameters (Base64 decoded):",o),o}}catch(t){console.warn("[Sokuji] [Plugins] Error parsing i18n from URL parameters:",t)}return{title:"Sokuji",guidance:'To use Sokuji, please select "Sokuji Virtual Microphone" in your microphone settings.',gotIt:"Got it",remindLater:"Remind me later"}}();const o={"app.gather.town":{name:"Gather Town",hostname:"app.gather.town",init(){console.info("[Sokuji] [Gather] Gather Town plugin initialized")},showGuidance(n){const i=n||{title:"Sokuji for Gather Town",guidance:'To use Sokuji, please select "Sokuji Virtual Microphone" in your microphone settings.',gotIt:"Got it",remindLater:"Remind me later"};e({pluginName:"Gather",hostname:this.hostname,backgroundColor:"linear-gradient(135deg, #6666FF 0%, #4444CC 100%)",messages:i})},getDebugInfo(){return n(this.hostname)},resetGuidanceDismissal(){return i(this.hostname)}},"whereby.com":{name:"Whereby",hostname:"whereby.com",init(){console.info("[Sokuji] [Whereby] Whereby plugin initialized")},showGuidance(n){const i=n||{title:"Sokuji for Whereby",guidance:'To use Sokuji, please select "Sokuji Virtual Microphone" in your microphone settings and disable Noise reduction for better performance.',gotIt:"Got it",remindLater:"Remind me later"};e({pluginName:"Whereby",hostname:this.hostname,backgroundColor:"linear-gradient(135deg, #006654 0%, #004d40 100%)",messages:i})},getDebugInfo(){return n(this.hostname)},resetGuidanceDismissal(){return i(this.hostname)}},"discord.com":{name:"Discord",hostname:"discord.com",init(){console.info("[Sokuji] [Discord] Discord plugin initialized")},showGuidance(n){const i=n||{title:"Sokuji for Discord",guidance:'To use Sokuji, please select <strong>"Sokuji Virtual Microphone"</strong> in your microphone settings and <strong>disable Noise Suppression</strong> in Discord\'s Voice settings for better performance.',gotIt:"Got it",remindLater:"Remind me later"};e({pluginName:"Discord",hostname:this.hostname,backgroundColor:"linear-gradient(135deg, #5865F2 0%, #4752C4 100%)",messages:i})},getDebugInfo(){return n(this.hostname)},resetGuidanceDismissal(){return i(this.hostname)}},"app.slack.com":{name:"Slack",hostname:"app.slack.com",init(){console.info("[Sokuji] [Slack] Slack plugin initialized")},showGuidance(n){const i=n||{title:"Sokuji for Slack",guidance:'To use Sokuji in Slack Huddles, please <strong>start a Huddle</strong>, then select <strong>"Sokuji Virtual Microphone"</strong> in your Video and Mic settings, and <strong>disable Noise Suppression</strong> in Audio & Video preferences for better performance.',gotIt:"Got it",remindLater:"Remind me later"};e({pluginName:"Slack",hostname:this.hostname,backgroundColor:"linear-gradient(135deg, #4A154B 0%, #350d36 100%)",messages:i})},getDebugInfo(){return n(this.hostname)},resetGuidanceDismissal(){return i(this.hostname)}}};!function(){const e=window.location.hostname,n=o[e];n?(window.sokujiSitePlugin=n,console.info("[Sokuji] [Plugins] Loaded plugin for current site:",n.name,"("+e+")")):(window.sokujiSitePlugin=null,console.info("[Sokuji] [Plugins] No specific plugin found for current site:",e)),window.sokujiSitePlugin}(),function(){function e(){return window.location.hostname}function n(){const i=e();if(void 0===window.sokujiSitePlugin)return console.warn("[Sokuji] [Page] Site plugin not loaded yet, retrying..."),void setTimeout(n,100);if(!window.sokujiI18nMessages)return console.warn("[Sokuji] [Page] i18n messages not loaded yet, retrying..."),void setTimeout(n,100);const o=window.sokujiSitePlugin;if(o){console.info("[Sokuji] [Page] Initializing "+o.name+" plugin for "+i);try{o.init(),o.monitorAudio&&o.monitorAudio(),o.showGuidance&&setTimeout((function(){try{localStorage.getItem("sokuji-"+i+"-guidance-dismissed")||o.showGuidance(window.sokujiI18nMessages)}catch(e){o.showGuidance(window.sokujiI18nMessages)}}),3e3)}catch(e){console.error("[Sokuji] [Page] Error initializing "+o.name+" plugin:",e)}}else console.info("[Sokuji] [Page] No specific plugin found for "+i+", using generic functionality")}console.info("[Sokuji] [Page] Plugin initialization script running in page context"),"complete"===document.readyState||"interactive"===document.readyState?n():document.addEventListener("DOMContentLoaded",n),window.sokujiPageContext={version:"2.0.0",currentSite:e(),hasPlugin:function(){return!!window.sokujiSitePlugin},getActivePlugin:function(){return window.sokujiSitePlugin?window.sokujiSitePlugin.name:"Generic"},getStatus:function(){return{initialized:!0,hasVirtualMic:!!window.sokujiVirtualMic,canInjectAudio:!0,currentSite:e(),activePlugin:window.sokujiSitePlugin?window.sokujiSitePlugin.name:"Generic",pluginLoaded:!!window.sokujiSitePlugin}},reinitSitePlugin:n,getCurrentPlugin:function(){return window.sokujiSitePlugin||null}}}()})();