/*! For license information please see fullpage.js.LICENSE.txt */
(()=>{var e,t,n,i,o={362:(e,t,n)=>{"use strict";var i=n(6441);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,a,r){if(r!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return n.PropTypes=n,n}},440:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".logs-panel{display:flex;flex-direction:column;height:100%;width:100%;box-sizing:border-box;overflow-x:hidden}.logs-panel .logs-panel-header{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #333;box-sizing:border-box;width:100%}.logs-panel .logs-panel-header h2{margin:0;font-size:16px;font-weight:500}.logs-panel .logs-panel-header .header-actions{display:flex;align-items:center;gap:10px}.logs-panel .logs-panel-header .auto-scroll-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.logs-panel .logs-panel-header .auto-scroll-button span{margin-left:5px;font-size:13px}.logs-panel .logs-panel-header .auto-scroll-button:hover{background-color:hsla(0,0%,100%,.1);color:#fff}.logs-panel .logs-panel-header .auto-scroll-button.active{background-color:rgba(16,163,127,.1);color:#10a37f}.logs-panel .logs-panel-header .auto-scroll-button.active:hover{background-color:rgba(16,163,127,.2)}.logs-panel .logs-panel-header .clear-logs-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.logs-panel .logs-panel-header .clear-logs-button span{margin-left:5px;font-size:13px}.logs-panel .logs-panel-header .clear-logs-button:hover{background-color:rgba(255,76,76,.1);color:#ff4c4c}.logs-panel .logs-panel-header .close-logs-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.logs-panel .logs-panel-header .close-logs-button span{margin-left:5px;font-size:13px}.logs-panel .logs-panel-header .close-logs-button:hover{background-color:hsla(0,0%,100%,.1);color:#fff}.logs-panel .logs-content{flex:1;overflow-y:auto;overflow-x:hidden;padding:12px;font-family:monospace;font-size:12px;scrollbar-gutter:stable;box-sizing:border-box;width:100%}.logs-panel .logs-content .log-entry{margin-bottom:4px;display:flex}.logs-panel .logs-content .log-entry .log-timestamp{color:#888;margin-right:10px;flex-shrink:0;font-size:11px}.logs-panel .logs-content .log-entry .log-message{color:#ddd;word-break:break-word;font-size:12px}.logs-panel .logs-content .log-entry.info .log-message{color:#ddd}.logs-panel .logs-content .log-entry.success .log-message{color:#10a37f}.logs-panel .logs-content .log-entry.warning .log-message{color:#ffc107}.logs-panel .logs-content .log-entry.error .log-message{color:#ff4c4c}.logs-panel .logs-content .log-entry.token .log-message{color:#4285f4;font-family:monospace}.logs-panel .logs-content .logs-placeholder{display:flex;justify-content:center;align-items:center;height:100%;width:100%;color:#888;font-size:16px}.logs-panel .logs-content .logs-placeholder .placeholder-content{display:flex;flex-direction:column;align-items:center;text-align:center}.logs-panel .logs-content .logs-placeholder .placeholder-content .icon-container{display:flex;justify-content:center;align-items:center;width:48px;height:48px;background-color:#333;border-radius:8px;margin-bottom:16px}.logs-panel .logs-content .logs-placeholder .placeholder-content .icon-container svg{color:#888}.logs-panel .logs-content .event-entry{display:flex;flex-direction:column;margin-bottom:6px;background-color:#1e1e1e;border-radius:4px;overflow:hidden}.logs-panel .logs-content .event-entry .event-header{display:flex;align-items:center;gap:6px;padding:5px 10px;cursor:pointer;transition:background-color .2s}.logs-panel .logs-content .event-entry .event-header:hover{background-color:#2a2a2a}.logs-panel .logs-content .event-entry .event-header .log-timestamp{color:#888;margin-right:5px;flex-shrink:0;font-size:11px}.logs-panel .logs-content .event-entry .event-header .client-icon,.logs-panel .logs-content .event-entry .event-header .server-icon{flex-shrink:0;width:14px;height:14px}.logs-panel .logs-content .event-entry .event-header .client-icon{color:#4285f4}.logs-panel .logs-content .event-entry .event-header .server-icon{color:#10a37f}.logs-panel .logs-content .event-entry .event-header .event-info{display:flex;align-items:center;gap:5px;font-size:11px}.logs-panel .logs-content .event-entry .event-header .event-info .source-label{color:#aaa}.logs-panel .logs-content .event-entry .event-header .event-info .event-type{color:#ddd}.logs-panel .logs-content .event-entry .event-header .event-info .event-count{color:#ffc107;font-weight:500;background-color:rgba(255,193,7,.1);border-radius:10px;padding:1px 6px;font-size:10px;margin-left:2px}.logs-panel .logs-content .event-entry .event-details{background-color:#252525;padding:8px;border-radius:0 0 4px 4px;overflow-x:auto}.logs-panel .logs-content .event-entry .event-details pre{margin:0;font-size:11px;color:#ddd;white-space:pre-wrap;word-break:break-word}.logs-panel .logs-content .event-entry .event-details .grouped-events{display:flex;flex-direction:column;gap:12px}.logs-panel .logs-content .event-entry .event-details .grouped-events .grouped-event{border-left:2px solid #444;padding-left:8px}.logs-panel .logs-content .event-entry .event-details .grouped-events .grouped-event .grouped-event-header{padding:4px 0;margin-bottom:4px}.logs-panel .logs-content .event-entry .event-details .grouped-events .grouped-event .grouped-event-header .grouped-event-index{font-size:10px;color:#888;font-style:italic}.logs-panel .logs-content .event-entry .event-details .grouped-events .grouped-event pre{margin-left:4px}",""]);const s=r},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1284:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".main-layout{display:flex;height:100vh;width:100%;background-color:#1e1e1e;color:#fff;overflow:hidden}@media(max-width: 768px){.main-layout{flex-direction:column}.main-layout .settings-panel-container{width:100% !important;min-width:100% !important;max-width:100% !important;height:calc(100vh - 120px);border-top:1px solid #333;border-right:none}.main-layout .main-content{height:auto}.main-layout .main-content.with-panel{height:120px;min-height:120px;border-right:none}.main-layout .main-content.with-panel .main-panel-container{display:block;height:60px;overflow:hidden}.main-layout .main-content.with-panel .main-panel-container .main-panel{height:100%}.main-layout .main-content.with-panel .main-panel-container .main-panel .conversation-container{display:none}.main-layout .main-content.with-panel .main-panel-container .main-panel .audio-visualization{position:relative;bottom:auto;margin-top:10px}}.main-layout .main-content{display:flex;flex-direction:column;flex:1;min-width:0}.main-layout .main-content.with-panel{border-right:1px solid #333}.main-layout .main-content.full-width{width:100%}.main-layout .main-panel-header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background-color:#252525;border-bottom:1px solid #333}.main-layout .main-panel-header h1{margin:0;font-size:18px;font-weight:500}.main-layout .main-panel-header .header-controls{display:flex;align-items:center;gap:8px}.main-layout .main-panel-header .header-controls .settings-button,.main-layout .main-panel-header .header-controls .audio-button,.main-layout .main-panel-header .header-controls .logs-button{display:flex;align-items:center;gap:6px;background:rgba(0,0,0,0);border:1px solid #555;border-radius:4px;color:#fff;padding:6px 12px;cursor:pointer;font-size:14px}.main-layout .main-panel-header .header-controls .settings-button:hover,.main-layout .main-panel-header .header-controls .audio-button:hover,.main-layout .main-panel-header .header-controls .logs-button:hover{background-color:hsla(0,0%,100%,.1)}.main-layout .main-panel-header .header-controls .settings-button.active,.main-layout .main-panel-header .header-controls .audio-button.active,.main-layout .main-panel-header .header-controls .logs-button.active{background-color:hsla(0,0%,100%,.2);border-color:#10a37f}@media(max-width: 576px){.main-layout .main-panel-header .header-controls .settings-button,.main-layout .main-panel-header .header-controls .audio-button,.main-layout .main-panel-header .header-controls .logs-button{padding:6px}.main-layout .main-panel-header .header-controls .settings-button span,.main-layout .main-panel-header .header-controls .audio-button span,.main-layout .main-panel-header .header-controls .logs-button span{display:none}}.main-layout .main-panel-container{flex:1;display:flex;flex-direction:column}.main-layout .settings-panel-container{width:450px;min-width:300px;max-width:450px;overflow-y:auto;padding:0;background-color:#252525}",""]);const s=r},1328:e=>{var t=new Error("Element already at target scroll position"),n=new Error("Scroll cancelled"),i=Math.min,o=Date.now;function a(e){return function(a,l,c,u){"function"==typeof(c=c||{})&&(u=c,c={}),"function"!=typeof u&&(u=s);var d=o(),p=a[e],h=c.ease||r,g=isNaN(c.duration)?350:+c.duration,m=!1;return p===l?u(t,a[e]):requestAnimationFrame((function t(r){if(m)return u(n,a[e]);var s=o(),c=i(1,(s-d)/g),f=h(c);a[e]=f*(l-p)+p,c<1?requestAnimationFrame(t):requestAnimationFrame((function(){u(null,a[e])}))})),function(){m=!0}}}function r(e){return.5*(1-Math.cos(Math.PI*e))}function s(){}e.exports={left:a("scrollLeft"),top:a("scrollTop")}},1434:(e,t,n)=>{"use strict";e.exports=n(7699)},1469:(e,t,n)=>{"use strict";e.exports=n.p+"5033642319a5831046e0.js"},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1948:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".audio-feedback-warning{position:fixed;top:20px;right:20px;max-width:400px;z-index:1000;animation:slideIn .3s ease-out}.audio-feedback-warning .warning-content{background:linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.3);color:#fff;overflow:hidden;border:1px solid hsla(0,0%,100%,.1)}.audio-feedback-warning .warning-header{display:flex;align-items:center;padding:16px;background:rgba(0,0,0,.1);border-bottom:1px solid hsla(0,0%,100%,.1)}.audio-feedback-warning .warning-header .warning-icon{margin-right:8px;color:#fff}.audio-feedback-warning .warning-header .warning-title{font-weight:600;font-size:16px;flex:1}.audio-feedback-warning .warning-header .dismiss-button{background:none;border:none;color:#fff;font-size:20px;cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background-color .2s}.audio-feedback-warning .warning-header .dismiss-button:hover{background:hsla(0,0%,100%,.2)}.audio-feedback-warning .warning-body{padding:16px}.audio-feedback-warning .warning-body .warning-description{margin:0 0 16px 0;line-height:1.4;font-size:14px}.audio-feedback-warning .warning-body .device-info{margin:16px 0;background:rgba(0,0,0,.1);border-radius:8px;padding:12px}.audio-feedback-warning .warning-body .device-info .device-row{display:flex;align-items:center;margin-bottom:8px}.audio-feedback-warning .warning-body .device-info .device-row:last-child{margin-bottom:0}.audio-feedback-warning .warning-body .device-info .device-row .device-icon{margin-right:8px;color:hsla(0,0%,100%,.8)}.audio-feedback-warning .warning-body .device-info .device-row .device-label{font-size:13px;color:hsla(0,0%,100%,.9)}.audio-feedback-warning .warning-body .recommended-action{margin:16px 0;padding:12px;background:rgba(0,0,0,.15);border-radius:8px;border-left:4px solid hsla(0,0%,100%,.3)}.audio-feedback-warning .warning-body .recommended-action strong{color:#fff;font-size:14px}.audio-feedback-warning .warning-body .recommended-action p{margin:8px 0 0 0;font-size:13px;color:hsla(0,0%,100%,.9);line-height:1.4}.audio-feedback-warning .warning-body .feedback-solutions{margin-top:16px}.audio-feedback-warning .warning-body .feedback-solutions h4{margin:0 0 12px 0;font-size:14px;color:#fff;font-weight:600}.audio-feedback-warning .warning-body .feedback-solutions ul{margin:0;padding-left:20px}.audio-feedback-warning .warning-body .feedback-solutions ul li{margin-bottom:8px;font-size:13px;color:hsla(0,0%,100%,.9);line-height:1.4}.audio-feedback-warning .warning-body .feedback-solutions ul li:last-child{margin-bottom:0}@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}@media(max-width: 768px){.audio-feedback-warning{left:20px;right:20px;max-width:none;top:20px}}@media(prefers-color-scheme: dark){.audio-feedback-warning .warning-content{background:linear-gradient(135deg, #d63031 0%, #b71c1c 100%)}}",""]);const s=r},2192:(e,t,n)=>{"use strict";var i=n(3696),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,a={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)r.call(t,i)&&!l.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},2288:e=>{"use strict";e.exports="data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E"},2511:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,'.App{width:100%;height:100vh;overflow:hidden;background-color:#1e1e1e;color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif}',""]);const s=r},2540:(e,t,n)=>{"use strict";e.exports=n(2192)},2688:(e,t,n)=>{e.exports=n(362)()},2900:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a),s=n(4417),l=n.n(s),c=new URL(n(2288),n.b),u=r()(o()),d=l()(c);u.push([e.id,`.settings-panel{display:flex;flex-direction:column;height:100%;width:100%;box-sizing:border-box;overflow-x:hidden}.settings-panel .settings-panel-header{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #333;box-sizing:border-box;width:100%}.settings-panel .settings-panel-header h2{margin:0;font-size:16px;font-weight:500;color:#fff}.settings-panel .settings-panel-header .header-actions{display:flex;align-items:center;gap:15px}.settings-panel .settings-panel-header .header-actions .save-all-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.settings-panel .settings-panel-header .header-actions .save-all-button span{margin-left:5px;font-size:13px}.settings-panel .settings-panel-header .header-actions .save-all-button:hover:not(:disabled){background-color:hsla(0,0%,100%,.1);color:#fff}.settings-panel .settings-panel-header .header-actions .save-all-button:disabled{opacity:.5;cursor:not-allowed;color:#666}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper{display:flex;align-items:center;justify-content:center;cursor:help}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper.success{color:#10a37f}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper.error{color:#ff4c4c}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper.warning{color:#ffc107}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper.info{color:#4285f4}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper .status-icon{transition:transform .2s ease}.settings-panel .settings-panel-header .header-actions .status-icon-wrapper:hover .status-icon{transform:scale(1.2)}.settings-panel .settings-panel-header .header-actions .save-message{padding:5px 10px;border-radius:4px;font-size:13px}.settings-panel .settings-panel-header .header-actions .save-message.success{background-color:rgba(16,163,127,.2);color:#10a37f}.settings-panel .settings-panel-header .header-actions .save-message.error{background-color:rgba(255,76,76,.2);color:#ff4c4c}.settings-panel .settings-panel-header .header-actions .save-message.warning{background-color:rgba(255,193,7,.2);color:#ffc107}.settings-panel .settings-panel-header .header-actions .save-message.info{background-color:rgba(66,133,244,.2);color:#4285f4}.settings-panel .settings-panel-header .close-settings-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.settings-panel .settings-panel-header .close-settings-button span{margin-left:5px;font-size:13px}.settings-panel .settings-panel-header .close-settings-button:hover{background-color:hsla(0,0%,100%,.1);color:#fff}.settings-panel .settings-content{flex:1;overflow-y:auto;overflow-x:hidden;padding:15px;scrollbar-gutter:stable;box-sizing:border-box;width:100%}.settings-panel .settings-content .session-active-notice{display:flex;align-items:center;gap:8px;background-color:rgba(255,193,7,.15);border:1px solid rgba(255,193,7,.3);border-radius:6px;padding:12px;margin-bottom:20px;color:#ffc107;font-size:13px;line-height:1.4}.settings-panel .settings-content .session-active-notice svg{flex-shrink:0;margin-top:1px}.settings-panel .settings-content .session-active-notice span{flex:1}.settings-panel .settings-content .settings-section{margin-bottom:20px}.settings-panel .settings-content .settings-section h2{font-size:14px;font-weight:500;margin-bottom:10px;color:#ccc}.settings-panel .settings-content .settings-section .api-key-status{margin-top:8px;padding:6px 10px;border-radius:4px;font-size:12px}.settings-panel .settings-content .settings-section .api-key-status.success{background-color:rgba(16,163,127,.1);color:#10a37f}.settings-panel .settings-content .settings-section .api-key-status.error{background-color:rgba(255,76,76,.1);color:#ff4c4c}.settings-panel .settings-content .settings-section .api-key-status.info{background-color:rgba(66,133,244,.1);color:#4285f4}.settings-panel .settings-content .settings-section .system-instructions{width:100%;min-height:120px;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;padding:10px;font-size:12px;line-height:1.4;resize:vertical;box-sizing:border-box}.settings-panel .settings-content .settings-section .system-instructions:focus{outline:none;border-color:#10a37f}.settings-panel .settings-content .settings-section .system-instructions:disabled{background-color:#2a2a2a;color:#777;cursor:not-allowed;opacity:.6}.settings-panel .settings-content .settings-section .system-instructions-preview{width:100%;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;font-size:12px;line-height:1.4;box-sizing:border-box;padding:10px;margin-top:6px}.settings-panel .settings-content .settings-section .system-instructions-preview .preview-content{white-space:pre-wrap;font-family:monospace;font-size:11px;line-height:1.5;color:#ddd;background-color:rgba(0,0,0,.2);padding:8px;border-radius:4px;max-height:200px;overflow-y:auto}.settings-panel .settings-content .settings-section .setting-item{margin-bottom:12px}.settings-panel .settings-content .settings-section .setting-item .setting-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:13px}.settings-panel .settings-content .settings-section .setting-item .setting-label .setting-value{color:#aaa}.settings-panel .settings-content .settings-section .setting-item .setting-label .preview-toggle{cursor:pointer;display:flex;align-items:center;color:#aaa;font-size:12px}.settings-panel .settings-content .settings-section .setting-item .setting-label .preview-toggle:hover{color:#fff}.settings-panel .settings-content .settings-section .setting-item .setting-label .preview-toggle svg{margin-left:4px;transition:transform .2s}.settings-panel .settings-content .settings-section .setting-item .setting-label .preview-toggle.expanded svg{transform:rotate(90deg)}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch{display:flex;align-items:center}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label{display:flex;align-items:center;gap:8px;cursor:pointer;user-select:none}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label span{color:#aaa;font-size:13px;transition:color .2s}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label span.active{color:#10a37f;font-weight:500}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container{position:relative;display:inline-block;width:40px;height:20px}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container input{opacity:0;width:0;height:0}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container input:checked+.slider{background-color:#10a37f}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container input:checked+.slider:before{transform:translateX(20px)}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#555;transition:.2s;border-radius:20px}.settings-panel .settings-content .settings-section .setting-item .setting-label .toggle-switch .toggle-label .toggle-container .slider:before{position:absolute;content:"";height:16px;width:16px;left:2px;bottom:2px;background-color:#fff;transition:.2s;border-radius:50%}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper{display:flex;align-items:center;position:relative;width:100%}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .select-dropdown{flex-grow:1}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper{margin-left:8px;position:relative;display:flex;align-items:center;justify-content:center;flex-shrink:0}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper .experimental-icon{color:#ffc107;transition:color .2s}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper .experimental-icon:hover{color:#ffca28}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper .experimental-tooltip{visibility:hidden;width:200px;background-color:#333;color:#fff;text-align:center;border-radius:6px;padding:8px;position:absolute;z-index:10;bottom:180%;right:-15px;opacity:0;transition:opacity .3s;font-weight:normal;font-size:12px;box-shadow:0 2px 10px rgba(0,0,0,.2);pointer-events:none;line-height:1.4}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper .experimental-tooltip::after{content:"";position:absolute;top:100%;right:18px;border-width:5px;border-style:solid;border-color:#333 rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0)}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper .experimental-icon-wrapper:hover .experimental-tooltip{visibility:visible;opacity:1}.settings-panel .settings-content .settings-section .setting-item .provider-selection-wrapper span[title]{display:flex;align-items:center;justify-content:center}.settings-panel .settings-content .settings-section .setting-item .api-key-container{display:flex;gap:10px;width:100%}.settings-panel .settings-content .settings-section .setting-item .api-key-container .api-key-input{flex:1}.settings-panel .settings-content .settings-section .setting-item .api-key-container .api-key-input.valid{border-color:#10a37f;background-color:rgba(16,163,127,.05)}.settings-panel .settings-content .settings-section .setting-item .api-key-container .api-key-input.invalid{border-color:#ff4c4c;background-color:rgba(255,76,76,.05)}.settings-panel .settings-content .settings-section .setting-item .api-key-container .validate-key-button{display:flex;align-items:center;justify-content:center;background-color:#333;border:1px solid #444;border-radius:4px;color:#ddd;cursor:pointer;padding:0 12px;transition:all .2s;white-space:nowrap}.settings-panel .settings-content .settings-section .setting-item .api-key-container .validate-key-button span{margin-left:5px;font-size:13px}.settings-panel .settings-content .settings-section .setting-item .api-key-container .validate-key-button:hover:not(:disabled){background-color:#444;border-color:#555}.settings-panel .settings-content .settings-section .setting-item .api-key-container .validate-key-button:disabled{opacity:.5;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .api-key-status{margin-top:8px;padding:6px 10px;border-radius:4px;font-size:12px}.settings-panel .settings-content .settings-section .setting-item .api-key-status.success{background-color:rgba(16,163,127,.1);color:#10a37f}.settings-panel .settings-content .settings-section .setting-item .api-key-status.error{background-color:rgba(255,76,76,.1);color:#ff4c4c}.settings-panel .settings-content .settings-section .setting-item .api-key-status.info{background-color:rgba(66,133,244,.1);color:#4285f4}.settings-panel .settings-content .settings-section .setting-item .model-selection-container{display:flex;gap:10px;width:100%}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .select-dropdown{flex:1}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button{display:flex;align-items:center;justify-content:center;background-color:#333;border:1px solid #444;border-radius:4px;color:#ddd;cursor:pointer;padding:0 12px;transition:all .2s;white-space:nowrap;min-width:40px}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button span{display:flex;align-items:center;justify-content:center;font-size:16px;transition:transform .5s ease;transform-origin:center center}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button span svg{display:block;transform-origin:center center}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button span.loading{animation:spin 1s linear infinite}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button:hover:not(:disabled){background-color:#444;border-color:#555}.settings-panel .settings-content .settings-section .setting-item .model-selection-container .refresh-models-button:disabled{opacity:.5;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .loading-status{margin-top:8px;padding:6px 10px;border-radius:4px;font-size:12px;background-color:rgba(66,133,244,.1);color:#4285f4}.settings-panel .settings-content .settings-section .setting-item .models-info{margin-top:8px;padding:6px 10px;border-radius:4px;font-size:12px;background-color:rgba(16,163,127,.1);color:#10a37f}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.settings-panel .settings-content .settings-section .setting-item .select-dropdown{width:100%;padding:8px 10px;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;font-size:14px;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url(${d});background-repeat:no-repeat;background-position:right 10px center;background-size:12px}.settings-panel .settings-content .settings-section .setting-item .select-dropdown:focus{outline:none;border-color:#10a37f}.settings-panel .settings-content .settings-section .setting-item .select-dropdown:disabled{background-color:#2a2a2a;color:#777;cursor:not-allowed;opacity:.6}.settings-panel .settings-content .settings-section .setting-item .slider{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;height:4px;border-radius:2px;background:#444;outline:none}.settings-panel .settings-content .settings-section .setting-item .slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;border-radius:50%;background:#10a37f;cursor:pointer}.settings-panel .settings-content .settings-section .setting-item .slider::-moz-range-thumb{width:14px;height:14px;border-radius:50%;background:#10a37f;cursor:pointer;border:none}.settings-panel .settings-content .settings-section .setting-item .slider:disabled{opacity:.6;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .slider:disabled::-webkit-slider-thumb{background:#777;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .slider:disabled::-moz-range-thumb{background:#777;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options{display:flex;width:100%;border-radius:4px;overflow:hidden;border:1px solid #444}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button{flex:1;background-color:#333;color:#fff;border:none;padding:8px 0;font-size:13px;cursor:pointer;transition:background-color .2s}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button:not(:last-child){border-right:1px solid #444}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button.active{background-color:#10a37f}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button:hover:not(.active):not(:disabled){background-color:#444}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button:disabled{opacity:.6;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .turn-detection-options .option-button:disabled.active{background-color:#777}.settings-panel .settings-content .settings-section .setting-item .text-input{width:100%;padding:8px 10px;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;font-size:13px;box-sizing:border-box;transition:border-color .2s}.settings-panel .settings-content .settings-section .setting-item .text-input:focus{outline:none;border-color:#10a37f}.settings-panel .settings-content .settings-section .setting-item .text-input::placeholder{color:#777}.settings-panel .settings-content .settings-section .setting-item .text-input:disabled{background-color:#2a2a2a;color:#777;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .system-instructions-mode-toggle{display:flex;align-items:center;justify-content:center;background-color:#333;border:1px solid #444;border-radius:4px;color:#ddd;cursor:pointer;padding:0 12px;transition:all .2s;white-space:nowrap}.settings-panel .settings-content .settings-section .setting-item .system-instructions-mode-toggle span{margin-left:5px;font-size:13px}.settings-panel .settings-content .settings-section .setting-item .system-instructions-mode-toggle:hover:not(:disabled){background-color:#444;border-color:#555}.settings-panel .settings-content .settings-section .setting-item .system-instructions-mode-toggle:disabled{opacity:.5;cursor:not-allowed}.settings-panel .settings-content .settings-section .setting-item .language-inputs{display:flex;gap:10px;width:100%}.settings-panel .settings-content .settings-section .setting-item .language-inputs .language-input{flex:1}.settings-panel .settings-content .settings-section .setting-item .language-inputs .language-input.valid{border-color:#10a37f;background-color:rgba(16,163,127,.05)}.settings-panel .settings-content .settings-section .setting-item .language-inputs .language-input.invalid{border-color:#ff4c4c;background-color:rgba(255,76,76,.05)}.settings-panel .settings-content .settings-section .setting-item .preview{width:100%;padding:8px 10px;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;font-size:14px;box-sizing:border-box}.settings-panel .settings-content .settings-section .setting-item .preview:focus{outline:none;border-color:#10a37f}.settings-panel .settings-content .settings-section .api-key-config .config-info{display:flex;align-items:center;margin-bottom:15px;font-size:.9rem}.settings-panel .settings-content .settings-section .api-key-config .config-info p{margin:0;flex-grow:1;color:#aaa}.settings-panel .settings-content .settings-section .api-key-config .config-info code{background-color:#333;padding:2px 5px;border-radius:3px;font-family:monospace;font-size:.85rem;color:#ddd}.settings-panel .settings-content .settings-section .api-key-config .config-info .text-button{display:flex;align-items:center;background:none;border:none;color:#10a37f;cursor:pointer;padding:5px;margin-left:10px}.settings-panel .settings-content .settings-section .api-key-config .config-info .text-button:hover{text-decoration:underline}.settings-panel .settings-content .settings-section .api-key-config .config-info .text-button svg{margin-right:5px}.settings-panel .settings-content .settings-section .api-key-config .api-key-input{position:relative;width:100%}.settings-panel .settings-content .settings-section .api-key-config .api-key-input .api-key-field{width:100%;padding:8px 35px 8px 10px;background-color:#333;border:1px solid #444;border-radius:4px;color:#fff;font-size:14px}.settings-panel .settings-content .settings-section .api-key-config .api-key-input .api-key-field:focus{outline:none;border-color:#10a37f}.settings-panel .settings-content .settings-section .api-key-config .api-key-input .toggle-visibility{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:#aaa;cursor:pointer}.settings-panel .settings-content .settings-section .api-key-config .api-key-input .toggle-visibility:hover{color:#fff}.settings-panel .settings-content .settings-section .api-key-config .actions{display:flex;align-items:center;margin:15px 0}.settings-panel .settings-content .settings-section .api-key-config .actions .save-button{display:flex;align-items:center;padding:8px 15px;background-color:#10a37f;color:#fff;border:none;border-radius:4px;font-size:.9rem;cursor:pointer}.settings-panel .settings-content .settings-section .api-key-config .actions .save-button:hover{background-color:#0d8c6d}.settings-panel .settings-content .settings-section .api-key-config .actions .save-button:disabled{background-color:#444;cursor:not-allowed}.settings-panel .settings-content .settings-section .api-key-config .actions .save-button svg{margin-right:5px}.settings-panel .settings-content .settings-section .api-key-config .actions .save-message{margin-left:15px;padding:5px 10px;border-radius:4px;font-size:.9rem}.settings-panel .settings-content .settings-section .api-key-config .actions .save-message.success{background-color:rgba(16,163,127,.2);color:#10a37f}.settings-panel .settings-content .settings-section .api-key-config .actions .save-message.error{background-color:rgba(255,76,76,.2);color:#ff4c4c}.settings-panel .settings-content .settings-section .api-key-config .actions .save-message.warning{background-color:rgba(255,193,7,.2);color:#ffc107}.settings-panel .settings-content .settings-section .api-key-config .actions .save-message.info{background-color:rgba(66,133,244,.2);color:#4285f4}.settings-panel .settings-content .settings-section .api-key-config .api-key-info{font-size:.9rem;color:#aaa}.settings-panel .settings-content .settings-section .api-key-config .api-key-info p{margin:0}.settings-panel .settings-content .settings-section .api-key-config .api-key-info a{color:#10a37f;text-decoration:none}.settings-panel .settings-content .settings-section .api-key-config .api-key-info a:hover{text-decoration:underline}.settings-panel .settings-content .settings-footer{display:none}.settings-panel .settings-content .restart-onboarding-button{display:flex;align-items:center;width:100%;padding:10px 15px;background-color:#10a37f;color:#fff;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.settings-panel .settings-content .restart-onboarding-button svg{margin-right:8px}.settings-panel .settings-content .restart-onboarding-button:hover{background-color:#0d8c6d}.settings-panel .settings-content .restart-onboarding-button:active{background-color:#0b7a5f}.settings-panel .settings-content .restart-onboarding-button:disabled{background-color:#444;cursor:not-allowed;opacity:.6}`,""]);const p=u},3696:(e,t,n)=>{"use strict";e.exports=n(4403)},4156:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function a(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function r(e,t){try{return t in e}catch(e){return!1}}function s(e,n,l){(l=l||{}).arrayMerge=l.arrayMerge||o,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=i;var c=Array.isArray(n);return c===Array.isArray(e)?c?l.arrayMerge(e,n,l):function(e,t,n){var o={};return n.isMergeableObject(e)&&a(e).forEach((function(t){o[t]=i(e[t],n)})),a(t).forEach((function(a){(function(e,t){return r(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,a)||(r(e,a)&&n.isMergeableObject(t[a])?o[a]=function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(a,n)(e[a],t[a],n):o[a]=i(t[a],n))})),o}(e,n,l):i(n,l)}s.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return s(e,n,t)}),{})};var l=s;e.exports=l},4403:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator,g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,f={};function v(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||g}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=f,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var k=b.prototype=new y;k.constructor=b,m(k,v.prototype),k.isPureReactComponent=!0;var S=Array.isArray,w=Object.prototype.hasOwnProperty,T={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,i){var o,a={},r=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(r=""+t.key),t)w.call(t,o)&&!C.hasOwnProperty(o)&&(a[o]=t[o]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===a[o]&&(a[o]=l[o]);return{$$typeof:n,type:e,key:r,ref:s,props:a,_owner:T.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function E(e,t,o,a,r){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return r=r(l=e),e=""===a?"."+A(l,0):a,S(r)?(o="",null!=e&&(o=e.replace(I,"$&/")+"/"),E(r,t,o,"",(function(e){return e}))):null!=r&&(x(r)&&(r=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,o+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(I,"$&/")+"/")+e)),t.push(r)),1;if(l=0,a=""===a?".":a+":",S(e))for(var c=0;c<e.length;c++){var u=a+A(s=e[c],c);l+=E(s,t,o,u,r)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=E(s=s.value,t,o,u=a+A(s,c++),r);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,n){if(null==e)return e;var i=[],o=0;return E(e,i,"","",(function(e){return t.call(n,e,o++)})),i}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},M={transition:null},R={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:M,ReactCurrentOwner:T};function j(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,n){O(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=r,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=j,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=m({},e.props),a=e.key,r=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(r=t.ref,s=T.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!C.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:n,type:e.type,key:a,ref:r,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=j,t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.3.1"},4417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4628:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:1000;backdrop-filter:blur(2px)}.modal-content{background-color:#2a2a2a;border-radius:8px;width:90%;max-width:500px;box-shadow:0 4px 20px rgba(0,0,0,.3);color:#fff;overflow:hidden;animation:modal-appear .2s ease-out}@keyframes modal-appear{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #3a3a3a}.modal-header h3{margin:0;font-size:18px;font-weight:600}.modal-header .close-button{background:none;border:none;color:#aaa;cursor:pointer;padding:4px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.modal-header .close-button:hover{color:#fff;background-color:hsla(0,0%,100%,.1)}.modal-body{padding:20px;line-height:1.5}",""]);const s=r},4648:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,'.main-panel{display:flex;flex-direction:column;height:100%;position:relative;overflow:hidden}.main-panel .conversation-container{position:absolute;top:0;left:0;right:0;bottom:70px;overflow-y:auto;padding:0 20px;display:flex;flex-direction:column;justify-content:flex-start;margin-bottom:0}.main-panel .conversation-container .conversation-placeholder{display:flex;justify-content:center;align-items:center;height:100%;color:#888;font-size:16px;width:100%}.main-panel .conversation-container .conversation-placeholder .placeholder-content{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.main-panel .conversation-container .conversation-placeholder .placeholder-content .icon-container{display:flex;justify-content:center;align-items:center;width:48px;height:48px;background-color:#333;border-radius:8px;margin-bottom:16px}.main-panel .conversation-container .conversation-placeholder .placeholder-content .icon-container svg{color:#888}.main-panel .conversation-container .conversation-content{width:100%;padding:20px 0;display:flex;flex-direction:column}.main-panel .conversation-container .conversation-content .conversation-item{margin-bottom:12px;padding:10px;border-radius:8px;max-width:95%}.main-panel .conversation-container .conversation-content .conversation-item.user{background-color:#2a2a2a;align-self:flex-end;margin-left:auto}.main-panel .conversation-container .conversation-content .conversation-item.assistant{background-color:#10a37f;align-self:flex-start;margin-right:auto}.main-panel .conversation-container .conversation-content .conversation-item.system{background-color:#444;align-self:center;font-style:italic;max-width:90%}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role{font-size:10px;color:hsla(0,0%,100%,.6);margin-bottom:0;text-transform:capitalize;display:flex;align-items:center;gap:6px;position:absolute;top:4px;right:8px;background-color:inherit;padding:2px 4px;border-radius:4px;z-index:2}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button{display:flex;align-items:center;justify-content:center;background-color:hsla(0,0%,100%,.1);border:none;border-radius:3px;width:16px;height:16px;padding:0;color:#fff;cursor:pointer;transition:background-color .2s ease}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button:hover{background-color:hsla(0,0%,100%,.2)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button:active{background-color:hsla(0,0%,100%,.3)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button.playing{background-color:rgba(16,163,127,.5)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button:disabled{opacity:.5;cursor:not-allowed}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-role .inline-play-button svg{flex-shrink:0}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content{padding-top:12px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item{margin-bottom:4px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item:last-child{margin-bottom:0}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.text,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.input_text{white-space:pre-wrap;word-break:break-word}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript{font-style:italic;color:hsla(0,0%,100%,.8);font-size:.9em;padding-left:8px;border-left:2px solid hsla(0,0%,100%,.3)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .transcript-content{margin-bottom:6px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls{display:flex;justify-content:flex-start;margin-top:6px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button{display:flex;align-items:center;gap:4px;background-color:hsla(0,0%,100%,.1);border:none;border-radius:4px;padding:4px 8px;color:#fff;font-size:12px;cursor:pointer;transition:background-color .2s ease}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button:hover{background-color:hsla(0,0%,100%,.2)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button:active{background-color:hsla(0,0%,100%,.3)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button.playing{background-color:rgba(16,163,127,.5)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button:disabled{opacity:.5;cursor:not-allowed}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.transcript .audio-controls .play-button svg{flex-shrink:0}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator{display:flex;align-items:center;gap:8px;padding:8px 12px;background-color:rgba(0,0,0,.2);border-radius:6px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .audio-icon{display:flex;align-items:center;justify-content:center;color:hsla(0,0%,100%,.8)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .audio-text{font-size:14px;color:hsla(0,0%,100%,.8);flex:1}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button{display:flex;align-items:center;gap:4px;background-color:hsla(0,0%,100%,.1);border:none;border-radius:4px;padding:4px 8px;color:#fff;font-size:12px;cursor:pointer;transition:background-color .2s ease}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button:hover{background-color:hsla(0,0%,100%,.2)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button:active{background-color:hsla(0,0%,100%,.3)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button.playing{background-color:rgba(16,163,127,.5)}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button:disabled{opacity:.5;cursor:not-allowed}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.audio .audio-indicator .play-button svg{flex-shrink:0}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-call,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-output{background-color:rgba(0,0,0,.2);border-radius:6px;padding:10px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-call .tool-name,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-output .tool-name{font-weight:bold;margin-bottom:5px;font-size:14px}.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-call .tool-args pre,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-call .output-content pre,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-output .tool-args pre,.main-panel .conversation-container .conversation-content .conversation-item .conversation-item-content .content-item.tool-output .output-content pre{margin:0;white-space:pre-wrap;font-family:monospace;font-size:13px;background-color:rgba(0,0,0,.2);padding:8px;border-radius:4px;overflow-x:auto}.main-panel .conversation-container .logs-container h3{margin-top:0;margin-bottom:15px;font-size:16px;font-weight:500}.main-panel .conversation-container .logs-container .logs-content{background-color:#2a2a2a;border-radius:4px;padding:15px;font-family:monospace;font-size:13px;color:#ddd;max-height:500px;overflow-y:auto}.main-panel .main-panel-footer{display:flex;justify-content:center;gap:10px;padding:15px 20px;border-top:1px solid #333}.main-panel .main-panel-footer button{padding:8px 16px;border-radius:4px;font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px}.main-panel .main-panel-footer button.start-button{background-color:#10a37f;color:#fff;border:none}.main-panel .main-panel-footer button.start-button:hover{background-color:#0d8c6d}.main-panel .main-panel-footer button.output-button{background-color:rgba(0,0,0,0);color:#fff;border:1px solid #555}.main-panel .main-panel-footer button.output-button:hover{background-color:hsla(0,0%,100%,.1)}.main-panel .audio-visualization{display:flex;align-items:center;padding:6px 10px;background-color:rgba(0,0,0,.2);border-radius:8px;position:absolute;bottom:15px;left:10px;right:10px;z-index:5;height:40px}.main-panel .audio-visualization .visualization-container{flex:1;margin:0 5px;display:flex;flex-direction:column;justify-content:center;height:100%;max-width:30%;position:relative}.main-panel .audio-visualization .visualization-container .visualization-label{font-size:13px;color:#888;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%);z-index:2;text-align:center}.main-panel .audio-visualization .visualization-container .visualization-canvas{width:100%;height:28px;background-color:rgba(0,0,0,.1);border-radius:4px}.main-panel .audio-visualization .visualization-container .visualization-canvas.client-canvas{background-color:rgba(0,153,255,.1)}.main-panel .audio-visualization .visualization-container .visualization-canvas.server-canvas{background-color:rgba(0,153,0,.1)}.main-panel .audio-visualization .controls-container{display:flex;align-items:center;gap:10px;justify-content:center;padding:0 5px;margin:0 auto}.main-panel .audio-visualization .controls-container .push-to-talk-button{display:flex;align-items:center;gap:8px;background-color:#444;border:none;border-radius:6px;color:#fff;padding:6px 12px;font-size:13px;font-weight:500;cursor:pointer;transition:background-color .2s;height:28px}.main-panel .audio-visualization .controls-container .push-to-talk-button:hover{background-color:#555}.main-panel .audio-visualization .controls-container .push-to-talk-button.recording{background-color:#e74c3c}.main-panel .audio-visualization .controls-container .push-to-talk-button.recording:hover{background-color:#c0392b}.main-panel .audio-visualization .controls-container .push-to-talk-button:disabled{opacity:.5;cursor:not-allowed}@media(max-width: 576px){.main-panel .audio-visualization .controls-container .push-to-talk-button{padding:6px;gap:0}.main-panel .audio-visualization .controls-container .push-to-talk-button span{display:none}}.main-panel .audio-visualization .controls-container .session-button{display:flex;align-items:center;gap:8px;background-color:#10a37f;border:none;border-radius:6px;color:#fff;padding:6px 12px;font-size:13px;font-weight:500;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2);transition:background-color .2s,transform .1s;height:28px;position:relative}.main-panel .audio-visualization .controls-container .session-button:hover{background-color:#0c8c6a}.main-panel .audio-visualization .controls-container .session-button.active{background-color:#444}.main-panel .audio-visualization .controls-container .session-button.active:hover{background-color:#555}.main-panel .audio-visualization .controls-container .session-button:disabled{background-color:#666;opacity:.6;cursor:not-allowed;box-shadow:none}.main-panel .audio-visualization .controls-container .session-button:disabled:hover{background-color:#666}.main-panel .audio-visualization .controls-container .session-button:disabled:hover .tooltip{visibility:visible;opacity:1}.main-panel .audio-visualization .controls-container .session-button:disabled .tooltip{visibility:hidden;width:200px;background-color:#333;color:#fff;text-align:center;border-radius:6px;padding:8px;position:absolute;z-index:10;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity .3s;font-weight:normal;font-size:12px;box-shadow:0 2px 10px rgba(0,0,0,.2);pointer-events:none}.main-panel .audio-visualization .controls-container .session-button:disabled .tooltip::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#333 rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0)}@media(max-width: 576px){.main-panel .audio-visualization .controls-container .session-button{padding:6px;gap:0}.main-panel .audio-visualization .controls-container .session-button span{display:none}}.main-panel .audio-visualization .controls-container .debug-button{display:flex;align-items:center;gap:8px;background-color:rgba(0,0,0,0);border:1px solid #555;border-radius:6px;color:#fff;padding:6px 12px;font-size:13px;cursor:pointer;height:28px;transition:background-color .2s}.main-panel .audio-visualization .controls-container .debug-button:hover{background-color:hsla(0,0%,100%,.1)}.main-panel .audio-visualization .controls-container .debug-button.active{background-color:#444}.main-panel .audio-visualization .controls-container .debug-button.active:hover{background-color:#555}@media(max-width: 576px){.main-panel .audio-visualization .controls-container .debug-button{padding:6px;gap:0}.main-panel .audio-visualization .controls-container .debug-button span{display:none}}@media(max-width: 576px){.session-button .tooltip{display:block !important}}',""]);const s=r},5056:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var a={},r=[],s=0;s<e.length;s++){var l=e[s],c=i.base?l[0]+i.base:l[0],u=a[c]||0,d="".concat(c," ").concat(u);a[c]=u+1;var p=n(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var g=o(h,i);i.byIndex=s,t.splice(s,0,{identifier:d,updater:g,references:1})}r.push(d)}return r}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var a=i(e=e||[],o=o||{});return function(e){e=e||[];for(var r=0;r<a.length;r++){var s=n(a[r]);t[s].references--}for(var l=i(e,o),c=0;c<a.length;c++){var u=n(a[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=l}}},5323:(e,t,n)=>{"use strict";n.d(t,{k2:()=>i,uc:()=>o,uo:()=>r,yz:()=>a});const i={POSTHOG_KEY:"phc_EMOuUDTntTI5SuzKQATy11qHgxVrlhJsgNFbBaWEhet",POSTHOG_HOST:"https://us.i.posthog.com"},o=()=>{try{if(void 0!==globalThis.process&&globalThis.process.env)return"development"===globalThis.process.env.NODE_ENV?"development":"production"}catch(e){}return"undefined"!=typeof window&&window.location&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"5173"===window.location.port)||"undefined"!=typeof document&&document.title&&document.title.includes("dev")||void 0!==globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.getManifest&&!("update_url"in globalThis.chrome.runtime.getManifest())?"development":"production"},a=()=>"development"===o(),r=()=>{const e=window.chrome;return void 0!==e&&e.runtime&&e.runtime.id?"extension":window.electronAPI||window.require||navigator.userAgent.includes("Electron")?"app":"web"}},6006:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".audio-panel{display:flex;flex-direction:column;height:100%;width:100%;box-sizing:border-box;overflow-x:hidden}.audio-panel .audio-panel-header{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #333;box-sizing:border-box;width:100%}.audio-panel .audio-panel-header h2{margin:0;font-size:16px;font-weight:500}.audio-panel .audio-panel-header .close-audio-button{display:flex;align-items:center;background:none;border:none;color:#aaa;cursor:pointer;padding:5px 10px;border-radius:4px;transition:all .2s}.audio-panel .audio-panel-header .close-audio-button span{margin-left:5px;font-size:13px}.audio-panel .audio-panel-header .close-audio-button:hover{background-color:hsla(0,0%,100%,.1);color:#fff}.audio-panel .audio-content{flex:1;overflow-y:auto;overflow-x:hidden;padding:15px;scrollbar-gutter:stable;box-sizing:border-box;width:100%}.audio-panel .audio-content .audio-section{margin-bottom:20px}.audio-panel .audio-content .audio-section h3{font-size:14px;font-weight:500;margin-bottom:15px;color:#ccc}.audio-panel .audio-content .audio-section h4{font-size:13px;font-weight:500;margin:15px 0 10px;color:#aaa}.audio-panel .audio-content .audio-section .device-selector{background-color:#2a2a2a;border-radius:6px;padding:12px;margin-bottom:15px}.audio-panel .audio-content .audio-section .device-selector .device-status{display:flex;align-items:center;margin-bottom:12px}.audio-panel .audio-content .audio-section .device-selector .device-status .device-icon{width:36px;height:36px;border-radius:50%;background-color:#333;display:flex;justify-content:center;align-items:center;margin-right:12px}.audio-panel .audio-content .audio-section .device-selector .device-status .device-icon.active{background-color:#10a37f;color:#fff}.audio-panel .audio-content .audio-section .device-selector .device-status .device-icon.inactive{background-color:#444;color:#aaa}.audio-panel .audio-content .audio-section .device-selector .device-status .device-info{flex:1}.audio-panel .audio-content .audio-section .device-selector .device-status .device-info .device-name{font-size:14px;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}.audio-panel .audio-content .audio-section .device-selector .device-toggle-button{width:100%;padding:8px;border-radius:4px;border:none;font-size:13px;cursor:pointer;transition:all .2s}.audio-panel .audio-content .audio-section .device-selector .device-toggle-button.on{background-color:#10a37f;color:#fff}.audio-panel .audio-content .audio-section .device-selector .device-toggle-button.on:hover{background-color:#0c8c6a}.audio-panel .audio-content .audio-section .device-selector .device-toggle-button.off{background-color:#444;color:#ddd}.audio-panel .audio-content .audio-section .device-selector .device-toggle-button.off:hover{background-color:#555}.audio-panel .audio-content .audio-section .device-list .device-list-header{display:flex;justify-content:space-between;align-items:center;margin:15px 0 10px}.audio-panel .audio-content .audio-section .device-list .device-list-header h4{font-size:13px;font-weight:500;margin:0;color:#aaa}.audio-panel .audio-content .audio-section .device-list .device-list-header .refresh-button{background:none;border:none;color:#aaa;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:4px;border-radius:4px;transition:all .2s}.audio-panel .audio-content .audio-section .device-list .device-list-header .refresh-button:hover{background-color:hsla(0,0%,100%,.1);color:#fff}.audio-panel .audio-content .audio-section .device-list .device-list-header .refresh-button:disabled{opacity:.5;cursor:not-allowed}.audio-panel .audio-content .audio-section .device-list .device-list-header .refresh-button:disabled:hover{background:none;color:#aaa}.audio-panel .audio-content .audio-section .device-list .device-option{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background-color:#2a2a2a;border-radius:4px;margin-bottom:6px;cursor:pointer;transition:background-color .2s;position:relative}.audio-panel .audio-content .audio-section .device-list .device-option:hover{background-color:hsla(0,0%,100%,.05)}.audio-panel .audio-content .audio-section .device-list .device-option.selected{background-color:hsla(0,0%,100%,.1)}.audio-panel .audio-content .audio-section .device-list .device-option.virtual-device{border-left:3px solid #f0ad4e;background-color:rgba(240,173,78,.05)}.audio-panel .audio-content .audio-section .device-list .device-option.virtual-device:hover{background-color:rgba(240,173,78,.1)}.audio-panel .audio-content .audio-section .device-list .device-option span{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.audio-panel .audio-content .audio-section .device-list .device-option .selected-indicator{width:8px;height:8px;border-radius:50%;background-color:#3498db;margin-left:10px}.audio-panel .audio-content .audio-section .device-list .device-option .virtual-indicator{margin-left:8px;display:flex;align-items:center}.audio-panel .audio-content .audio-section .device-list .device-option .default-indicator{margin-left:8px;display:flex;align-items:center;background-color:#10a37f;border-radius:3px;padding:2px 5px}.audio-panel .audio-content .audio-section .device-list .device-option .default-indicator span{font-size:10px;color:#fff;font-weight:500}.audio-panel .audio-waveform{display:flex;align-items:center;gap:2px;height:16px;max-width:45px;min-width:30px;margin-right:10px}.audio-panel .audio-waveform .waveform-bar{background-color:#10a37f;width:3px;border-radius:1.5px;transition:height .1s ease}.audio-panel .virtual-mic-warning{display:flex;flex-direction:column;align-items:center;text-align:center}.audio-panel .virtual-mic-warning .warning-icon{margin-bottom:16px;background-color:rgba(240,173,78,.1);border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center}.audio-panel .virtual-mic-warning p{margin-bottom:12px;line-height:1.5;color:#e0e0e0}.audio-panel .virtual-mic-warning p strong{color:#fff}.audio-panel .virtual-mic-warning .understand-button{margin-top:16px;padding:10px 20px;background-color:#3498db;color:#fff;border:none;border-radius:4px;cursor:pointer;font-weight:500;transition:background-color .2s}.audio-panel .virtual-mic-warning .understand-button:hover{background-color:#2980b9}.audio-panel .voice-passthrough-section .device-info .device-description{font-size:12px;color:#aaa;line-height:1.4;margin-top:2px}.audio-panel .voice-passthrough-section .device-list .volume-control{background-color:#2a2a2a;border-radius:4px;padding:12px;margin-bottom:6px}.audio-panel .voice-passthrough-section .device-list .volume-control .setting-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.audio-panel .voice-passthrough-section .device-list .volume-control .setting-label span{font-size:13px}.audio-panel .voice-passthrough-section .device-list .volume-control .setting-label span:first-child{color:#fff;font-weight:500}.audio-panel .voice-passthrough-section .device-list .volume-control .setting-label span.setting-value{color:#10a37f;font-weight:600}.audio-panel .voice-passthrough-section .device-list .volume-control.disabled .setting-label span:first-child{color:#888}.audio-panel .voice-passthrough-section .device-list .volume-control.disabled .setting-label span.setting-value{color:#666}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider{width:100%;height:4px;border-radius:2px;background:#444;outline:none;-webkit-appearance:none;appearance:none;margin-bottom:8px;transition:opacity .2s}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:16px;height:16px;border-radius:50%;background:#10a37f;cursor:pointer;border:2px solid #fff;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:all .2s}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:#10a37f;cursor:pointer;border:2px solid #fff;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:all .2s}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider:disabled{opacity:.5;cursor:not-allowed}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider:disabled::-webkit-slider-thumb{background:#666;cursor:not-allowed;box-shadow:0 1px 2px rgba(0,0,0,.1)}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-slider:disabled::-moz-range-thumb{background:#666;cursor:not-allowed;box-shadow:0 1px 2px rgba(0,0,0,.1)}.audio-panel .voice-passthrough-section .device-list .volume-control .volume-limits{display:flex;justify-content:space-between;font-size:11px;color:#666}",""]);const s=r},6067:(e,t,n)=>{"use strict";var i=n(3696),o=n(1434);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)r.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function m(e,t,n,i,o,a,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=r}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){f[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];f[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){f[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){f[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){f[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){f[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){f[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){f[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){f[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var o=f.hasOwnProperty(t)?f[t]:null;(null!==o?0!==o.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,i)&&(n=null),i||null===o?function(e){return!!d.call(g,e)||!d.call(h,e)&&(p.test(e)?g[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,i=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);f[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);f[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);f[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){f[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),f.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){f[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var k=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),I=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function j(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=R&&e[R]||e["@@iterator"])?e:null}var D,L=Object.assign;function F(e){if(void 0===D)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var z=!1;function U(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var i=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){i=e}e.call(t.prototype)}else{try{throw Error()}catch(e){i=e}e()}}catch(t){if(t&&i&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),a=i.stack.split("\n"),r=o.length-1,s=a.length-1;1<=r&&0<=s&&o[r]!==a[s];)s--;for(;1<=r&&0<=s;r--,s--)if(o[r]!==a[s]){if(1!==r||1!==s)do{if(r--,0>--s||o[r]!==a[s]){var l="\n"+o[r].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=r&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case w:return"Portal";case P:return"Profiler";case C:return"StrictMode";case E:return"Suspense";case O:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return B(e(t))}catch(e){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){i=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=H(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function $(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=K(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Z(e,t){Y(e,t);var n=K(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&i&&(e[n].defaultSelected=!0)}else{for(n=""+K(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(i&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:K(n)}}function ae(e,t){var n=K(t.value),i=K(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),o=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,o):e[n]=o}}Object.keys(he).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Te=null,Ce=null;function Pe(e){if(e=ko(e)){if("function"!=typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=wo(t),we(e.stateNode,e.type,t))}}function xe(e){Te?Ce?Ce.push(e):Ce=[e]:Te=e}function Ie(){if(Te){var e=Te,t=Ce;if(Ce=Te=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function Ae(e,t){return e(t)}function Ee(){}var Oe=!1;function _e(e,t,n){if(Oe)return e(t,n);Oe=!0;try{return Ae(e,t,n)}finally{Oe=!1,(null!==Te||null!==Ce)&&(Ee(),Ie())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var i=wo(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Me=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Me=!1}function je(e,t,n,i,o,a,r,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var De=!1,Le=null,Fe=!1,ze=null,Ue={onError:function(e){De=!0,Le=e}};function Ve(e,t,n,i,o,a,r,s,l){De=!1,Le=null,je.apply(Ue,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Ke(e){if(Be(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(null===o)break;var r=o.alternate;if(null===r){if(null!==(i=o.return)){n=i;continue}break}if(o.child===r.child){for(r=o.child;r;){if(r===n)return Ke(o),e;if(r===i)return Ke(o),t;r=r.sibling}throw Error(a(188))}if(n.return!==i.return)n=o,i=r;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s){for(l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ge=o.unstable_scheduleCallback,$e=o.unstable_cancelCallback,Je=o.unstable_shouldYield,Qe=o.unstable_requestPaint,Ye=o.unstable_now,Ze=o.unstable_getCurrentPriorityLevel,Xe=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,it=o.unstable_IdlePriority,ot=null,at=null,rt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2,ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,o=e.suspendedLanes,a=e.pingedLanes,r=268435455&n;if(0!==r){var s=r&~o;0!==s?i=dt(s):0!=(a&=r)&&(i=dt(a))}else 0!=(r=n&~o)?i=dt(r):0!==a&&(i=dt(a));if(0===i)return 0;if(0!==t&&t!==i&&!(t&o)&&((o=i&-i)>=(a=t&-t)||16===o&&4194240&a))return t;if(4&i&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)o=1<<(n=31-rt(t)),i|=e[n],t&=~o;return i}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-rt(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-rt(n),o=1<<i;o&t|e[i]&t&&(e[i]|=t),n&=~o}}var bt=0;function kt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var St,wt,Tt,Ct,Pt,xt=!1,It=[],At=null,Et=null,Ot=null,_t=new Map,Nt=new Map,Mt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Et=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Dt(e,t,n,i,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[o]},null!==t&&null!==(t=ko(t))&&wt(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=bo(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Pt(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ko(n))&&wt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ke=i,n.target.dispatchEvent(i),ke=null,t.shift()}return!0}function zt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){xt=!1,null!==At&&Ft(At)&&(At=null),null!==Et&&Ft(Et)&&(Et=null),null!==Ot&&Ft(Ot)&&(Ot=null),_t.forEach(zt),Nt.forEach(zt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return Vt(t,e)}if(0<It.length){Vt(It[0],e);for(var n=1;n<It.length;n++){var i=It[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==At&&Vt(At,e),null!==Et&&Vt(Et,e),null!==Ot&&Vt(Ot,e),_t.forEach(t),Nt.forEach(t),n=0;n<Mt.length;n++)(i=Mt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Mt.shift()}var qt=k.ReactCurrentBatchConfig,Kt=!0;function Ht(e,t,n,i){var o=bt,a=qt.transition;qt.transition=null;try{bt=1,Gt(e,t,n,i)}finally{bt=o,qt.transition=a}}function Wt(e,t,n,i){var o=bt,a=qt.transition;qt.transition=null;try{bt=4,Gt(e,t,n,i)}finally{bt=o,qt.transition=a}}function Gt(e,t,n,i){if(Kt){var o=Jt(e,t,n,i);if(null===o)Ki(e,t,i,$t,n),jt(e,i);else if(function(e,t,n,i,o){switch(t){case"focusin":return At=Dt(At,e,t,n,i,o),!0;case"dragenter":return Et=Dt(Et,e,t,n,i,o),!0;case"mouseover":return Ot=Dt(Ot,e,t,n,i,o),!0;case"pointerover":var a=o.pointerId;return _t.set(a,Dt(_t.get(a)||null,e,t,n,i,o)),!0;case"gotpointercapture":return a=o.pointerId,Nt.set(a,Dt(Nt.get(a)||null,e,t,n,i,o)),!0}return!1}(o,e,t,n,i))i.stopPropagation();else if(jt(e,i),4&t&&-1<Rt.indexOf(e)){for(;null!==o;){var a=ko(o);if(null!==a&&St(a),null===(a=Jt(e,t,n,i))&&Ki(e,t,i,$t,n),a===o)break;o=a}null!==o&&i.stopPropagation()}else Ki(e,t,i,null,n)}}var $t=null;function Jt(e,t,n,i){if($t=null,null!==(e=bo(e=Se(i))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Zt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Zt,i=n.length,o="value"in Yt?Yt.value:Yt.textContent,a=o.length;for(e=0;e<i&&n[e]===o[e];e++);var r=i-e;for(t=1;t<=r&&n[i-t]===o[a-t];t++);return Xt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function an(e){function t(t,n,i,o,a){for(var r in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(o):o[r]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:on,this.isPropagationStopped=on,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=L({},cn,{view:0,detail:0}),pn=an(dn),hn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(rn=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=rn=0,ln=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),gn=an(hn),mn=an(L({},hn,{dataTransfer:0})),fn=an(L({},dn,{relatedTarget:0})),vn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),kn=an(L({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function Pn(){return Cn}var xn=L({},dn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=an(xn),An=an(L({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),En=an(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),On=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=L({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=an(_n),Mn=[9,13,27,32],Rn=u&&"CompositionEvent"in window,jn=null;u&&"documentMode"in document&&(jn=document.documentMode);var Dn=u&&"TextEvent"in window&&!jn,Ln=u&&(!Rn||jn&&8<jn&&11>=jn),Fn=String.fromCharCode(32),zn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1,qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Hn(e,t,n,i){xe(i),0<(t=Wi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Wn=null,Gn=null;function $n(e){Fi(e,0)}function Jn(e){if(G(So(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Zn;if(u){var Xn="oninput"in document;if(!Xn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Xn="function"==typeof ei.oninput}Zn=Xn}else Zn=!1;Yn=Zn&&(!document.documentMode||9<document.documentMode)}function ti(){Wn&&(Wn.detachEvent("onpropertychange",ni),Gn=Wn=null)}function ni(e){if("value"===e.propertyName&&Jn(Gn)){var t=[];Hn(t,Gn,e,Se(e)),_e($n,t)}}function ii(e,t,n){"focusin"===e?(ti(),Gn=n,(Wn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function oi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Gn)}function ai(e,t){if("click"===e)return Jn(t)}function ri(e,t){if("input"===e||"change"===e)return Jn(t)}var si="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function li(e,t){if(si(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!d.call(t,o)||!si(e[o],t[o]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pi(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function hi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gi(e){var t=pi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&hi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(i.start,o);i=void 0===i.end?a:Math.min(i.end,o),!e.extend&&a>i&&(o=i,i=a,a=o),o=ui(n,a);var r=ui(n,i);o&&r&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,fi=null,vi=null,yi=null,bi=!1;function ki(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==fi||fi!==$(i)||(i="selectionStart"in(i=fi)&&hi(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Wi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=fi)))}function Si(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:Si("Animation","AnimationEnd"),animationiteration:Si("Animation","AnimationIteration"),animationstart:Si("Animation","AnimationStart"),transitionend:Si("Transition","TransitionEnd")},Ti={},Ci={};function Pi(e){if(Ti[e])return Ti[e];if(!wi[e])return e;var t,n=wi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ci)return Ti[e]=n[t];return e}u&&(Ci=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var xi=Pi("animationend"),Ii=Pi("animationiteration"),Ai=Pi("animationstart"),Ei=Pi("transitionend"),Oi=new Map,_i="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(e,t){Oi.set(e,t),l(t,[e])}for(var Mi=0;Mi<_i.length;Mi++){var Ri=_i[Mi];Ni(Ri.toLowerCase(),"on"+(Ri[0].toUpperCase()+Ri.slice(1)))}Ni(xi,"onAnimationEnd"),Ni(Ii,"onAnimationIteration"),Ni(Ai,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Ei,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(ji));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,o,r,s,l,c){if(Ve.apply(this,arguments),De){if(!De)throw Error(a(198));var u=Le;De=!1,Le=null,Fe||(Fe=!0,ze=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],o=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var r=i.length-1;0<=r;r--){var s=i[r],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;Li(o,s,c),a=l}else for(r=0;r<i.length;r++){if(l=(s=i[r]).instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;Li(o,s,c),a=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zi(e,t){var n=t[fo];void 0===n&&(n=t[fo]=new Set);var i=e+"__bubble";n.has(i)||(qi(t,e,2,!1),n.add(i))}function Ui(e,t,n){var i=0;t&&(i|=4),qi(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Bi(e){if(!e[Vi]){e[Vi]=!0,r.forEach((function(t){"selectionchange"!==t&&(Di.has(t)||Ui(t,!1,e),Ui(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Ui("selectionchange",!1,t))}}function qi(e,t,n,i){switch(Qt(t)){case 1:var o=Ht;break;case 4:o=Wt;break;default:o=Gt}n=o.bind(null,t,n,e),o=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),i?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ki(e,t,n,i,o){var a=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var r=i.tag;if(3===r||4===r){var s=i.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===r)for(r=i.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;r=r.return}for(;null!==s;){if(null===(r=bo(s)))return;if(5===(l=r.tag)||6===l){i=a=r;continue e}s=s.parentNode}}i=i.return}_e((function(){var i=a,o=Se(n),r=[];e:{var s=Oi.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=fn;break;case"focusout":c="blur",l=fn;break;case"beforeblur":case"afterblur":l=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=En;break;case xi:case Ii:case Ai:l=vn;break;case Ei:l=On;break;case"scroll":l=pn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=!!(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var h,g=i;null!==g;){var m=(h=g).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==p&&null!=(m=Ne(g,p))&&u.push(Hi(g,m,h))),d)break;g=g.return}0<u.length&&(s=new l(s,c,null,n,o),r.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ke||!(c=n.relatedTarget||n.fromElement)||!bo(c)&&!c[mo])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?bo(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=gn,m="onMouseLeave",p="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,m="onPointerLeave",p="onPointerEnter",g="pointer"),d=null==l?s:So(l),h=null==c?s:So(c),(s=new u(m,g+"leave",l,n,o)).target=d,s.relatedTarget=h,m=null,bo(o)===i&&((u=new u(p,g+"enter",c,n,o)).target=h,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(p=c,g=0,h=u=l;h;h=Gi(h))g++;for(h=0,m=p;m;m=Gi(m))h++;for(;0<g-h;)u=Gi(u),g--;for(;0<h-g;)p=Gi(p),h--;for(;g--;){if(u===p||null!==p&&u===p.alternate)break e;u=Gi(u),p=Gi(p)}u=null}else u=null;null!==l&&$i(r,s,l,u,!1),null!==c&&null!==d&&$i(r,d,c,u,!0)}if("select"===(l=(s=i?So(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var f=Qn;else if(Kn(s))if(Yn)f=ri;else{f=oi;var v=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(f=ai);switch(f&&(f=f(e,i))?Hn(r,f,n,o):(v&&v(e,s,i),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=i?So(i):window,e){case"focusin":(Kn(v)||"true"===v.contentEditable)&&(fi=v,vi=i,yi=null);break;case"focusout":yi=vi=fi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,ki(r,n,o);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":ki(r,n,o)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):(Zt="value"in(Yt=o)?Yt.value:Yt.textContent,Bn=!0)),0<(v=Wi(i,b)).length&&(b=new kn(b,e,null,n,o),r.push({event:b,listeners:v}),(y||null!==(y=Vn(n)))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(zn=!0,Fn);case"textInput":return(e=t.data)===Fn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Rn&&Un(e,t)?(e=en(),Xt=Zt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(i=Wi(i,"onBeforeInput")).length&&(o=new kn("onBeforeInput","beforeinput",null,n,o),r.push({event:o,listeners:i}),o.data=y)}Fi(r,t)}))}function Hi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wi(e,t){for(var n=t+"Capture",i=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=Ne(e,n))&&i.unshift(Hi(e,a,o)),null!=(a=Ne(e,t))&&i.push(Hi(e,a,o))),e=e.return}return i}function Gi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $i(e,t,n,i,o){for(var a=t._reactName,r=[];null!==n&&n!==i;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Ne(n,a))&&r.unshift(Hi(n,l,s)):o||null!=(l=Ne(n,a))&&r.push(Hi(n,l,s))),n=n.return}0!==r.length&&e.push({event:t,listeners:r})}var Ji=/\r\n?/g,Qi=/\u0000|\uFFFD/g;function Yi(e){return("string"==typeof e?e:""+e).replace(Ji,"\n").replace(Qi,"")}function Zi(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(a(425))}function Xi(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var io="function"==typeof setTimeout?setTimeout:void 0,oo="function"==typeof clearTimeout?clearTimeout:void 0,ao="function"==typeof Promise?Promise:void 0,ro="function"==typeof queueMicrotask?queueMicrotask:void 0!==ao?function(e){return ao.resolve(null).then(e).catch(so)}:io;function so(e){setTimeout((function(){throw e}))}function lo(e,t){var n=t,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===i)return e.removeChild(o),void Bt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=o}while(n);Bt(t)}function co(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),ho="__reactFiber$"+po,go="__reactProps$"+po,mo="__reactContainer$"+po,fo="__reactEvents$"+po,vo="__reactListeners$"+po,yo="__reactHandles$"+po;function bo(e){var t=e[ho];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mo]||n[ho]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[ho])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function ko(e){return!(e=e[ho]||e[mo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function So(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wo(e){return e[go]||null}var To=[],Co=-1;function Po(e){return{current:e}}function xo(e){0>Co||(e.current=To[Co],To[Co]=null,Co--)}function Io(e,t){Co++,To[Co]=e.current,e.current=t}var Ao={},Eo=Po(Ao),Oo=Po(!1),_o=Ao;function No(e,t){var n=e.type.contextTypes;if(!n)return Ao;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Mo(e){return null!=e.childContextTypes}function Ro(){xo(Oo),xo(Eo)}function jo(e,t,n){if(Eo.current!==Ao)throw Error(a(168));Io(Eo,t),Io(Oo,n)}function Do(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var o in i=i.getChildContext())if(!(o in t))throw Error(a(108,q(e)||"Unknown",o));return L({},n,i)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ao,_o=Eo.current,Io(Eo,e),Io(Oo,Oo.current),!0}function Fo(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=Do(e,t,_o),i.__reactInternalMemoizedMergedChildContext=e,xo(Oo),xo(Eo),Io(Eo,e)):xo(Oo),Io(Oo,n)}var zo=null,Uo=!1,Vo=!1;function Bo(e){null===zo?zo=[e]:zo.push(e)}function qo(){if(!Vo&&null!==zo){Vo=!0;var e=0,t=bt;try{var n=zo;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}zo=null,Uo=!1}catch(t){throw null!==zo&&(zo=zo.slice(e+1)),Ge(Xe,qo),t}finally{bt=t,Vo=!1}}return null}var Ko=[],Ho=0,Wo=null,Go=0,$o=[],Jo=0,Qo=null,Yo=1,Zo="";function Xo(e,t){Ko[Ho++]=Go,Ko[Ho++]=Wo,Wo=e,Go=t}function ea(e,t,n){$o[Jo++]=Yo,$o[Jo++]=Zo,$o[Jo++]=Qo,Qo=e;var i=Yo;e=Zo;var o=32-rt(i)-1;i&=~(1<<o),n+=1;var a=32-rt(t)+o;if(30<a){var r=o-o%5;a=(i&(1<<r)-1).toString(32),i>>=r,o-=r,Yo=1<<32-rt(t)+o|n<<o|i,Zo=a+e}else Yo=1<<a|n<<o|i,Zo=e}function ta(e){null!==e.return&&(Xo(e,1),ea(e,1,0))}function na(e){for(;e===Wo;)Wo=Ko[--Ho],Ko[Ho]=null,Go=Ko[--Ho],Ko[Ho]=null;for(;e===Qo;)Qo=$o[--Jo],$o[Jo]=null,Zo=$o[--Jo],$o[Jo]=null,Yo=$o[--Jo],$o[Jo]=null}var ia=null,oa=null,aa=!1,ra=null;function sa(e,t){var n=_c(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function la(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ia=e,oa=co(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ia=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qo?{id:Yo,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_c(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ia=e,oa=null,!0);default:return!1}}function ca(e){return!(!(1&e.mode)||128&e.flags)}function ua(e){if(aa){var t=oa;if(t){var n=t;if(!la(e,t)){if(ca(e))throw Error(a(418));t=co(n.nextSibling);var i=ia;t&&la(e,t)?sa(i,n):(e.flags=-4097&e.flags|2,aa=!1,ia=e)}}else{if(ca(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,ia=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ia=e}function pa(e){if(e!==ia)return!1;if(!aa)return da(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oa)){if(ca(e))throw ha(),Error(a(418));for(;t;)sa(e,t),t=co(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oa=co(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oa=null}}else oa=ia?co(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=oa;e;)e=co(e.nextSibling)}function ga(){oa=ia=null,aa=!1}function ma(e){null===ra?ra=[e]:ra.push(e)}var fa=k.ReactCurrentBatchConfig;function va(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var o=i,r=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=o.refs;null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function ka(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function r(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Lc(n,e.mode,i)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,i){var a=n.type;return a===T?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===N&&ba(a)===t.type)?((i=o(t,n.props)).ref=va(e,t,n),i.return=e,i):((i=Rc(n.type,n.key,n.props,null,e.mode,i)).ref=va(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,i,a){return null===t||7!==t.tag?((t=jc(n,e.mode,i,a)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=va(e,null,t),n.return=e,n;case w:return(t=Fc(t,e.mode,n)).return=e,t;case N:return p(e,(0,t._init)(t._payload),n)}if(te(t)||j(t))return(t=jc(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function h(e,t,n,i){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===o?c(e,t,n,i):null;case w:return n.key===o?u(e,t,n,i):null;case N:return h(e,t,(o=n._init)(n._payload),i)}if(te(n)||j(n))return null!==o?null:d(e,t,n,i,null);ya(e,n)}return null}function g(e,t,n,i,o){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,o);if("object"==typeof i&&null!==i){switch(i.$$typeof){case S:return c(t,e=e.get(null===i.key?n:i.key)||null,i,o);case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,o);case N:return g(e,t,n,(0,i._init)(i._payload),o)}if(te(i)||j(i))return d(t,e=e.get(n)||null,i,o,null);ya(t,i)}return null}function m(o,a,s,l){for(var c=null,u=null,d=a,m=a=0,f=null;null!==d&&m<s.length;m++){d.index>m?(f=d,d=null):f=d.sibling;var v=h(o,d,s[m],l);if(null===v){null===d&&(d=f);break}e&&d&&null===v.alternate&&t(o,d),a=r(v,a,m),null===u?c=v:u.sibling=v,u=v,d=f}if(m===s.length)return n(o,d),aa&&Xo(o,m),c;if(null===d){for(;m<s.length;m++)null!==(d=p(o,s[m],l))&&(a=r(d,a,m),null===u?c=d:u.sibling=d,u=d);return aa&&Xo(o,m),c}for(d=i(o,d);m<s.length;m++)null!==(f=g(d,o,m,s[m],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?m:f.key),a=r(f,a,m),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach((function(e){return t(o,e)})),aa&&Xo(o,m),c}function f(o,s,l,c){var u=j(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,m=s,f=s=0,v=null,y=l.next();null!==m&&!y.done;f++,y=l.next()){m.index>f?(v=m,m=null):v=m.sibling;var b=h(o,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(o,m),s=r(b,s,f),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(o,m),aa&&Xo(o,f),u;if(null===m){for(;!y.done;f++,y=l.next())null!==(y=p(o,y.value,c))&&(s=r(y,s,f),null===d?u=y:d.sibling=y,d=y);return aa&&Xo(o,f),u}for(m=i(o,m);!y.done;f++,y=l.next())null!==(y=g(m,o,f,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?f:y.key),s=r(y,s,f),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(o,e)})),aa&&Xo(o,f),u}return function e(i,a,r,l){if("object"==typeof r&&null!==r&&r.type===T&&null===r.key&&(r=r.props.children),"object"==typeof r&&null!==r){switch(r.$$typeof){case S:e:{for(var c=r.key,u=a;null!==u;){if(u.key===c){if((c=r.type)===T){if(7===u.tag){n(i,u.sibling),(a=o(u,r.props.children)).return=i,i=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===N&&ba(c)===u.type){n(i,u.sibling),(a=o(u,r.props)).ref=va(i,u,r),a.return=i,i=a;break e}n(i,u);break}t(i,u),u=u.sibling}r.type===T?((a=jc(r.props.children,i.mode,l,r.key)).return=i,i=a):((l=Rc(r.type,r.key,r.props,null,i.mode,l)).ref=va(i,a,r),l.return=i,i=l)}return s(i);case w:e:{for(u=r.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===r.containerInfo&&a.stateNode.implementation===r.implementation){n(i,a.sibling),(a=o(a,r.children||[])).return=i,i=a;break e}n(i,a);break}t(i,a),a=a.sibling}(a=Fc(r,i.mode,l)).return=i,i=a}return s(i);case N:return e(i,a,(u=r._init)(r._payload),l)}if(te(r))return m(i,a,r,l);if(j(r))return f(i,a,r,l);ya(i,r)}return"string"==typeof r&&""!==r||"number"==typeof r?(r=""+r,null!==a&&6===a.tag?(n(i,a.sibling),(a=o(a,r)).return=i,i=a):(n(i,a),(a=Lc(r,i.mode,l)).return=i,i=a),s(i)):n(i,a)}}var Sa=ka(!0),wa=ka(!1),Ta=Po(null),Ca=null,Pa=null,xa=null;function Ia(){xa=Pa=Ca=null}function Aa(e){var t=Ta.current;xo(Ta),e._currentValue=t}function Ea(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Oa(e,t){Ca=e,xa=Pa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(bs=!0),e.firstContext=null)}function _a(e){var t=e._currentValue;if(xa!==e)if(e={context:e,memoizedValue:t,next:null},null===Pa){if(null===Ca)throw Error(a(308));Pa=e,Ca.dependencies={lanes:0,firstContext:e}}else Pa=Pa.next=e;return t}var Na=null;function Ma(e){null===Na?Na=[e]:Na.push(e)}function Ra(e,t,n,i){var o=t.interleaved;return null===o?(n.next=n,Ma(t)):(n.next=o.next,o.next=n),t.interleaved=n,ja(e,i)}function ja(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Da=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function za(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&Al){var o=i.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),i.pending=t,ja(e,n)}return null===(o=i.interleaved)?(t.next=t,Ma(i)):(t.next=o.next,o.next=t),i.interleaved=t,ja(e,n)}function Va(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ba(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var r={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=r:a=a.next=r,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qa(e,t,n,i){var o=e.updateQueue;Da=!1;var a=o.firstBaseUpdate,r=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===r?a=c:r.next=c,r=l;var u=e.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==r&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l)}if(null!==a){var d=o.baseState;for(r=0,u=c=l=null,s=a;;){var p=s.lane,h=s.eventTime;if((i&p)===p){null!==u&&(u=u.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,m=s;switch(p=t,h=n,m.tag){case 1:if("function"==typeof(g=m.payload)){d=g.call(h,d,p);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null==(p="function"==typeof(g=m.payload)?g.call(h,d,p):g))break e;d=L({},d,p);break e;case 2:Da=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=h,l=d):u=u.next=h,r|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{r|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Dl|=r,e.lanes=r,e.memoizedState=d}}function Ka(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(null!==o){if(i.callback=null,i=n,"function"!=typeof o)throw Error(a(191,o));o.call(i)}}}var Ha={},Wa=Po(Ha),Ga=Po(Ha),$a=Po(Ha);function Ja(e){if(e===Ha)throw Error(a(174));return e}function Qa(e,t){switch(Io($a,t),Io(Ga,e),Io(Wa,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xo(Wa),Io(Wa,t)}function Ya(){xo(Wa),xo(Ga),xo($a)}function Za(e){Ja($a.current);var t=Ja(Wa.current),n=le(t,e.type);t!==n&&(Io(Ga,e),Io(Wa,n))}function Xa(e){Ga.current===e&&(xo(Wa),xo(Ga))}var er=Po(0);function tr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nr=[];function ir(){for(var e=0;e<nr.length;e++)nr[e]._workInProgressVersionPrimary=null;nr.length=0}var or=k.ReactCurrentDispatcher,ar=k.ReactCurrentBatchConfig,rr=0,sr=null,lr=null,cr=null,ur=!1,dr=!1,pr=0,hr=0;function gr(){throw Error(a(321))}function mr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!si(e[n],t[n]))return!1;return!0}function fr(e,t,n,i,o,r){if(rr=r,sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,or.current=null===e||null===e.memoizedState?Xr:es,e=n(i,o),dr){r=0;do{if(dr=!1,pr=0,25<=r)throw Error(a(301));r+=1,cr=lr=null,t.updateQueue=null,or.current=ts,e=n(i,o)}while(dr)}if(or.current=Zr,t=null!==lr&&null!==lr.next,rr=0,cr=lr=sr=null,ur=!1,t)throw Error(a(300));return e}function vr(){var e=0!==pr;return pr=0,e}function yr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cr?sr.memoizedState=cr=e:cr=cr.next=e,cr}function br(){if(null===lr){var e=sr.alternate;e=null!==e?e.memoizedState:null}else e=lr.next;var t=null===cr?sr.memoizedState:cr.next;if(null!==t)cr=t,lr=e;else{if(null===e)throw Error(a(310));e={memoizedState:(lr=e).memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},null===cr?sr.memoizedState=cr=e:cr=cr.next=e}return cr}function kr(e,t){return"function"==typeof t?t(e):t}function Sr(e){var t=br(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=lr,o=i.baseQueue,r=n.pending;if(null!==r){if(null!==o){var s=o.next;o.next=r.next,r.next=s}i.baseQueue=o=r,n.pending=null}if(null!==o){r=o.next,i=i.baseState;var l=s=null,c=null,u=r;do{var d=u.lane;if((rr&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=p,s=i):c=c.next=p,sr.lanes|=d,Dl|=d}u=u.next}while(null!==u&&u!==r);null===c?s=i:c.next=l,si(i,t.memoizedState)||(bs=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){o=e;do{r=o.lane,sr.lanes|=r,Dl|=r,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wr(e){var t=br(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,r=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{r=e(r,s.action),s=s.next}while(s!==o);si(r,t.memoizedState)||(bs=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),n.lastRenderedState=r}return[r,i]}function Tr(){}function Cr(e,t){var n=sr,i=br(),o=t(),r=!si(i.memoizedState,o);if(r&&(i.memoizedState=o,bs=!0),i=i.queue,Dr(Ir.bind(null,n,i,e),[e]),i.getSnapshot!==t||r||null!==cr&&1&cr.memoizedState.tag){if(n.flags|=2048,_r(9,xr.bind(null,n,i,o,t),void 0,null),null===El)throw Error(a(349));30&rr||Pr(n,t,o)}return o}function Pr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sr.updateQueue)?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function xr(e,t,n,i){t.value=n,t.getSnapshot=i,Ar(t)&&Er(e)}function Ir(e,t,n){return n((function(){Ar(t)&&Er(e)}))}function Ar(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!si(e,n)}catch(e){return!0}}function Er(e){var t=ja(e,1);null!==t&&nc(t,e,1,-1)}function Or(e){var t=yr();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kr,lastRenderedState:e},t.queue=e,e=e.dispatch=$r.bind(null,sr,e),[t.memoizedState,e]}function _r(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=sr.updateQueue)?(t={lastEffect:null,stores:null},sr.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Nr(){return br().memoizedState}function Mr(e,t,n,i){var o=yr();sr.flags|=e,o.memoizedState=_r(1|t,n,void 0,void 0===i?null:i)}function Rr(e,t,n,i){var o=br();i=void 0===i?null:i;var a=void 0;if(null!==lr){var r=lr.memoizedState;if(a=r.destroy,null!==i&&mr(i,r.deps))return void(o.memoizedState=_r(t,n,a,i))}sr.flags|=e,o.memoizedState=_r(1|t,n,a,i)}function jr(e,t){return Mr(8390656,8,e,t)}function Dr(e,t){return Rr(2048,8,e,t)}function Lr(e,t){return Rr(4,2,e,t)}function Fr(e,t){return Rr(4,4,e,t)}function zr(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ur(e,t,n){return n=null!=n?n.concat([e]):null,Rr(4,4,zr.bind(null,t,e),n)}function Vr(){}function Br(e,t){var n=br();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mr(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function qr(e,t){var n=br();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mr(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Kr(e,t,n){return 21&rr?(si(n,t)||(n=mt(),sr.lanes|=n,Dl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n)}function Hr(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=ar.transition;ar.transition={};try{e(!1),t()}finally{bt=n,ar.transition=i}}function Wr(){return br().memoizedState}function Gr(e,t,n){var i=tc(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Jr(e)?Qr(t,n):null!==(n=Ra(e,t,n,i))&&(nc(n,e,i,ec()),Yr(n,t,i))}function $r(e,t,n){var i=tc(e),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jr(e))Qr(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var r=t.lastRenderedState,s=a(r,n);if(o.hasEagerState=!0,o.eagerState=s,si(s,r)){var l=t.interleaved;return null===l?(o.next=o,Ma(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=Ra(e,t,o,i))&&(nc(n,e,i,o=ec()),Yr(n,t,i))}}function Jr(e){var t=e.alternate;return e===sr||null!==t&&t===sr}function Qr(e,t){dr=ur=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yr(e,t,n){if(4194240&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Zr={readContext:_a,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},Xr={readContext:_a,useCallback:function(e,t){return yr().memoizedState=[e,void 0===t?null:t],e},useContext:_a,useEffect:jr,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Mr(4194308,4,zr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Mr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mr(4,2,e,t)},useMemo:function(e,t){var n=yr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=yr();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Gr.bind(null,sr,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},yr().memoizedState=e},useState:Or,useDebugValue:Vr,useDeferredValue:function(e){return yr().memoizedState=e},useTransition:function(){var e=Or(!1),t=e[0];return e=Hr.bind(null,e[1]),yr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=sr,o=yr();if(aa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===El)throw Error(a(349));30&rr||Pr(i,t,n)}o.memoizedState=n;var r={value:n,getSnapshot:t};return o.queue=r,jr(Ir.bind(null,i,r,e),[e]),i.flags|=2048,_r(9,xr.bind(null,i,r,n,t),void 0,null),n},useId:function(){var e=yr(),t=El.identifierPrefix;if(aa){var n=Zo;t=":"+t+"R"+(n=(Yo&~(1<<32-rt(Yo)-1)).toString(32)+n),0<(n=pr++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:_a,useCallback:Br,useContext:_a,useEffect:Dr,useImperativeHandle:Ur,useInsertionEffect:Lr,useLayoutEffect:Fr,useMemo:qr,useReducer:Sr,useRef:Nr,useState:function(){return Sr(kr)},useDebugValue:Vr,useDeferredValue:function(e){return Kr(br(),lr.memoizedState,e)},useTransition:function(){return[Sr(kr)[0],br().memoizedState]},useMutableSource:Tr,useSyncExternalStore:Cr,useId:Wr,unstable_isNewReconciler:!1},ts={readContext:_a,useCallback:Br,useContext:_a,useEffect:Dr,useImperativeHandle:Ur,useInsertionEffect:Lr,useLayoutEffect:Fr,useMemo:qr,useReducer:wr,useRef:Nr,useState:function(){return wr(kr)},useDebugValue:Vr,useDeferredValue:function(e){var t=br();return null===lr?t.memoizedState=e:Kr(t,lr.memoizedState,e)},useTransition:function(){return[wr(kr)[0],br().memoizedState]},useMutableSource:Tr,useSyncExternalStore:Cr,useId:Wr,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function is(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var os={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),o=tc(e),a=za(i,o);a.payload=t,null!=n&&(a.callback=n),null!==(t=Ua(e,a,o))&&(nc(t,e,o,i),Va(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),o=tc(e),a=za(i,o);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=Ua(e,a,o))&&(nc(t,e,o,i),Va(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),o=za(n,i);o.tag=2,null!=t&&(o.callback=t),null!==(t=Ua(e,o,i))&&(nc(t,e,i,n),Va(t,e,i))}};function as(e,t,n,i,o,a,r){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,r):!(t.prototype&&t.prototype.isPureReactComponent&&li(n,i)&&li(o,a))}function rs(e,t,n){var i=!1,o=Ao,a=t.contextType;return"object"==typeof a&&null!==a?a=_a(a):(o=Mo(t)?_o:Eo.current,a=(i=null!=(i=t.contextTypes))?No(e,o):Ao),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=os,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&os.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,i){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},La(e);var a=t.contextType;"object"==typeof a&&null!==a?o.context=_a(a):(a=Mo(t)?_o:Eo.current,o.context=No(e,a)),o.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(is(e,t,a,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&os.enqueueReplaceState(o,o.state,null),qa(e,n,o,i),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ps="function"==typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=za(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Kl||(Kl=!0,Hl=i),ds(0,t)},n}function gs(e,t,n){(n=za(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var o=t.value;n.payload=function(){return i(o)},n.callback=function(){ds(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!=typeof i&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ps;var o=new Set;i.set(t,o)}else void 0===(o=i.get(t))&&(o=new Set,i.set(t,o));o.has(n)||(o.add(n),e=Pc.bind(null,e,t,n),t.then(e,e))}function fs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,i,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=za(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e)}var ys=k.ReactCurrentOwner,bs=!1;function ks(e,t,n,i){t.child=null===e?wa(t,null,n,i):Sa(t,e.child,n,i)}function Ss(e,t,n,i,o){n=n.render;var a=t.ref;return Oa(t,o),i=fr(e,t,n,i,a,o),n=vr(),null===e||bs?(aa&&n&&ta(t),t.flags|=1,ks(e,t,i,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ks(e,t,o))}function ws(e,t,n,i,o){if(null===e){var a=n.type;return"function"!=typeof a||Nc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,i,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ts(e,t,a,i,o))}if(a=e.child,!(e.lanes&o)){var r=a.memoizedProps;if((n=null!==(n=n.compare)?n:li)(r,i)&&e.ref===t.ref)return Ks(e,t,o)}return t.flags|=1,(e=Mc(a,i)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,n,i,o){if(null!==e){var a=e.memoizedProps;if(li(a,i)&&e.ref===t.ref){if(bs=!1,t.pendingProps=i=a,!(e.lanes&o))return t.lanes=e.lanes,Ks(e,t,o);131072&e.flags&&(bs=!0)}}return xs(e,t,n,i,o)}function Cs(e,t,n){var i=t.pendingProps,o=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Io(Ml,Nl),Nl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:n,Io(Ml,Nl),Nl|=i}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(Ml,Nl),Nl|=n;else null!==a?(i=a.baseLanes|n,t.memoizedState=null):i=n,Io(Ml,Nl),Nl|=i;return ks(e,t,o,n),t.child}function Ps(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xs(e,t,n,i,o){var a=Mo(n)?_o:Eo.current;return a=No(t,a),Oa(t,o),n=fr(e,t,n,i,a,o),i=vr(),null===e||bs?(aa&&i&&ta(t),t.flags|=1,ks(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ks(e,t,o))}function Is(e,t,n,i,o){if(Mo(n)){var a=!0;Lo(t)}else a=!1;if(Oa(t,o),null===t.stateNode)qs(e,t),rs(t,n,i),ls(t,n,i,o),i=!0;else if(null===e){var r=t.stateNode,s=t.memoizedProps;r.props=s;var l=r.context,c=n.contextType;c="object"==typeof c&&null!==c?_a(c):No(t,c=Mo(n)?_o:Eo.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof r.getSnapshotBeforeUpdate;d||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(s!==i||l!==c)&&ss(t,r,i,c),Da=!1;var p=t.memoizedState;r.state=p,qa(t,i,r,o),l=t.memoizedState,s!==i||p!==l||Oo.current||Da?("function"==typeof u&&(is(t,n,u,i),l=t.memoizedState),(s=Da||as(t,n,s,i,p,l,c))?(d||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(t.flags|=4194308)):("function"==typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),r.props=i,r.state=l,r.context=c,i=s):("function"==typeof r.componentDidMount&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,Fa(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),r.props=c,d=t.pendingProps,p=r.context,l="object"==typeof(l=n.contextType)&&null!==l?_a(l):No(t,l=Mo(n)?_o:Eo.current);var h=n.getDerivedStateFromProps;(u="function"==typeof h||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(s!==d||p!==l)&&ss(t,r,i,l),Da=!1,p=t.memoizedState,r.state=p,qa(t,i,r,o);var g=t.memoizedState;s!==d||p!==g||Oo.current||Da?("function"==typeof h&&(is(t,n,h,i),g=t.memoizedState),(c=Da||as(t,n,c,i,p,g,l)||!1)?(u||"function"!=typeof r.UNSAFE_componentWillUpdate&&"function"!=typeof r.componentWillUpdate||("function"==typeof r.componentWillUpdate&&r.componentWillUpdate(i,g,l),"function"==typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(i,g,l)),"function"==typeof r.componentDidUpdate&&(t.flags|=4),"function"==typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof r.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=g),r.props=i,r.state=g,r.context=l,i=c):("function"!=typeof r.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),i=!1)}return As(e,t,n,i,a,o)}function As(e,t,n,i,o,a){Ps(e,t);var r=!!(128&t.flags);if(!i&&!r)return o&&Fo(t,n,!1),Ks(e,t,a);i=t.stateNode,ys.current=t;var s=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&r?(t.child=Sa(t,e.child,null,a),t.child=Sa(t,null,s,a)):ks(e,t,s,a),t.memoizedState=i.state,o&&Fo(t,n,!0),t.child}function Es(e){var t=e.stateNode;t.pendingContext?jo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&jo(0,t.context,!1),Qa(e,t.containerInfo)}function Os(e,t,n,i,o){return ga(),ma(o),t.flags|=256,ks(e,t,n,i),t.child}var _s,Ns,Ms,Rs,js={dehydrated:null,treeContext:null,retryLane:0};function Ds(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var i,o=t.pendingProps,r=er.current,s=!1,l=!!(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&!!(2&r)),i?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(r|=1),Io(er,1&r),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},1&o||null===s?s=Dc(l,o,0,null):(s.childLanes=0,s.pendingProps=l),e=jc(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ds(n),t.memoizedState=js,e):Fs(t,l));if(null!==(r=e.memoizedState)&&null!==(i=r.dehydrated))return function(e,t,n,i,o,r,s){if(n)return 256&t.flags?(t.flags&=-257,zs(e,t,s,i=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(r=i.fallback,o=t.mode,i=Dc({mode:"visible",children:i.children},o,0,null),(r=jc(r,o,s,null)).flags|=2,i.return=t,r.return=t,i.sibling=r,t.child=i,1&t.mode&&Sa(t,e.child,null,s),t.child.memoizedState=Ds(s),t.memoizedState=js,r);if(!(1&t.mode))return zs(e,t,s,null);if("$!"===o.data){if(i=o.nextSibling&&o.nextSibling.dataset)var l=i.dgst;return i=l,zs(e,t,s,i=us(r=Error(a(419)),i,void 0))}if(l=!!(s&e.childLanes),bs||l){if(null!==(i=El)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=o&(i.suspendedLanes|s)?0:o)&&o!==r.retryLane&&(r.retryLane=o,ja(e,o),nc(i,e,o,-1))}return mc(),zs(e,t,s,i=us(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),o._reactRetry=t,null):(e=r.treeContext,oa=co(o.nextSibling),ia=t,aa=!0,ra=null,null!==e&&($o[Jo++]=Yo,$o[Jo++]=Zo,$o[Jo++]=Qo,Yo=e.id,Zo=e.overflow,Qo=t),(t=Fs(t,i.children)).flags|=4096,t)}(e,t,l,o,i,r,n);if(s){s=o.fallback,l=t.mode,i=(r=e.child).sibling;var c={mode:"hidden",children:o.children};return 1&l||t.child===r?(o=Mc(r,c)).subtreeFlags=14680064&r.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null),null!==i?s=Mc(i,s):(s=jc(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?Ds(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=js,o}return e=(s=e.child).sibling,o=Mc(s,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Fs(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,i){return null!==i&&ma(i),Sa(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ea(e.return,t,n)}function Vs(e,t,n,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=o)}function Bs(e,t,n){var i=t.pendingProps,o=i.revealOrder,a=i.tail;if(ks(e,t,i.children,n),2&(i=er.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Io(er,i),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===tr(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Vs(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===tr(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Vs(t,!0,n,null,a);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function qs(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ks(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,i|=14680064&o.subtreeFlags,i|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Gs(e,t,n){var i=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Mo(t.type)&&Ro(),Ws(t),null;case 3:return i=t.stateNode,Ya(),xo(Oo),xo(Eo),ir(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(pa(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ra&&(rc(ra),ra=null))),Ns(e,t),Ws(t),null;case 5:Xa(t);var o=Ja($a.current);if(n=t.type,null!==e&&null!=t.stateNode)Ms(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return Ws(t),null}if(e=Ja(Wa.current),pa(t)){i=t.stateNode,n=t.type;var r=t.memoizedProps;switch(i[ho]=t,i[go]=r,e=!!(1&t.mode),n){case"dialog":zi("cancel",i),zi("close",i);break;case"iframe":case"object":case"embed":zi("load",i);break;case"video":case"audio":for(o=0;o<ji.length;o++)zi(ji[o],i);break;case"source":zi("error",i);break;case"img":case"image":case"link":zi("error",i),zi("load",i);break;case"details":zi("toggle",i);break;case"input":Q(i,r),zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},zi("invalid",i);break;case"textarea":oe(i,r),zi("invalid",i)}for(var l in ye(n,r),o=null,r)if(r.hasOwnProperty(l)){var c=r[l];"children"===l?"string"==typeof c?i.textContent!==c&&(!0!==r.suppressHydrationWarning&&Zi(i.textContent,c,e),o=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(!0!==r.suppressHydrationWarning&&Zi(i.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zi("scroll",i)}switch(n){case"input":W(i),X(i,r,!0);break;case"textarea":W(i),re(i);break;case"select":case"option":break;default:"function"==typeof r.onClick&&(i.onclick=Xi)}i=o,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[ho]=t,e[go]=i,_s(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":zi("cancel",e),zi("close",e),o=i;break;case"iframe":case"object":case"embed":zi("load",e),o=i;break;case"video":case"audio":for(o=0;o<ji.length;o++)zi(ji[o],e);o=i;break;case"source":zi("error",e),o=i;break;case"img":case"image":case"link":zi("error",e),zi("load",e),o=i;break;case"details":zi("toggle",e),o=i;break;case"input":Q(e,i),o=J(e,i),zi("invalid",e);break;case"option":default:o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=L({},i,{value:void 0}),zi("invalid",e);break;case"textarea":oe(e,i),o=ie(e,i),zi("invalid",e)}for(r in ye(n,o),c=o)if(c.hasOwnProperty(r)){var u=c[r];"style"===r?fe(e,u):"dangerouslySetInnerHTML"===r?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===r?"string"==typeof u?("textarea"!==n||""!==u)&&pe(e,u):"number"==typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(s.hasOwnProperty(r)?null!=u&&"onScroll"===r&&zi("scroll",e):null!=u&&b(e,r,u,l))}switch(n){case"input":W(e),X(e,i,!1);break;case"textarea":W(e),re(e);break;case"option":null!=i.value&&e.setAttribute("value",""+K(i.value));break;case"select":e.multiple=!!i.multiple,null!=(r=i.value)?ne(e,!!i.multiple,r,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Xi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Rs(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(a(166));if(n=Ja($a.current),Ja(Wa.current),pa(t)){if(i=t.stateNode,n=t.memoizedProps,i[ho]=t,(r=i.nodeValue!==n)&&null!==(e=ia))switch(e.tag){case 3:Zi(i.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zi(i.nodeValue,n,!!(1&e.mode))}r&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[ho]=t,t.stateNode=i}return Ws(t),null;case 13:if(xo(er),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&1&t.mode&&!(128&t.flags))ha(),ga(),t.flags|=98560,r=!1;else if(r=pa(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[ho]=t}else ga(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),r=!1}else null!==ra&&(rc(ra),ra=null),r=!0;if(!r)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((i=null!==i)!=(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,1&t.mode&&(null===e||1&er.current?0===Rl&&(Rl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return Ya(),Ns(e,t),null===e&&Bi(t.stateNode.containerInfo),Ws(t),null;case 10:return Aa(t.type._context),Ws(t),null;case 19:if(xo(er),null===(r=t.memoizedState))return Ws(t),null;if(i=!!(128&t.flags),null===(l=r.rendering))if(i)Hs(r,!1);else{if(0!==Rl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=tr(e))){for(t.flags|=128,Hs(r,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(r=n).flags&=14680066,null===(l=r.alternate)?(r.childLanes=0,r.lanes=e,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,e=l.dependencies,r.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Io(er,1&er.current|2),t.child}e=e.sibling}null!==r.tail&&Ye()>Bl&&(t.flags|=128,i=!0,Hs(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=tr(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!aa)return Ws(t),null}else 2*Ye()-r.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,i=!0,Hs(r,!1),t.lanes=4194304);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Ye(),t.sibling=null,n=er.current,Io(er,i?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&1&t.mode?!!(1073741824&Nl)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function $s(e,t){switch(na(t),t.tag){case 1:return Mo(t.type)&&Ro(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),xo(Oo),xo(Eo),ir(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xa(t),null;case 13:if(xo(er),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ga()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xo(er),null;case 4:return Ya(),null;case 10:return Aa(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}_s=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ns=function(){},Ms=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,Ja(Wa.current);var a,r=null;switch(n){case"input":o=J(e,o),i=J(e,i),r=[];break;case"select":o=L({},o,{value:void 0}),i=L({},i,{value:void 0}),r=[];break;case"textarea":o=ie(e,o),i=ie(e,i),r=[];break;default:"function"!=typeof o.onClick&&"function"==typeof i.onClick&&(e.onclick=Xi)}for(u in ye(n,i),n=null,o)if(!i.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=o?o[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(r||(r=[]),r.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(r=r||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(r=r||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zi("scroll",e),r||l===c||(r=[])):(r=r||[]).push(u,c))}n&&(r=r||[]).push("style",n);var u=r;(t.updateQueue=u)&&(t.flags|=4)}},Rs=function(e,t,n,i){n!==i&&(t.flags|=4)};var Js=!1,Qs=!1,Ys="function"==typeof WeakSet?WeakSet:Set,Zs=null;function Xs(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Cc(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){Cc(e,t,n)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var o=i=i.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&el(t,n,a)}o=o.next}while(o!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[ho],delete t[go],delete t[fo],delete t[vo],delete t[yo]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rl(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Xi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,n)}catch(e){}switch(n.tag){case 5:Qs||Xs(n,t);case 6:var i=ul,o=dl;ul=null,pl(e,t,n),dl=o,null!==(ul=i)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),Bt(e)):lo(ul,n.stateNode));break;case 4:i=ul,o=dl,ul=n.stateNode.containerInfo,dl=!0,pl(e,t,n),ul=i,dl=o;break;case 0:case 11:case 14:case 15:if(!Qs&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){o=i=i.next;do{var a=o,r=a.destroy;a=a.tag,void 0!==r&&(2&a||4&a)&&el(n,t,r),o=o.next}while(o!==i)}pl(e,t,n);break;case 1:if(!Qs&&(Xs(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(e){Cc(n,t,e)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Qs=(i=Qs)||null!==n.memoizedState,pl(e,t,n),Qs=i):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var i=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var o=n[i];try{var r=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));hl(r,s,o),ul=null,dl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(e){Cc(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fl(t,e),t=t.sibling}function fl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(t){Cc(e,e.return,t)}try{nl(5,e,e.return)}catch(t){Cc(e,e.return,t)}}break;case 1:ml(t,e),vl(e),512&i&&null!==n&&Xs(n,n.return);break;case 5:if(ml(t,e),vl(e),512&i&&null!==n&&Xs(n,n.return),32&e.flags){var o=e.stateNode;try{pe(o,"")}catch(t){Cc(e,e.return,t)}}if(4&i&&null!=(o=e.stateNode)){var r=e.memoizedProps,s=null!==n?n.memoizedProps:r,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===r.type&&null!=r.name&&Y(o,r),be(l,s);var u=be(l,r);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?fe(o,p):"dangerouslySetInnerHTML"===d?de(o,p):"children"===d?pe(o,p):b(o,d,p,u)}switch(l){case"input":Z(o,r);break;case"textarea":ae(o,r);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!r.multiple;var g=r.value;null!=g?ne(o,!!r.multiple,g,!1):h!==!!r.multiple&&(null!=r.defaultValue?ne(o,!!r.multiple,r.defaultValue,!0):ne(o,!!r.multiple,r.multiple?[]:"",!1))}o[go]=r}catch(t){Cc(e,e.return,t)}}break;case 6:if(ml(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,r=e.memoizedProps;try{o.nodeValue=r}catch(t){Cc(e,e.return,t)}}break;case 3:if(ml(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(t){Cc(e,e.return,t)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(o=e.child).flags&&(r=null!==o.memoizedState,o.stateNode.isHidden=r,!r||null!==o.alternate&&null!==o.alternate.memoizedState||(Vl=Ye())),4&i&&gl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(u=Qs)||d,ml(t,e),Qs=u):ml(t,e),vl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Zs=e,d=e.child;null!==d;){for(p=Zs=d;null!==Zs;){switch(g=(h=Zs).child,h.tag){case 0:case 11:case 14:case 15:nl(4,h,h.return);break;case 1:Xs(h,h.return);var m=h.stateNode;if("function"==typeof m.componentWillUnmount){i=h,n=h.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(e){Cc(i,n,e)}}break;case 5:Xs(h,h.return);break;case 22:if(null!==h.memoizedState){Sl(p);continue}}null!==g?(g.return=h,Zs=g):Sl(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"==typeof(r=o.style).setProperty?r.setProperty("display","none","important"):r.display="none":(l=p.stateNode,s=null!=(c=p.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(t){Cc(e,e.return,t)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(t){Cc(e,e.return,t)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ml(t,e),vl(e),4&i&&gl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rl(n)){var i=n;break e}n=n.return}throw Error(a(160))}switch(i.tag){case 5:var o=i.stateNode;32&i.flags&&(pe(o,""),i.flags&=-33),cl(e,sl(e),o);break;case 3:case 4:var r=i.stateNode.containerInfo;ll(e,sl(e),r);break;default:throw Error(a(161))}}catch(t){Cc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Zs=e,bl(e,t,n)}function bl(e,t,n){for(var i=!!(1&e.mode);null!==Zs;){var o=Zs,a=o.child;if(22===o.tag&&i){var r=null!==o.memoizedState||Js;if(!r){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Qs;s=Js;var c=Qs;if(Js=r,(Qs=l)&&!c)for(Zs=o;null!==Zs;)l=(r=Zs).child,22===r.tag&&null!==r.memoizedState?wl(o):null!==l?(l.return=r,Zs=l):wl(o);for(;null!==a;)Zs=a,bl(a,t,n),a=a.sibling;Zs=o,Js=s,Qs=c}kl(e)}else 8772&o.subtreeFlags&&null!==a?(a.return=o,Zs=a):kl(e)}}function kl(e){for(;null!==Zs;){var t=Zs;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Qs||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Qs)if(null===n)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=t.updateQueue;null!==r&&Ka(t,r,i);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ka(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Bt(p)}}}break;default:throw Error(a(163))}Qs||512&t.flags&&ol(t)}catch(e){Cc(t,t.return,e)}}if(t===e){Zs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zs=n;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zs=n;break}Zs=t.return}}function wl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(e){Cc(t,n,e)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var o=t.return;try{i.componentDidMount()}catch(e){Cc(t,o,e)}}var a=t.return;try{ol(t)}catch(e){Cc(t,a,e)}break;case 5:var r=t.return;try{ol(t)}catch(e){Cc(t,r,e)}}}catch(e){Cc(t,t.return,e)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var Tl,Cl=Math.ceil,Pl=k.ReactCurrentDispatcher,xl=k.ReactCurrentOwner,Il=k.ReactCurrentBatchConfig,Al=0,El=null,Ol=null,_l=0,Nl=0,Ml=Po(0),Rl=0,jl=null,Dl=0,Ll=0,Fl=0,zl=null,Ul=null,Vl=0,Bl=1/0,ql=null,Kl=!1,Hl=null,Wl=null,Gl=!1,$l=null,Jl=0,Ql=0,Yl=null,Zl=-1,Xl=0;function ec(){return 6&Al?Ye():-1!==Zl?Zl:Zl=Ye()}function tc(e){return 1&e.mode?2&Al&&0!==_l?_l&-_l:null!==fa.transition?(0===Xl&&(Xl=mt()),Xl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type):1}function nc(e,t,n,i){if(50<Ql)throw Ql=0,Yl=null,Error(a(185));vt(e,n,i),2&Al&&e===El||(e===El&&(!(2&Al)&&(Ll|=n),4===Rl&&sc(e,_l)),ic(e,i),1===n&&0===Al&&!(1&t.mode)&&(Bl=Ye()+500,Uo&&qo()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var r=31-rt(a),s=1<<r,l=o[r];-1===l?s&n&&!(s&i)||(o[r]=ht(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var i=pt(e,e===El?_l:0);if(0===i)null!==n&&$e(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&$e(n),1===t)0===e.tag?function(e){Uo=!0,Bo(e)}(lc.bind(null,e)):Bo(lc.bind(null,e)),ro((function(){!(6&Al)&&qo()})),n=null;else{switch(kt(i)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Ec(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Zl=-1,Xl=0,6&Al)throw Error(a(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var i=pt(e,e===El?_l:0);if(0===i)return null;if(30&i||i&e.expiredLanes||t)t=fc(e,i);else{t=i;var o=Al;Al|=2;var r=gc();for(El===e&&_l===t||(ql=null,Bl=Ye()+500,pc(e,t));;)try{yc();break}catch(t){hc(e,t)}Ia(),Pl.current=r,Al=o,null!==Ol?t=0:(El=null,_l=0,t=Rl)}if(0!==t){if(2===t&&0!==(o=gt(e))&&(i=o,t=ac(e,o)),1===t)throw n=jl,pc(e,0),sc(e,i),ic(e,Ye()),n;if(6===t)sc(e,i);else{if(o=e.current.alternate,!(30&i||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var o=n[i],a=o.getSnapshot;o=o.value;try{if(!si(a(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=fc(e,i),2===t&&(r=gt(e),0!==r&&(i=r,t=ac(e,r))),1!==t)))throw n=jl,pc(e,0),sc(e,i),ic(e,Ye()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:Sc(e,Ul,ql);break;case 3:if(sc(e,i),(130023424&i)===i&&10<(t=Vl+500-Ye())){if(0!==pt(e,0))break;if(((o=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=io(Sc.bind(null,e,Ul,ql),t);break}Sc(e,Ul,ql);break;case 4:if(sc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,o=-1;0<i;){var s=31-rt(i);r=1<<s,(s=t[s])>o&&(o=s),i&=~r}if(i=o,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Cl(i/1960))-i)){e.timeoutHandle=io(Sc.bind(null,e,Ul,ql),i);break}Sc(e,Ul,ql);break;default:throw Error(a(329))}}}return ic(e,Ye()),e.callbackNode===n?oc.bind(null,e):null}function ac(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=fc(e,t))&&(t=Ul,Ul=n,null!==t&&rc(t)),e}function rc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function sc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rt(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(6&Al)throw Error(a(327));wc();var t=pt(e,0);if(!(1&t))return ic(e,Ye()),null;var n=fc(e,t);if(0!==e.tag&&2===n){var i=gt(e);0!==i&&(t=i,n=ac(e,i))}if(1===n)throw n=jl,pc(e,0),sc(e,t),ic(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,Ul,ql),ic(e,Ye()),null}function cc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Bl=Ye()+500,Uo&&qo())}}function uc(e){null!==$l&&0===$l.tag&&!(6&Al)&&wc();var t=Al;Al|=1;var n=Il.transition,i=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=i,Il.transition=n,!(6&(Al=t))&&qo()}}function dc(){Nl=Ml.current,xo(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Ol)for(n=Ol.return;null!==n;){var i=n;switch(na(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Ro();break;case 3:Ya(),xo(Oo),xo(Eo),ir();break;case 5:Xa(i);break;case 4:Ya();break;case 13:case 19:xo(er);break;case 10:Aa(i.type._context);break;case 22:case 23:dc()}n=n.return}if(El=e,Ol=e=Mc(e.current,null),_l=Nl=t,Rl=0,jl=null,Fl=Ll=Dl=0,Ul=zl=null,null!==Na){for(t=0;t<Na.length;t++)if(null!==(i=(n=Na[t]).interleaved)){n.interleaved=null;var o=i.next,a=n.pending;if(null!==a){var r=a.next;a.next=o,i.next=r}n.pending=i}Na=null}return e}function hc(e,t){for(;;){var n=Ol;try{if(Ia(),or.current=Zr,ur){for(var i=sr.memoizedState;null!==i;){var o=i.queue;null!==o&&(o.pending=null),i=i.next}ur=!1}if(rr=0,cr=lr=sr=null,dr=!1,pr=0,xl.current=null,null===n||null===n.return){Rl=1,jl=t,Ol=null;break}e:{var r=e,s=n.return,l=n,c=t;if(t=_l,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,p=d.tag;if(!(1&d.mode||0!==p&&11!==p&&15!==p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=fs(s);if(null!==g){g.flags&=-257,vs(g,s,l,0,t),1&g.mode&&ms(r,u,t),c=u;var m=(t=g).updateQueue;if(null===m){var f=new Set;f.add(c),t.updateQueue=f}else m.add(c);break e}if(!(1&t)){ms(r,u,t),mc();break e}c=Error(a(426))}else if(aa&&1&l.mode){var v=fs(s);if(null!==v){!(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),ma(cs(c,l));break e}}r=c=cs(c,l),4!==Rl&&(Rl=2),null===zl?zl=[r]:zl.push(r),r=s;do{switch(r.tag){case 3:r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,hs(0,c,t));break e;case 1:l=c;var y=r.type,b=r.stateNode;if(!(128&r.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Wl&&Wl.has(b)))){r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,gs(r,l,t));break e}}r=r.return}while(null!==r)}kc(n)}catch(e){t=e,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function gc(){var e=Pl.current;return Pl.current=Zr,null===e?Zr:e}function mc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===El||!(268435455&Dl)&&!(268435455&Ll)||sc(El,_l)}function fc(e,t){var n=Al;Al|=2;var i=gc();for(El===e&&_l===t||(ql=null,pc(e,t));;)try{vc();break}catch(t){hc(e,t)}if(Ia(),Al=n,Pl.current=i,null!==Ol)throw Error(a(261));return El=null,_l=0,Rl}function vc(){for(;null!==Ol;)bc(Ol)}function yc(){for(;null!==Ol&&!Je();)bc(Ol)}function bc(e){var t=Tl(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,null===t?kc(e):Ol=t,xl.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=$s(n,t)))return n.flags&=32767,void(Ol=n);if(null===e)return Rl=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Gs(n,t,Nl)))return void(Ol=n);if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Rl&&(Rl=5)}function Sc(e,t,n){var i=bt,o=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,i){do{wc()}while(null!==$l);if(6&Al)throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var r=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-rt(n),a=1<<o;t[o]=0,i[o]=-1,e[o]=-1,n&=~a}}(e,r),e===El&&(Ol=El=null,_l=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Gl||(Gl=!0,Ec(tt,(function(){return wc(),null}))),r=!!(15990&n.flags),15990&n.subtreeFlags||r){r=Il.transition,Il.transition=null;var s=bt;bt=1;var l=Al;Al|=4,xl.current=null,function(e,t){if(eo=Kt,hi(e=pi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var o=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch(e){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var g;p!==n||0!==o&&3!==p.nodeType||(l=s+o),p!==r||0!==i&&3!==p.nodeType||(c=s+i),3===p.nodeType&&(s+=p.nodeValue.length),null!==(g=p.firstChild);)h=p,p=g;for(;;){if(p===e)break t;if(h===n&&++u===o&&(l=s),h===r&&++d===i&&(c=s),null!==(g=p.nextSibling))break;h=(p=h).parentNode}p=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Kt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,1028&t.subtreeFlags&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var f=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?f:ns(t.type,f),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=t.stateNode.containerInfo;1===k.nodeType?k.textContent="":9===k.nodeType&&k.documentElement&&k.removeChild(k.documentElement);break;default:throw Error(a(163))}}catch(e){Cc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}m=tl,tl=!1}(e,n),fl(n,e),gi(to),Kt=!!eo,to=eo=null,e.current=n,yl(n,e,o),Qe(),Al=l,bt=s,Il.transition=r}else e.current=n;if(Gl&&(Gl=!1,$l=e,Jl=o),0===(r=e.pendingLanes)&&(Wl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),ic(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)i((o=t[n]).value,{componentStack:o.stack,digest:o.digest});if(Kl)throw Kl=!1,e=Hl,Hl=null,e;!!(1&Jl)&&0!==e.tag&&wc(),1&(r=e.pendingLanes)?e===Yl?Ql++:(Ql=0,Yl=e):Ql=0,qo()}(e,t,n,i)}finally{Il.transition=o,bt=i}return null}function wc(){if(null!==$l){var e=kt(Jl),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===$l)var i=!1;else{if(e=$l,$l=null,Jl=0,6&Al)throw Error(a(331));var o=Al;for(Al|=4,Zs=e.current;null!==Zs;){var r=Zs,s=r.child;if(16&Zs.flags){var l=r.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zs=u;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:nl(8,d,r)}var p=d.child;if(null!==p)p.return=d,Zs=p;else for(;null!==Zs;){var h=(d=Zs).sibling,g=d.return;if(al(d),d===u){Zs=null;break}if(null!==h){h.return=g,Zs=h;break}Zs=g}}}var m=r.alternate;if(null!==m){var f=m.child;if(null!==f){m.child=null;do{var v=f.sibling;f.sibling=null,f=v}while(null!==f)}}Zs=r}}if(2064&r.subtreeFlags&&null!==s)s.return=r,Zs=s;else e:for(;null!==Zs;){if(2048&(r=Zs).flags)switch(r.tag){case 0:case 11:case 15:nl(9,r,r.return)}var y=r.sibling;if(null!==y){y.return=r.return,Zs=y;break e}Zs=r.return}}var b=e.current;for(Zs=b;null!==Zs;){var k=(s=Zs).child;if(2064&s.subtreeFlags&&null!==k)k.return=s,Zs=k;else e:for(s=b;null!==Zs;){if(2048&(l=Zs).flags)try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(e){Cc(l,l.return,e)}if(l===s){Zs=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Zs=S;break e}Zs=l.return}}if(Al=o,qo(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(e){}i=!0}return i}finally{bt=n,Il.transition=t}}return!1}function Tc(e,t,n){e=Ua(e,t=hs(0,t=cs(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function Cc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Wl||!Wl.has(i))){t=Ua(t,e=gs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Pc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,El===e&&(_l&n)===n&&(4===Rl||3===Rl&&(130023424&_l)===_l&&500>Ye()-Vl?pc(e,0):Fl|=n),ic(e,t)}function xc(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=ec();null!==(e=ja(e,t))&&(vt(e,t,n),ic(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),xc(e,n)}function Ec(e,t){return Ge(e,t)}function Oc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _c(e,t,n,i){return new Oc(e,t,n,i)}function Nc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=_c(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,i,o,r){var s=2;if(i=e,"function"==typeof e)Nc(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case T:return jc(n.children,o,r,t);case C:s=8,o|=8;break;case P:return(e=_c(12,n,t,2|o)).elementType=P,e.lanes=r,e;case E:return(e=_c(13,n,t,o)).elementType=E,e.lanes=r,e;case O:return(e=_c(19,n,t,o)).elementType=O,e.lanes=r,e;case M:return Dc(n,o,r,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:s=10;break e;case I:s=9;break e;case A:s=11;break e;case _:s=14;break e;case N:s=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=_c(s,n,t,o)).elementType=e,t.type=i,t.lanes=r,t}function jc(e,t,n,i){return(e=_c(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=_c(22,e,i,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=_c(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=_c(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,i,o,a,r,s,l){return e=new zc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=_c(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function Vc(e){if(!e)return Ao;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Mo(n))return Do(e,n,t)}return t}function Bc(e,t,n,i,o,a,r,s,l){return(e=Uc(n,i,!0,e,0,a,0,s,l)).context=Vc(null),n=e.current,(a=za(i=ec(),o=tc(n))).callback=null!=t?t:null,Ua(n,a,o),e.current.lanes=o,vt(e,o,i),ic(e,i),e}function qc(e,t,n,i){var o=t.current,a=ec(),r=tc(o);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=za(a,r)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ua(o,t,r))&&(nc(e,o,r,a),Va(e,o,r)),r}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oo.current)bs=!0;else{if(!(e.lanes&n||128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Es(t),ga();break;case 5:Za(t);break;case 1:Mo(t.type)&&Lo(t);break;case 4:Qa(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;Io(Ta,i._currentValue),i._currentValue=o;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Io(er,1&er.current),t.flags|=128,null):n&t.child.childLanes?Ls(e,t,n):(Io(er,1&er.current),null!==(e=Ks(e,t,n))?e.sibling:null);Io(er,1&er.current);break;case 19:if(i=!!(n&t.childLanes),128&e.flags){if(i)return Bs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Io(er,er.current),i)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Ks(e,t,n)}(e,t,n);bs=!!(131072&e.flags)}else bs=!1,aa&&1048576&t.flags&&ea(t,Go,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;qs(e,t),e=t.pendingProps;var o=No(t,Eo.current);Oa(t,n),o=fr(null,t,i,e,o,n);var r=vr();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mo(i)?(r=!0,Lo(t)):r=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,La(t),o.updater=os,t.stateNode=o,o._reactInternals=t,ls(t,i,e,n),t=As(null,t,i,!0,r,n)):(t.tag=0,aa&&r&&ta(t),ks(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(qs(e,t),e=t.pendingProps,i=(o=i._init)(i._payload),t.type=i,o=t.tag=function(e){if("function"==typeof e)return Nc(e)?1:0;if(null!=e){if((e=e.$$typeof)===A)return 11;if(e===_)return 14}return 2}(i),e=ns(i,e),o){case 0:t=xs(null,t,i,e,n);break e;case 1:t=Is(null,t,i,e,n);break e;case 11:t=Ss(null,t,i,e,n);break e;case 14:t=ws(null,t,i,ns(i.type,e),n);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,xs(e,t,i,o=t.elementType===i?o:ns(i,o),n);case 1:return i=t.type,o=t.pendingProps,Is(e,t,i,o=t.elementType===i?o:ns(i,o),n);case 3:e:{if(Es(t),null===e)throw Error(a(387));i=t.pendingProps,o=(r=t.memoizedState).element,Fa(e,t),qa(t,i,null,n);var s=t.memoizedState;if(i=s.element,r.isDehydrated){if(r={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=Os(e,t,i,n,o=cs(Error(a(423)),t));break e}if(i!==o){t=Os(e,t,i,n,o=cs(Error(a(424)),t));break e}for(oa=co(t.stateNode.containerInfo.firstChild),ia=t,aa=!0,ra=null,n=wa(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ga(),i===o){t=Ks(e,t,n);break e}ks(e,t,i,n)}t=t.child}return t;case 5:return Za(t),null===e&&ua(t),i=t.type,o=t.pendingProps,r=null!==e?e.memoizedProps:null,s=o.children,no(i,o)?s=null:null!==r&&no(i,r)&&(t.flags|=32),Ps(e,t),ks(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return Ls(e,t,n);case 4:return Qa(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Sa(t,null,i,n):ks(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,Ss(e,t,i,o=t.elementType===i?o:ns(i,o),n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,r=t.memoizedProps,s=o.value,Io(Ta,i._currentValue),i._currentValue=s,null!==r)if(si(r.value,s)){if(r.children===o.children&&!Oo.current){t=Ks(e,t,n);break e}}else for(null!==(r=t.child)&&(r.return=t);null!==r;){var l=r.dependencies;if(null!==l){s=r.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===r.tag){(c=za(-1,n&-n)).tag=2;var u=r.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=n,null!==(c=r.alternate)&&(c.lanes|=n),Ea(r.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===r.tag)s=r.type===t.type?null:r.child;else if(18===r.tag){if(null===(s=r.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ea(s,n,t),s=r.sibling}else s=r.child;if(null!==s)s.return=r;else for(s=r;null!==s;){if(s===t){s=null;break}if(null!==(r=s.sibling)){r.return=s.return,s=r;break}s=s.return}r=s}ks(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,Oa(t,n),i=i(o=_a(o)),t.flags|=1,ks(e,t,i,n),t.child;case 14:return o=ns(i=t.type,t.pendingProps),ws(e,t,i,o=ns(i.type,o),n);case 15:return Ts(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:ns(i,o),qs(e,t),t.tag=1,Mo(i)?(e=!0,Lo(t)):e=!1,Oa(t,n),rs(t,i,o),ls(t,i,o,n),As(null,t,i,!0,e,n);case 19:return Bs(e,t,n);case 22:return Cs(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"==typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function Xc(e,t,n,i,o){var a=n._reactRootContainer;if(a){var r=a;if("function"==typeof o){var s=o;o=function(){var e=Kc(r);s.call(e)}}qc(t,r,e,o)}else r=function(e,t,n,i,o){if(o){if("function"==typeof i){var a=i;i=function(){var e=Kc(r);a.call(e)}}var r=Bc(t,i,e,0,null,!1,0,"",Zc);return e._reactRootContainer=r,e[mo]=r.current,Bi(8===e.nodeType?e.parentNode:e),uc(),r}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof i){var s=i;i=function(){var e=Kc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[mo]=l.current,Bi(8===e.nodeType?e.parentNode:e),uc((function(){qc(t,l,n,i)})),l}(n,t,e,o,i);return Kc(r)}Jc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));qc(e,t,null,null)},Jc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){qc(null,e,null,null)})),t[mo]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Lt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Ye()),!(6&Al)&&(Bl=Ye()+500,qo()))}break;case 13:uc((function(){var t=ja(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Wc(e,1)}},wt=function(e){if(13===e.tag){var t=ja(e,134217728);null!==t&&nc(t,e,134217728,ec()),Wc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tc(e),n=ja(e,t);null!==n&&nc(n,e,t,ec()),Wc(e,t)}},Ct=function(){return bt},Pt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=wo(i);if(!o)throw Error(a(90));G(i),Z(i,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,Ee=uc;var eu={usingClientEntryPoint:!1,Events:[ko,So,wo,xe,Ie,cc]},tu={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{ot=iu.inject(nu),at=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(a(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(a(299));var n=!1,i="",o=Gc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,i,o),e[mo]=t.current,Bi(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return Xc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(a(405));var i=null!=n&&n.hydratedSources||null,o=!1,r="",s=Gc;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,o,0,r,s),e[mo]=t.current,Bi(e),i)for(e=0;e<i.length;e++)o=(o=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Jc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return Xc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){Xc(null,null,e,!1,(function(){e._reactRootContainer=null,e[mo]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Xc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(r[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);i&&r[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},6336:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(1601),o=n.n(i),a=n(6314),r=n.n(a)()(o());r.push([e.id,".onboarding .react-joyride__tooltip{z-index:10001 !important}.onboarding .react-joyride__overlay{z-index:10000 !important}.onboarding .react-joyride__spotlight{z-index:10001 !important}.onboarding .react-joyride__beacon{z-index:10002 !important}.react-joyride__spotlight{border-radius:4px !important}@keyframes joyride-beacon{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}.react-joyride__beacon{animation:joyride-beacon 1.5s ease-in-out infinite}@media(max-width: 768px){.react-joyride__tooltip{max-width:90vw !important;margin:10px !important}}",""]);const s=r},6441:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},6467:function(e,t){var n,i;void 0===(i="function"==typeof(n=function(){function e(e){var t=getComputedStyle(e,null).getPropertyValue("overflow");return t.indexOf("scroll")>-1||t.indexOf("auto")>-1}return function(t){if(t instanceof HTMLElement||t instanceof SVGElement){for(var n=t.parentNode;n.parentNode;){if(e(n))return n;n=n.parentNode}return document.scrollingElement||document.documentElement}}})?n.apply(t,[]):n)||(e.exports=i)},6958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var i=n(5072),o=n.n(i),a=n(7825),r=n.n(a),s=n(7659),l=n.n(s),c=n(5056),u=n.n(c),d=n(540),p=n.n(d),h=n(1113),g=n.n(h),m=n(2511),f={};f.styleTagTransform=g(),f.setAttributes=u(),f.insert=l().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=p(),o()(m.A,f);const v=m.A&&m.A.locals?m.A.locals:void 0},7151:e=>{e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},7464:(e,t,n)=>{"use strict";e.exports=n.p+"416ca446c1d40588f68e.js"},7470:(e,t,n)=>{"use strict";var i=n(8325);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},7540:(e,t,n)=>{"use strict";n.r(t),n.d(t,{syncDistinctIdToBackground:()=>s,useAnalytics:()=>l});var i=n(9666),o=n(5323);const a=["email","phone","address","ip","password","token","audio_content","translation_text","user_input","api_key"];function r(e){const t={...e};for(const e of a)e in t&&delete t[e];return t}async function s(e){if("extension"===(0,o.uo)())try{let t=null;e&&"function"==typeof e.getDistinctId?(t=e.getDistinctId(),console.debug("[Sokuji] [Analytics] Retrieved distinct_id from PostHog instance")):console.debug("[Sokuji] [Analytics] PostHog instance not available or getDistinctId not found"),window.chrome.runtime.sendMessage({type:"UPDATE_UNINSTALL_URL",distinct_id:t},(e=>{window.chrome.runtime.lastError?console.error("[Sokuji] [Analytics] Error syncing distinct_id to background:",window.chrome.runtime.lastError):e?.success?console.debug("[Sokuji] [Analytics] Successfully synced distinct_id to background script"):console.warn("[Sokuji] [Analytics] Background script returned unsuccessful response")}))}catch(e){console.error("[Sokuji] [Analytics] Error syncing distinct_id to background:",e)}}function l(){const e=(0,i.$)();return{trackEvent:(t,n)=>{try{if(e){console.log("[Sokuji] [Analytics] Tracking event:",t,n);const i=r(n);e.capture(t,i),setTimeout((()=>{s(e)}),100)}else console.warn("[Sokuji] [Analytics] PostHog instance not available, event not tracked:",t)}catch(e){console.error("[Sokuji] [Analytics] Analytics tracking error:",e)}},identifyUser:(t,n)=>{try{if(e){const i=n?r(n):{};e.identify(t,i),setTimeout((()=>{s(e)}),100)}}catch(e){console.error("[Sokuji] [Analytics] User identification error:",e)}},setUserProperties:t=>{try{if(e){const n=r(t);e.identify(e.getDistinctId(),{$set:n})}}catch(e){console.error("[Sokuji] [Analytics] Set user properties error:",e)}},syncDistinctIdToBackground:()=>s(e),getDistinctId:()=>{try{return e&&e.getDistinctId?e.getDistinctId():null}catch(e){return console.error("[Sokuji] [Analytics] Error getting distinct_id:",e),null}},...(0,o.yz)()&&{enableCapturing:()=>{(0,o.yz)()&&e&&(e.optIn(),console.debug("[Sokuji] [Analytics] PostHog capturing enabled for development"))},disableCapturing:()=>{(0,o.yz)()&&e&&(e.optOut(),console.debug("[Sokuji] [Analytics] PostHog capturing disabled for development"))},isCapturingEnabled:()=>!!e}}}},7659:e=>{"use strict";var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},7699:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,o=e[i];if(!(0<a(o,t)))break e;e[i]=t,e[n]=o,n=i}}function i(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,o=e.length,r=o>>>1;i<r;){var s=2*(i+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[s]=n,i=s);else{if(!(c<o&&0>a(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,p=null,h=3,g=!1,m=!1,f=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function k(e){for(var t=i(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function S(e){if(f=!1,k(e),!m)if(null!==i(c))m=!0,M(w);else{var t=i(u);null!==t&&R(S,t.startTime-e)}}function w(e,n){m=!1,f&&(f=!1,y(x),x=-1),g=!0;var a=h;try{for(k(n),p=i(c);null!==p&&(!(p.expirationTime>n)||e&&!E());){var r=p.callback;if("function"==typeof r){p.callback=null,h=p.priorityLevel;var s=r(p.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?p.callback=s:p===i(c)&&o(c),k(n)}else o(c);p=i(c)}if(null!==p)var l=!0;else{var d=i(u);null!==d&&R(S,d.startTime-n),l=!1}return l}finally{p=null,h=a,g=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,C=!1,P=null,x=-1,I=5,A=-1;function E(){return!(t.unstable_now()-A<I)}function O(){if(null!==P){var e=t.unstable_now();A=e;var n=!0;try{n=P(!0,e)}finally{n?T():(C=!1,P=null)}}else C=!1}if("function"==typeof b)T=function(){b(O)};else if("undefined"!=typeof MessageChannel){var _=new MessageChannel,N=_.port2;_.port1.onmessage=O,T=function(){N.postMessage(null)}}else T=function(){v(O,0)};function M(e){P=e,C||(C=!0,T())}function R(e,n){x=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||g||(m=!0,M(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,o,a){var r=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?r+a:r,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>r?(e.sortIndex=a,n(u,e),null===i(c)&&e===i(u)&&(f?(y(x),x=-1):f=!0,R(S,a-r))):(e.sortIndex=s,n(c,e),m||g||(m=!0,M(w))),e},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},8325:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(6067)},9059:(e,t,n)=>{"use strict";e.exports=n.p+"be7cba3d4b9ba5c89563.js"},9198:e=>{"use strict";var t=function(e,t){return e+n(t)},n=function(e){return null===e||"boolean"==typeof e||void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?e:Array.isArray(e)?e.reduce(t,""):function(e){return Object.prototype.hasOwnProperty.call(e,"props")}(e)&&Object.prototype.hasOwnProperty.call(e.props,"children")?n(e.props.children):""};n.default=n,e.exports=n},9666:(e,t,n)=>{"use strict";n.d(t,{$:()=>Ib});var i=n(3696),o=n(7470);n(6958);const a=e=>"string"==typeof e,r=()=>{let e,t;const n=new Promise(((n,i)=>{e=n,t=i}));return n.resolve=e,n.reject=t,n},s=e=>null==e?"":""+e,l=/###/g,c=e=>e&&e.indexOf("###")>-1?e.replace(l,"."):e,u=e=>!e||a(e),d=(e,t,n)=>{const i=a(t)?t.split("."):t;let o=0;for(;o<i.length-1;){if(u(e))return{};const t=c(i[o]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++o}return u(e)?{}:{obj:e,k:c(i[o])}},p=(e,t,n)=>{const{obj:i,k:o}=d(e,t,Object);if(void 0!==i||1===t.length)return void(i[o]=n);let a=t[t.length-1],r=t.slice(0,t.length-1),s=d(e,r,Object);for(;void 0===s.obj&&r.length;)a=`${r[r.length-1]}.${a}`,r=r.slice(0,r.length-1),s=d(e,r,Object),s?.obj&&void 0!==s.obj[`${s.k}.${a}`]&&(s.obj=void 0);s.obj[`${s.k}.${a}`]=n},h=(e,t)=>{const{obj:n,k:i}=d(e,t);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},g=(e,t,n)=>{for(const i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?a(e[i])||e[i]instanceof String||a(t[i])||t[i]instanceof String?n&&(e[i]=t[i]):g(e[i],t[i],n):e[i]=t[i]);return e},m=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const v=e=>a(e)?e.replace(/[&<>"'\/]/g,(e=>f[e])):e,y=[" ",",","?","!",";"],b=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}(20),k=(e,t,n=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const i=t.split(n);let o=e;for(let e=0;e<i.length;){if(!o||"object"!=typeof o)return;let t,a="";for(let r=e;r<i.length;++r)if(r!==e&&(a+=n),a+=i[r],t=o[a],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&r<i.length-1)continue;e+=r-e+1;break}o=t}return o},S=e=>e?.replace("_","-"),w={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class T{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||w,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(a(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new T(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new T(this.logger,e)}}var C=new T;class P{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const n=this.observers[e].get(t)||0;this.observers[e].set(t,n+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach((([e,n])=>{for(let i=0;i<n;i++)e(...t)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((([n,i])=>{for(let o=0;o<i;o++)n.apply(n,[e,...t])}))}}class x extends P{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n,i={}){const o=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,r=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],n&&(Array.isArray(n)?s.push(...n):a(n)&&o?s.push(...n.split(o)):s.push(n)));const l=h(this.data,s);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=s[0],t=s[1],n=s.slice(2).join(".")),!l&&r&&a(n)?k(this.data?.[e]?.[t],n,o):l}addResource(e,t,n,i,o={silent:!1}){const a=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let r=[e,t];n&&(r=r.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(r=e.split("."),i=t,t=r[1]),this.addNamespaces(t),p(this.data,r,i),o.silent||this.emit("added",e,t,n,i)}addResources(e,t,n,i={silent:!1}){for(const i in n)(a(n[i])||Array.isArray(n[i]))&&this.addResource(e,t,i,n[i],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,i,o,a={silent:!1,skipCopy:!1}){let r=[e,t];e.indexOf(".")>-1&&(r=e.split("."),i=n,n=t,t=r[1]),this.addNamespaces(t);let s=h(this.data,r)||{};a.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?g(s,n,o):s={...s,...n},p(this.data,r,s),a.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var I={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,n,i,o){return e.forEach((e=>{t=this.processors[e]?.process(t,n,i,o)??t})),t}};const A={},E=e=>!a(e)&&"boolean"!=typeof e&&"number"!=typeof e;class O extends P{constructor(e,t={}){var n,i;super(),n=e,i=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((e=>{n[e]&&(i[e]=n[e])})),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=C.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const n={...t};if(null==e)return!1;const i=this.resolve(e,n);return void 0!==i?.res}extractFromKey(e,t){let n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const r=n&&e.indexOf(n)>-1,s=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,n)=>{t=t||"",n=n||"";const i=y.filter((e=>t.indexOf(e)<0&&n.indexOf(e)<0));if(0===i.length)return!0;const o=b.getRegExp(`(${i.map((e=>"?"===e?"\\?":e)).join("|")})`);let a=!o.test(e);if(!a){const t=e.indexOf(n);t>0&&!o.test(e.substring(0,t))&&(a=!0)}return a})(e,n,i));if(r&&!s){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:a(o)?[o]:o};const r=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(r[0])>-1)&&(o=r.shift()),e=r.join(i)}return{key:e,namespaces:a(o)?[o]:o}}translate(e,t,n){let i="object"==typeof t?{...t}:t;if("object"!=typeof i&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(i={...i}),i||(i={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const o=void 0!==i.returnDetails?i.returnDetails:this.options.returnDetails,r=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(e[e.length-1],i),c=l[l.length-1];let u=void 0!==i.nsSeparator?i.nsSeparator:this.options.nsSeparator;void 0===u&&(u=":");const d=i.lng||this.language,p=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===d?.toLowerCase())return p?o?{res:`${c}${u}${s}`,usedKey:s,exactUsedKey:s,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(i)}:`${c}${u}${s}`:o?{res:s,usedKey:s,exactUsedKey:s,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(i)}:s;const h=this.resolve(e,i);let g=h?.res;const m=h?.usedKey||s,f=h?.exactUsedKey||s,v=void 0!==i.joinArrays?i.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,b=void 0!==i.count&&!a(i.count),k=O.hasDefaultValue(i),S=b?this.pluralResolver.getSuffix(d,i.count,i):"",w=i.ordinal&&b?this.pluralResolver.getSuffix(d,i.count,{ordinal:!1}):"",T=b&&!i.ordinal&&0===i.count,C=T&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${S}`]||i[`defaultValue${w}`]||i.defaultValue;let P=g;y&&!g&&k&&(P=C);const x=E(P),I=Object.prototype.toString.apply(P);if(!(y&&P&&x&&["[object Number]","[object Function]","[object RegExp]"].indexOf(I)<0)||a(v)&&Array.isArray(P))if(y&&a(v)&&Array.isArray(g))g=g.join(v),g&&(g=this.extendTranslation(g,e,i,n));else{let t=!1,o=!1;!this.isValidLookup(g)&&k&&(t=!0,g=C),this.isValidLookup(g)||(o=!0,g=s);const a=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:g,l=k&&C!==g&&this.options.updateMissing;if(o||t||l){if(this.logger.log(l?"updateKey":"missingKey",d,c,s,l?C:g),r){const e=this.resolve(s,{...i,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let n=0;n<t.length;n++)e.push(t[n]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(i.lng||this.language):e.push(i.lng||this.language);const n=(e,t,n)=>{const o=k&&n!==g?n:a;this.options.missingKeyHandler?this.options.missingKeyHandler(e,c,t,o,l,i):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,c,t,o,l,i),this.emit("missingKey",e,c,t,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&b?e.forEach((e=>{const t=this.pluralResolver.getSuffixes(e,i);T&&i[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach((t=>{n([e],s+t,i[`defaultValue${t}`]||C)}))})):n(e,s,C))}g=this.extendTranslation(g,e,i,h,n),o&&g===s&&this.options.appendNamespaceToMissingKey&&(g=`${c}${u}${s}`),(o||t)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${u}${s}`:s,t?g:void 0,i))}else{if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,P,{...i,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return o?(h.res=e,h.usedParams=this.getUsedParamsDetails(i),h):e}if(r){const e=Array.isArray(P),t=e?[]:{},n=e?f:m;for(const e in P)if(Object.prototype.hasOwnProperty.call(P,e)){const o=`${n}${r}${e}`;t[e]=k&&!g?this.translate(o,{...i,defaultValue:E(C)?C[e]:void 0,joinArrays:!1,ns:l}):this.translate(o,{...i,joinArrays:!1,ns:l}),t[e]===o&&(t[e]=P[e])}g=t}}return o?(h.res=g,h.usedParams=this.getUsedParamsDetails(i),h):g}extendTranslation(e,t,n,i,o){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const r=a(e)&&(void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let s;if(r){const t=e.match(this.interpolator.nestingRegexp);s=t&&t.length}let l=n.replace&&!a(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,n.lng||this.language||i.usedLng,n),r){const t=e.match(this.interpolator.nestingRegexp);s<(t&&t.length)&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,((...e)=>o?.[0]!==e[0]||n.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null)),n)),n.interpolation&&this.interpolator.reset()}const r=n.postProcess||this.options.postProcess,s=a(r)?[r]:r;return null!=e&&s?.length&&!1!==n.applyPostProcessor&&(e=I.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,t={}){let n,i,o,r,s;return a(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(n))return;const l=this.extractFromKey(e,t),c=l.key;i=c;let u=l.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const d=void 0!==t.count&&!a(t.count),p=d&&!t.ordinal&&0===t.count,h=void 0!==t.context&&(a(t.context)||"number"==typeof t.context)&&""!==t.context,g=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);u.forEach((e=>{this.isValidLookup(n)||(s=e,A[`${g[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(s)||(A[`${g[0]}-${e}`]=!0,this.logger.warn(`key "${i}" for languages "${g.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach((i=>{if(this.isValidLookup(n))return;r=i;const a=[c];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(a,c,i,e,t);else{let e;d&&(e=this.pluralResolver.getSuffix(i,t.count,t));const n=`${this.options.pluralSeparator}zero`,o=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(a.push(c+e),t.ordinal&&0===e.indexOf(o)&&a.push(c+e.replace(o,this.options.pluralSeparator)),p&&a.push(c+n)),h){const i=`${c}${this.options.contextSeparator}${t.context}`;a.push(i),d&&(a.push(i+e),t.ordinal&&0===e.indexOf(o)&&a.push(i+e.replace(o,this.options.pluralSeparator)),p&&a.push(i+n))}}let s;for(;s=a.pop();)this.isValidLookup(n)||(o=s,n=this.getResource(i,e,s,t))})))}))})),{res:n,usedKey:i,exactUsedKey:o,usedLng:r,usedNS:s}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,n,i={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!a(e.replace);let i=n?e.replace:e;if(n&&void 0!==e.count&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(const e of t)delete i[e]}return i}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}class _{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=C.create("languageUtils")}getScriptPartFromCode(e){if(!(e=S(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=S(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(a(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const n=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(n)||(t=n)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const n=this.getScriptPartFromCode(e);if(this.isSupportedCode(n))return t=n;const i=this.getLanguagePartFromCode(e);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find((e=>e===i?e:e.indexOf("-")<0&&i.indexOf("-")<0?void 0:e.indexOf("-")>0&&i.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===i||0===e.indexOf(i)&&i.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),a(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){const n=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),i=[],o=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return a(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):a(e)&&o(this.formatLanguageCode(e)),n.forEach((e=>{i.indexOf(e)<0&&o(this.formatLanguageCode(e))})),i}}const N={zero:0,one:1,two:2,few:3,many:4,other:5},M={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class R{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=C.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const n=S("dev"===e?"en":e),i=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:i});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let a;try{a=new Intl.PluralRules(n,{type:i})}catch(n){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),M;if(!e.match(/-|_/))return M;const i=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(i,t)}return this.pluralRulesCache[o]=a,a}needsPlural(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,n={}){return this.getSuffixes(e,n).map((e=>`${t}${e}`))}getSuffixes(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?n.resolvedOptions().pluralCategories.sort(((e,t)=>N[e]-N[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):[]}getSuffix(e,t,n={}){const i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}}const j=(e,t,n,i=".",o=!0)=>{let r=((e,t,n)=>{const i=h(e,n);return void 0!==i?i:h(t,n)})(e,t,n);return!r&&o&&a(n)&&(r=k(e,n,i),void 0===r&&(r=k(t,n,i))),r},D=e=>e.replace(/\$/g,"$$$$");class L{constructor(e={}){this.logger=C.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:o,prefixEscaped:a,suffix:r,suffixEscaped:s,formatSeparator:l,unescapeSuffix:c,unescapePrefix:u,nestingPrefix:d,nestingPrefixEscaped:p,nestingSuffix:h,nestingSuffixEscaped:g,nestingOptionsSeparator:f,maxReplaces:y,alwaysFormat:b}=e.interpolation;this.escape=void 0!==t?t:v,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==i&&i,this.prefix=o?m(o):a||"{{",this.suffix=r?m(r):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=c?"":u||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=d?m(d):p||m("$t("),this.nestingSuffix=h?m(h):g||m(")"),this.nestingOptionsSeparator=f||",",this.maxReplaces=y||1e3,this.alwaysFormat=void 0!==b&&b,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,i){let o,r,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=e=>{if(e.indexOf(this.formatSeparator)<0){const o=j(t,c,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,n,{...i,...t,interpolationkey:e}):o}const o=e.split(this.formatSeparator),a=o.shift().trim(),r=o.join(this.formatSeparator).trim();return this.format(j(t,c,a,this.options.keySeparator,this.options.ignoreJSONStructure),r,n,{...i,...t,interpolationkey:a})};this.resetRegExp();const d=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,p=void 0!==i?.interpolation?.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>D(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?D(this.escape(e)):D(e)}].forEach((t=>{for(l=0;o=t.regex.exec(e);){const n=o[1].trim();if(r=u(n),void 0===r)if("function"==typeof d){const t=d(e,o,i);r=a(t)?t:""}else if(i&&Object.prototype.hasOwnProperty.call(i,n))r="";else{if(p){r=o[0];continue}this.logger.warn(`missed to pass in variable ${n} for interpolating ${e}`),r=""}else a(r)||this.useRawValueToEscape||(r=s(r));const c=t.safeValue(r);if(e=e.replace(o[0],c),p?(t.regex.lastIndex+=r.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,l++,l>=this.maxReplaces)break}})),e}nest(e,t,n={}){let i,o,r;const l=(e,t)=>{const n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;const i=e.split(new RegExp(`${n}[ ]*{`));let o=`{${i[1]}`;e=i[0],o=this.interpolate(o,r);const a=o.match(/'/g),s=o.match(/"/g);((a?.length??0)%2==0&&!s||s.length%2!=0)&&(o=o.replace(/'/g,'"'));try{r=JSON.parse(o),t&&(r={...t,...r})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${n}${o}`}return r.defaultValue&&r.defaultValue.indexOf(this.prefix)>-1&&delete r.defaultValue,e};for(;i=this.nestingRegexp.exec(e);){let c=[];r={...n},r=r.replace&&!a(r.replace)?r.replace:r,r.applyPostProcessor=!1,delete r.defaultValue;let u=!1;if(-1!==i[0].indexOf(this.formatSeparator)&&!/{.*}/.test(i[1])){const e=i[1].split(this.formatSeparator).map((e=>e.trim()));i[1]=e.shift(),c=e,u=!0}if(o=t(l.call(this,i[1].trim(),r),r),o&&i[0]===e&&!a(o))return o;a(o)||(o=s(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),o=""),u&&(o=c.reduce(((e,t)=>this.format(e,t,n.lng,{...n,interpolationkey:i[1].trim()})),o.trim())),e=e.replace(i[0],o),this.regexp.lastIndex=0}return e}}const F=e=>{const t={};return(n,i,o)=>{let a=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(a={...a,[o.interpolationkey]:void 0});const r=i+JSON.stringify(a);let s=t[r];return s||(s=e(S(i),o),t[r]=s),s(n)}},z=e=>(t,n,i)=>e(S(n),i)(t);class U{constructor(e={}){this.logger=C.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const n=t.cacheInBuiltFormats?F:z;this.formats={number:n(((e,t)=>{const n=new Intl.NumberFormat(e,{...t});return e=>n.format(e)})),currency:n(((e,t)=>{const n=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>n.format(e)})),datetime:n(((e,t)=>{const n=new Intl.DateTimeFormat(e,{...t});return e=>n.format(e)})),relativetime:n(((e,t)=>{const n=new Intl.RelativeTimeFormat(e,{...t});return e=>n.format(e,t.range||"day")})),list:n(((e,t)=>{const n=new Intl.ListFormat(e,{...t});return e=>n.format(e)}))}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=F(t)}format(e,t,n,i={}){const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find((e=>e.indexOf(")")>-1))){const e=o.findIndex((e=>e.indexOf(")")>-1));o[0]=[o[0],...o.splice(1,e)].join(this.formatSeparator)}return o.reduce(((e,t)=>{const{formatName:o,formatOptions:a}=(e=>{let t=e.toLowerCase().trim();const n={};if(e.indexOf("(")>-1){const i=e.split("(");t=i[0].toLowerCase().trim();const o=i[1].substring(0,i[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((e=>{if(e){const[t,...i]=e.split(":"),o=i.join(":").trim().replace(/^'+|'+$/g,""),a=t.trim();n[a]||(n[a]=o),"false"===o&&(n[a]=!1),"true"===o&&(n[a]=!0),isNaN(o)||(n[a]=parseInt(o,10))}}))}return{formatName:t,formatOptions:n}})(t);if(this.formats[o]){let t=e;try{const r=i?.formatParams?.[i.interpolationkey]||{},s=r.locale||r.lng||i.locale||i.lng||n;t=this.formats[o](e,s,{...a,...i,...r})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${o}`),e}),e)}}class V extends P{constructor(e,t,n,i={}){super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=C.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,i.backend,i)}queueLoad(e,t,n,i){const o={},a={},r={},s={};return e.forEach((e=>{let i=!0;t.forEach((t=>{const r=`${e}|${t}`;!n.reload&&this.store.hasResourceBundle(e,t)?this.state[r]=2:this.state[r]<0||(1===this.state[r]?void 0===a[r]&&(a[r]=!0):(this.state[r]=1,i=!1,void 0===a[r]&&(a[r]=!0),void 0===o[r]&&(o[r]=!0),void 0===s[t]&&(s[t]=!0)))})),i||(r[e]=!0)})),(Object.keys(o).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(a),toLoadLanguages:Object.keys(r),toLoadNamespaces:Object.keys(s)}}loaded(e,t,n){const i=e.split("|"),o=i[0],a=i[1];t&&this.emit("failedLoading",o,a,t),!t&&n&&this.store.addResourceBundle(o,a,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);const r={};this.queue.forEach((n=>{((e,t,n)=>{const{obj:i,k:o}=d(e,t,Object);i[o]=i[o]||[],i[o].push(n)})(n.loaded,[o],a),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((e=>{r[e]||(r[e]={});const t=n.loaded[e];t.length&&t.forEach((t=>{void 0===r[e][t]&&(r[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",r),this.queue=this.queue.filter((e=>!e.done))}read(e,t,n,i=0,o=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:o,callback:a});this.readingCalls++;const r=(r,s)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}r&&s&&i<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,n,i+1,2*o,a)}),o):a(r,s)},s=this.backend[n].bind(this.backend);if(2!==s.length)return s(e,t,r);try{const n=s(e,t);n&&"function"==typeof n.then?n.then((e=>r(null,e))).catch(r):r(null,n)}catch(e){r(e)}}prepareLoading(e,t,n={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();a(e)&&(e=this.languageUtils.toResolveHierarchy(e)),a(t)&&(t=[t]);const o=this.queueLoad(e,t,n,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e,t=""){const n=e.split("|"),i=n[0],o=n[1];this.read(i,o,"read",void 0,void 0,((n,a)=>{n&&this.logger.warn(`${t}loading namespace ${o} for language ${i} failed`,n),!n&&a&&this.logger.log(`${t}loaded namespace ${o} for language ${i}`,a),this.loaded(e,n,a)}))}saveMissing(e,t,n,i,o,a={},r=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=n&&""!==n){if(this.backend?.create){const s={...a,isUpdate:o},l=this.backend.create.bind(this.backend);if(l.length<6)try{let o;o=5===l.length?l(e,t,n,i,s):l(e,t,n,i),o&&"function"==typeof o.then?o.then((e=>r(null,e))).catch(r):r(null,o)}catch(e){r(e)}else l(e,t,n,i,r,s)}e&&e[0]&&this.store.addResource(e[0],t,n,i)}}else this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const B=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),a(e[1])&&(t.defaultValue=e[1]),a(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const n=e[3]||e[2];Object.keys(n).forEach((e=>{t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),q=e=>(a(e.ns)&&(e.ns=[e.ns]),a(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),a(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),K=()=>{};class H extends P{constructor(e={},t){var n;if(super(),this.options=q(e),this.services={},this.logger=C,this.modules={external:[]},n=this,Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach((e=>{"function"==typeof n[e]&&(n[e]=n[e].bind(n))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(a(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=B();this.options={...n,...this.options,...q(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?C.init(i(this.modules.logger),this.options):C.init(null,this.options),e=this.modules.formatter?this.modules.formatter:U;const t=new _(this.options);this.store=new x(this.options.resources,this.options);const o=this.services;o.logger=C,o.resourceStore=this.store,o.languageUtils=t,o.pluralResolver=new R(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format||(o.formatter=i(e),o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new L(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new V(i(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.languageDetector&&(o.languageDetector=i(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=i(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new O(this.services,this.options),this.translator.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,t||(t=K),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=(...t)=>this.store[e](...t)})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=(...t)=>(this.store[e](...t),this)}));const o=r(),s=()=>{const e=(e,n)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(n),t(e,n)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),o}loadResources(e,t=K){let n=t;const i=a(e)?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===i?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return n();const e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};i?t(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>t(e))),this.options.preload?.forEach?.((e=>t(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),n(e)}))}else n(null)}reloadResources(e,t,n){const i=r();return"function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=K),this.services.backendConnector.reload(e,t,(e=>{i.resolve(),n(e)})),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&I.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const n=r();this.emit("languageChanging",e);const i=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},o=(o,a)=>{a?this.isLanguageChangingTo===e&&(i(a),this.translator.changeLanguage(a),this.isLanguageChangingTo=void 0,this.emit("languageChanged",a),this.logger.log("languageChanged",a)):this.isLanguageChangingTo=void 0,n.resolve(((...e)=>this.t(...e))),t&&t(o,((...e)=>this.t(...e)))},s=t=>{e||t||!this.services.languageDetector||(t=[]);const n=a(t)?t:t&&t[0],r=this.store.hasLanguageSomeTranslations(n)?n:this.services.languageUtils.getBestMatchFromCodes(a(t)?[t]:t);r&&(this.language||i(r),this.translator.language||this.translator.changeLanguage(r),this.services.languageDetector?.cacheUserLanguage?.(r)),this.loadResources(r,(e=>{o(e,r)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),n}getFixedT(e,t,n){const i=(e,t,...o)=>{let a;a="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(o)):{...t},a.lng=a.lng||i.lng,a.lngs=a.lngs||i.lngs,a.ns=a.ns||i.ns,""!==a.keyPrefix&&(a.keyPrefix=a.keyPrefix||n||i.keyPrefix);const r=this.options.keySeparator||".";let s;return s=a.keyPrefix&&Array.isArray(e)?e.map((e=>`${a.keyPrefix}${r}${e}`)):a.keyPrefix?`${a.keyPrefix}${r}${e}`:e,this.t(s,a)};return a(e)?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=n,i}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;const a=(e,t)=>{const n=this.services.backendConnector.state[`${e}|${t}`];return-1===n||0===n||2===n};if(t.precheck){const e=t.precheck(this,a);if(void 0!==e)return e}return!(!this.hasResourceBundle(n,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!a(n,e)||i&&!a(o,e)))}loadNamespaces(e,t){const n=r();return this.options.ns?(a(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){const n=r();a(e)&&(e=[e]);const i=this.options.preload||[],o=e.filter((e=>i.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return o.length?(this.options.preload=i.concat(o),this.loadResources((e=>{n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services?.languageUtils||new _(B());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new H(e,t)}cloneInstance(e={},t=K){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},o=new H(i);if(void 0===e.debug&&void 0===e.prefix||(o.logger=o.logger.clone(e)),["store","services","language"].forEach((e=>{o[e]=this[e]})),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){const e=Object.keys(this.store.data).reduce(((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce(((n,i)=>(n[i]={...e[t][i]},n)),e[t]),e)),{});o.store=new x(e,i),o.services.resourceStore=o.store}return o.translator=new O(o.services,i),o.translator.on("*",((e,...t)=>{o.emit(e,...t)})),o.init(i,t),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const W=H.createInstance();W.createInstance=H.createInstance,W.createInstance,W.dir,W.init,W.loadResources,W.reloadResources,W.use,W.changeLanguage,W.getFixedT,W.t,W.exists,W.setDefaultNamespace,W.hasLoadedNamespace,W.loadNamespaces,W.loadLanguages,n(7151),Object.create(null);const G={},$=(e,t,n,i)=>{Z(n)&&G[n]||(Z(n)&&(G[n]=new Date),((e,t,n,i)=>{const o=[n,{code:t,...i||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(o,"warn","react-i18next::",!0);Z(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...o):console?.warn&&console.warn(...o)})(e,t,n,i))},J=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout((()=>{e.off("initialized",n)}),0),t()};e.on("initialized",n)}},Q=(e,t,n)=>{e.loadNamespaces(t,J(e,n))},Y=(e,t,n,i)=>{if(Z(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return Q(e,n,i);n.forEach((t=>{e.options.ns.indexOf(t)<0&&e.options.ns.push(t)})),e.loadLanguages(t,J(e,i))},Z=e=>"string"==typeof e,X=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,ee={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},te=e=>ee[e];let ne,ie={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(X,te)};const oe={type:"3rdParty",init(e){((e={})=>{ie={...ie,...e}})(e.options.react),(e=>{ne=e})(e)}},ae=(0,i.createContext)();class re{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach((e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)}))}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const se=(e,t,n,i)=>e.getFixedT(t,n,i),le=(e,t={})=>{const{i18n:n}=t,{i18n:o,defaultNS:a}=(0,i.useContext)(ae)||{},r=n||o||ne;if(r&&!r.reportNamespaces&&(r.reportNamespaces=new re),!r){$(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const e=(e,t)=>{return Z(t)?t:"object"==typeof(n=t)&&null!==n&&Z(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e;var n},t=[e,{},!1];return t.t=e,t.i18n={},t.ready=!1,t}r.options.react?.wait&&$(r,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const s={...ie,...r.options.react,...t},{useSuspense:l,keyPrefix:c}=s;let u=e||a||r.options?.defaultNS;u=Z(u)?[u]:u||["translation"],r.reportNamespaces.addUsedNamespaces?.(u);const d=(r.isInitialized||r.initializedStoreOnce)&&u.every((e=>((e,t,n={})=>t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:n.lng,precheck:(t,i)=>{if(n.bindI18n?.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e))return!1}}):($(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0))(e,r,s))),p=((e,t,n,o)=>(0,i.useCallback)(se(e,t,n,o),[e,t,n,o]))(r,t.lng||null,"fallback"===s.nsMode?u:u[0],c),h=()=>p,g=()=>se(r,t.lng||null,"fallback"===s.nsMode?u:u[0],c),[m,f]=(0,i.useState)(h);let v=u.join();t.lng&&(v=`${t.lng}${v}`);const y=((e,t)=>{const n=(0,i.useRef)();return(0,i.useEffect)((()=>{n.current=e}),[e,t]),n.current})(v),b=(0,i.useRef)(!0);(0,i.useEffect)((()=>{const{bindI18n:e,bindI18nStore:n}=s;b.current=!0,d||l||(t.lng?Y(r,t.lng,u,(()=>{b.current&&f(g)})):Q(r,u,(()=>{b.current&&f(g)}))),d&&y&&y!==v&&b.current&&f(g);const i=()=>{b.current&&f(g)};return e&&r?.on(e,i),n&&r?.store.on(n,i),()=>{b.current=!1,r&&e?.split(" ").forEach((e=>r.off(e,i))),n&&r&&n.split(" ").forEach((e=>r.store.off(e,i)))}}),[r,v]),(0,i.useEffect)((()=>{b.current&&d&&f(h)}),[r,c,d]);const k=[m,r,d];if(k.t=m,k.i18n=r,k.ready=d,d)return k;if(!d&&!l)return k;throw new Promise((e=>{t.lng?Y(r,t.lng,u,(()=>e())):Q(r,u,(()=>e()))}))},{slice:ce,forEach:ue}=[],de=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,pe={create(e,t,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+60*n*1e3)),i&&(o.domain=i),document.cookie=function(e,t){const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/"};let i=`${e}=${encodeURIComponent(t)}`;if(n.maxAge>0){const e=n.maxAge-0;if(Number.isNaN(e))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(e)}`}if(n.domain){if(!de.test(n.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${n.domain}`}if(n.path){if(!de.test(n.path))throw new TypeError("option path is invalid");i+=`; Path=${n.path}`}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");i+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n.partitioned&&(i+="; Partitioned"),i}(e,encodeURIComponent(t),o)},read(e){const t=`${e}=`,n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},remove(e){this.create(e,"",-1)}};var he={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&"undefined"!=typeof document)return pe.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:n,cookieMinutes:i,cookieDomain:o,cookieOptions:a}=t;n&&"undefined"!=typeof document&&pe.create(n,e,i,o,a)}},ge={name:"querystring",lookup(e){let t,{lookupQuerystring:n}=e;if("undefined"!=typeof window){let{search:e}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(e=window.location.hash.substring(window.location.hash.indexOf("?")));const i=e.substring(1).split("&");for(let e=0;e<i.length;e++){const o=i[e].indexOf("=");o>0&&i[e].substring(0,o)===n&&(t=i[e].substring(o+1))}}return t}};let me=null;const fe=()=>{if(null!==me)return me;try{if(me="undefined"!=typeof window&&null!==window.localStorage,!me)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){me=!1}return me};var ve={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&fe())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:n}=t;n&&fe()&&window.localStorage.setItem(n,e)}};let ye=null;const be=()=>{if(null!==ye)return ye;try{if(ye="undefined"!=typeof window&&null!==window.sessionStorage,!ye)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){ye=!1}return ye};var ke={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&be())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:n}=t;n&&be()&&window.sessionStorage.setItem(n,e)}},Se={name:"navigator",lookup(e){const t=[];if("undefined"!=typeof navigator){const{languages:e,userLanguage:n,language:i}=navigator;if(e)for(let n=0;n<e.length;n++)t.push(e[n]);n&&t.push(n),i&&t.push(i)}return t.length>0?t:void 0}},we={name:"htmlTag",lookup(e){let t,{htmlTag:n}=e;const i=n||("undefined"!=typeof document?document.documentElement:null);return i&&"function"==typeof i.getAttribute&&(t=i.getAttribute("lang")),t}},Te={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if("undefined"==typeof window)return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(!Array.isArray(n))return;const i="number"==typeof t?t:0;return n[i]?.replace("/","")}},Ce={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const n="number"==typeof t?t+1:1,i="undefined"!=typeof window&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(i)return i[n]}};let Pe=!1;try{document.cookie,Pe=!0}catch(No){}const xe=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Pe||xe.splice(1,1);class Ie{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{languageUtils:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(e){return ue.call(ce.call(arguments,1),(t=>{if(t)for(const n in t)void 0===e[n]&&(e[n]=t[n])})),e}(t,this.options||{},{order:xe,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e}),"string"==typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=e=>e.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(he),this.addDetector(ge),this.addDetector(ve),this.addDetector(ke),this.addDetector(Se),this.addDetector(we),this.addDetector(Te),this.addDetector(Ce)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.order,t=[];return e.forEach((e=>{if(this.detectors[e]){let n=this.detectors[e].lookup(this.options);n&&"string"==typeof n&&(n=[n]),n&&(t=t.concat(n))}})),t=t.filter((e=>{return null!=e&&!("string"==typeof(t=e)&&[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some((e=>e.test(t))));var t})).map((e=>this.options.convertDetectedLanguage(e))),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach((t=>{this.detectors[t]&&this.detectors[t].cacheUserLanguage(e,this.options)})))}}Ie.type="languageDetector";const Ae={en:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Cancel","save":"Save","close":"Close","settings":"Settings","help":"Help","loading":"Loading...","error":"Error","success":"Success","warning":"Warning","info":"Information","logs":"Logs","clear":"Clear"},"app":{"title":"Sokuji","description":"Live speech translation application"},"menu":{"file":"File","edit":"Edit","view":"View","window":"Window","help":"Help"},"settings":{"title":"Settings","provider":"Provider","openaiApiKey":"OpenAI API Key","geminiApiKey":"Gemini API Key","palabraApiKey":"Palabra API Key","clientId":"Client ID","clientSecret":"Client Secret","systemPrompt":"System Prompt","language":"Language","languageSettings":"Language Settings","voice":"Voice","voiceSettings":"Voice Settings","model":"Model","selectModel":"Select a model","noModelsAvailable":"No models available","turnOnMicrophone":"Turn on Microphone","turnOffMicrophone":"Turn off Microphone","turnOnSpeakers":"Turn on Speakers","turnOffSpeakers":"Turn off Speakers","vad":"VAD","vadEnable":"Enable VAD","vadOn":"VAD On","vadOff":"VAD Off","vadThreshold":"VAD Threshold","vadMode":"VAD Mode","vadDebounceTime":"VAD Debounce Time","endpointing":"Endpointing","endpointingEnable":"Enable Endpointing","endpointingOn":"Endpointing On","endpointingOff":"Endpointing Off","endpointingDelay":"Endpointing Delay","endpointingLatency":"Endpointing Latency","endpointingMode":"Endpointing Mode","endpointingLevel":"Endpointing Level","vadPeriodicSilenceCheck":"Periodic Silence Check","vadResetAfterSilence":"Reset After Silence","speechProcessing":"Speech Processing","silenceThreshold":"Silence Threshold","sentenceSplitter":"Sentence Splitter","enabled":"Enabled","translatePartialTranscriptions":"Translate Partial Transcriptions","queueConfiguration":"Audio Buffer Configuration","desiredQueueLevel":"Target Audio Buffer","maxQueueLevel":"Max Audio Buffer","autoTempo":"Adaptive Speech Speed","apiKey":"API Key","apiKeyInfo":"Your API key is stored locally and never sent to any server except to the API provider.","systemPromptPlaceholder":"e.g. Translate into formal Japanese.","hotkey":"Hotkey","pushToTalk":"Push-to-talk","appBehavior":"App Behavior","autoStart":"Auto-start on launch","windowManagement":"Window Management","alwaysOnTop":"Always on top","closeToTray":"Close to tray","about":"About","version":"Version","licenses":"Licenses","credits":"Credits","privacy":"Privacy","terms":"Terms","changes":"What\'s new?","general":"General","audio":"Audio","translation":"Translation","uiLanguage":"UI Language","providerType":"Provider","systemInstructions":"System Instructions","automaticTurnDetection":"Automatic turn detection","userTranscriptModel":"User transcript model","noiseReduction":"Noise reduction","modelConfiguration":"Model configuration","sourceLanguage":"Source Language","targetLanguage":"Target Language","preview":"Preview","simple":"Simple","advanced":"Advanced","normal":"Normal","semantic":"Semantic","disabled":"Disabled","threshold":"Threshold","prefixPadding":"Prefix padding","silenceDuration":"Silence duration","eagerness":"Eagerness","temperature":"Temperature","maxTokens":"Max tokens","saving":"Saving...","validate":"Validate","validating":"Validating...","enterApiKey":"Enter your OpenAI API key","enterCustomInstructions":"Enter custom system instructions here...","settingsSavedSuccessfully":"Settings saved successfully","failedToSaveSettings":"Failed to save settings","validatingApiKey":"Validating API key...","settingSavedSuccessfully":"Successfully saved setting: {{key}}","failedToSaveSetting":"Failed to save setting: {{key}}","apiKeyValidationCompleted":"API key validation completed","errorValidatingApiKey":"Error validating API key","sessionActiveNotice":"Settings are locked while session is active. Please end the session to modify settings.","realtimeModelAvailable":"Realtime model is available","realtimeModelNotAvailable":"Realtime model is not available","refreshModels":"Refresh available models","loadingModels":"Loading available models...","modelsFound":"{{count}} models available","experimentalFeatureTooltip":"This is an experimental feature and may be unstable.","help":"Help","auto":"Auto","low":"Low","medium":"Medium","high":"High","apiKeyValidated":"API key validated","realtimeTranslationAvailable":"Realtime translation is available"},"audioPanel":{"title":"Audio Settings","audioInputDevice":"Audio Input Device","virtualSpeakerMonitorDevice":"Virtual Speaker Monitor Device","availableInputDevices":"Available Input Devices","availableMonitorDevices":"Available Monitor Devices","loadingDevices":"Loading devices...","noDeviceSelected":"No device selected","turnOn":"Turn On","turnOff":"Turn Off","refreshInputDevices":"Refresh input devices","refreshMonitorDevices":"Refresh monitor devices","virtualMicrophone":"Virtual microphone","virtualSpeaker":"Virtual speaker","virtualMicrophoneNotice":"Virtual Microphone Notice","virtualSpeakerNotice":"Virtual Speaker Notice","iUnderstand":"I understand","virtualMicWarningTitle":"This is a virtual microphone created by Sokuji.","virtualMicWarningText1":"Please do not select this device here. Instead, use this virtual microphone in your video conferencing applications (like Google Meet, Zoom, Microsoft Teams, etc.) to receive the live speech translation output.","virtualMicWarningText2":"For Sokuji to work properly, please select your actual physical microphone from the list.","virtualSpeakerWarningTitle":"This is a virtual speaker created by Sokuji.","virtualSpeakerWarningText1":"Please do not select this device as your monitor. The Sokuji_Virtual_Speaker is used by Sokuji to output audio to your conferencing applications.","virtualSpeakerWarningText2":"Connecting your monitor to Sokuji\'s output device would create an audio feedback loop, causing your input to contain your own monitored output.","virtualSpeakerWarningText3":"The \\"Turn On\\" switch connects the virtual speaker to your selected monitor device, allowing you to hear what\'s being sent to your conferencing application. The \\"Turn Off\\" switch disconnects this monitoring connection.","virtualSpeakerWarningText4":"For proper operation, please select a different monitor device (like your headphones or speakers) from the list.","realVoicePassthrough":"Original Audio Passthrough","enableRealVoicePassthrough":"Enable Original Audio Passthrough","realVoicePassthroughDescription":"Pass your original audio (speaker\'s voice) directly to the virtual microphone so listeners can hear both original and translated audio","realVoiceVolume":"Original Audio Volume"},"logsPanel":{"title":"Logs","autoScrollOn":"Auto-scroll on","autoScrollOff":"Auto-scroll off","enableAutoScroll":"Enable auto-scroll","disableAutoScroll":"Disable auto-scroll","logsPlaceholder":"Logs will appear here","client":"client","server":"server","event":"Event","of":"of","unknown":"unknown"},"translation":{"start":"Start Translation","stop":"Stop Translation","listening":"Listening...","translating":"Translating...","sourceLanguage":"Source Language","targetLanguage":"Target Language"},"mainPanel":{"conversationPlaceholder":"Conversation will appear here","audioContent":"Audio content","function":"Function","input":"Input","output":"Output","release":"release","pushToTalk":"push to talk (Space)","inputDeviceOff":"input device off","endSession":"End Session","startSession":"Start Session","initializing":"Initializing...","stopDebug":"Stop Debug","debug":"Debug","apiKeyRequired":"Please add a valid OpenAI API Key in settings first","modelsRequired":"Models are required. Please validate your API key first to load available models.","modelsLoading":"Loading available models, please wait..."},"errors":{"microphoneAccess":"Microphone access denied","networkError":"Network connection error","translationFailed":"Translation failed","audioError":"Audio processing error"},"audioFeedback":{"title":"Audio Feedback Warning","description":"Potential audio feedback detected. This may cause echo or sound loops during recording.","inputDevice":"Input Device","outputDevice":"Output Device","recommendation":"Recommendation","solutions":{"title":"Solutions","differentDevices":"Select different input and output devices","useHeadphones":"Use headphones instead of speakers","adjustDistance":"Increase distance between microphone and speakers","disablePassthrough":"Disable original audio passthrough"}},"onboarding":{"back":"Back","close":"Close","finish":"Finish","next":"Next","nextWithProgress":"Next ({step}/{steps})","open":"Open the dialog","skip":"Skip tour","restartTour":"Restart Setup Guide","steps":{"welcome":{"title":"Welcome to Sokuji","content":"Welcome to Sokuji! This guide will help you set up the extension for live speech translation. Let\'s get started!"},"settings":{"title":"Step 1: Open Settings","content":"First, let\'s configure your settings. Click here to open the Settings panel where you can set up your OpenAI API key and customize system instructions."},"apiKey":{"title":"Step 2: Configure API Key","content":"Enter your OpenAI API key here. You can get one from the","linkText":"OpenAI page","required":"This is required for the speech translation to work."},"systemInstructions":{"title":"Step 3: System Instructions","content":"Customize the system instructions to control how the AI responds. You can modify the translation behavior and add specific requirements here."},"voiceSettings":{"title":"Step 4: Voice Settings","content":"Configure the voice type that will be used for speech synthesis. Choose from different voice options to match your preference."},"turnDetection":{"title":"Step 5: Turn Detection","content":"Configure automatic turn detection settings including detection mode, threshold, and audio parameters for optimal speech recognition performance."},"audioSettings":{"title":"Step 6: Audio Settings","content":"Next, let\'s configure your audio settings. Click here to open the Audio panel and set up your microphone and speakers."},"microphoneSetup":{"title":"Step 7: Microphone Setup","content":"Select your microphone device here. Make sure to choose the correct input device for the best audio quality."},"speakerSetup":{"title":"Step 8: Speaker Setup","content":"Select a monitoring device to listen to the translated audio and verify if it meets your requirements. It is recommended to use headphones for monitoring to avoid interference with microphone input. When you are satisfied with the translation settings, it is suggested to turn off monitoring so you can focus more on your expression without microphone interference."},"startSession":{"title":"Step 9: Start Session","content":"Click the \\"Start Session\\" button to begin using Sokuji. Once started, you can speak naturally for live translation. If Automatic turn detection is disabled, use \\"Push to Talk\\" (Space key) to speak."},"complete":{"title":"Setup Guide Complete!","content":"Great! You\'ve completed the setup guide and are now familiar with the interface. To start using Sokuji, please enter your OpenAI API key in the settings, grant microphone permissions when prompted, and select \\"Sokuji Virtual Microphone\\" as your microphone in your meeting application (Google Meet, Zoom, Microsoft Teams, etc.). You can restart this guide anytime from the settings."}}}}')},ja:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":""},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":"UI","openaiApiKey":"OpenAI API","provider":"","providerType":"","apiKey":"API","systemInstructions":"","voice":"","automaticTurnDetection":"","model":"","userTranscriptModel":"","noiseReduction":"","modelConfiguration":"","sourceLanguage":"","targetLanguage":"","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":"","silenceDuration":"","eagerness":"","temperature":"","maxTokens":"","saving":"...","validate":"","validating":"...","enterApiKey":"OpenAI API","enterCustomInstructions":"...","settingsSavedSuccessfully":"","failedToSaveSettings":"","validatingApiKey":"API...","settingSavedSuccessfully":": {{key}}","failedToSaveSetting":": {{key}}","apiKeyValidationCompleted":"API","errorValidatingApiKey":"API","sessionActiveNotice":"","realtimeModelAvailable":"","realtimeModelNotAvailable":"","refreshModels":"","loadingModels":"...","modelsFound":"{{count}}","experimentalFeatureTooltip":"","help":"","auto":"","low":"","medium":"","high":"","clientId":"ID","clientSecret":"","languageSettings":"","voiceSettings":"","speechProcessing":"","silenceThreshold":"","sentenceSplitter":"","enabled":"","translatePartialTranscriptions":"","queueConfiguration":"","desiredQueueLevel":"","maxQueueLevel":"","autoTempo":"","apiKeyValidated":"API","realtimeTranslationAvailable":""},"audioPanel":{"title":"","audioInputDevice":"","virtualSpeakerMonitorDevice":"","availableInputDevices":"","availableMonitorDevices":"","loadingDevices":"...","noDeviceSelected":"","turnOn":"","turnOff":"","refreshInputDevices":"","refreshMonitorDevices":"","virtualMicrophone":"","virtualSpeaker":"","virtualMicrophoneNotice":"","virtualSpeakerNotice":"","iUnderstand":"","virtualMicWarningTitle":"Sokuji","virtualMicWarningText1":"Google MeetZoomMicrosoft Teams","virtualMicWarningText2":"Sokuji","virtualSpeakerWarningTitle":"Sokuji","virtualSpeakerWarningText1":"Sokuji_Virtual_SpeakerSokuji","virtualSpeakerWarningText2":"Sokuji","virtualSpeakerWarningText3":"","virtualSpeakerWarningText4":"","realVoicePassthrough":"","enableRealVoicePassthrough":"","realVoicePassthroughDescription":"","realVoiceVolume":""},"logsPanel":{"title":"","autoScrollOn":" ","autoScrollOff":" ","enableAutoScroll":"","disableAutoScroll":"","logsPlaceholder":"","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":"","stop":"","listening":"...","translating":"...","sourceLanguage":"","targetLanguage":""},"mainPanel":{"conversationPlaceholder":"","audioContent":"","function":"","input":"","output":"","release":"","pushToTalk":" ()","inputDeviceOff":"","endSession":"","startSession":"","initializing":"...","stopDebug":"","debug":"","apiKeyRequired":"OpenAI API","modelsRequired":"API","modelsLoading":"..."},"errors":{"microphoneAccess":"","networkError":"","translationFailed":"","audioError":""},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"","steps":{"welcome":{"title":"Sokuji","content":"Sokuji"},"settings":{"title":"1","content":"OpenAI API"},"apiKey":{"title":"2API","content":"OpenAI API","linkText":"OpenAI","required":""},"systemInstructions":{"title":"3","content":"AI"},"voiceSettings":{"title":"4","content":""},"turnDetection":{"title":"5","content":""},"audioSettings":{"title":"6","content":""},"microphoneSetup":{"title":"7","content":""},"speakerSetup":{"title":"8","content":""},"startSession":{"title":"9","content":"Sokuji"},"complete":{"title":"","content":"SokujiOpenAI APIGoogle MeetZoomMicrosoft TeamsSokuji Virtual Microphone"}}}}')},zh_CN:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":""},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":"","openaiApiKey":"OpenAI API","provider":"","providerType":"","apiKey":"API","systemInstructions":"","voice":"","automaticTurnDetection":"","model":"","userTranscriptModel":"","noiseReduction":"","modelConfiguration":"","sourceLanguage":"","targetLanguage":"","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":"","silenceDuration":"","eagerness":"","temperature":"","maxTokens":"","saving":"...","validate":"","validating":"...","enterApiKey":"OpenAI API","enterCustomInstructions":"...","settingsSavedSuccessfully":"","failedToSaveSettings":"","validatingApiKey":"API...","settingSavedSuccessfully":": {{key}}","failedToSaveSetting":": {{key}}","apiKeyValidationCompleted":"API","errorValidatingApiKey":"API","sessionActiveNotice":"","realtimeModelAvailable":"","realtimeModelNotAvailable":"","refreshModels":"","loadingModels":"...","modelsFound":"{{count}}","experimentalFeatureTooltip":"","help":"","auto":"","low":"","medium":"","high":"","clientId":"ID","clientSecret":"","languageSettings":"","voiceSettings":"","speechProcessing":"","silenceThreshold":"","sentenceSplitter":"","enabled":"","translatePartialTranscriptions":"","queueConfiguration":"","desiredQueueLevel":"","maxQueueLevel":"","autoTempo":"","apiKeyValidated":"API","realtimeTranslationAvailable":""},"audioPanel":{"title":"","audioInputDevice":"","virtualSpeakerMonitorDevice":"","availableInputDevices":"","availableMonitorDevices":"","loadingDevices":"...","noDeviceSelected":"","turnOn":"","turnOff":"","refreshInputDevices":"","refreshMonitorDevices":"","virtualMicrophone":"","virtualSpeaker":"","virtualMicrophoneNotice":"","virtualSpeakerNotice":"","iUnderstand":"","virtualMicWarningTitle":"Sokuji","virtualMicWarningText1":"Google MeetZoomMicrosoft Teams","virtualMicWarningText2":"Sokuji","virtualSpeakerWarningTitle":"Sokuji","virtualSpeakerWarningText1":"Sokuji_Virtual_SpeakerSokuji","virtualSpeakerWarningText2":"Sokuji","virtualSpeakerWarningText3":"\\"\\"\\"\\"","virtualSpeakerWarningText4":"","realVoicePassthrough":"","enableRealVoicePassthrough":"","realVoicePassthroughDescription":"","realVoiceVolume":""},"logsPanel":{"title":"","autoScrollOn":" ","autoScrollOff":" ","enableAutoScroll":"","disableAutoScroll":"","logsPlaceholder":"","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":"","stop":"","listening":"...","translating":"...","sourceLanguage":"","targetLanguage":""},"mainPanel":{"conversationPlaceholder":"","audioContent":"","function":"","input":"","output":"","release":"","pushToTalk":" ()","inputDeviceOff":"","endSession":"","startSession":"","initializing":"...","stopDebug":"","debug":"","apiKeyRequired":"OpenAI API","modelsRequired":"API","modelsLoading":"..."},"errors":{"microphoneAccess":"","networkError":"","translationFailed":"","audioError":""},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"","steps":{"welcome":{"title":"Sokuji","content":"Sokuji"},"settings":{"title":"1","content":"OpenAI API"},"apiKey":{"title":"2API","content":"OpenAI API","linkText":"OpenAI","required":""},"systemInstructions":{"title":"3","content":"AI"},"voiceSettings":{"title":"4","content":""},"turnDetection":{"title":"5","content":""},"audioSettings":{"title":"6","content":""},"microphoneSetup":{"title":"7","content":""},"speakerSetup":{"title":"8","content":""},"startSession":{"title":"9","content":"\\"\\"Sokuji\\"\\""},"complete":{"title":"","content":"SokujiOpenAI APIGoogle MeetZoomMicrosoft Teams\\"Sokuji Virtual Microphone\\""}}}}')},zh_TW:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":""},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":"","openaiApiKey":"OpenAI API","provider":"","providerType":"","apiKey":"API","systemInstructions":"","voice":"","automaticTurnDetection":"","model":"","userTranscriptModel":"","noiseReduction":"","modelConfiguration":"","sourceLanguage":"","targetLanguage":"","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":"","silenceDuration":"","eagerness":"","temperature":"","maxTokens":"","saving":"...","validate":"","validating":"...","enterApiKey":"OpenAI API","enterCustomInstructions":"...","settingsSavedSuccessfully":"","failedToSaveSettings":"","validatingApiKey":"API...","settingSavedSuccessfully":": {{key}}","failedToSaveSetting":": {{key}}","apiKeyValidationCompleted":"API","errorValidatingApiKey":"API","sessionActiveNotice":"","realtimeModelAvailable":"","realtimeModelNotAvailable":"","refreshModels":"","loadingModels":"...","modelsFound":" {{count}} ","experimentalFeatureTooltip":"","help":"","auto":"","low":"","medium":"","high":"","clientId":"ID","clientSecret":"","languageSettings":"","voiceSettings":"","speechProcessing":"","silenceThreshold":"","sentenceSplitter":"","enabled":"","translatePartialTranscriptions":"","queueConfiguration":"","desiredQueueLevel":"","maxQueueLevel":"","autoTempo":"","apiKeyValidated":"API","realtimeTranslationAvailable":""},"audioPanel":{"title":"","audioInputDevice":"","virtualSpeakerMonitorDevice":"","availableInputDevices":"","availableMonitorDevices":"","loadingDevices":"...","noDeviceSelected":"","turnOn":"","turnOff":"","refreshInputDevices":"","refreshMonitorDevices":"","virtualMicrophone":"","virtualSpeaker":"","virtualMicrophoneNotice":"","virtualSpeakerNotice":"","iUnderstand":"","virtualMicWarningTitle":"Sokuji","virtualMicWarningText1":"Google MeetZoomMicrosoft Teams","virtualMicWarningText2":"Sokuji","virtualSpeakerWarningTitle":"Sokuji","virtualSpeakerWarningText1":"Sokuji_Virtual_SpeakerSokuji","virtualSpeakerWarningText2":"Sokuji","virtualSpeakerWarningText3":"","virtualSpeakerWarningText4":"","realVoicePassthrough":"","enableRealVoicePassthrough":"","realVoicePassthroughDescription":"","realVoiceVolume":""},"logsPanel":{"title":"","autoScrollOn":" ","autoScrollOff":" ","enableAutoScroll":"","disableAutoScroll":"","logsPlaceholder":"","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":"","stop":"","listening":"...","translating":"...","sourceLanguage":"","targetLanguage":""},"mainPanel":{"conversationPlaceholder":"","audioContent":"","function":"","input":"","output":"","release":"","pushToTalk":" ()","inputDeviceOff":"","endSession":"","startSession":"","initializing":"...","stopDebug":"","debug":"","apiKeyRequired":"OpenAI API","modelsRequired":"API","modelsLoading":"..."},"errors":{"microphoneAccess":"","networkError":"","translationFailed":"","audioError":""},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"","steps":{"welcome":{"title":" Sokuji","content":""},"openSettings":{"title":"","content":" API "},"apiKey":{"title":" OpenAI API ","content":" OpenAI API  <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI </a> "},"systemInstructions":{"title":"","content":""},"voiceSettings":{"title":"","content":""},"turnDetection":{"title":"","content":""},"audioSettings":{"title":"","content":""},"microphoneSetup":{"title":"","content":""},"speakerSetup":{"title":"","content":""},"startSession":{"title":"","content":" Sokuji "},"completion":{"title":"","content":" API  Google MeetZoom  Sokuji "}}}}')},fr:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Annuler","save":"Enregistrer","close":"Fermer","settings":"Paramtres","help":"Aide","loading":"Chargement...","error":"Erreur","success":"Succs","warning":"Avertissement","info":"Information","logs":"Journaux","clear":"Effacer"},"app":{"title":"Sokuji","description":"Application de traduction vocale en temps rel"},"menu":{"file":"Fichier","edit":"diter","view":"Affichage","window":"Fentre","help":"Aide"},"settings":{"title":"Paramtres","language":"Langue","audio":"Audio","translation":"Traduction","general":"Gnral","uiLanguage":"Langue de l\'interface","openaiApiKey":"Cl API OpenAI","provider":"Fournisseur de service","providerType":"Fournisseur","apiKey":"Cl API","systemInstructions":"Instructions systme","voice":"Voix","automaticTurnDetection":"Dtection automatique des tours","model":"Modle","userTranscriptModel":"Modle de transcription utilisateur","noiseReduction":"Rduction du bruit","modelConfiguration":"Configuration du modle","sourceLanguage":"Langue source","targetLanguage":"Langue cible","preview":"Aperu","simple":"Simple","advanced":"Avanc","normal":"Normal","semantic":"Smantique","disabled":"Dsactiv","threshold":"Seuil","prefixPadding":"Remplissage de prfixe","silenceDuration":"Dure du silence","eagerness":"Empressement","temperature":"Temprature","maxTokens":"Jetons maximum","saving":"Enregistrement...","validate":"Valider","validating":"Validation...","enterApiKey":"Entrez votre cl API OpenAI","enterCustomInstructions":"Entrez les instructions systme personnalises ici...","settingsSavedSuccessfully":"Paramtres enregistrs avec succs","failedToSaveSettings":"chec de l\'enregistrement des paramtres","validatingApiKey":"Validation de la cl API...","settingSavedSuccessfully":"Paramtre enregistr avec succs : {{key}}","failedToSaveSetting":"chec de l\'enregistrement du paramtre : {{key}}","apiKeyValidationCompleted":"Validation de la cl API termine","errorValidatingApiKey":"Erreur lors de la validation de la cl API","sessionActiveNotice":"Les paramtres sont verrouills pendant que la session est active. Veuillez terminer la session pour modifier les paramtres.","realtimeModelAvailable":"Le modle en temps rel est disponible","realtimeModelNotAvailable":"Le modle en temps rel n\'est pas disponible","refreshModels":"Actualiser les modles disponibles","loadingModels":"Chargement des modles disponibles...","modelsFound":"{{count}} modles disponibles","experimentalFeatureTooltip":"Il s\'agit d\'une fonctionnalit exprimentale qui peut tre instable.","help":"Aide","auto":"Auto","low":"Bas","medium":"Moyen","high":"lev","clientId":"ID Client","clientSecret":"Secret Client","languageSettings":"Paramtres de Langue","voiceSettings":"Paramtres de Voix","speechProcessing":"Traitement de la Parole","silenceThreshold":"Seuil de Silence","sentenceSplitter":"Diviseur de Phrase","enabled":"Activ","translatePartialTranscriptions":"Traduire les Transcriptions Partielles","queueConfiguration":"Configuration du Tampon Audio","desiredQueueLevel":"Tampon Audio Cible","maxQueueLevel":"Tampon Audio Maximum","autoTempo":"Vitesse de Parole Adaptative","apiKeyValidated":"Cl API valide","realtimeTranslationAvailable":"Service de traduction en temps rel disponible"},"audioPanel":{"title":"Paramtres audio","audioInputDevice":"Priphrique d\'entre audio","virtualSpeakerMonitorDevice":"Priphrique de surveillance du haut-parleur virtuel","availableInputDevices":"Priphriques d\'entre disponibles","availableMonitorDevices":"Priphriques de surveillance disponibles","loadingDevices":"Chargement des priphriques...","noDeviceSelected":"Aucun priphrique slectionn","turnOn":"Activer","turnOff":"Dsactiver","refreshInputDevices":"Actualiser les priphriques d\'entre","refreshMonitorDevices":"Actualiser les priphriques de surveillance","virtualMicrophone":"Microphone virtuel","virtualSpeaker":"Haut-parleur virtuel","virtualMicrophoneNotice":"Avis sur le microphone virtuel","virtualSpeakerNotice":"Avis sur le haut-parleur virtuel","iUnderstand":"Je comprends","virtualMicWarningTitle":"Ceci est un microphone virtuel cr par Sokuji.","virtualMicWarningText1":"Veuillez ne pas slectionner ce priphrique ici. Utilisez plutt ce microphone virtuel dans vos applications de visioconfrence (comme Google Meet, Zoom, Microsoft Teams, etc.) pour recevoir la sortie de traduction vocale en temps rel.","virtualMicWarningText2":"Pour que Sokuji fonctionne correctement, veuillez slectionner votre microphone physique rel dans la liste.","virtualSpeakerWarningTitle":"Ceci est un haut-parleur virtuel cr par Sokuji.","virtualSpeakerWarningText1":"Veuillez ne pas slectionner ce priphrique comme moniteur. Le Sokuji_Virtual_Speaker est utilis par Sokuji pour diffuser l\'audio vers vos applications de confrence.","virtualSpeakerWarningText2":"Connecter votre moniteur au priphrique de sortie de Sokuji crerait une boucle de rtroaction audio, causant votre entre  contenir votre propre sortie surveille.","virtualSpeakerWarningText3":"Le commutateur \\"Activer\\" connecte le haut-parleur virtuel  votre priphrique de surveillance slectionn, vous permettant d\'entendre ce qui est envoy  votre application de confrence. Le commutateur \\"Dsactiver\\" dconnecte cette connexion de surveillance.","virtualSpeakerWarningText4":"Pour un fonctionnement correct, veuillez slectionner un priphrique de surveillance diffrent (comme vos couteurs ou haut-parleurs) dans la liste.","realVoicePassthrough":"Passage Audio Original","enableRealVoicePassthrough":"Activer le Passage Audio Original","realVoicePassthroughDescription":"Transmettre votre audio original (voix du locuteur) directement au microphone virtuel pour que les auditeurs puissent entendre  la fois l\'audio original et traduit","realVoiceVolume":"Volume Audio Original"},"logsPanel":{"title":"Journaux","autoScrollOn":"Dfilement automatique activ","autoScrollOff":"Dfilement automatique dsactiv","enableAutoScroll":"Activer le dfilement automatique","disableAutoScroll":"Dsactiver le dfilement automatique","logsPlaceholder":"Les journaux apparatront ici","client":"client","server":"serveur","event":"vnement","of":"de","unknown":"inconnu"},"translation":{"start":"Dmarrer la traduction","stop":"Arrter la traduction","listening":"coute...","translating":"Traduction...","sourceLanguage":"Langue source","targetLanguage":"Langue cible"},"mainPanel":{"conversationPlaceholder":"La conversation apparatra ici","audioContent":"Contenu audio","function":"Fonction","input":"Entre","output":"Sortie","release":"relcher","pushToTalk":"appuyer pour parler (Espace)","inputDeviceOff":"priphrique d\'entre teint","endSession":"Terminer la session","startSession":"Dmarrer la session","initializing":"Initialisation...","stopDebug":"Arrter le dbogage","debug":"Dboguer","apiKeyRequired":"Veuillez d\'abord ajouter une cl API OpenAI valide dans les paramtres","modelsRequired":"Des modles sont requis. Veuillez d\'abord valider votre cl API pour charger les modles disponibles.","modelsLoading":"Chargement des modles disponibles, veuillez patienter..."},"errors":{"microphoneAccess":"Accs au microphone refus","networkError":"Erreur de connexion rseau","translationFailed":"chec de la traduction","audioError":"Erreur de traitement audio"},"onboarding":{"back":"Retour","close":"Fermer","finish":"Terminer","next":"Suivant","nextWithProgress":"Suivant ({step}/{steps})","open":"Ouvrir la bote de dialogue","skip":"Ignorer la visite","restartTour":"Redmarrer le guide de configuration","steps":{"welcome":{"title":"Bienvenue dans Sokuji","content":"Bienvenue dans Sokuji ! Ce guide vous aidera  configurer l\'extension pour la traduction vocale en temps rel. Commenons !"},"settings":{"title":"tape 1 : Ouvrir les paramtres","content":"D\'abord, configurons vos paramtres. Cliquez ici pour ouvrir le panneau des paramtres o vous pouvez configurer votre cl API OpenAI et personnaliser les instructions systme."},"apiKey":{"title":"tape 2 : Configurer la cl API","content":"Entrez votre cl API OpenAI ici. Vous pouvez en obtenir une depuis la","linkText":"page OpenAI","required":". Ceci est requis pour la traduction vocale."},"systemInstructions":{"title":"tape 3 : Instructions systme","content":"Personnalisez les instructions systme pour contrler comment l\'IA rpond. Vous pouvez modifier le comportement de traduction et ajouter des exigences spcifiques ici."},"voiceSettings":{"title":"tape 4 : Paramtres vocaux","content":"Configurez le type de voix qui sera utilis pour la synthse vocale. Choisissez parmi diffrentes options vocales selon votre prfrence."},"turnDetection":{"title":"tape 5 : Dtection des tours","content":"Configurez les paramtres de dtection automatique des tours incluant le mode de dtection, le seuil et les paramtres audio pour une performance optimale de reconnaissance vocale."},"audioSettings":{"title":"tape 6 : Paramtres audio","content":"Ensuite, configurons vos paramtres audio. Cliquez ici pour ouvrir le panneau audio et configurer votre microphone et vos haut-parleurs."},"microphoneSetup":{"title":"tape 7 : Configuration du microphone","content":"Slectionnez votre dispositif microphone ici. Assurez-vous de choisir le bon dispositif d\'entre pour la meilleure qualit audio."},"speakerSetup":{"title":"tape 8 : Configuration des haut-parleurs","content":"Slectionnez un dispositif de surveillance pour couter l\'audio traduit et vrifier s\'il rpond  vos exigences. Il est recommand d\'utiliser des couteurs pour la surveillance afin d\'viter les interfrences avec l\'entre du microphone. Lorsque vous pensez que les paramtres de traduction rpondent  vos exigences, il est suggr de dsactiver la surveillance afin que vous puissiez vous concentrer davantage sur votre expression et ne pas interfrer avec l\'entre du microphone."},"startSession":{"title":"tape 9 : Dmarrer la session","content":"Cliquez sur le bouton \\"Dmarrer la session\\" pour commencer  utiliser Sokuji. Une fois dmarr, vous pouvez parler naturellement pour la traduction en temps rel. Si la dtection automatique des tours est dsactive, utilisez \\"Appuyer pour parler\\" (barre d\'espace) pour parler."},"complete":{"title":"Guide de configuration termin !","content":"Excellent ! Vous avez termin le guide de configuration et tes maintenant familier avec l\'interface. Pour commencer  utiliser Sokuji, veuillez entrer votre cl API OpenAI dans les paramtres, accordez les permissions du microphone lorsque demand, et slectionnez \\"Sokuji Virtual Microphone\\" comme votre microphone dans votre application de runion (Google Meet, Zoom, Microsoft Teams, etc.). Vous pouvez redmarrer ce guide  tout moment depuis les paramtres."}}}}')},es:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Cancelar","save":"Guardar","close":"Cerrar","settings":"Configuracin","help":"Ayuda","loading":"Cargando...","error":"Error","success":"xito","warning":"Advertencia","info":"Informacin","logs":"Registros","clear":"Limpiar"},"app":{"title":"Sokuji","description":"Aplicacin de traduccin de voz en tiempo real"},"menu":{"file":"Archivo","edit":"Editar","view":"Ver","window":"Ventana","help":"Ayuda"},"settings":{"title":"Configuracin","language":"Idioma","audio":"Audio","translation":"Traduccin","general":"General","uiLanguage":"Idioma de la interfaz","openaiApiKey":"Clave API de OpenAI","provider":"Proveedor de servicio","providerType":"Proveedor","apiKey":"Clave API","systemInstructions":"Instrucciones del sistema","voice":"Voz","automaticTurnDetection":"Deteccin automtica de turnos","model":"Modelo","userTranscriptModel":"Modelo de transcripcin del usuario","noiseReduction":"Reduccin de ruido","modelConfiguration":"Configuracin del modelo","sourceLanguage":"Idioma origen","targetLanguage":"Idioma destino","preview":"Vista previa","simple":"Simple","advanced":"Avanzado","normal":"Normal","semantic":"Semntico","disabled":"Deshabilitado","threshold":"Umbral","prefixPadding":"Relleno de prefijo","silenceDuration":"Duracin del silencio","eagerness":"Ansiedad","temperature":"Temperatura","maxTokens":"Tokens mximos","saving":"Guardando...","validate":"Validar","validating":"Validando...","enterApiKey":"Ingrese su clave API de OpenAI","enterCustomInstructions":"Ingrese instrucciones personalizadas del sistema aqu...","settingsSavedSuccessfully":"Configuracin guardada exitosamente","failedToSaveSettings":"Error al guardar la configuracin","validatingApiKey":"Validando clave API...","settingSavedSuccessfully":"Configuracin guardada exitosamente: {{key}}","failedToSaveSetting":"Error al guardar la configuracin: {{key}}","apiKeyValidationCompleted":"Validacin de clave API completada","errorValidatingApiKey":"Error al validar la clave API","sessionActiveNotice":"La configuracin est bloqueada mientras la sesin est activa. Termina la sesin para modificar la configuracin.","realtimeModelAvailable":"El modelo en tiempo real est disponible","realtimeModelNotAvailable":"El modelo en tiempo real no est disponible","refreshModels":"Actualizar modelos disponibles","loadingModels":"Cargando modelos disponibles...","modelsFound":"{{count}} modelos disponibles","experimentalFeatureTooltip":"Esta es una funcin experimental y puede ser inestable.","help":"Ayuda","auto":"Auto","low":"Bajo","medium":"Medio","high":"Alto","clientId":"ID de Cliente","clientSecret":"Secreto de Cliente","languageSettings":"Configuracin de Idioma","voiceSettings":"Configuracin de Voz","speechProcessing":"Procesamiento de Voz","silenceThreshold":"Umbral de Silencio","sentenceSplitter":"Divisor de Frases","enabled":"Habilitado","translatePartialTranscriptions":"Traducir Transcripciones Parciales","queueConfiguration":"Configuracin del Bfer de Audio","desiredQueueLevel":"Bfer de Audio Deseado","maxQueueLevel":"Bfer de Audio Mximo","autoTempo":"Velocidad de Habla Adaptativa","apiKeyValidated":"Clave de API validada","realtimeTranslationAvailable":"Servicio de traduccin en tiempo real disponible"},"audioPanel":{"title":"Configuracin de audio","audioInputDevice":"Dispositivo de entrada de audio","virtualSpeakerMonitorDevice":"Dispositivo monitor de altavoz virtual","availableInputDevices":"Dispositivos de entrada disponibles","availableMonitorDevices":"Dispositivos de monitor disponibles","loadingDevices":"Cargando dispositivos...","noDeviceSelected":"Ningn dispositivo seleccionado","turnOn":"Encender","turnOff":"Apagar","refreshInputDevices":"Actualizar dispositivos de entrada","refreshMonitorDevices":"Actualizar dispositivos de monitor","virtualMicrophone":"Micrfono virtual","virtualSpeaker":"Altavoz virtual","virtualMicrophoneNotice":"Aviso sobre micrfono virtual","virtualSpeakerNotice":"Aviso sobre altavoz virtual","iUnderstand":"Entiendo","virtualMicWarningTitle":"Este es un micrfono virtual creado por Sokuji.","virtualMicWarningText1":"Por favor, no seleccione este dispositivo aqu. En su lugar, use este micrfono virtual en sus aplicaciones de videoconferencia (como Google Meet, Zoom, Microsoft Teams, etc.) para recibir la salida de traduccin de voz en tiempo real.","virtualMicWarningText2":"Para que Sokuji funcione correctamente, seleccione su micrfono fsico real de la lista.","virtualSpeakerWarningTitle":"Este es un altavoz virtual creado por Sokuji.","virtualSpeakerWarningText1":"Por favor, no seleccione este dispositivo como su monitor. El Sokuji_Virtual_Speaker es usado por Sokuji para enviar audio a sus aplicaciones de conferencia.","virtualSpeakerWarningText2":"Conectar su monitor al dispositivo de salida de Sokuji creara un bucle de retroalimentacin de audio, causando que su entrada contenga su propia salida monitoreada.","virtualSpeakerWarningText3":"El interruptor \\"Encender\\" conecta el altavoz virtual a su dispositivo de monitor seleccionado, permitindole escuchar lo que se enva a su aplicacin de conferencia. El interruptor \\"Apagar\\" desconecta esta conexin de monitoreo.","virtualSpeakerWarningText4":"Para un funcionamiento adecuado, seleccione un dispositivo de monitor diferente (como sus auriculares o altavoces) de la lista.","realVoicePassthrough":"Paso de Audio Original","enableRealVoicePassthrough":"Habilitar Paso de Audio Original","realVoicePassthroughDescription":"Pasar tu audio original (voz del hablante) directamente al micrfono virtual para que los oyentes puedan escuchar tanto el audio original como el traducido","realVoiceVolume":"Volumen de Audio Original"},"logsPanel":{"title":"Registros","autoScrollOn":"Desplazamiento automtico activado","autoScrollOff":"Desplazamiento automtico desactivado","enableAutoScroll":"Habilitar desplazamiento automtico","disableAutoScroll":"Deshabilitar desplazamiento automtico","logsPlaceholder":"Los registros aparecern aqu","client":"cliente","server":"servidor","event":"Evento","of":"de","unknown":"desconocido"},"translation":{"start":"Iniciar traduccin","stop":"Detener traduccin","listening":"Escuchando...","translating":"Traduciendo...","sourceLanguage":"Idioma origen","targetLanguage":"Idioma destino"},"mainPanel":{"conversationPlaceholder":"La conversacin aparecer aqu","audioContent":"Contenido de audio","function":"Funcin","input":"Entrada","output":"Salida","release":"soltar","pushToTalk":"presionar para hablar (Espacio)","inputDeviceOff":"dispositivo de entrada apagado","endSession":"Terminar sesin","startSession":"Iniciar sesin","initializing":"Inicializando...","stopDebug":"Detener depuracin","debug":"Depurar","apiKeyRequired":"Por favor, agregue primero una clave API de OpenAI vlida en la configuracin","modelsRequired":"Se requieren modelos. Por favor, valide su clave API primero para cargar los modelos disponibles.","modelsLoading":"Cargando modelos disponibles, por favor espere..."},"errors":{"microphoneAccess":"Acceso al micrfono denegado","networkError":"Error de conexin de red","translationFailed":"Fall la traduccin","audioError":"Error de procesamiento de audio"},"onboarding":{"back":"Atrs","close":"Cerrar","finish":"Finalizar","next":"Siguiente","nextWithProgress":"Siguiente ({step}/{steps})","open":"Abrir dilogo","skip":"Omitir tour","restartTour":"Reiniciar gua de configuracin","steps":{"welcome":{"title":"Bienvenido a Sokuji","content":"Bienvenido a Sokuji! Esta gua te ayudar a configurar la extensin para traduccin de voz en tiempo real. Comencemos!"},"settings":{"title":"Paso 1: Abrir configuracin","content":"Primero, configuremos tus ajustes. Haz clic aqu para abrir el panel de configuracin donde puedes establecer tu clave API de OpenAI y personalizar las instrucciones del sistema."},"apiKey":{"title":"Paso 2: Configurar clave API","content":"Ingresa tu clave API de OpenAI aqu. Puedes obtener una desde la","linkText":"pgina de OpenAI","required":". Esto es requerido para la traduccin de voz."},"systemInstructions":{"title":"Paso 3: Instrucciones del sistema","content":"Personaliza las instrucciones del sistema para controlar cmo responde la IA. Puedes modificar el comportamiento de traduccin y agregar requisitos especficos aqu."},"voiceSettings":{"title":"Paso 4: Configuracin de voz","content":"Configura el tipo de voz que se utilizar para la sntesis de voz. Elige entre diferentes opciones de voz segn tu preferencia."},"turnDetection":{"title":"Paso 5: Deteccin de turnos","content":"Configura los ajustes de deteccin automtica de turnos incluyendo modo de deteccin, umbral y parmetros de audio para un rendimiento ptimo de reconocimiento de voz."},"audioSettings":{"title":"Paso 6: Configuracin de audio","content":"A continuacin, configuremos tus ajustes de audio. Haz clic aqu para abrir el panel de audio y configurar tu micrfono y altavoces."},"microphoneSetup":{"title":"Paso 7: Configuracin del micrfono","content":"Selecciona tu dispositivo de micrfono aqu. Asegrate de elegir el dispositivo de entrada correcto para la mejor calidad de audio."},"speakerSetup":{"title":"Paso 8: Configuracin de altavoces","content":"Selecciona un dispositivo de monitoreo para escuchar el audio traducido y verificar si cumple con tus requisitos. Se recomienda usar auriculares para el monitoreo para evitar interferencias con la entrada del micrfono. Cuando consideres que la configuracin de traduccin cumple con tus requisitos, se sugiere desactivar el monitoreo para que puedas concentrarte ms en tu expresin y no interferir con la entrada del micrfono."},"startSession":{"title":"Paso 9: Iniciar sesin","content":"Haz clic en el botn \\"Iniciar sesin\\" para comenzar a usar Sokuji. Una vez iniciado, puedes hablar naturalmente para traduccin en tiempo real. Si la deteccin automtica de turnos est deshabilitada, usa \\"Presionar para hablar\\" (barra espaciadora) para hablar."},"complete":{"title":"Gua de configuracin completada!","content":"Excelente! Has completado la gua de configuracin y ahora ests familiarizado con la interfaz. Para comenzar a usar Sokuji, por favor ingresa tu clave API de OpenAI en la configuracin, otorga permisos de micrfono cuando se solicite, y selecciona \\"Sokuji Virtual Microphone\\" como tu micrfono en tu aplicacin de reuniones (Google Meet, Zoom, Microsoft Teams, etc.). Puedes reiniciar esta gua en cualquier momento desde la configuracin."}}}}')},de:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Abbrechen","save":"Speichern","close":"Schlieen","settings":"Einstellungen","help":"Hilfe","loading":"Laden...","error":"Fehler","success":"Erfolg","warning":"Warnung","info":"Information","logs":"Protokolle","clear":"Lschen"},"app":{"title":"Sokuji","description":"Echtzeit-Sprachbersetzungsanwendung"},"menu":{"file":"Datei","edit":"Bearbeiten","view":"Ansicht","window":"Fenster","help":"Hilfe"},"settings":{"title":"Einstellungen","language":"Sprache","audio":"Audio","translation":"bersetzung","general":"Allgemein","uiLanguage":"Benutzeroberflchen-Sprache","openaiApiKey":"OpenAI API-Schlssel","provider":"Dienstanbieter","providerType":"Anbieter","apiKey":"API-Schlssel","systemInstructions":"Systemanweisungen","voice":"Stimme","automaticTurnDetection":"Automatische Wendeerkennung","model":"Modell","userTranscriptModel":"Benutzer-Transkriptionsmodell","noiseReduction":"Rauschunterdrckung","modelConfiguration":"Modellkonfiguration","sourceLanguage":"Quellsprache","targetLanguage":"Zielsprache","preview":"Vorschau","simple":"Einfach","advanced":"Erweitert","normal":"Normal","semantic":"Semantisch","disabled":"Deaktiviert","threshold":"Schwellenwert","prefixPadding":"Prfix-Auffllung","silenceDuration":"Stille-Dauer","eagerness":"Eifer","temperature":"Temperatur","maxTokens":"Maximale Token","saving":"Speichern...","validate":"Validieren","validating":"Validierung...","enterApiKey":"Geben Sie Ihren OpenAI API-Schlssel ein","enterCustomInstructions":"Geben Sie hier benutzerdefinierte Systemanweisungen ein...","settingsSavedSuccessfully":"Einstellungen erfolgreich gespeichert","failedToSaveSettings":"Fehler beim Speichern der Einstellungen","validatingApiKey":"API-Schlssel wird validiert...","settingSavedSuccessfully":"Einstellung erfolgreich gespeichert: {{key}}","failedToSaveSetting":"Fehler beim Speichern der Einstellung: {{key}}","apiKeyValidationCompleted":"API-Schlssel-Validierung abgeschlossen","errorValidatingApiKey":"Fehler bei der Validierung des API-Schlssels","sessionActiveNotice":"Die Einstellungen sind gesperrt, whrend die Sitzung aktiv ist. Beenden Sie die Sitzung, um die Einstellungen zu ndern.","realtimeModelAvailable":"Echtzeitmodell ist verfgbar","realtimeModelNotAvailable":"Echtzeitmodell ist nicht verfgbar","refreshModels":"Verfgbare Modelle aktualisieren","loadingModels":"Verfgbare Modelle werden geladen...","modelsFound":"{{count}} Modelle verfgbar","experimentalFeatureTooltip":"Dies ist eine experimentelle Funktion und kann instabil sein.","help":"Hilfe","auto":"Auto","low":"Niedrig","medium":"Mittel","high":"Hoch","clientId":"Client-ID","clientSecret":"Client-Geheimnis","languageSettings":"Spracheinstellungen","voiceSettings":"Stimmeinstellungen","speechProcessing":"Sprachverarbeitung","silenceThreshold":"Stilleschwelle","sentenceSplitter":"Satz-Trenner","enabled":"Aktiviert","translatePartialTranscriptions":"Teiltranskriptionen bersetzen","queueConfiguration":"Audio-Puffer-Konfiguration","desiredQueueLevel":"Ziel-Audio-Puffer","maxQueueLevel":"Maximaler Audio-Puffer","autoTempo":"Adaptive Sprechgeschwindigkeit","apiKeyValidated":"API-Schlssel validiert","realtimeTranslationAvailable":"Echtzeit-bersetzungsdienst ist verfgbar"},"audioPanel":{"title":"Audio-Einstellungen","audioInputDevice":"Audio-Eingabegert","virtualSpeakerMonitorDevice":"Virtuelles Lautsprecher-berwachungsgert","availableInputDevices":"Verfgbare Eingabegerte","availableMonitorDevices":"Verfgbare berwachungsgerte","loadingDevices":"Gerte werden geladen...","noDeviceSelected":"Kein Gert ausgewhlt","turnOn":"Einschalten","turnOff":"Ausschalten","refreshInputDevices":"Eingabegerte aktualisieren","refreshMonitorDevices":"berwachungsgerte aktualisieren","virtualMicrophone":"Virtuelles Mikrofon","virtualSpeaker":"Virtueller Lautsprecher","virtualMicrophoneNotice":"Hinweis zum virtuellen Mikrofon","virtualSpeakerNotice":"Hinweis zum virtuellen Lautsprecher","iUnderstand":"Ich verstehe","virtualMicWarningTitle":"Dies ist ein von Sokuji erstelltes virtuelles Mikrofon.","virtualMicWarningText1":"Bitte whlen Sie dieses Gert hier nicht aus. Verwenden Sie stattdessen dieses virtuelle Mikrofon in Ihren Videokonferenz-Anwendungen (wie Google Meet, Zoom, Microsoft Teams usw.), um die Live-Sprachbersetzungsausgabe zu erhalten.","virtualMicWarningText2":"Damit Sokuji ordnungsgem funktioniert, whlen Sie bitte Ihr tatschliches physisches Mikrofon aus der Liste aus.","virtualSpeakerWarningTitle":"Dies ist ein von Sokuji erstellter virtueller Lautsprecher.","virtualSpeakerWarningText1":"Bitte whlen Sie dieses Gert nicht als Ihren Monitor aus. Der Sokuji_Virtual_Speaker wird von Sokuji verwendet, um Audio an Ihre Konferenz-Anwendungen auszugeben.","virtualSpeakerWarningText2":"Das Verbinden Ihres Monitors mit Sokujis Ausgabegert wrde eine Audio-Rckkopplungsschleife erzeugen, wodurch Ihre Eingabe Ihre eigene berwachte Ausgabe enthalten wrde.","virtualSpeakerWarningText3":"Der \\"Einschalten\\"-Schalter verbindet den virtuellen Lautsprecher mit Ihrem ausgewhlten berwachungsgert, sodass Sie hren knnen, was an Ihre Konferenz-Anwendung gesendet wird. Der \\"Ausschalten\\"-Schalter trennt diese berwachungsverbindung.","virtualSpeakerWarningText4":"Fr den ordnungsgemen Betrieb whlen Sie bitte ein anderes berwachungsgert (wie Ihre Kopfhrer oder Lautsprecher) aus der Liste aus.","realVoicePassthrough":"Original-Audio-Durchleitung","enableRealVoicePassthrough":"Original-Audio-Durchleitung aktivieren","realVoicePassthroughDescription":"Ihr Original-Audio (Sprecherstimme) direkt an das virtuelle Mikrofon weiterleiten, damit Zuhrer sowohl das Original- als auch das bersetzte Audio hren knnen","realVoiceVolume":"Original-Audio-Lautstrke"},"logsPanel":{"title":"Protokolle","autoScrollOn":"Auto-Scroll ein","autoScrollOff":"Auto-Scroll aus","enableAutoScroll":"Auto-Scroll aktivieren","disableAutoScroll":"Auto-Scroll deaktivieren","logsPlaceholder":"Protokolle werden hier angezeigt","client":"Client","server":"Server","event":"Ereignis","of":"von","unknown":"unbekannt"},"translation":{"start":"bersetzung starten","stop":"bersetzung stoppen","listening":"Zuhren...","translating":"bersetzen...","sourceLanguage":"Quellsprache","targetLanguage":"Zielsprache"},"mainPanel":{"conversationPlaceholder":"Unterhaltung wird hier angezeigt","audioContent":"Audio-Inhalt","function":"Funktion","input":"Eingabe","output":"Ausgabe","release":"loslassen","pushToTalk":"Drcken zum Sprechen (Leertaste)","inputDeviceOff":"Eingabegert aus","endSession":"Sitzung beenden","startSession":"Sitzung starten","initializing":"Initialisierung...","stopDebug":"Debug stoppen","debug":"Debug","apiKeyRequired":"Bitte fgen Sie zuerst einen gltigen OpenAI API-Schlssel in den Einstellungen hinzu","modelsRequired":"Modelle sind erforderlich. Bitte validieren Sie zuerst Ihren API-Schlssel, um verfgbare Modelle zu laden.","modelsLoading":"Verfgbare Modelle werden geladen, bitte warten..."},"errors":{"microphoneAccess":"Mikrofonzugriff verweigert","networkError":"Netzwerkverbindungsfehler","translationFailed":"bersetzung fehlgeschlagen","audioError":"Audio-Verarbeitungsfehler"},"onboarding":{"back":"Zurck","close":"Schlieen","finish":"Fertig","next":"Weiter","nextWithProgress":"Weiter ({step}/{steps})","open":"Dialog ffnen","skip":"Tour berspringen","restartTour":"Setup-Anleitung neu starten","steps":{"welcome":{"title":"Willkommen bei Sokuji","content":"Willkommen bei Sokuji! Diese Anleitung hilft Ihnen dabei, die Erweiterung fr Live-Sprachbersetzung einzurichten. Lassen Sie uns beginnen!"},"settings":{"title":"Schritt 1: Einstellungen ffnen","content":"Zuerst konfigurieren wir Ihre Einstellungen. Klicken Sie hier, um das Einstellungspanel zu ffnen, wo Sie Ihren OpenAI API-Schlssel einrichten und Systemanweisungen anpassen knnen."},"apiKey":{"title":"Schritt 2: API-Schlssel konfigurieren","content":"Geben Sie hier Ihren OpenAI API-Schlssel ein. Sie knnen einen von der","linkText":"OpenAI-Seite","required":"erhalten. Dies ist fr die Sprachbersetzung erforderlich."},"systemInstructions":{"title":"Schritt 3: Systemanweisungen","content":"Passen Sie die Systemanweisungen an, um zu steuern, wie die KI antwortet. Sie knnen hier das bersetzungsverhalten ndern und spezifische Anforderungen hinzufgen."},"voiceSettings":{"title":"Schritt 4: Spracheinstellungen","content":"Konfigurieren Sie den Stimmtyp, der fr die Sprachsynthese verwendet wird. Whlen Sie aus verschiedenen Stimmoptionen entsprechend Ihrer Prferenz."},"turnDetection":{"title":"Schritt 5: Wendeerkennung","content":"Konfigurieren Sie die automatischen Wendeerkennungseinstellungen einschlielich Erkennungsmodus, Schwellenwert und Audioparameter fr optimale Spracherkennungsleistung."},"audioSettings":{"title":"Schritt 6: Audio-Einstellungen","content":"Als nchstes konfigurieren wir Ihre Audio-Einstellungen. Klicken Sie hier, um das Audio-Panel zu ffnen und Ihr Mikrofon und Ihre Lautsprecher einzurichten."},"microphoneSetup":{"title":"Schritt 7: Mikrofon-Setup","content":"Whlen Sie hier Ihr Mikrofongert aus. Stellen Sie sicher, dass Sie das richtige Eingabegert fr die beste Audioqualitt auswhlen."},"speakerSetup":{"title":"Schritt 8: Lautsprecher-Setup","content":"Whlen Sie ein berwachungsgert aus, um die bersetzte Audio anzuhren und zu berprfen, ob sie Ihren Anforderungen entspricht. Es wird empfohlen, Kopfhrer fr die berwachung zu verwenden, um Interferenzen mit der Mikrofoneingabe zu vermeiden. Wenn Sie der Meinung sind, dass die bersetzungseinstellungen Ihren Anforderungen entsprechen, wird empfohlen, die berwachung auszuschalten, damit Sie sich mehr auf Ihren Ausdruck konzentrieren knnen und die Mikrofoneingabe nicht stren."},"startSession":{"title":"Schritt 9: Sitzung starten","content":"Klicken Sie auf die Schaltflche \\"Sitzung starten\\", um mit der Verwendung von Sokuji zu beginnen. Nach dem Start knnen Sie natrlich sprechen fr Live-bersetzung. Wenn die automatische Wendeerkennung deaktiviert ist, verwenden Sie \\"Drcken zum Sprechen\\" (Leertaste) zum Sprechen."},"complete":{"title":"Setup-Anleitung abgeschlossen!","content":"Groartig! Sie haben die Setup-Anleitung abgeschlossen und sind nun mit der Benutzeroberflche vertraut. Um Sokuji zu verwenden, geben Sie bitte Ihren OpenAI API-Schlssel in den Einstellungen ein, gewhren Sie Mikrofonberechtigungen wenn aufgefordert, und whlen Sie \\"Sokuji Virtual Microphone\\" als Ihr Mikrofon in Ihrer Meeting-Anwendung (Google Meet, Zoom, Microsoft Teams, usw.). Sie knnen diese Anleitung jederzeit aus den Einstellungen neu starten."}}}}')},ko:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":" ...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"   "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":"UI ","openaiApiKey":"OpenAI API ","provider":" ","providerType":"","apiKey":"API ","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":" ","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":" ","silenceDuration":" ","eagerness":"","temperature":"","maxTokens":" ","saving":" ...","validate":"","validating":" ...","enterApiKey":"OpenAI API  ","enterCustomInstructions":"     ...","settingsSavedSuccessfully":"  ","failedToSaveSettings":"  ","validatingApiKey":"API   ...","settingSavedSuccessfully":"  : {{key}}","failedToSaveSetting":"  : {{key}}","apiKeyValidationCompleted":"API   ","errorValidatingApiKey":"API     ","sessionActiveNotice":"     .    .","realtimeModelAvailable":"    ","realtimeModelNotAvailable":"    ","refreshModels":"   ","loadingModels":"    ...","modelsFound":"{{count}}   ","experimentalFeatureTooltip":"     .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ID","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"   ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":"API  ","realtimeTranslationAvailable":"     "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"   ","availableMonitorDevices":"   ","loadingDevices":"  ...","noDeviceSelected":"  ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"  ","virtualSpeakerNotice":"  ","iUnderstand":"","virtualMicWarningTitle":" Sokuji   .","virtualMicWarningText1":"    .    (Google Meet, Zoom, Microsoft Teams )         .","virtualMicWarningText2":"Sokuji       .","virtualSpeakerWarningTitle":" Sokuji   .","virtualSpeakerWarningText1":"    . Sokuji_Virtual_Speaker Sokuji      .","virtualSpeakerWarningText2":" Sokuji            .","virtualSpeakerWarningText3":"\\"\\"               . \\"\\"     .","virtualSpeakerWarningText4":"      (  ) .","realVoicePassthrough":" ","enableRealVoicePassthrough":"  ","realVoicePassthroughDescription":"( )             ","realVoiceVolume":" "},"logsPanel":{"title":"","autoScrollOn":"  ","autoScrollOff":"  ","enableAutoScroll":"  ","disableAutoScroll":"  ","logsPlaceholder":"  ","client":"","server":"","event":"","of":"","unknown":"  "},"translation":{"start":" ","stop":" ","listening":" ...","translating":" ...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"  ","audioContent":" ","function":"","input":"","output":"","release":"","pushToTalk":"  ()","inputDeviceOff":"  ","endSession":" ","startSession":" ","initializing":" ...","stopDebug":" ","debug":"","apiKeyRequired":"   OpenAI API  ","modelsRequired":" .      API  .","modelsLoading":"    .   ..."},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":" ","skip":" ","restartTour":"   ","steps":{"welcome":{"title":"Sokuji   ","content":"Sokuji   !          . !"},"settings":{"title":"1:  ","content":"  .      OpenAI API        ."},"apiKey":{"title":"2: API  ","content":" OpenAI API  .","linkText":"OpenAI ","required":"   .     ."},"systemInstructions":{"title":"3:  ","content":"AI        .         ."},"voiceSettings":{"title":"4:  ","content":"     .       ."},"turnDetection":{"title":"5:  ","content":"      ,          ."},"audioSettings":{"title":"6:  ","content":"   .        ."},"microphoneSetup":{"title":"7:  ","content":"   .         ."},"speakerSetup":{"title":"8:  ","content":"          .        .                  ."},"startSession":{"title":"9:  ","content":"\\" \\"   Sokuji  .         .      \\" \\"( )  ."},"complete":{"title":"  !","content":"!      . Sokuji    OpenAI API  ,     ,  (Google Meet, Zoom, Microsoft Teams ) \\"Sokuji Virtual Microphone\\"  .        ."}}}}')},pt_BR:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Cancelar","save":"Salvar","close":"Fechar","settings":"Configuraes","help":"Ajuda","loading":"Carregando...","error":"Erro","success":"Sucesso","warning":"Aviso","info":"Informao","logs":"Logs","clear":"Limpar"},"app":{"title":"Sokuji","description":"Aplicativo de traduo de voz em tempo real"},"menu":{"file":"Arquivo","edit":"Editar","view":"Visualizar","window":"Janela","help":"Ajuda"},"settings":{"title":"Configuraes","language":"Idioma","audio":"udio","translation":"Traduo","general":"Geral","uiLanguage":"Idioma da interface","openaiApiKey":"Chave da API OpenAI","provider":"Provedor de servio","providerType":"Provedor","apiKey":"Chave da API","systemInstructions":"Instrues do sistema","voice":"Voz","automaticTurnDetection":"Deteco automtica de turno","model":"Modelo","userTranscriptModel":"Modelo de transcrio do usurio","noiseReduction":"Reduo de rudo","modelConfiguration":"Configurao do modelo","sourceLanguage":"Idioma de origem","targetLanguage":"Idioma de destino","preview":"Visualizar","simple":"Simples","advanced":"Avanado","normal":"Normal","semantic":"Semntico","disabled":"Desabilitado","threshold":"Limite","prefixPadding":"Preenchimento de prefixo","silenceDuration":"Durao do silncio","eagerness":"Ansiedade","temperature":"Temperatura","maxTokens":"Tokens mximos","saving":"Salvando...","validate":"Validar","validating":"Validando...","enterApiKey":"Digite sua chave da API OpenAI","enterCustomInstructions":"Digite instrues personalizadas do sistema aqui...","settingsSavedSuccessfully":"Configuraes salvas com sucesso","failedToSaveSettings":"Falha ao salvar configuraes","validatingApiKey":"Validando chave da API...","settingSavedSuccessfully":"Configurao salva com sucesso: {{key}}","failedToSaveSetting":"Falha ao salvar configurao: {{key}}","apiKeyValidationCompleted":"Validao da chave da API concluda","errorValidatingApiKey":"Erro ao validar a chave da API","sessionActiveNotice":"As configuraes esto bloqueadas enquanto a sesso est ativa. Finalize a sesso para modificar as configuraes.","realtimeModelAvailable":"O modelo em tempo real est disponvel","realtimeModelNotAvailable":"O modelo em tempo real no est disponvel","refreshModels":"Atualizar modelos disponveis","loadingModels":"Carregando modelos disponveis...","modelsFound":"{{count}} modelos disponveis","experimentalFeatureTooltip":"Este  um recurso experimental e pode ser instvel.","help":"Ajuda","auto":"Auto","low":"Baixo","medium":"Mdio","high":"Alto","clientId":"ID do Cliente","clientSecret":"Segredo do Cliente","languageSettings":"Configuraes de Idioma","voiceSettings":"Configuraes de Voz","speechProcessing":"Processamento de Fala","silenceThreshold":"Limite de Silncio","sentenceSplitter":"Divisor de Frases","enabled":"Ativado","translatePartialTranscriptions":"Traduzir Transcries Parciais","queueConfiguration":"Configurao do Buffer de udio","desiredQueueLevel":"Buffer de udio Desejado","maxQueueLevel":"Buffer de udio Mximo","autoTempo":"Velocidade de Fala Adaptvel","apiKeyValidated":"Chave de API validada","realtimeTranslationAvailable":"Servio de traduo em tempo real disponvel"},"audioPanel":{"title":"Configuraes de udio","audioInputDevice":"Dispositivo de entrada de udio","virtualSpeakerMonitorDevice":"Dispositivo monitor de alto-falante virtual","availableInputDevices":"Dispositivos de entrada disponveis","availableMonitorDevices":"Dispositivos de monitor disponveis","loadingDevices":"Carregando dispositivos...","noDeviceSelected":"Nenhum dispositivo selecionado","turnOn":"Ligar","turnOff":"Desligar","refreshInputDevices":"Atualizar dispositivos de entrada","refreshMonitorDevices":"Atualizar dispositivos de monitor","virtualMicrophone":"Microfone virtual","virtualSpeaker":"Alto-falante virtual","virtualMicrophoneNotice":"Aviso sobre microfone virtual","virtualSpeakerNotice":"Aviso sobre alto-falante virtual","iUnderstand":"Eu entendo","virtualMicWarningTitle":"Este  um microfone virtual criado pelo Sokuji.","virtualMicWarningText1":"Por favor, no selecione este dispositivo aqui. Em vez disso, use este microfone virtual em seus aplicativos de videoconferncia (como Google Meet, Zoom, Microsoft Teams, etc.) para receber a sada de traduo de voz em tempo real.","virtualMicWarningText2":"Para que o Sokuji funcione corretamente, selecione seu microfone fsico real da lista.","virtualSpeakerWarningTitle":"Este  um alto-falante virtual criado pelo Sokuji.","virtualSpeakerWarningText1":"Por favor, no selecione este dispositivo como seu monitor. O Sokuji_Virtual_Speaker  usado pelo Sokuji para enviar udio para seus aplicativos de conferncia.","virtualSpeakerWarningText2":"Conectar seu monitor ao dispositivo de sada do Sokuji criaria um loop de feedback de udio, fazendo com que sua entrada contenha sua prpria sada monitorada.","virtualSpeakerWarningText3":"O boto \\"Ligar\\" conecta o alto-falante virtual ao seu dispositivo de monitor selecionado, permitindo que voc oua o que est sendo enviado para seu aplicativo de conferncia. O boto \\"Desligar\\" desconecta esta conexo de monitoramento.","virtualSpeakerWarningText4":"Para operao adequada, selecione um dispositivo de monitor diferente (como seus fones de ouvido ou alto-falantes) da lista.","realVoicePassthrough":"Passagem de udio Original","enableRealVoicePassthrough":"Ativar Passagem de udio Original","realVoicePassthroughDescription":"Passe seu udio original (voz do falante) diretamente para o microfone virtual para que os ouvintes possam ouvir tanto o udio original quanto o traduzido","realVoiceVolume":"Volume do udio Original"},"logsPanel":{"title":"Logs","autoScrollOn":"Rolagem automtica ligada","autoScrollOff":"Rolagem automtica desligada","enableAutoScroll":"Habilitar rolagem automtica","disableAutoScroll":"Desabilitar rolagem automtica","logsPlaceholder":"Os logs aparecero aqui","client":"cliente","server":"servidor","event":"Evento","of":"de","unknown":"desconhecido"},"translation":{"start":"Iniciar traduo","stop":"Parar traduo","listening":"Ouvindo...","translating":"Traduzindo...","sourceLanguage":"Idioma de origem","targetLanguage":"Idioma de destino"},"mainPanel":{"conversationPlaceholder":"A conversa aparecer aqui","audioContent":"Contedo de udio","function":"Funo","input":"Entrada","output":"Sada","release":"soltar","pushToTalk":"pressionar para falar (Espao)","inputDeviceOff":"dispositivo de entrada desligado","endSession":"Encerrar sesso","startSession":"Iniciar sesso","initializing":"Inicializando...","stopDebug":"Parar depurao","debug":"Depurar","apiKeyRequired":"Por favor, adicione primeiro uma chave da API OpenAI vlida nas configuraes","modelsRequired":"Modelos so necessrios. Por favor, valide sua chave da API primeiro para carregar os modelos disponveis.","modelsLoading":"Carregando modelos disponveis, por favor aguarde..."},"errors":{"microphoneAccess":"Acesso ao microfone negado","networkError":"Erro de conexo de rede","translationFailed":"Falha na traduo","audioError":"Erro de processamento de udio"},"onboarding":{"back":"Voltar","close":"Fechar","finish":"Finalizar","next":"Prximo","nextWithProgress":"Prximo ({step}/{steps})","open":"Abrir dilogo","skip":"Pular tour","restartTour":"Reiniciar guia de configurao","steps":{"welcome":{"title":"Bem-vindo ao Sokuji","content":"Bem-vindo ao Sokuji! Este guia ajudar voc a configurar a extenso para traduo de voz em tempo real. Vamos comear!"},"settings":{"title":"Passo 1: Abrir configuraes","content":"Primeiro, vamos configurar suas definies. Clique aqui para abrir o painel de configuraes onde voc pode definir sua chave da API OpenAI e personalizar instrues do sistema."},"apiKey":{"title":"Passo 2: Configurar chave da API","content":"Digite sua chave da API OpenAI aqui. Voc pode obter uma na","linkText":"pgina da OpenAI","required":". Isso  necessrio para a traduo de voz."},"systemInstructions":{"title":"Passo 3: Instrues do sistema","content":"Personalize as instrues do sistema para controlar como a IA responde. Voc pode modificar o comportamento da traduo e adicionar requisitos especficos aqui."},"voiceSettings":{"title":"Passo 4: Configuraes de voz","content":"Configure o tipo de voz que ser usado para sntese de voz. Escolha entre diferentes opes de voz de acordo com sua preferncia."},"turnDetection":{"title":"Passo 5: Deteco de turno","content":"Configure as definies de deteco automtica de turno incluindo modo de deteco, limite e parmetros de udio para desempenho timo de reconhecimento de voz."},"audioSettings":{"title":"Passo 6: Configuraes de udio","content":"Em seguida, vamos configurar suas definies de udio. Clique aqui para abrir o painel de udio e configurar seu microfone e alto-falantes."},"microphoneSetup":{"title":"Passo 7: Configurao do microfone","content":"Selecione seu dispositivo de microfone aqui. Certifique-se de escolher o dispositivo de entrada correto para a melhor qualidade de udio."},"speakerSetup":{"title":"Passo 8: Configurao de alto-falantes","content":"Selecione um dispositivo de monitoramento para ouvir o udio traduzido e verificar se atende aos seus requisitos.  recomendado usar fones de ouvido para monitoramento para evitar interferncia com a entrada do microfone. Quando voc achar que as configuraes de traduo atendem aos seus requisitos,  sugerido desligar o monitoramento para que voc possa se concentrar mais em sua expresso e no interferir com a entrada do microfone."},"startSession":{"title":"Passo 9: Iniciar sesso","content":"Clique no boto \\"Iniciar sesso\\" para comear a usar o Sokuji. Uma vez iniciado, voc pode falar naturalmente para traduo em tempo real. Se a deteco automtica de turno estiver desabilitada, use \\"pressionar para falar\\" (barra de espao) para falar."},"complete":{"title":"Guia de configurao concludo!","content":"Excelente! Voc concluiu o guia de configurao e agora est familiarizado com a interface. Para comear a usar o Sokuji, por favor digite sua chave da API OpenAI nas configuraes, conceda permisses de microfone quando solicitado, e selecione \\"Sokuji Virtual Microphone\\" como seu microfone em seu aplicativo de reunio (Google Meet, Zoom, Microsoft Teams, etc.). Voc pode reiniciar este guia a qualquer momento nas configuraes."}}}}')},pt_PT:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Cancelar","save":"Guardar","close":"Fechar","settings":"Definies","help":"Ajuda","loading":"A carregar...","error":"Erro","success":"Sucesso","warning":"Aviso","info":"Informao","logs":"Registos","clear":"Limpar"},"app":{"title":"Sokuji","description":"Aplicao de traduo de voz em tempo real"},"menu":{"file":"Ficheiro","edit":"Editar","view":"Ver","window":"Janela","help":"Ajuda"},"settings":{"title":"Definies","language":"Idioma","audio":"udio","translation":"Traduo","general":"Geral","uiLanguage":"Idioma da interface","openaiApiKey":"Chave da API OpenAI","provider":"Fornecedor de servio","providerType":"Fornecedor","apiKey":"Chave da API","systemInstructions":"Instrues do sistema","voice":"Voz","automaticTurnDetection":"Deteco automtica de turno","model":"Modelo","userTranscriptModel":"Modelo de transcrio do utilizador","noiseReduction":"Reduo de rudo","modelConfiguration":"Configurao do modelo","sourceLanguage":"Idioma de origem","targetLanguage":"Idioma de destino","preview":"Pr-visualizar","simple":"Simples","advanced":"Avanado","normal":"Normal","semantic":"Semntico","disabled":"Desactivado","threshold":"Limite","prefixPadding":"Preenchimento de prefixo","silenceDuration":"Durao do silncio","eagerness":"Ansiedade","temperature":"Temperatura","maxTokens":"Tokens mximos","saving":"A guardar...","validate":"Validar","validating":"A validar...","enterApiKey":"Introduza a sua chave da API OpenAI","enterCustomInstructions":"Introduza instrues personalizadas do sistema aqui...","settingsSavedSuccessfully":"Definies guardadas com sucesso","failedToSaveSettings":"Falha ao guardar definies","validatingApiKey":"A validar chave da API...","settingSavedSuccessfully":"Definio guardada com sucesso: {{key}}","failedToSaveSetting":"Falha ao guardar definio: {{key}}","apiKeyValidationCompleted":"Validao da chave API concluda","errorValidatingApiKey":"Erro ao validar a chave API","sessionActiveNotice":"As definies esto bloqueadas enquanto a sesso est activa. Termine a sesso para modificar as definies.","realtimeModelAvailable":"O modelo em tempo real est disponvel","realtimeModelNotAvailable":"O modelo em tempo real no est disponvel","refreshModels":"Actualizar modelos disponveis","loadingModels":"A carregar modelos disponveis...","modelsFound":"{{count}} modelos disponveis","experimentalFeatureTooltip":"Esta  uma funcionalidade experimental e pode ser instvel.","help":"Ajuda","auto":"Auto","low":"Baixo","medium":"Mdio","high":"Alto","clientId":"ID do Cliente","clientSecret":"Segredo do Cliente","languageSettings":"Definies de Idioma","voiceSettings":"Definies de Voz","speechProcessing":"Processamento de Fala","silenceThreshold":"Limite de Silncio","sentenceSplitter":"Divisor de Frases","enabled":"Ativado","translatePartialTranscriptions":"Traduzir Transcries Parciais","queueConfiguration":"Configurao da Fila de udio","desiredQueueLevel":"Nvel de Fila Desejado","maxQueueLevel":"Nvel Mximo da Fila","autoTempo":"Velocidade de Fala Adaptativa","apiKeyValidated":"Chave de API validada","realtimeTranslationAvailable":"Servio de traduo em tempo real disponvel"},"audioPanel":{"title":"Definies de udio","audioInputDevice":"Dispositivo de entrada de udio","virtualSpeakerMonitorDevice":"Dispositivo monitor de altifalante virtual","availableInputDevices":"Dispositivos de entrada disponveis","availableMonitorDevices":"Dispositivos de monitor disponveis","loadingDevices":"A carregar dispositivos...","noDeviceSelected":"Nenhum dispositivo seleccionado","turnOn":"Ligar","turnOff":"Desligar","refreshInputDevices":"Actualizar dispositivos de entrada","refreshMonitorDevices":"Actualizar dispositivos de monitor","virtualMicrophone":"Microfone virtual","virtualSpeaker":"Altifalante virtual","virtualMicrophoneNotice":"Aviso sobre microfone virtual","virtualSpeakerNotice":"Aviso sobre altifalante virtual","iUnderstand":"Eu compreendo","virtualMicWarningTitle":"Este  um microfone virtual criado pelo Sokuji.","virtualMicWarningText1":"Por favor, no seleccione este dispositivo aqui. Em vez disso, use este microfone virtual nas suas aplicaes de videoconferncia (como Google Meet, Zoom, Microsoft Teams, etc.) para receber a sada de traduo de voz em tempo real.","virtualMicWarningText2":"Para que o Sokuji funcione correctamente, seleccione o seu microfone fsico real da lista.","virtualSpeakerWarningTitle":"Este  um altifalante virtual criado pelo Sokuji.","virtualSpeakerWarningText1":"Por favor, no seleccione este dispositivo como o seu monitor. O Sokuji_Virtual_Speaker  usado pelo Sokuji para enviar udio para as suas aplicaes de conferncia.","virtualSpeakerWarningText2":"Conectar o seu monitor ao dispositivo de sada do Sokuji criaria um loop de feedback de udio, fazendo com que a sua entrada contenha a sua prpria sada monitorizada.","virtualSpeakerWarningText3":"O boto \\"Ligar\\" conecta o altifalante virtual ao seu dispositivo de monitor seleccionado, permitindo que oua o que est a ser enviado para a sua aplicao de conferncia. O boto \\"Desligar\\" desconecta esta ligao de monitorizao.","virtualSpeakerWarningText4":"Para operao adequada, seleccione um dispositivo de monitor diferente (como os seus auscultadores ou altifalantes) da lista.","realVoicePassthrough":"Passagem de udio Original","enableRealVoicePassthrough":"Activar Passagem de udio Original","realVoicePassthroughDescription":"Passe o seu udio original (voz do orador) directamente para o microfone virtual para que os ouvintes possam ouvir tanto o udio original como o traduzido","realVoiceVolume":"Volume do udio Original"},"logsPanel":{"title":"Registos","autoScrollOn":"Deslocamento automtico ligado","autoScrollOff":"Deslocamento automtico desligado","enableAutoScroll":"Activar deslocamento automtico","disableAutoScroll":"Desactivar deslocamento automtico","logsPlaceholder":"Os registos aparecero aqui","client":"cliente","server":"servidor","event":"Evento","of":"de","unknown":"desconhecido"},"translation":{"start":"Iniciar traduo","stop":"Parar traduo","listening":"A ouvir...","translating":"A traduzir...","sourceLanguage":"Idioma de origem","targetLanguage":"Idioma de destino"},"mainPanel":{"conversationPlaceholder":"A conversa aparecer aqui","audioContent":"Contedo de udio","function":"Funo","input":"Entrada","output":"Sada","release":"soltar","pushToTalk":"pressionar para falar (Espao)","inputDeviceOff":"dispositivo de entrada desligado","endSession":"Terminar sesso","startSession":"Iniciar sesso","initializing":"A inicializar...","stopDebug":"Parar depurao","debug":"Depurar","apiKeyRequired":"Por favor, adicione primeiro uma chave da API OpenAI vlida nas definies","modelsRequired":"So necessrios modelos. Por favor, valide primeiro a sua chave da API para carregar os modelos disponveis.","modelsLoading":"A carregar modelos disponveis, por favor aguarde..."},"errors":{"microphoneAccess":"Acesso ao microfone negado","networkError":"Erro de ligao de rede","translationFailed":"Falha na traduo","audioError":"Erro de processamento de udio"},"onboarding":{"back":"Voltar","close":"Fechar","finish":"Terminar","next":"Seguinte","nextWithProgress":"Seguinte ({step}/{steps})","open":"Abrir","skip":"Saltar","restartTour":"Reiniciar guia de configurao","steps":{"welcome":{"title":"Bem-vindo ao Sokuji!","content":"Bem-vindo  aplicao de traduo de voz em tempo real! Vamos configurar rapidamente as suas definies para uma experincia ptima."},"openSettings":{"title":"Abrir painel de definies","content":"Clique neste boto para abrir o painel de definies onde iremos configurar a sua chave API e preferncias."},"apiKey":{"title":"Configurar chave da API OpenAI","content":"Introduza a sua chave da API OpenAI para activar a funcionalidade de traduo. Pode obter uma chave na <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>plataforma OpenAI</a>."},"systemInstructions":{"title":"Personalizar instrues do sistema","content":"Adicione instrues especficas aqui para personalizar o comportamento da traduo, como tom, estilo ou requisitos especiais."},"voiceSettings":{"title":"Definies de voz","content":"Escolha o seu modelo de voz preferido e definies. Estas definies afectaro a qualidade e velocidade da traduo."},"turnDetection":{"title":"Deteco de turno","content":"Configure as definies de deteco automtica de turno para controlar quando o sistema comea e pra de ouvir."},"audioSettings":{"title":"Painel de definies de udio","content":"Clique aqui para abrir as definies de udio onde ir configurar os seus dispositivos de microfone e altifalante."},"microphoneSetup":{"title":"Seleccionar dispositivo de microfone","content":"Escolha o seu dispositivo de microfone fsico real da lista. Evite seleccionar dispositivos virtuais, pois estes so destinados a aplicaes de conferncia."},"speakerSetup":{"title":"Configurao do dispositivo de monitorizao","content":"Seleccione um dispositivo de monitorizao (como auscultadores ou altifalantes) para ouvir a sada da traduo. Recomenda-se o uso de auscultadores para evitar feedback de udio. Se preferir focar-se na reunio sem distraco da monitorizao, pode desactivar a funcionalidade de monitorizao."},"startSession":{"title":"Iniciar a sua sesso","content":"Tudo pronto! Clique no boto \\"Iniciar sesso\\" para comear a traduo em tempo real. Lembre-se de seleccionar o microfone virtual Sokuji como dispositivo de entrada na sua aplicao de conferncia."},"completion":{"title":"Guia de configurao concludo!","content":"Concluiu o guia de configurao! Agora certifique-se de que realmente introduziu a sua chave API e configurou as suas definies, depois use o microfone virtual Sokuji em aplicaes de conferncia (como Google Meet, Zoom, etc.) para comear a traduo em tempo real."}}}}')},id:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Batal","save":"Simpan","close":"Tutup","settings":"Pengaturan","help":"Bantuan","loading":"Memuat...","error":"Kesalahan","success":"Berhasil","warning":"Peringatan","info":"Informasi","logs":"Log","clear":"Hapus"},"app":{"title":"Sokuji","description":"Aplikasi terjemahan suara real-time"},"menu":{"file":"File","edit":"Edit","view":"Lihat","window":"Jendela","help":"Bantuan"},"settings":{"title":"Pengaturan","language":"Bahasa","audio":"Audio","translation":"Terjemahan","general":"Umum","uiLanguage":"Bahasa antarmuka","openaiApiKey":"Kunci API OpenAI","provider":"Penyedia layanan","providerType":"Penyedia","apiKey":"Kunci API","systemInstructions":"Instruksi sistem","voice":"Suara","automaticTurnDetection":"Deteksi giliran otomatis","model":"Model","userTranscriptModel":"Model transkripsi pengguna","noiseReduction":"Pengurangan noise","modelConfiguration":"Konfigurasi model","sourceLanguage":"Bahasa sumber","targetLanguage":"Bahasa target","preview":"Pratinjau","simple":"Sederhana","advanced":"Lanjutan","normal":"Normal","semantic":"Semantik","disabled":"Dinonaktifkan","threshold":"Ambang batas","prefixPadding":"Padding awalan","silenceDuration":"Durasi keheningan","eagerness":"Keinginan","temperature":"Suhu","maxTokens":"Token maksimum","saving":"Menyimpan...","validate":"Validasi","validating":"Memvalidasi...","enterApiKey":"Masukkan kunci API OpenAI Anda","enterCustomInstructions":"Masukkan instruksi sistem kustom di sini...","settingsSavedSuccessfully":"Pengaturan berhasil disimpan","failedToSaveSettings":"Gagal menyimpan pengaturan","validatingApiKey":"Memvalidasi kunci API...","settingSavedSuccessfully":"Pengaturan berhasil disimpan: {{key}}","failedToSaveSetting":"Gagal menyimpan pengaturan: {{key}}","apiKeyValidationCompleted":"Validasi kunci API selesai","errorValidatingApiKey":"Kesalahan saat memvalidasi kunci API","sessionActiveNotice":"Pengaturan terkunci saat sesi aktif. Harap akhiri sesi untuk mengubah pengaturan.","realtimeModelAvailable":"Model real-time tersedia","realtimeModelNotAvailable":"Model real-time tidak tersedia","refreshModels":"Segarkan model yang tersedia","loadingModels":"Memuat model yang tersedia...","modelsFound":"{{count}} model tersedia","experimentalFeatureTooltip":"Ini adalah fitur eksperimental dan mungkin tidak stabil.","help":"Bantuan","medium":"Sedang","high":"Tinggi","clientId":"ID Klien","clientSecret":"Rahasia Klien","languageSettings":"Pengaturan Bahasa","voiceSettings":"Pengaturan Suara","speechProcessing":"Pemrosesan Ucapan","silenceThreshold":"Ambang Batas Hening","sentenceSplitter":"Pemisah Kalimat","enabled":"Diaktifkan","translatePartialTranscriptions":"Terjemahkan Transkripsi Parsial","queueConfiguration":"Konfigurasi Buffer Audio","desiredQueueLevel":"Buffer Audio Target","maxQueueLevel":"Buffer Audio Maksimum","autoTempo":"Kecepatan Bicara Adaptif","apiKeyValidated":"Kunci API divalidasi","realtimeTranslationAvailable":"Layanan terjemahan waktu nyata tersedia"},"audioPanel":{"title":"Pengaturan audio","audioInputDevice":"Perangkat input audio","virtualSpeakerMonitorDevice":"Perangkat monitor speaker virtual","availableInputDevices":"Perangkat input yang tersedia","availableMonitorDevices":"Perangkat monitor yang tersedia","loadingDevices":"Memuat perangkat...","noDeviceSelected":"Tidak ada perangkat yang dipilih","turnOn":"Nyalakan","turnOff":"Matikan","refreshInputDevices":"Segarkan perangkat input","refreshMonitorDevices":"Segarkan perangkat monitor","virtualMicrophone":"Mikrofon virtual","virtualSpeaker":"Speaker virtual","virtualMicrophoneNotice":"Pemberitahuan mikrofon virtual","virtualSpeakerNotice":"Pemberitahuan speaker virtual","iUnderstand":"Saya mengerti","virtualMicWarningTitle":"Ini adalah mikrofon virtual yang dibuat oleh Sokuji.","virtualMicWarningText1":"Jangan pilih perangkat ini di sini. Gunakan mikrofon virtual ini di aplikasi konferensi video Anda (seperti Google Meet, Zoom, Microsoft Teams, dll.) untuk menerima output terjemahan suara real-time.","virtualMicWarningText2":"Agar Sokuji berfungsi dengan benar, pilih mikrofon fisik asli Anda dari daftar.","virtualSpeakerWarningTitle":"Ini adalah speaker virtual yang dibuat oleh Sokuji.","virtualSpeakerWarningText1":"Jangan pilih perangkat ini sebagai monitor Anda. Sokuji_Virtual_Speaker digunakan oleh Sokuji untuk mengirim audio ke aplikasi konferensi Anda.","virtualSpeakerWarningText2":"Menghubungkan monitor Anda ke perangkat output Sokuji akan menciptakan loop umpan balik audio, menyebabkan input Anda berisi output monitor Anda sendiri.","virtualSpeakerWarningText3":"Tombol \\"Nyalakan\\" menghubungkan speaker virtual ke perangkat monitor yang dipilih, memungkinkan Anda mendengar apa yang dikirim ke aplikasi konferensi Anda. Tombol \\"Matikan\\" memutuskan koneksi monitoring ini.","virtualSpeakerWarningText4":"Untuk operasi yang tepat, pilih perangkat monitor yang berbeda (seperti headphone atau speaker Anda) dari daftar.","realVoicePassthrough":"Passthrough Audio Asli","enableRealVoicePassthrough":"Aktifkan Passthrough Audio Asli","realVoicePassthroughDescription":"Teruskan audio asli Anda (suara pembicara) langsung ke mikrofon virtual agar pendengar dapat mendengar audio asli dan terjemahan","realVoiceVolume":"Volume Audio Asli"},"logsPanel":{"title":"Log","autoScrollOn":"Gulir otomatis aktif","autoScrollOff":"Gulir otomatis nonaktif","enableAutoScroll":"Aktifkan gulir otomatis","disableAutoScroll":"Nonaktifkan gulir otomatis","logsPlaceholder":"Log akan muncul di sini","client":"klien","server":"server","event":"Peristiwa","of":"dari","unknown":"tidak diketahui"},"translation":{"start":"Mulai terjemahan","stop":"Hentikan terjemahan","listening":"Mendengarkan...","translating":"Menerjemahkan...","sourceLanguage":"Bahasa sumber","targetLanguage":"Bahasa target"},"mainPanel":{"conversationPlaceholder":"Percakapan akan muncul di sini","audioContent":"Konten audio","function":"Fungsi","input":"Input","output":"Output","release":"lepas","pushToTalk":"tekan untuk bicara (Spasi)","inputDeviceOff":"perangkat input mati","endSession":"Akhiri sesi","startSession":"Mulai sesi","initializing":"Menginisialisasi...","stopDebug":"Hentikan debug","debug":"Debug","apiKeyRequired":"Silakan tambahkan kunci API OpenAI yang valid di pengaturan terlebih dahulu","modelsRequired":"Model diperlukan. Silakan validasi kunci API Anda terlebih dahulu untuk memuat model yang tersedia.","modelsLoading":"Memuat model yang tersedia, harap tunggu..."},"errors":{"microphoneAccess":"Akses mikrofon ditolak","networkError":"Kesalahan koneksi jaringan","translationFailed":"Terjemahan gagal","audioError":"Kesalahan pemrosesan audio"},"onboarding":{"back":"Kembali","close":"Tutup","finish":"Selesai","next":"Selanjutnya","nextWithProgress":"Selanjutnya ({step}/{steps})","open":"Buka","skip":"Lewati","restartTour":"Mulai ulang panduan pengaturan","steps":{"welcome":{"title":"Selamat datang di Sokuji!","content":"Selamat datang di aplikasi terjemahan suara real-time! Mari kita atur sistem Anda dengan cepat untuk pengalaman terbaik."},"openSettings":{"title":"Buka panel pengaturan","content":"Klik tombol ini untuk membuka panel pengaturan, di mana kita akan mengonfigurasi kunci API dan preferensi Anda."},"apiKey":{"title":"Atur kunci API OpenAI","content":"Masukkan kunci API OpenAI Anda untuk mengaktifkan fungsi terjemahan. Anda bisa mendapatkan kunci dari <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>platform OpenAI</a>."},"systemInstructions":{"title":"Kustomisasi instruksi sistem","content":"Tambahkan instruksi khusus di sini untuk menyesuaikan perilaku terjemahan, seperti nada, gaya, atau persyaratan khusus."},"voiceSettings":{"title":"Pengaturan suara","content":"Pilih model suara dan pengaturan yang Anda sukai. Pengaturan ini akan mempengaruhi kualitas dan kecepatan terjemahan."},"turnDetection":{"title":"Deteksi giliran","content":"Konfigurasikan pengaturan deteksi giliran otomatis untuk mengontrol kapan sistem mulai dan berhenti mendengarkan."},"audioSettings":{"title":"Panel pengaturan audio","content":"Klik di sini untuk membuka pengaturan audio, di mana kita akan mengatur perangkat mikrofon dan speaker Anda."},"microphoneSetup":{"title":"Pilih perangkat mikrofon","content":"Pilih perangkat mikrofon fisik Anda dari daftar. Hindari memilih perangkat virtual karena ini digunakan untuk aplikasi konferensi."},"speakerSetup":{"title":"Pengaturan perangkat monitor","content":"Pilih perangkat monitor (seperti headphone atau speaker) untuk mendengar output terjemahan. Disarankan menggunakan headphone untuk menghindari umpan balik audio. Jika Anda ingin fokus pada rapat tanpa gangguan monitoring, Anda dapat mematikan fitur monitoring."},"startSession":{"title":"Mulai sesi Anda","content":"Semuanya sudah siap! Klik tombol \\"Mulai sesi\\" untuk memulai terjemahan real-time. Ingat untuk memilih mikrofon virtual Sokuji sebagai perangkat input di aplikasi konferensi Anda."},"completion":{"title":"Panduan pengaturan selesai!","content":"Anda telah menyelesaikan panduan pengaturan! Sekarang pastikan untuk benar-benar memasukkan kunci API dan mengonfigurasi pengaturan Anda, lalu gunakan mikrofon virtual Sokuji di aplikasi konferensi (seperti Google Meet, Zoom, dll.) untuk memulai terjemahan real-time."}}}}')},it:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Annulla","save":"Salva","close":"Chiudi","settings":"Impostazioni","help":"Aiuto","loading":"Caricamento...","error":"Errore","success":"Successo","warning":"Avviso","info":"Informazione","logs":"Log","clear":"Cancella"},"app":{"title":"Sokuji","description":"Applicazione di traduzione vocale in tempo reale"},"menu":{"file":"File","edit":"Modifica","view":"Visualizza","window":"Finestra","help":"Aiuto"},"settings":{"title":"Impostazioni","language":"Lingua","audio":"Audio","translation":"Traduzione","general":"Generale","uiLanguage":"Lingua dell\'interfaccia","openaiApiKey":"Chiave API OpenAI","provider":"Fornitore di servizi","providerType":"Fornitore","apiKey":"Chiave API","systemInstructions":"Istruzioni di sistema","voice":"Voce","automaticTurnDetection":"Rilevamento automatico del turno","model":"Modello","userTranscriptModel":"Modello di trascrizione utente","noiseReduction":"Riduzione del rumore","modelConfiguration":"Configurazione del modello","sourceLanguage":"Lingua di origine","targetLanguage":"Lingua di destinazione","preview":"Anteprima","simple":"Semplice","advanced":"Avanzato","normal":"Normale","semantic":"Semantico","disabled":"Disabilitato","threshold":"Soglia","prefixPadding":"Riempimento prefisso","silenceDuration":"Durata del silenzio","eagerness":"Impazienza","temperature":"Temperatura","maxTokens":"Token massimi","saving":"Salvataggio...","validate":"Convalida","validating":"Convalida...","enterApiKey":"Inserisci la tua chiave API OpenAI","enterCustomInstructions":"Inserisci istruzioni di sistema personalizzate qui...","settingsSavedSuccessfully":"Impostazioni salvate con successo","failedToSaveSettings":"Impossibile salvare le impostazioni","validatingApiKey":"Convalida chiave API...","settingSavedSuccessfully":"Impostazione salvata con successo: {{key}}","failedToSaveSetting":"Impossibile salvare l\'impostazione: {{key}}","apiKeyValidationCompleted":"Convalida della chiave API completata","errorValidatingApiKey":"Errore nella convalida della chiave API","sessionActiveNotice":"Le impostazioni sono bloccate mentre la sessione  attiva. Termina la sessione per modificare le impostazioni.","realtimeModelAvailable":"Il modello in tempo reale  disponibile","realtimeModelNotAvailable":"Il modello in tempo reale non  disponibile","refreshModels":"Aggiorna modelli disponibili","loadingModels":"Caricamento modelli disponibili...","modelsFound":"{{count}} modelli disponibili","experimentalFeatureTooltip":"Questa  una funzionalit sperimentale e potrebbe essere instabile.","help":"Aiuto","auto":"Auto","low":"Basso","medium":"Medio","high":"Alto","clientId":"ID Cliente","clientSecret":"Segreto Cliente","languageSettings":"Impostazioni Lingua","voiceSettings":"Impostazioni Voce","speechProcessing":"Elaborazione Vocale","silenceThreshold":"Soglia di Silenzio","sentenceSplitter":"Divisore di Frasi","enabled":"Abilitato","translatePartialTranscriptions":"Traduci Trascrizioni Parziali","queueConfiguration":"Configurazione Buffer Audio","desiredQueueLevel":"Buffer Audio di Destinazione","maxQueueLevel":"Buffer Audio Massimo","autoTempo":"Velocit di Discorso Adattiva","apiKeyValidated":"Chiave API convalidata","realtimeTranslationAvailable":"Servizio di traduzione in tempo reale disponibile"},"audioPanel":{"title":"Impostazioni audio","audioInputDevice":"Dispositivo di input audio","virtualSpeakerMonitorDevice":"Dispositivo monitor altoparlante virtuale","availableInputDevices":"Dispositivi di input disponibili","availableMonitorDevices":"Dispositivi monitor disponibili","loadingDevices":"Caricamento dispositivi...","noDeviceSelected":"Nessun dispositivo selezionato","turnOn":"Accendi","turnOff":"Spegni","refreshInputDevices":"Aggiorna dispositivi di input","refreshMonitorDevices":"Aggiorna dispositivi monitor","virtualMicrophone":"Microfono virtuale","virtualSpeaker":"Altoparlante virtuale","virtualMicrophoneNotice":"Avviso microfono virtuale","virtualSpeakerNotice":"Avviso altoparlante virtuale","iUnderstand":"Ho capito","virtualMicWarningTitle":"Questo  un microfono virtuale creato da Sokuji.","virtualMicWarningText1":"Per favore non selezionare questo dispositivo qui. Invece, usa questo microfono virtuale nelle tue applicazioni di videoconferenza (come Google Meet, Zoom, Microsoft Teams, ecc.) per ricevere l\'output di traduzione vocale in tempo reale.","virtualMicWarningText2":"Perch Sokuji funzioni correttamente, seleziona il tuo microfono fisico reale dall\'elenco.","virtualSpeakerWarningTitle":"Questo  un altoparlante virtuale creato da Sokuji.","virtualSpeakerWarningText1":"Per favore non selezionare questo dispositivo come monitor. Il Sokuji_Virtual_Speaker  usato da Sokuji per inviare audio alle tue applicazioni di conferenza.","virtualSpeakerWarningText2":"Collegare il tuo monitor al dispositivo di output di Sokuji creerebbe un loop di feedback audio, causando che il tuo input contenga il tuo stesso output monitorato.","virtualSpeakerWarningText3":"L\'interruttore \\"Accendi\\" collega l\'altoparlante virtuale al tuo dispositivo monitor selezionato, permettendoti di sentire cosa viene inviato alla tua applicazione di conferenza. L\'interruttore \\"Spegni\\" disconnette questa connessione di monitoraggio.","virtualSpeakerWarningText4":"Per un funzionamento corretto, seleziona un dispositivo monitor diverso (come le tue cuffie o altoparlanti) dall\'elenco.","realVoicePassthrough":"Passaggio Audio Originale","enableRealVoicePassthrough":"Abilita Passaggio Audio Originale","realVoicePassthroughDescription":"Passa il tuo audio originale (voce del parlante) direttamente al microfono virtuale in modo che gli ascoltatori possano sentire sia l\'audio originale che quello tradotto","realVoiceVolume":"Volume Audio Originale"},"logsPanel":{"title":"Log","autoScrollOn":"Scorrimento automatico attivo","autoScrollOff":"Scorrimento automatico disattivo","enableAutoScroll":"Abilita scorrimento automatico","disableAutoScroll":"Disabilita scorrimento automatico","logsPlaceholder":"I log appariranno qui","client":"client","server":"server","event":"Evento","of":"di","unknown":"sconosciuto"},"translation":{"start":"Inizia traduzione","stop":"Ferma traduzione","listening":"In ascolto...","translating":"Traduzione...","sourceLanguage":"Lingua di origine","targetLanguage":"Lingua di destinazione"},"mainPanel":{"conversationPlaceholder":"La conversazione apparir qui","audioContent":"Contenuto audio","function":"Funzione","input":"Input","output":"Output","release":"rilascia","pushToTalk":"premi per parlare (Spazio)","inputDeviceOff":"dispositivo di input spento","endSession":"Termina sessione","startSession":"Inizia sessione","initializing":"Inizializzazione...","stopDebug":"Ferma debug","debug":"Debug","apiKeyRequired":"Per favore aggiungi prima una chiave API OpenAI valida nelle impostazioni","modelsRequired":"Sono richiesti modelli. Per favore valida prima la tua chiave API per caricare i modelli disponibili.","modelsLoading":"Caricamento modelli disponibili, attendere prego..."},"errors":{"microphoneAccess":"Accesso al microfono negato","networkError":"Errore di connessione di rete","translationFailed":"Traduzione fallita","audioError":"Errore di elaborazione audio"},"onboarding":{"back":"Indietro","close":"Chiudi","finish":"Termina","next":"Avanti","nextWithProgress":"Avanti ({step}/{steps})","open":"Apri dialogo","skip":"Salta tour","restartTour":"Riavvia guida configurazione","steps":{"welcome":{"title":"Benvenuto in Sokuji","content":"Benvenuto in Sokuji! Questa guida ti aiuter a configurare l\'estensione per la traduzione vocale in tempo reale. Iniziamo!"},"settings":{"title":"Passo 1: Apri impostazioni","content":"Prima, configuriamo le tue impostazioni. Clicca qui per aprire il pannello delle impostazioni dove puoi configurare la tua chiave API OpenAI e personalizzare le istruzioni di sistema."},"apiKey":{"title":"Passo 2: Configura chiave API","content":"Inserisci la tua chiave API OpenAI qui. Puoi ottenerne una dalla","linkText":"pagina OpenAI","required":". Questo  richiesto per la traduzione vocale."},"systemInstructions":{"title":"Passo 3: Istruzioni di sistema","content":"Personalizza le istruzioni di sistema per controllare come l\'IA risponde. Puoi modificare il comportamento di traduzione e aggiungere requisiti specifici qui."},"voiceSettings":{"title":"Passo 4: Impostazioni vocali","content":"Configura il tipo di voce che sar utilizzato per la sintesi vocale. Scegli tra diverse opzioni vocali secondo la tua preferenza."},"turnDetection":{"title":"Passo 5: Rilevamento turni","content":"Configura le impostazioni di rilevamento automatico dei turni inclusi modalit di rilevamento, soglia e parametri audio per prestazioni ottimali di riconoscimento vocale."},"audioSettings":{"title":"Passo 6: Impostazioni audio","content":"Successivamente, configuriamo le tue impostazioni audio. Clicca qui per aprire il pannello audio e configurare il tuo microfono e altoparlanti."},"microphoneSetup":{"title":"Passo 7: Configurazione microfono","content":"Seleziona il tuo dispositivo microfono qui. Assicurati di scegliere il dispositivo di input corretto per la migliore qualit audio."},"speakerSetup":{"title":"Passo 8: Configurazione altoparlanti","content":"Seleziona un dispositivo di monitoraggio per ascoltare l\'audio tradotto e verificare se soddisfa i tuoi requisiti. Si raccomanda di utilizzare cuffie per il monitoraggio per evitare interferenze con l\'input del microfono. Quando ritieni che le impostazioni di traduzione soddisfino i tuoi requisiti, si suggerisce di disattivare il monitoraggio in modo da poterti concentrare di pi sulla tua espressione e non interferire con l\'input del microfono."},"startSession":{"title":"Passo 9: Avvia sessione","content":"Clicca sul pulsante \\"Avvia sessione\\" per iniziare a usare Sokuji. Una volta avviato, puoi parlare naturalmente per la traduzione in tempo reale. Se il rilevamento automatico dei turni  disabilitato, usa \\"Premi per parlare\\" (barra spaziatrice) per parlare."},"complete":{"title":"Guida configurazione completata!","content":"Eccellente! Hai completato la guida di configurazione e ora hai familiarit con l\'interfaccia. Per iniziare a usare Sokuji, per favore inserisci la tua chiave API OpenAI nelle impostazioni, concedi i permessi del microfono quando richiesto, e seleziona \\"Sokuji Virtual Microphone\\" come tuo microfono nella tua applicazione di meeting (Google Meet, Zoom, Microsoft Teams, ecc.). Puoi riavviare questa guida in qualsiasi momento dalle impostazioni."}}}}')},hi:{translation:JSON.parse('{"common":{"ok":" ","cancel":" ","save":" ","close":" ","settings":"","help":"","loading":"   ...","error":"","success":"","warning":"","info":"","logs":"","clear":" "},"app":{"title":"Sokuji","description":"-   "},"settings":{"title":"","uiLanguage":"UI ","openaiApiKey":"OpenAI API ","provider":" ","providerType":"","apiKey":"API ","validate":" ","validating":"...","enterApiKey":" OpenAI API   ","refreshModels":"   ","loadingModels":"     ...","modelsFound":"{{count}}   ","experimentalFeatureTooltip":"         ","apiKeyValidationCompleted":"API    ","errorValidatingApiKey":"API    ","sessionActiveNotice":"              ","realtimeModelAvailable":"-   ","realtimeModelNotAvailable":"-    ","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" TINGS","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"    ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":"API  ","realtimeTranslationAvailable":"-    "},"mainPanel":{"conversationPlaceholder":"   ","pushToTalk":"    ()","endSession":"  ","startSession":"  ","initializing":"   ...","apiKeyRequired":"      OpenAI API  ","modelsRequired":"            API    ","modelsLoading":"     ,   ..."},"audioPanel":{"title":" ","realVoicePassthrough":"  ","enableRealVoicePassthrough":"    ","realVoicePassthroughDescription":"   (  )               ","realVoiceVolume":"  "},"logsPanel":{"title":""},"translation":{"start":"  ","stop":" "},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":" ","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":" ","skip":" ","restartTour":"    ","steps":{"welcome":{"title":"Sokuji    ","content":"Sokuji    !    -              !"},"settings":{"title":" 1:  ","content":",                 OpenAI API             "},"apiKey":{"title":" 2: API   ","content":"  OpenAI API     ","linkText":"OpenAI ","required":"           "},"systemInstructions":{"title":" 3:  ","content":"AI                              "},"voiceSettings":{"title":" 4:  ","content":"                      "},"turnDetection":{"title":" 5:  ","content":"       ,           "},"audioSettings":{"title":" 6:  ","content":",                     "},"microphoneSetup":{"title":" 7:  ","content":"               "},"speakerSetup":{"title":" 8:  ","content":"                                                       ,                          "},"startSession":{"title":" 9:   ","content":"Sokuji       \\"  \\"        ,  -               ,     \\"  \\" ( )   "},"complete":{"title":"  !","content":" !                Sokuji      ,     OpenAI API   ,       ,     (Google Meet, Zoom, Microsoft Teams, )  \\"Sokuji Virtual Microphone\\"                    "}}}}')},fi:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Peruuta","save":"Tallenna","close":"Sulje","settings":"Asetukset","help":"Ohje","loading":"Ladataan...","error":"Virhe","success":"Onnistui","warning":"Varoitus","info":"Tieto","logs":"Lokit","clear":"Tyhjenn"},"app":{"title":"Sokuji","description":"Reaaliaikainen nenknnssovellus"},"settings":{"title":"Asetukset","uiLanguage":"Kyttliittymn kieli","openaiApiKey":"OpenAI API-avain","provider":"Palveluntarjoaja","providerType":"Tarjoaja","apiKey":"API-avain","validate":"Vahvista","validating":"Vahvistetaan...","enterApiKey":"Syt OpenAI API-avaimesi","refreshModels":"Pivit saatavilla olevat mallit","loadingModels":"Ladataan saatavilla olevia malleja...","modelsFound":"{{count}} mallia saatavilla","experimentalFeatureTooltip":"Tm on kokeellinen ominaisuus ja voi olla epvakaa.","apiKeyValidationCompleted":"API-avaimen validointi valmis","errorValidatingApiKey":"Virhe API-avainta validoidessa","sessionActiveNotice":"Asetukset on lukittu istunnon ollessa aktiivinen. Lopeta istunto muuttaaksesi asetuksia.","realtimeModelAvailable":"Reaaliaikamalli on saatavilla","realtimeModelNotAvailable":"Reaaliaikamalli ei ole saatavilla","help":"Ohje","auto":"Auto","low":"Matala","medium":"Keskitaso","high":"Korkea","clientId":"Asiakastunnus","clientSecret":"Asiakassalaisuus","languageSettings":"Kieliasetukset","voiceSettings":"niasetukset","speechProcessing":"Puheen ksittely","silenceThreshold":"Hiljaisuuden kynnys","sentenceSplitter":"Lauseen jakaja","enabled":"Kytss","translatePartialTranscriptions":"Knn osittaiset transkriptiot","queueConfiguration":"nipuskurin asetukset","desiredQueueLevel":"Tavoiteltu nipuskuri","maxQueueLevel":"Suurin nipuskuri","autoTempo":"Mukautuva puhenopeus","apiKeyValidated":"API-avain vahvistettu","realtimeTranslationAvailable":"Reaaliaikainen knnspalvelu on saatavilla"},"mainPanel":{"conversationPlaceholder":"Keskustelu nkyy tss","pushToTalk":"paina puhuaksesi (Vlilynti)","endSession":"Lopeta istunto","startSession":"Aloita istunto","initializing":"Alustetaan...","apiKeyRequired":"Lis ensin kelvollinen OpenAI API-avain asetuksiin","modelsRequired":"Malleja tarvitaan. Vahvista ensin API-avaimesi ladataksesi kytettviss olevat mallit.","modelsLoading":"Ladataan kytettviss olevia malleja, odota hetki..."},"audioPanel":{"title":"niasetukset","realVoicePassthrough":"Alkuperisen nen lpiviennti","enableRealVoicePassthrough":"Ota alkuperisen nen lpiviennti kyttn","realVoicePassthroughDescription":"Vlit alkuperinen nesi (puhujan ni) suoraan virtuaalimikrofoniin, jotta kuulijat voivat kuulla sek alkuperisen ett knnetyn nen","realVoiceVolume":"Alkuperisen nen nenvoimakkuus"},"logsPanel":{"title":"Lokit"},"translation":{"start":"Aloita knns","stop":"Lopeta knns"},"errors":{"microphoneAccess":"Mikrofonin kytt evtty","networkError":"Verkkoyhteyden virhe","translationFailed":"Knns eponnistui","audioError":"nen ksittelyn virhe"},"onboarding":{"back":"Takaisin","close":"Sulje","finish":"Valmis","next":"Seuraava","nextWithProgress":"Seuraava ({step}/{steps})","open":"Avaa","skip":"Ohita","restartTour":"Kynnist asennusopas uudelleen","steps":{"welcome":{"title":"Tervetuloa Sokuji:iin!","content":"Tervetuloa reaaliaikaiseen nenknnssovellukseen! Mritetn jrjestelmsi nopeasti parhaan kokemuksen saamiseksi."},"openSettings":{"title":"Avaa asetuspaneeli","content":"Napsauta tt painiketta avataksesi asetuspaneelin, jossa mritmme API-avaimesi ja asetuksesi."},"apiKey":{"title":"Mrit OpenAI API-avain","content":"Syt OpenAI API-avaimesi knnstoiminnon kyttnottamiseksi. Voit hankkia avaimen <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI-alustalta</a>."},"systemInstructions":{"title":"Mukauta jrjestelmohjeita","content":"Lis thn erityisi ohjeita knnskyttytymisen mukauttamiseksi, kuten svy, tyyli tai erityisvaatimukset."},"voiceSettings":{"title":"niasetukset","content":"Valitse haluamasi nimalli ja asetukset. Nm asetukset vaikuttavat knnksen laatuun ja nopeuteen."},"turnDetection":{"title":"Vuoron tunnistus","content":"Mrit automaattisen vuoron tunnistuksen asetukset hallitaksesi, milloin jrjestelm alkaa ja lopettaa kuuntelun."},"audioSettings":{"title":"niasetuspaneeli","content":"Napsauta tt avataksesi niasetukset, jossa mritmme mikrofoni- ja kaiutinlaitteesi."},"microphoneSetup":{"title":"Valitse mikrofonilaitteesi","content":"Valitse todellinen fyysinen mikrofonilaitteesi luettelosta. Vlt virtuaalisten laitteiden valitsemista, koska ne on tarkoitettu konferenssisovelluksille."},"speakerSetup":{"title":"Monitorilaitteen asennus","content":"Valitse monitorilaitteesi (kuten kuulokkeet tai kaiuttimet) kuullaksesi knnksen tulosteen. Kuulokkeiden kytt suositellaan nipalautteiden vlttmiseksi. Jos haluat keskitty kokoukseen ilman monitoroinnin hiriit, voit poistaa monitorointitoiminnon kytst."},"startSession":{"title":"Aloita istuntosi","content":"Kaikki on valmista! Napsauta \\"Aloita istunto\\" -painiketta aloittaaksesi reaaliaikaisen knnksen. Muista valita Sokuji-virtuaalimikrofoni syttlaitteeksi konferenssisovelluksessasi."},"completion":{"title":"Asennusopas valmis!","content":"Olet suorittanut asennusoppaan! Varmista nyt, ett sytt todella API-avaimesi ja mritt asetuksesi, kyt sitten Sokuji-virtuaalimikrofonia konferenssisovelluksissa (kuten Google Meet, Zoom jne.) aloittaaksesi reaaliaikaisen knnksen."}}}}')},fil:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Kanselahin","save":"I-save","close":"Isara","settings":"Mga Setting","help":"Tulong","loading":"Naglo-load...","error":"Error","success":"Tagumpay","warning":"Babala","info":"Impormasyon","logs":"Mga Log","clear":"Linisin"},"app":{"title":"Sokuji","description":"Real-time voice translation application"},"settings":{"title":"Mga Setting","uiLanguage":"Wika ng interface","openaiApiKey":"OpenAI API key","provider":"Provider ng serbisyo","providerType":"Provider","apiKey":"API key","validate":"I-validate","validating":"Nag-va-validate...","enterApiKey":"Ilagay ang inyong OpenAI API key","refreshModels":"I-refresh ang mga available na model","loadingModels":"Naglo-load ng mga available na model...","modelsFound":"{{count}} na mga model ang available","experimentalFeatureTooltip":"Ito ay isang experimental na feature at maaaring hindi stable.","help":"Tulong","auto":"Awtomatiko","low":"Mababa","medium":"Katamtaman","high":"Mataas","clientId":"Client ID","clientSecret":"Client Secret","languageSettings":"Mga Setting ng Wika","voiceSettings":"Mga Setting ng Boses","speechProcessing":"Pagproseso ng Pagsasalita","silenceThreshold":"Prag ng Katahimikan","sentenceSplitter":"Panghati ng Pangungusap","enabled":"Pinagana","translatePartialTranscriptions":"Isalin ang mga Bahagyang Transkripsyon","queueConfiguration":"Configuration ng Audio Buffer","desiredQueueLevel":"Target na Audio Buffer","maxQueueLevel":"Pinakamataas na Audio Buffer","autoTempo":"Nakikibagay na Bilis ng Pagsasalita","apiKeyValidated":"Na-validate ang API key","realtimeTranslationAvailable":"Available ang serbisyo ng real-time na pagsasalin"},"mainPanel":{"conversationPlaceholder":"Ang usapan ay lalabas dito","pushToTalk":"pindutin para magsalita (Space)","endSession":"Tapusin ang session","startSession":"Simulan ang session","initializing":"Nagsisimula...","apiKeyRequired":"Magdagdag muna ng valid na OpenAI API key sa settings","modelsRequired":"Kailangan ang mga modelo. Mangyaring i-validate muna ang inyong API key upang ma-load ang mga available na modelo.","modelsLoading":"Naglo-load ng mga available na modelo, mangyaring maghintay..."},"audioPanel":{"title":"Mga Setting ng Audio","realVoicePassthrough":"Original Audio Passthrough","enableRealVoicePassthrough":"I-enable ang Original Audio Passthrough","realVoicePassthroughDescription":"Ipasa ang inyong orihinal na audio (boses ng nagsasalita) direkta sa virtual microphone para marinig ng mga nakikinig ang parehong orihinal at translated na audio","realVoiceVolume":"Original Audio Volume"},"logsPanel":{"title":"Mga Log"},"translation":{"start":"Simulan ang pagsasalin","stop":"Itigil ang pagsasalin"},"errors":{"microphoneAccess":"Hindi pinahintulutan ang access sa microphone","networkError":"Error sa network connection","translationFailed":"Nabigo ang pagsasalin","audioError":"Error sa audio processing"},"onboarding":{"back":"Bumalik","close":"Isara","finish":"Tapos","next":"Susunod","nextWithProgress":"Susunod ({step}/{steps})","open":"Buksan","skip":"Laktawan","restartTour":"I-restart ang setup guide","steps":{"welcome":{"title":"Maligayang pagdating sa Sokuji!","content":"Maligayang pagdating sa real-time voice translation application! Mabilis nating i-configure ang inyong mga setting para sa pinakamahusay na karanasan."},"openSettings":{"title":"Buksan ang settings panel","content":"I-click ang button na ito para buksan ang settings panel kung saan natin i-configure ang inyong API key at mga preference."},"apiKey":{"title":"I-set up ang OpenAI API key","content":"Ilagay ang inyong OpenAI API key para ma-enable ang translation functionality. Makakakuha kayo ng key sa <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI platform</a>."},"systemInstructions":{"title":"I-customize ang system instructions","content":"Magdagdag ng mga specific na instruction dito para ma-customize ang translation behavior, tulad ng tone, style, o mga special na requirement."},"voiceSettings":{"title":"Voice settings","content":"Piliin ang inyong preferred voice model at mga setting. Ang mga setting na ito ay makakaapekto sa kalidad at bilis ng translation."},"turnDetection":{"title":"Turn detection","content":"I-configure ang automatic turn detection settings para kontrolin kung kailan magsisimula at titigil ang system sa pakikinig."},"audioSettings":{"title":"Audio settings panel","content":"I-click dito para buksan ang audio settings kung saan nyo i-configure ang inyong microphone at speaker devices."},"microphoneSetup":{"title":"Pumili ng microphone device","content":"Piliin ang inyong tunay na physical microphone device sa listahan. Iwasan ang pagpili ng virtual devices dahil ang mga ito ay para sa conference applications."},"speakerSetup":{"title":"Monitor device setup","content":"Pumili ng monitor device (tulad ng headphones o speakers) para marinig ang translation output. Inirerekomenda ang paggamit ng headphones para maiwasan ang audio feedback. Kung mas gusto ninyong mag-focus sa meeting nang walang distraction mula sa monitoring, pwede ninyong i-disable ang monitoring feature."},"startSession":{"title":"Simulan ang inyong session","content":"Handa na lahat! I-click ang \\"Start session\\" button para simulan ang real-time translation. Tandaan na piliin ang Sokuji virtual microphone bilang input device sa inyong conference application."},"completion":{"title":"Tapos na ang setup guide!","content":"Natapos ninyo na ang setup guide! Ngayon, siguraduhin na talagang nalagay ninyo ang inyong API key at na-configure ang inyong mga setting, tapos gamitin ang Sokuji virtual microphone sa mga conference applications (tulad ng Google Meet, Zoom, atbp.) para simulan ang real-time translation."}}},"apiKeyValidationCompleted":"Tapos na ang pag-verify ng API key","errorValidatingApiKey":"May error sa pag-verify ng API key","sessionActiveNotice":"Nakalock ang mga setting habang aktibo ang session. Tapusin ang session para mabago ang mga setting.","realtimeModelAvailable":"Available ang realtime model","realtimeModelNotAvailable":"Hindi available ang realtime model"}')},sv:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Avbryt","save":"Spara","close":"Stng","settings":"Instllningar","help":"Hjlp","loading":"Laddar...","error":"Fel","success":"Framgng","warning":"Varning","info":"Information","logs":"Loggar","clear":"Rensa"},"app":{"title":"Sokuji","description":"Realtidsapplikation fr rstversttning"},"settings":{"title":"Instllningar","uiLanguage":"Grnssnittssprk","openaiApiKey":"OpenAI API-nyckel","provider":"Tjnsteleverantr","providerType":"Leverantr","apiKey":"API-nyckel","validate":"Validera","validating":"Validerar...","enterApiKey":"Ange din OpenAI API-nyckel","refreshModels":"Uppdatera tillgngliga modeller","loadingModels":"Laddar tillgngliga modeller...","modelsFound":"{{count}} modeller tillgngliga","experimentalFeatureTooltip":"Detta r en experimentell funktion och kan vara instabil.","help":"Hjlp","auto":"Auto","low":"Lg","medium":"Medel","high":"Hg","clientId":"Klient-ID","clientSecret":"Klienthemlighet","languageSettings":"Sprkinstllningar","voiceSettings":"Rstinstllningar","speechProcessing":"Talbehandling","silenceThreshold":"Tystnadstrskel","sentenceSplitter":"Meningdelare","enabled":"Aktiverad","translatePartialTranscriptions":"verstt Partiella Transkriptioner","queueConfiguration":"Ljudbuffertkonfiguration","desiredQueueLevel":"Mlljudbuffert","maxQueueLevel":"Maximal ljudbuffert","autoTempo":"Adaptiv Talhastighet","apiKeyValidated":"API-nyckel validerad","realtimeTranslationAvailable":"Realtidsversttningstjnst r tillgnglig"},"mainPanel":{"conversationPlaceholder":"Konversationen kommer att visas hr","pushToTalk":"tryck fr att tala (Mellanslag)","endSession":"Avsluta session","startSession":"Starta session","initializing":"Initialiserar...","apiKeyRequired":"Lgg frst till en giltig OpenAI API-nyckel i instllningarna","modelsRequired":"Modeller krvs. Vnligen validera din API-nyckel frst fr att ladda tillgngliga modeller.","modelsLoading":"Laddar tillgngliga modeller, vnligen vnta..."},"audioPanel":{"title":"Ljudinstllningar","realVoicePassthrough":"Original Audio Genomstrmning","enableRealVoicePassthrough":"Aktivera Original Audio Genomstrmning","realVoicePassthroughDescription":"Skicka ditt ursprungliga ljud (talarens rst) direkt till den virtuella mikrofonen s att lyssnarna kan hra bde det ursprungliga och versatta ljudet","realVoiceVolume":"Original Audio Volym"},"logsPanel":{"title":"Loggar"},"translation":{"start":"Starta versttning","stop":"Stoppa versttning"},"errors":{"microphoneAccess":"Mikrofontkomst nekad","networkError":"Ntverksanslutningsfel","translationFailed":"versttning misslyckades","audioError":"Ljudbehandlingsfel"},"onboarding":{"back":"Tillbaka","close":"Stng","finish":"Slutfr","next":"Nsta","nextWithProgress":"Nsta ({step}/{steps})","open":"ppna","skip":"Hoppa ver","restartTour":"Starta om installationsguiden","steps":{"welcome":{"title":"Vlkommen till Sokuji!","content":"Vlkommen till realtidsapplikationen fr rstversttning! Lt oss snabbt konfigurera ditt system fr bsta upplevelse."},"openSettings":{"title":"ppna instllningspanelen","content":"Klicka p denna knapp fr att ppna instllningspanelen, dr vi kommer att konfigurera din API-nyckel och preferenser."},"apiKey":{"title":"Konfigurera OpenAI API-nyckel","content":"Ange din OpenAI API-nyckel fr att aktivera versttningsfunktionen. Du kan f en nyckel frn <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI-plattformen</a>."},"systemInstructions":{"title":"Anpassa systeminstruktioner","content":"Lgg till specifika instruktioner hr fr att anpassa versttningsbeteendet, ssom ton, stil eller srskilda krav."},"voiceSettings":{"title":"Rstinstllningar","content":"Vlj din fredragna rstmodell och instllningar. Dessa instllningar kommer att pverka versttningens kvalitet och hastighet."},"turnDetection":{"title":"Turdetektering","content":"Konfigurera automatiska turdetekteringsinstllningar fr att kontrollera nr systemet brjar och slutar lyssna."},"audioSettings":{"title":"Ljudinstllningspanel","content":"Klicka hr fr att ppna ljudinstllningar, dr vi kommer att konfigurera dina mikrofon- och hgtalarenheter."},"microphoneSetup":{"title":"Vlj mikrofonenhet","content":"Vlj din verkliga fysiska mikrofonenhet frn listan. Undvik att vlja virtuella enheter eftersom dessa r fr konferensapplikationer."},"speakerSetup":{"title":"Monitorenhetsinstllning","content":"Vlj en monitorenhet (som hrlurar eller hgtalare) fr att hra versttningsutdata. Det rekommenderas att anvnda hrlurar fr att undvika ljudterkoppling. Om du vill fokusera p mtet utan distraktion frn vervakning kan du stnga av vervakningsfunktionen."},"startSession":{"title":"Starta din session","content":"Allt r redo! Klicka p \\"Starta session\\"-knappen fr att brja realtidsversttning. Kom ihg att vlja Sokuji virtuell mikrofon som inmatningsenhet i din konferensapplikation."},"completion":{"title":"Installationsguiden slutfrd!","content":"Du har slutfrt installationsguiden! Se nu till att du faktiskt anger din API-nyckel och konfigurerar dina instllningar, anvnd sedan Sokuji virtuell mikrofon i konferensapplikationer (som Google Meet, Zoom, etc.) fr att starta realtidsversttning."}}},"apiKeyValidationCompleted":"API-nyckel validering slutfrd","errorValidatingApiKey":"Fel vid validering av API-nyckel","sessionActiveNotice":"Instllningar r lsta nr sessionen r aktiv. Avsluta sessionen fr att ndra instllningar.","realtimeModelAvailable":"Realtidsmodell r tillgnglig","realtimeModelNotAvailable":"Realtidsmodell r inte tillgnglig"}')},ru:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"      "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":" ","openaiApiKey":"API- OpenAI","provider":" ","providerType":"","apiKey":"API-","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":"","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":" ","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":" ","silenceDuration":" ","eagerness":"","temperature":"","maxTokens":" ","saving":"...","validate":"","validating":"...","enterApiKey":"  API- OpenAI","enterCustomInstructions":"    ...","settingsSavedSuccessfully":"  ","failedToSaveSettings":"   ","validatingApiKey":" API-...","settingSavedSuccessfully":"  : {{key}}","failedToSaveSetting":"   : {{key}}","apiKeyValidationCompleted":" API- ","errorValidatingApiKey":"   API-","sessionActiveNotice":"     .  ,   .","realtimeModelAvailable":"    ","realtimeModelNotAvailable":"    ","refreshModels":"  ","loadingModels":"  ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"  ,    .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":" -","desiredQueueLevel":" -","maxQueueLevel":" -","autoTempo":"  ","apiKeyValidated":" API ","realtimeTranslationAvailable":"     "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"  ","availableMonitorDevices":"  ","loadingDevices":" ...","noDeviceSelected":"  ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"   ","virtualSpeakerNotice":"   ","iUnderstand":" ","virtualMicWarningTitle":"  ,  Sokuji.","virtualMicWarningText1":",     .           (  Google Meet, Zoom, Microsoft Teams  ..)        .","virtualMicWarningText2":"   Sokuji       .","virtualSpeakerWarningTitle":"  ,  Sokuji.","virtualSpeakerWarningText1":",       . Sokuji_Virtual_Speaker  Sokuji       .","virtualSpeakerWarningText2":"      Sokuji     ,           .","virtualSpeakerWarningText3":" \\"\\"       ,    ,      .  \\"\\"    .","virtualSpeakerWarningText4":"       (,    )  .","realVoicePassthrough":"   ","enableRealVoicePassthrough":"    ","realVoicePassthroughDescription":"    ( )    ,      ,    ","realVoiceVolume":"  "},"logsPanel":{"title":"","autoScrollOn":" ","autoScrollOff":" ","enableAutoScroll":" ","disableAutoScroll":" ","logsPlaceholder":"  ","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":" ","stop":" ","listening":"...","translating":"...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"  ","audioContent":" ","function":"","input":"","output":"","release":"","pushToTalk":"   ()","inputDeviceOff":"  ","endSession":" ","startSession":" ","initializing":"...","stopDebug":" ","debug":"","apiKeyRequired":",    API- OpenAI  ","modelsRequired":" . ,    API-    .","modelsLoading":"  ,  ..."},"errors":{"microphoneAccess":"   ","networkError":"  ","translationFailed":"  ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":" ","skip":" ","restartTour":"   ","steps":{"welcome":{"title":"   Sokuji","content":"   Sokuji!            .  !"},"settings":{"title":" 1:  ","content":"   .  ,    ,      API- OpenAI    ."},"apiKey":{"title":" 2:  API-","content":"  API- OpenAI .     ","linkText":" OpenAI","required":".     ."},"systemInstructions":{"title":" 3:  ","content":"     ,   .          ."},"voiceSettings":{"title":" 4:  ","content":"  ,      .        ."},"turnDetection":{"title":" 5:  ","content":"    ,   ,         ."},"audioSettings":{"title":" 6:  ","content":"    .  ,          ."},"microphoneSetup":{"title":" 7:  ","content":"    . ,         ."},"speakerSetup":{"title":" 8:  ","content":"           .     ,      .   ,      ,   ,             ."},"startSession":{"title":" 9:  ","content":"  \\" \\",    Sokuji.           .     ,  \\"  \\" ()  ."},"complete":{"title":"   !","content":"!          .    Sokuji, ,   API- OpenAI  ,     ,   \\"Sokuji Virtual Microphone\\"         (Google Meet, Zoom, Microsoft Teams  ..).          ."}}}}')},ta:{translation:JSON.parse('{"common":{"ok":"","cancel":" ","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"   "},"settings":{"title":"","uiLanguage":" ","openaiApiKey":"OpenAI API ","provider":" ","providerType":"","apiKey":"API ","validate":"","validating":"...","enterApiKey":" OpenAI API  ","refreshModels":"  ","loadingModels":"  ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"      .","apiKeyValidationCompleted":"API   ","errorValidatingApiKey":"API   ","sessionActiveNotice":"     .    .","realtimeModelAvailable":"  ","realtimeModelNotAvailable":"  ","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":"API  ","realtimeTranslationAvailable":"   "},"mainPanel":{"conversationPlaceholder":"  ","pushToTalk":"  (Space)","endSession":" ","startSession":" ","initializing":"...","apiKeyRequired":"   OpenAI API  ","modelsRequired":" .      API  .","modelsLoading":"  ,  ..."},"audioPanel":{"title":" ","realVoicePassthrough":"  ","enableRealVoicePassthrough":"   ","realVoicePassthroughDescription":"   ( )    ,        ","realVoiceVolume":"  "},"logsPanel":{"title":""},"translation":{"start":" ","stop":" "},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"   ","steps":{"welcome":{"title":"Sokuji- !","content":"    !      ."},"openSettings":{"title":"  ","content":" API            ."},"apiKey":{"title":"OpenAI API  ","content":"    OpenAI API  . <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI </a>  ."},"systemInstructions":{"title":"  ","content":",            ."},"voiceSettings":{"title":" ","content":"      .       ."},"turnDetection":{"title":" ","content":"            ."},"audioSettings":{"title":"  ","content":"           ."},"microphoneSetup":{"title":"  ","content":"      .        ."},"speakerSetup":{"title":"  ","content":"      (   ) .      .       ,   ."},"startSession":{"title":"  ","content":" !    \\" \\"   .      Sokuji     ."},"completion":{"title":"  !","content":"   !   API         ,       (Google Meet, Zoom ) Sokuji   ."}}}}')},te:{translation:JSON.parse('{"common":{"ok":"","cancel":" ","save":" ","close":"","settings":"","help":"","loading":" ...","error":"","success":"","warning":"","info":"","logs":"","clear":" "},"app":{"title":"Sokuji","description":"-   "},"settings":{"title":"","uiLanguage":" ","openaiApiKey":"OpenAI API ","provider":" ","providerType":"","apiKey":"API ","validate":"","validating":"...","enterApiKey":" OpenAI API   ","refreshModels":"    ","loadingModels":"    ...","modelsFound":"{{count}}   ","experimentalFeatureTooltip":"     .","apiKeyValidationCompleted":"API   ","errorValidatingApiKey":"API   ","sessionActiveNotice":"     .     .","realtimeModelAvailable":"-   ","realtimeModelNotAvailable":"-   ","help":"","auto":"","low":"","medium":"","high":"","clientId":" ID","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":"API  ","realtimeTranslationAvailable":"-    "},"mainPanel":{"conversationPlaceholder":"  ","pushToTalk":"  (Space)","endSession":" ","startSession":" ","initializing":"...","apiKeyRequired":"     OpenAI API  ","modelsRequired":" .         API  .","modelsLoading":"    ,   ..."},"audioPanel":{"title":" ","realVoicePassthrough":"  ","enableRealVoicePassthrough":"   ","realVoicePassthroughDescription":"   ( )    ,         ","realVoiceVolume":"  "},"logsPanel":{"title":""},"translation":{"start":" ","stop":" "},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"  ","steps":{"welcome":{"title":"Sokuji  !","content":"-    !        ."},"openSettings":{"title":"  ","content":" API            ."},"apiKey":{"title":"OpenAI API   ","content":"    OpenAI API   .  <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI </a>   ."},"systemInstructions":{"title":"  ","content":",            ."},"voiceSettings":{"title":" ","content":"      .         ."},"turnDetection":{"title":" ","content":"             ."},"audioSettings":{"title":"  ","content":"            ."},"microphoneSetup":{"title":"  ","content":"       .         ."},"speakerSetup":{"title":"  ","content":"     (   ) .       .        ,    ."},"startSession":{"title":"  ","content":" ! -   \\" \\"   .      Sokuji    ."},"completion":{"title":"  !","content":"    !     API        ,  -     (Google Meet, Zoom ) Sokuji   ."}}}}')},th:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":""},"settings":{"title":"","uiLanguage":"","openaiApiKey":" API OpenAI","provider":"","providerType":"","apiKey":" API","validate":"","validating":"...","enterApiKey":" API OpenAI ","refreshModels":"","loadingModels":"...","modelsFound":" {{count}} ","experimentalFeatureTooltip":"","apiKeyValidationCompleted":" API key ","errorValidatingApiKey":" API key","sessionActiveNotice":" ","realtimeModelAvailable":"","realtimeModelNotAvailable":"","help":"","auto":"","low":"","medium":"","high":"","clientId":"","clientSecret":"","languageSettings":"","voiceSettings":"","speechProcessing":"","silenceThreshold":"","sentenceSplitter":"","enabled":"","translatePartialTranscriptions":"","queueConfiguration":"","desiredQueueLevel":"","maxQueueLevel":"","autoTempo":"","apiKeyValidated":" API ","realtimeTranslationAvailable":""},"mainPanel":{"conversationPlaceholder":"","pushToTalk":" (Space)","endSession":"","startSession":"","initializing":"...","apiKeyRequired":" API OpenAI ","modelsRequired":"  API ","modelsLoading":" ..."},"audioPanel":{"title":"","realVoicePassthrough":"","enableRealVoicePassthrough":"","realVoicePassthroughDescription":" ()  ","realVoiceVolume":""},"logsPanel":{"title":""},"translation":{"start":"","stop":""},"errors":{"microphoneAccess":"","networkError":"","translationFailed":"","audioError":""},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"","steps":{"welcome":{"title":" Sokuji!","content":"! "},"openSettings":{"title":"","content":"  API key "},"apiKey":{"title":" OpenAI API key","content":" OpenAI API key   key  <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'> OpenAI</a>"},"systemInstructions":{"title":"","content":"    "},"voiceSettings":{"title":"","content":" "},"turnDetection":{"title":"","content":""},"audioSettings":{"title":"","content":" "},"microphoneSetup":{"title":"","content":" "},"speakerSetup":{"title":"","content":" ( )    "},"startSession":{"title":"","content":"!  \\"\\"   Sokuji "},"completion":{"title":"!","content":"!  API key   Sokuji  ( Google Meet, Zoom ) "}}}}')},tr:{translation:JSON.parse('{"common":{"ok":"Tamam","cancel":"ptal","save":"Kaydet","close":"Kapat","settings":"Ayarlar","help":"Yardm","loading":"Ykleniyor...","error":"Hata","success":"Baarl","warning":"Uyar","info":"Bilgi","logs":"Gnlkler","clear":"Temizle"},"app":{"title":"Sokuji","description":"Gerek zamanl ses eviri uygulamas"},"settings":{"title":"Ayarlar","uiLanguage":"Arayz dili","openaiApiKey":"OpenAI API anahtar","provider":"Hizmet salayc","providerType":"Salayc","apiKey":"API anahtar","validate":"Dorula","validating":"Dorulanyor...","enterApiKey":"OpenAI API anahtarnz girin","refreshModels":"Mevcut modelleri yenile","loadingModels":"Mevcut modeller ykleniyor...","modelsFound":"{{count}} model mevcut","experimentalFeatureTooltip":"Bu deneysel bir zelliktir ve kararsz olabilir.","apiKeyValidationCompleted":"API anahtar dorulamas tamamland","errorValidatingApiKey":"API anahtarn dorularken hata","sessionActiveNotice":"Oturum aktifken ayarlar kilitlenir. Ayarlar deitirmek iin ltfen oturumu sonlandrn.","realtimeModelAvailable":"Gerek zamanl model kullanlabilir","realtimeModelNotAvailable":"Gerek zamanl model kullanlamyor","help":"Yardm","auto":"Otomatik","low":"Dk","medium":"Orta","high":"Yksek","clientId":"stemci Kimlii","clientSecret":"stemci Srr","languageSettings":"Dil Ayarlar","voiceSettings":"Ses Ayarlar","speechProcessing":"Konuma leme","silenceThreshold":"Sessizlik Eii","sentenceSplitter":"Cmle Ayrc","enabled":"Etkin","translatePartialTranscriptions":"Ksmi Transkripsiyonlar evir","queueConfiguration":"Ses Tamponu Yaplandrmas","desiredQueueLevel":"Hedef Ses Tamponu","maxQueueLevel":"Maksimum Ses Tamponu","autoTempo":"Uyarlanabilir Konuma Hz","apiKeyValidated":"API anahtar doruland","realtimeTranslationAvailable":"Gerek zamanl eviri hizmeti mevcut"},"mainPanel":{"conversationPlaceholder":"Konuma burada grnecek","pushToTalk":"konumak iin basn (Boluk)","endSession":"Oturumu sonlandr","startSession":"Oturumu balat","initializing":"Balatlyor...","apiKeyRequired":"Ltfen nce ayarlarda geerli bir OpenAI API anahtar ekleyin","modelsRequired":"Modeller gereklidir. Mevcut modelleri yklemek iin ltfen nce API anahtarnz dorulayn.","modelsLoading":"Mevcut modeller ykleniyor, ltfen bekleyin..."},"audioPanel":{"title":"Ses Ayarlar","realVoicePassthrough":"Orijinal Ses Geii","enableRealVoicePassthrough":"Orijinal Ses Geiini Etkinletir","realVoicePassthroughDescription":"Orijinal sesinizi (konumacnn sesi) dorudan sanal mikrofona iletin, bylece dinleyiciler hem orijinal hem de evrilmi sesi duyabilir","realVoiceVolume":"Orijinal Ses Seviyesi"},"logsPanel":{"title":"Gnlkler"},"translation":{"start":"eviriyi balat","stop":"eviriyi durdur"},"errors":{"microphoneAccess":"Mikrofon eriimi reddedildi","networkError":"A balant hatas","translationFailed":"eviri baarsz","audioError":"Ses ileme hatas"},"onboarding":{"back":"Geri","close":"Kapat","finish":"Bitir","next":"leri","nextWithProgress":"leri ({step}/{steps})","open":"A","skip":"Atla","restartTour":"Kurulum klavuzunu yeniden balat","steps":{"welcome":{"title":"Sokuji\'ye ho geldiniz!","content":"Gerek zamanl ses eviri uygulamasna ho geldiniz! En iyi deneyim iin sisteminizi hzlca kuralm."},"openSettings":{"title":"Ayarlar panelini a","content":"API anahtarnz ve tercihlerinizi yaplandracamz ayarlar panelini amak iin bu dmeye tklayn."},"apiKey":{"title":"OpenAI API anahtarn ayarla","content":"eviri ilevini etkinletirmek iin OpenAI API anahtarnz girin. <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI platformundan</a> bir anahtar alabilirsiniz."},"systemInstructions":{"title":"Sistem talimatlarn zelletir","content":"Ton, stil veya zel gereksinimler gibi eviri davrann zelletirmek iin burada belirli talimatlar ekleyin."},"voiceSettings":{"title":"Ses ayarlar","content":"Tercih ettiiniz ses modelini ve ayarlar sein. Bu ayarlar evirinin kalitesini ve hzn etkileyecektir."},"turnDetection":{"title":"Sra alglama","content":"Sistemin ne zaman dinlemeye balayp durduunu kontrol etmek iin otomatik sra alglama ayarlarn yaplandrn."},"audioSettings":{"title":"Ses ayarlar paneli","content":"Mikrofon ve hoparlr cihazlarnz kuracamz ses ayarlarn amak iin buraya tklayn."},"microphoneSetup":{"title":"Mikrofon cihazn se","content":"Listeden gerek fiziksel mikrofon cihaznz sein. Sanal cihazlar semekten kann nk bunlar konferans uygulamalar iindir."},"speakerSetup":{"title":"Monitr cihaz kurulumu","content":"eviri ktsn duymak iin bir monitr cihaz (kulaklk veya hoparlr gibi) sein. Ses geri beslemesini nlemek iin kulaklk kullanlmas nerilir. Toplantya odaklanmak ve monitrleme tarafndan dikkatinizin dalmasn istemiyorsanz, monitrleme zelliini kapatabilirsiniz."},"startSession":{"title":"Oturumunuzu balatn","content":"Her ey hazr! Gerek zamanl eviriyi balatmak iin \\"Oturumu balat\\" dmesine tklayn. Konferans uygulamanzda giri cihaz olarak Sokuji sanal mikrofonunu semeyi unutmayn."},"completion":{"title":"Kurulum klavuzu tamamland!","content":"Kurulum klavuzunu tamamladnz! imdi gerekten API anahtarnz girdiinizden ve ayarlarnz yaplandrdnzdan emin olun, ardndan gerek zamanl eviriyi balatmak iin konferans uygulamalarnda (Google Meet, Zoom vb. gibi) Sokuji sanal mikrofonunu kullann."}}}}')},uk:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"      "},"settings":{"title":"","uiLanguage":" ","openaiApiKey":"API- OpenAI","provider":" ","providerType":"","apiKey":"API-","validate":"","validating":"...","enterApiKey":"  API- OpenAI","refreshModels":"  ","loadingModels":"  ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"      .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":" ","desiredQueueLevel":" ","maxQueueLevel":" ","autoTempo":"  ","apiKeyValidated":" API ","realtimeTranslationAvailable":"     "},"mainPanel":{"conversationPlaceholder":" \' ","pushToTalk":",   ()","endSession":" ","startSession":" ","initializing":"...","apiKeyRequired":" ,    API- OpenAI  ","modelsRequired":" .  ,    API-    .","modelsLoading":"  ,  , ..."},"audioPanel":{"title":" ","realVoicePassthrough":"   ","enableRealVoicePassthrough":"    ","realVoicePassthroughDescription":"    ( )    ,      ,    ","realVoiceVolume":"  "},"logsPanel":{"title":""},"translation":{"start":" ","stop":" "},"errors":{"microphoneAccess":"   ","networkError":"  \'","translationFailed":"  ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":" ","skip":" ","restartTour":"  ","steps":{"welcome":{"title":"   Sokuji","content":"   Sokuji!            . !"},"settings":{"title":" 1:  ","content":"   .  ,    ,      API- OpenAI    ."},"apiKey":{"title":" 2:  API-","content":"  API- OpenAI .     ","linkText":" OpenAI","required":".     ."},"systemInstructions":{"title":" 3:  ","content":"     ,   .          ."},"voiceSettings":{"title":" 4:  ","content":"  ,      .         ."},"turnDetection":{"title":" 5:  ","content":"    ,   ,         ."},"audioSettings":{"title":" 6:  ","content":"    .  ,          ."},"microphoneSetup":{"title":" 7:  ","content":"    . ,         ."},"speakerSetup":{"title":" 8:  ","content":"           .     ,      .   ,      ,   ,             ."},"startSession":{"title":" 9:  ","content":"  \\" \\",    Sokuji.           .     ,  \\"  \\" ()  ."},"complete":{"title":"  !","content":"!         .    Sokuji,  ,   API- OpenAI  ,     ,   \\"Sokuji Virtual Microphone\\"         (Google Meet, Zoom, Microsoft Teams ).       -   ."}}},"apiKeyValidationCompleted":" API- ","errorValidatingApiKey":"   API-","sessionActiveNotice":"     .  ,   .","realtimeModelAvailable":"    ","realtimeModelNotAvailable":"    "}')},vi:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Hy","save":"Lu","close":"ng","settings":"Ci t","help":"Tr gip","loading":"ang ti...","error":"Li","success":"Thnh cng","warning":"Cnh bo","info":"Thng tin","logs":"Nht k","clear":"Xa"},"app":{"title":"Sokuji","description":"ng dng dch ging ni thi gian thc"},"settings":{"title":"Ci t","uiLanguage":"Ngn ng giao din","openaiApiKey":"Kha API OpenAI","provider":"Nh cung cp dch v","providerType":"Nh cung cp","apiKey":"Kha API","validate":"Xc thc","validating":"ang xc thc...","enterApiKey":"Nhp kha API OpenAI ca bn","refreshModels":"Lm mi cc m hnh c sn","loadingModels":"ang ti cc m hnh c sn...","modelsFound":"{{count}} m hnh c sn","experimentalFeatureTooltip":"y l mt tnh nng th nghim v c th khng n nh.","apiKeyValidationCompleted":"Xc thc kha API hon tt","errorValidatingApiKey":"Li khi xc thc kha API","sessionActiveNotice":"Ci t b kha khi phin ang hot ng. Vui lng kt thc phin  thay i ci t.","realtimeModelAvailable":"M hnh thi gian thc c sn","realtimeModelNotAvailable":"M hnh thi gian thc khng c sn","help":"Tr gip","auto":"T ng","low":"Thp","medium":"Trung bnh","high":"Cao","clientId":"ID khch hng","clientSecret":"M b mt khch hng","languageSettings":"Ci t ngn ng","voiceSettings":"Ci t ging ni","speechProcessing":"X l ging ni","silenceThreshold":"Ngng im lng","sentenceSplitter":"B chia cu","enabled":" bt","translatePartialTranscriptions":"Dch cc bn ghi mt phn","queueConfiguration":"Cu hnh b m m thanh","desiredQueueLevel":"B m m thanh mc tiu","maxQueueLevel":"B m m thanh ti a","autoTempo":"Tc  ni thch ng","apiKeyValidated":" xc thc kha API","realtimeTranslationAvailable":"Dch v dch thut thi gian thc c sn"},"mainPanel":{"conversationPlaceholder":"Cuc tr chuyn s xut hin  y","pushToTalk":"nhn  ni (Space)","endSession":"Kt thc phin","startSession":"Bt u phin","initializing":"ang khi to...","apiKeyRequired":"Vui lng thm kha API OpenAI hp l trong ci t trc","modelsRequired":"Cn c cc m hnh. Vui lng xc thc kha API ca bn trc  ti cc m hnh c sn.","modelsLoading":"ang ti cc m hnh c sn, vui lng i..."},"audioPanel":{"title":"Ci t m thanh","realVoicePassthrough":"Truyn m Thanh Gc","enableRealVoicePassthrough":"Bt Truyn m Thanh Gc","realVoicePassthroughDescription":"Truyn m thanh gc ca bn (ging ni ca ngi ni) trc tip n microphone o  ngi nghe c th nghe c m thanh gc v m thanh  dch","realVoiceVolume":"m Lng m Thanh Gc"},"logsPanel":{"title":"Nht k"},"translation":{"start":"Bt u dch","stop":"Dng dch"},"errors":{"microphoneAccess":"Quyn truy cp microphone b t chi","networkError":"Li kt ni mng","translationFailed":"Dch tht bi","audioError":"Li x l m thanh"},"onboarding":{"back":"Quay li","close":"ng","finish":"Hon thnh","next":"Tip theo","nextWithProgress":"Tip theo ({step}/{steps})","open":"M","skip":"B qua","restartTour":"Khi ng li hng dn thit lp","steps":{"welcome":{"title":"Cho mng n vi Sokuji!","content":"Cho mng bn n vi ng dng dch ging ni thi gian thc! Hy thit lp h thng ca bn nhanh chng  c tri nghim tt nht."},"openSettings":{"title":"M bng ci t","content":"Nhp vo nt ny  m bng ci t, ni chng ta s cu hnh kha API v ty chn ca bn."},"apiKey":{"title":"Thit lp kha API OpenAI","content":"Nhp kha API OpenAI ca bn  kch hot chc nng dch. Bn c th ly kha t <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>nn tng OpenAI</a>."},"systemInstructions":{"title":"Ty chnh hng dn h thng","content":"Thm bt k hng dn c th no  y  ty chnh hnh vi dch, chng hn nh ging iu, phong cch hoc yu cu c bit."},"voiceSettings":{"title":"Ci t ging ni","content":"Chn m hnh ging ni v ci t a thch ca bn. Nhng ci t ny s nh hng n cht lng v tc  dch."},"turnDetection":{"title":"Pht hin lt","content":"Cu hnh ci t pht hin lt t ng  kim sot khi no h thng bt u v dng nghe."},"audioSettings":{"title":"Bng ci t m thanh","content":"Nhp vo y  m ci t m thanh, ni chng ta s thit lp thit b microphone v loa ca bn."},"microphoneSetup":{"title":"Chn thit b microphone","content":"Chn thit b microphone vt l thc ca bn t danh sch. Trnh chn thit b o v chng c s dng cho ng dng hi ngh."},"speakerSetup":{"title":"Thit lp thit b gim st","content":"Chn thit b gim st (nh tai nghe hoc loa)  nghe u ra dch. Khuyn ngh s dng tai nghe  trnh phn hi m thanh. Nu bn mun tp trung vo cuc hp m khng b phn tm bi gim st, bn c th tt tnh nng gim st."},"startSession":{"title":"Bt u phin ca bn","content":"Mi th  sn sng! Nhp vo nt \\"Bt u phin\\"  bt u dch thi gian thc. Nh chn microphone o Sokuji lm thit b u vo trong ng dng hi ngh ca bn."},"completion":{"title":"Hng dn thit lp hon thnh!","content":"Bn  hon thnh hng dn thit lp! By gi hy m bo thc s nhp kha API v cu hnh ci t ca bn, sau  s dng microphone o Sokuji trong ng dng hi ngh (nh Google Meet, Zoom, v.v.)  bt u dch thi gian thc."}}}}')},bn:{translation:JSON.parse('{"common":{"ok":" ","cancel":"","save":"","close":"","settings":"","help":"","loading":" ...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"-   "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":" ","openaiApiKey":"OpenAI API ","provider":" ","providerType":"","apiKey":"API ","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":" ","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":" ","silenceDuration":" ","eagerness":"","temperature":"","maxTokens":" ","saving":"  ...","validate":"","validating":"  ...","enterApiKey":" OpenAI API   ","enterCustomInstructions":"     ...","settingsSavedSuccessfully":"   ","failedToSaveSettings":"  ","validatingApiKey":"API    ...","settingSavedSuccessfully":"  : {{key}}","failedToSaveSetting":"  : {{key}}","apiKeyValidationCompleted":"API   ","errorValidatingApiKey":"API    ","refreshModels":"   ","loadingModels":"   ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"       ","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"   ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":"API    ","realtimeTranslationAvailable":"-   "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"  ","availableMonitorDevices":"  ","loadingDevices":"  ...","noDeviceSelected":"   ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"  ","virtualSpeakerNotice":"  ","iUnderstand":" ","virtualMicWarningTitle":" Sokuji     ","virtualMicWarningText1":"        , -         ( Google Meet, Zoom, Microsoft Teams, )     ","virtualMicWarningText2":"Sokuji    ,        ","virtualSpeakerWarningTitle":" Sokuji     ","virtualSpeakerWarningText1":"          Sokuji_Virtual_Speaker      Sokuji   ","virtualSpeakerWarningText2":"  Sokuji            ,          ","virtualSpeakerWarningText3":"\\"\\"          ,            \\"\\"      ","virtualSpeakerWarningText4":"  ,       (    )  ","realVoicePassthrough":"  ","enableRealVoicePassthrough":"    ","realVoicePassthroughDescription":"   ( )             ","realVoiceVolume":"  "},"logsPanel":{"title":"","autoScrollOn":"  ","autoScrollOff":"  ","enableAutoScroll":"   ","disableAutoScroll":"   ","logsPlaceholder":"   ","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":"  ","stop":"  ","listening":"...","translating":" ...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"   ","audioContent":" ","function":"","input":"","output":"","release":" ","pushToTalk":"   ()","inputDeviceOff":"  ","endSession":"  ","startSession":"  ","initializing":"  ...","stopDebug":"  ","debug":"","apiKeyRequired":"      OpenAI API   ","modelsRequired":"        API   ","modelsLoading":"   ,    ..."},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":" ","restartTour":"    ","steps":{"welcome":{"title":"Sokuji- !","content":"-    !        "},"openSettings":{"title":"  ","content":"          API     "},"apiKey":{"title":"OpenAI API   ","content":"     OpenAI API     <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI </a>     "},"systemInstructions":{"title":"   ","content":",              "},"voiceSettings":{"title":" ","content":"               "},"turnDetection":{"title":" ","content":"               "},"audioSettings":{"title":"  ","content":"              "},"microphoneSetup":{"title":"   ","content":"                  "},"speakerSetup":{"title":"  ","content":"      (   )                      ,      "},"startSession":{"title":"   ","content":" ! -    \\"  \\"          Sokuji      "},"completion":{"title":"  !","content":"    !        API        ,  -      ( Google Meet, Zoom, ) Sokuji    "}}}}')},fa:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"  ...","error":"","success":"","warning":"","info":"","logs":"","clear":" "},"app":{"title":"Sokuji","description":"   "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":"  ","openaiApiKey":" API OpenAI","provider":" ","providerType":"","apiKey":" API","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":" ","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":"","silenceDuration":" ","eagerness":"","temperature":"","maxTokens":" ","saving":"  ...","validate":"","validating":"  ...","enterApiKey":" API OpenAI    ","enterCustomInstructions":"      ...","settingsSavedSuccessfully":"    ","failedToSaveSettings":"   ","validatingApiKey":"    API...","settingSavedSuccessfully":"    : {{key}}","failedToSaveSetting":"   : {{key}}","apiKeyValidationCompleted":"  API  ","errorValidatingApiKey":"    API","sessionActiveNotice":"       .          .","realtimeModelAvailable":"     ","realtimeModelNotAvailable":"     ","refreshModels":"  ","loadingModels":"  ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"         .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":" API  ","realtimeTranslationAvailable":"     "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"  ","availableMonitorDevices":"  ","loadingDevices":" ...","noDeviceSelected":"   ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"  ","virtualSpeakerNotice":"  ","iUnderstand":" ","virtualMicWarningTitle":"       Sokuji .","virtualMicWarningText1":"      .             ( Google Meet Zoom Microsoft Teams  )        .","virtualMicWarningText2":"   Sokuji         .","virtualSpeakerWarningTitle":"       Sokuji .","virtualSpeakerWarningText1":"         . Sokuji_Virtual_Speaker  Sokuji         .","virtualSpeakerWarningText2":"      Sokuji                 .","virtualSpeakerWarningText3":" \\"\\"                        .  \\"\\"      .","virtualSpeakerWarningText4":"       (    )    .","realVoicePassthrough":"  ","enableRealVoicePassthrough":"    ","realVoicePassthroughDescription":"     ( )                ","realVoiceVolume":"  "},"logsPanel":{"title":"","autoScrollOn":"  ","autoScrollOff":"  ","enableAutoScroll":"   ","disableAutoScroll":"   ","logsPlaceholder":"     ","client":"","server":"","event":"","of":"","unknown":""},"translation":{"start":" ","stop":" ","listening":"   ...","translating":"  ...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"     ","audioContent":" ","function":"","input":"","output":"","release":" ","pushToTalk":"    (Space)","inputDeviceOff":"  ","endSession":" ","startSession":" ","initializing":"  ...","stopDebug":" ","debug":"","apiKeyRequired":"    API  OpenAI    ","modelsRequired":"   .    API         .","modelsLoading":"       ..."},"errors":{"microphoneAccess":"    ","networkError":"  ","translationFailed":"  ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":" ","skip":" ","restartTour":"   ","steps":{"welcome":{"title":" Sokuji  !","content":"      !          ."},"openSettings":{"title":"   ","content":"              API       ."},"apiKey":{"title":"  API OpenAI","content":" API OpenAI         .    <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'> OpenAI</a>  ."},"systemInstructions":{"title":"  ","content":"                 ."},"voiceSettings":{"title":" ","content":"         .          ."},"turnDetection":{"title":" ","content":"               ."},"audioSettings":{"title":"  ","content":"                   ."},"microphoneSetup":{"title":"  ","content":"         .            ."},"speakerSetup":{"title":"  ","content":"   (   )      .          .                ."},"startSession":{"title":"  ","content":"   !   \\" \\"       .        Sokuji           ."},"completion":{"title":"   !","content":"     !       API              Sokuji    ( Google Meet Zoom  )      ."}}}}')},nl:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Annuleren","save":"Opslaan","close":"Sluiten","settings":"Instellingen","help":"Help","loading":"Laden...","error":"Fout","success":"Succes","warning":"Waarschuwing","info":"Informatie","logs":"Logs","clear":"Wissen"},"app":{"title":"Sokuji","description":"Realtime spraakvertaling applicatie"},"menu":{"file":"Bestand","edit":"Bewerken","view":"Weergave","window":"Venster","help":"Help"},"settings":{"title":"Instellingen","language":"Taal","audio":"Audio","translation":"Vertaling","general":"Algemeen","uiLanguage":"Interface taal","openaiApiKey":"OpenAI API sleutel","provider":"Serviceprovider","providerType":"Provider","apiKey":"API sleutel","systemInstructions":"Systeeminstructies","voice":"Stem","automaticTurnDetection":"Automatische beurtdetectie","model":"Model","userTranscriptModel":"Gebruiker transcript model","noiseReduction":"Ruisonderdrukking","modelConfiguration":"Model configuratie","sourceLanguage":"Brontaal","targetLanguage":"Doeltaal","preview":"Voorbeeld","simple":"Eenvoudig","advanced":"Geavanceerd","normal":"Normaal","semantic":"Semantisch","disabled":"Uitgeschakeld","threshold":"Drempel","prefixPadding":"Prefix padding","silenceDuration":"Stilte duur","eagerness":"Gretigheid","temperature":"Temperatuur","maxTokens":"Maximum tokens","saving":"Opslaan...","validate":"Valideren","validating":"Valideren...","enterApiKey":"Voer uw OpenAI API sleutel in","enterCustomInstructions":"Voer aangepaste systeeminstructies hier in...","settingsSavedSuccessfully":"Instellingen succesvol opgeslagen","failedToSaveSettings":"Opslaan van instellingen mislukt","validatingApiKey":"API sleutel valideren...","settingSavedSuccessfully":"Instelling succesvol opgeslagen: {{key}}","failedToSaveSetting":"Opslaan van instelling mislukt: {{key}}","apiKeyValidationCompleted":"API-sleutel validatie voltooid","errorValidatingApiKey":"Fout bij het valideren van API-sleutel","sessionActiveNotice":"Instellingen zijn vergrendeld tijdens een actieve sessie. Beindig de sessie om instellingen te wijzigen.","realtimeModelAvailable":"Realtime model is beschikbaar","realtimeModelNotAvailable":"Realtime model is niet beschikbaar","refreshModels":"Beschikbare modellen vernieuwen","loadingModels":"Beschikbare modellen laden...","modelsFound":"{{count}} modellen beschikbaar","experimentalFeatureTooltip":"Dit is een experimentele functie en kan instabiel zijn.","help":"Help","auto":"Auto","low":"Laag","medium":"Gemiddeld","high":"Hoog","clientId":"Client-ID","clientSecret":"Clientgeheim","languageSettings":"Taalinstellingen","voiceSettings":"Spraakinstellingen","speechProcessing":"Spraakverwerking","silenceThreshold":"Stiltedrempel","sentenceSplitter":"Zinverdeler","enabled":"Ingeschakeld","translatePartialTranscriptions":"Vertaal Gedeeltelijke Transcripties","queueConfiguration":"Audiobufferconfiguratie","desiredQueueLevel":"Doel-audiobuffer","maxQueueLevel":"Maximale audiobuffer","autoTempo":"Adaptieve Spraaksnelheid","apiKeyValidated":"API-sleutel gevalideerd","realtimeTranslationAvailable":"Realtime vertaalservice is beschikbaar"},"audioPanel":{"title":"Audio instellingen","audioInputDevice":"Audio invoerapparaat","virtualSpeakerMonitorDevice":"Virtuele luidspreker monitor apparaat","availableInputDevices":"Beschikbare invoerapparaten","availableMonitorDevices":"Beschikbare monitor apparaten","loadingDevices":"Apparaten laden...","noDeviceSelected":"Geen apparaat geselecteerd","turnOn":"Inschakelen","turnOff":"Uitschakelen","refreshInputDevices":"Invoerapparaten vernieuwen","refreshMonitorDevices":"Monitor apparaten vernieuwen","virtualMicrophone":"Virtuele microfoon","virtualSpeaker":"Virtuele luidspreker","virtualMicrophoneNotice":"Virtuele microfoon kennisgeving","virtualSpeakerNotice":"Virtuele luidspreker kennisgeving","iUnderstand":"Ik begrijp het","virtualMicWarningTitle":"Dit is een virtuele microfoon gemaakt door Sokuji.","virtualMicWarningText1":"Selecteer dit apparaat hier niet. Gebruik in plaats daarvan deze virtuele microfoon in uw videoconferentie-applicaties (zoals Google Meet, Zoom, Microsoft Teams, enz.) om realtime spraakvertaling output te ontvangen.","virtualMicWarningText2":"Voor een juiste werking van Sokuji, selecteer uw echte fysieke microfoon uit de lijst.","virtualSpeakerWarningTitle":"Dit is een virtuele luidspreker gemaakt door Sokuji.","virtualSpeakerWarningText1":"Selecteer dit apparaat niet als uw monitor. De Sokuji_Virtual_Speaker wordt door Sokuji gebruikt om audio naar uw conferentie-applicaties te sturen.","virtualSpeakerWarningText2":"Het verbinden van uw monitor met Sokuji\'s output apparaat zou een audio feedback loop creren, waardoor uw input uw eigen gemonitorde output zou bevatten.","virtualSpeakerWarningText3":"De \\"Inschakelen\\" schakelaar verbindt de virtuele luidspreker met uw geselecteerde monitor apparaat, zodat u kunt horen wat naar uw conferentie-applicatie wordt gestuurd. De \\"Uitschakelen\\" schakelaar verbreekt deze monitor verbinding.","virtualSpeakerWarningText4":"Voor een juiste werking, selecteer een ander monitor apparaat (zoals uw koptelefoon of luidsprekers) uit de lijst.","realVoicePassthrough":"Originele Audio Doorvoer","enableRealVoicePassthrough":"Originele Audio Doorvoer Inschakelen","realVoicePassthroughDescription":"Geef uw originele audio (stem van de spreker) rechtstreeks door aan de virtuele microfoon zodat luisteraars zowel de originele als de vertaalde audio kunnen horen","realVoiceVolume":"Originele Audio Volume"},"logsPanel":{"title":"Logs","autoScrollOn":"Auto-scroll aan","autoScrollOff":"Auto-scroll uit","enableAutoScroll":"Auto-scroll inschakelen","disableAutoScroll":"Auto-scroll uitschakelen","logsPlaceholder":"Logs verschijnen hier","client":"client","server":"server","event":"Gebeurtenis","of":"van","unknown":"onbekend"},"translation":{"start":"Vertaling starten","stop":"Vertaling stoppen","listening":"Luisteren...","translating":"Vertalen...","sourceLanguage":"Brontaal","targetLanguage":"Doeltaal"},"mainPanel":{"conversationPlaceholder":"Gesprek verschijnt hier","audioContent":"Audio inhoud","function":"Functie","input":"Invoer","output":"Uitvoer","release":"loslaten","pushToTalk":"druk om te spreken (Spatie)","inputDeviceOff":"invoerapparaat uit","endSession":"Sessie beindigen","startSession":"Sessie starten","initializing":"Initialiseren...","stopDebug":"Debug stoppen","debug":"Debug","apiKeyRequired":"Voeg eerst een geldige OpenAI API sleutel toe in de instellingen","modelsRequired":"Modellen zijn vereist. Valideer eerst uw API-sleutel om beschikbare modellen te laden.","modelsLoading":"Beschikbare modellen laden, even geduld..."},"errors":{"microphoneAccess":"Microfoon toegang geweigerd","networkError":"Netwerkverbinding fout","translationFailed":"Vertaling mislukt","audioError":"Audio verwerkingsfout"},"onboarding":{"back":"Terug","close":"Sluiten","finish":"Voltooien","next":"Volgende","nextWithProgress":"Volgende ({step}/{steps})","open":"Openen","skip":"Overslaan","restartTour":"Setup gids opnieuw starten","steps":{"welcome":{"title":"Welkom bij Sokuji!","content":"Welkom bij de realtime spraakvertaling applicatie! Laten we uw systeem snel instellen voor de beste ervaring."},"openSettings":{"title":"Instellingen paneel openen","content":"Klik op deze knop om het instellingen paneel te openen, waar we uw API sleutel en voorkeuren zullen configureren."},"apiKey":{"title":"OpenAI API sleutel instellen","content":"Voer uw OpenAI API sleutel in om de vertaalfunctie te activeren. U kunt een sleutel verkrijgen van het <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>OpenAI platform</a>."},"systemInstructions":{"title":"Systeeminstructies aanpassen","content":"Voeg hier specifieke instructies toe om het vertaalgedrag aan te passen, zoals toon, stijl of speciale vereisten."},"voiceSettings":{"title":"Stem instellingen","content":"Kies uw gewenste stemmodel en instellingen. Deze instellingen benvloeden de kwaliteit en snelheid van de vertaling."},"turnDetection":{"title":"Beurt detectie","content":"Configureer de automatische beurt detectie instellingen om te bepalen wanneer het systeem begint en stopt met luisteren."},"audioSettings":{"title":"Audio instellingen paneel","content":"Klik hier om de audio instellingen te openen, waar we uw microfoon en luidspreker apparaten zullen instellen."},"microphoneSetup":{"title":"Microfoon apparaat selecteren","content":"Selecteer uw echte fysieke microfoon apparaat uit de lijst. Vermijd het selecteren van virtuele apparaten omdat deze voor conferentie applicaties zijn."},"speakerSetup":{"title":"Monitor apparaat instelling","content":"Selecteer een monitor apparaat (zoals koptelefoon of luidsprekers) om de vertaling output te horen. Het wordt aanbevolen om koptelefoons te gebruiken om audio feedback te vermijden. Als u zich wilt concentreren op de vergadering zonder afleiding van monitoring, kunt u de monitoring functie uitschakelen."},"startSession":{"title":"Start uw sessie","content":"Alles is klaar! Klik op de \\"Sessie starten\\" knop om realtime vertaling te beginnen. Vergeet niet om de Sokuji virtuele microfoon te selecteren als invoer apparaat in uw conferentie applicatie."},"completion":{"title":"Setup gids voltooid!","content":"U heeft de setup gids voltooid! Zorg er nu voor dat u daadwerkelijk uw API sleutel invoert en uw instellingen configureert, gebruik dan de Sokuji virtuele microfoon in conferentie applicaties (zoals Google Meet, Zoom, enz.) om realtime vertaling te starten."}}}}')},pl:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Anuluj","save":"Zapisz","close":"Zamknij","settings":"Ustawienia","help":"Pomoc","loading":"adowanie...","error":"Bd","success":"Sukces","warning":"Ostrzeenie","info":"Informacja","logs":"Logi","clear":"Wyczy"},"app":{"title":"Sokuji","description":"Aplikacja do tumaczenia mowy w czasie rzeczywistym"},"menu":{"file":"Plik","edit":"Edytuj","view":"Widok","window":"Okno","help":"Pomoc"},"settings":{"title":"Ustawienia","language":"Jzyk","audio":"Audio","translation":"Tumaczenie","general":"Oglne","uiLanguage":"Jzyk interfejsu","openaiApiKey":"Klucz API OpenAI","provider":"Dostawca usug","providerType":"Dostawca","apiKey":"Klucz API","systemInstructions":"Instrukcje systemowe","voice":"Gos","automaticTurnDetection":"Automatyczne wykrywanie kolejki","model":"Model","userTranscriptModel":"Model transkrypcji uytkownika","noiseReduction":"Redukcja szumw","modelConfiguration":"Konfiguracja modelu","sourceLanguage":"Jzyk rdowy","targetLanguage":"Jzyk docelowy","preview":"Podgld","simple":"Prosty","advanced":"Zaawansowany","normal":"Normalny","semantic":"Semantyczny","disabled":"Wyczony","threshold":"Prg","prefixPadding":"Wypenienie prefiksu","silenceDuration":"Czas trwania ciszy","eagerness":"Ch","temperature":"Temperatura","maxTokens":"Maksymalna liczba tokenw","saving":"Zapisywanie...","validate":"Sprawd","validating":"Sprawdzanie...","enterApiKey":"Wprowad swj klucz API OpenAI","enterCustomInstructions":"Wprowad niestandardowe instrukcje systemowe tutaj...","settingsSavedSuccessfully":"Ustawienia zostay pomylnie zapisane","failedToSaveSettings":"Nie udao si zapisa ustawie","validatingApiKey":"Sprawdzanie klucza API...","settingSavedSuccessfully":"Ustawienie zostao pomylnie zapisane: {{key}}","failedToSaveSetting":"Nie udao si zapisa ustawienia: {{key}}","apiKeyValidationCompleted":"Walidacja klucza API zakoczona","errorValidatingApiKey":"Bd podczas walidacji klucza API","sessionActiveNotice":"Ustawienia s zablokowane podczas aktywnej sesji. Zakocz sesj, aby zmieni ustawienia.","realtimeModelAvailable":"Model w czasie rzeczywistym jest dostpny","realtimeModelNotAvailable":"Model w czasie rzeczywistym nie jest dostpny","refreshModels":"Odwie dostpne modele","loadingModels":"adowanie dostpnych modeli...","modelsFound":"{{count}} modeli dostpnych","experimentalFeatureTooltip":"To jest funkcja eksperymentalna i moe by niestabilna.","auto":"Auto","low":"Niski","medium":"redni","high":"Wysoki","clientId":"ID Klienta","clientSecret":"Tajny Klucz Klienta","languageSettings":"Ustawienia Jzykowe","voiceSettings":"Ustawienia Gosu","speechProcessing":"Przetwarzanie Mowy","silenceThreshold":"Prg Ciszy","sentenceSplitter":"Dzielnik Zda","enabled":"Wczone","translatePartialTranscriptions":"Tumacz Czciowe Transkrypcje","queueConfiguration":"Konfiguracja Bufora Audio","desiredQueueLevel":"Docelowy Bufor Audio","maxQueueLevel":"Maksymalny Bufor Audio","autoTempo":"Adaptacyjna Szybko Mowy","apiKeyValidated":"Klucz API zweryfikowany","realtimeTranslationAvailable":"Usuga tumaczenia w czasie rzeczywistym jest dostpna"},"audioPanel":{"title":"Ustawienia audio","audioInputDevice":"Urzdzenie wejciowe audio","virtualSpeakerMonitorDevice":"Urzdzenie monitorujce wirtualnego gonika","availableInputDevices":"Dostpne urzdzenia wejciowe","availableMonitorDevices":"Dostpne urzdzenia monitorujce","loadingDevices":"adowanie urzdze...","noDeviceSelected":"Nie wybrano urzdzenia","turnOn":"Wcz","turnOff":"Wycz","refreshInputDevices":"Odwie urzdzenia wejciowe","refreshMonitorDevices":"Odwie urzdzenia monitorujce","virtualMicrophone":"Wirtualny mikrofon","virtualSpeaker":"Wirtualny gonik","virtualMicrophoneNotice":"Powiadomienie o wirtualnym mikrofonie","virtualSpeakerNotice":"Powiadomienie o wirtualnym goniku","iUnderstand":"Rozumiem","virtualMicWarningTitle":"To jest wirtualny mikrofon utworzony przez Sokuji.","virtualMicWarningText1":"Prosz nie wybiera tego urzdzenia tutaj. Zamiast tego uyj tego wirtualnego mikrofonu w swoich aplikacjach do wideokonferencji (takich jak Google Meet, Zoom, Microsoft Teams itp.), aby otrzymywa wyjcie tumaczenia mowy w czasie rzeczywistym.","virtualMicWarningText2":"Aby Sokuji dziaao prawidowo, wybierz swj prawdziwy fizyczny mikrofon z listy.","virtualSpeakerWarningTitle":"To jest wirtualny gonik utworzony przez Sokuji.","virtualSpeakerWarningText1":"Prosz nie wybiera tego urzdzenia jako monitora. Sokuji_Virtual_Speaker jest uywany przez Sokuji do wysyania dwiku do aplikacji konferencyjnych.","virtualSpeakerWarningText2":"Podczenie monitora do urzdzenia wyjciowego Sokuji utworzyoby ptl sprzenia zwrotnego audio, powodujc, e twoje wejcie zawieraoby twoje wasne monitorowane wyjcie.","virtualSpeakerWarningText3":"Przecznik \\"Wcz\\" czy wirtualny gonik z wybranym urzdzeniem monitorujcym, pozwalajc ci sysze to, co jest wysyane do aplikacji konferencyjnej. Przecznik \\"Wycz\\" rozcza to poczenie monitorujce.","virtualSpeakerWarningText4":"Dla prawidowego dziaania wybierz inne urzdzenie monitorujce (takie jak suchawki lub goniki) z listy.","realVoicePassthrough":"Przepuszczanie Oryginalnego Dwiku","enableRealVoicePassthrough":"Wcz Przepuszczanie Oryginalnego Dwiku","realVoicePassthroughDescription":"Przekazuj swj oryginalny dwik (gos mwcy) bezporednio do wirtualnego mikrofonu, aby suchacze mogli sysze zarwno oryginalny, jak i przetumaczony dwik","realVoiceVolume":"Gono Oryginalnego Dwiku"},"logsPanel":{"title":"Logi","autoScrollOn":"Auto-przewijanie wczone","autoScrollOff":"Auto-przewijanie wyczone","enableAutoScroll":"Wcz auto-przewijanie","disableAutoScroll":"Wycz auto-przewijanie","logsPlaceholder":"Logi pojawi si tutaj","client":"klient","server":"serwer","event":"Zdarzenie","of":"z","unknown":"nieznane"},"translation":{"start":"Rozpocznij tumaczenie","stop":"Zatrzymaj tumaczenie","listening":"Sucham...","translating":"Tumacz...","sourceLanguage":"Jzyk rdowy","targetLanguage":"Jzyk docelowy"},"mainPanel":{"conversationPlaceholder":"Rozmowa pojawi si tutaj","audioContent":"Zawarto audio","function":"Funkcja","input":"Wejcie","output":"Wyjcie","release":"pu","pushToTalk":"nacinij aby mwi (Spacja)","inputDeviceOff":"urzdzenie wejciowe wyczone","endSession":"Zakocz sesj","startSession":"Rozpocznij sesj","initializing":"Inicjalizacja...","stopDebug":"Zatrzymaj debugowanie","debug":"Debuguj","apiKeyRequired":"Prosz najpierw doda wany klucz API OpenAI w ustawieniach","modelsRequired":"Wymagane s modele. Prosz najpierw zweryfikowa klucz API, aby zaadowa dostpne modele.","modelsLoading":"adowanie dostpnych modeli, prosz czeka..."},"errors":{"microphoneAccess":"Dostp do mikrofonu zosta odrzucony","networkError":"Bd poczenia sieciowego","translationFailed":"Tumaczenie nie powiodo si","audioError":"Bd przetwarzania audio"},"onboarding":{"back":"Wstecz","close":"Zamknij","finish":"Zakocz","next":"Dalej","nextWithProgress":"Dalej ({step}/{steps})","open":"Otwrz","skip":"Pomi","restartTour":"Uruchom ponownie przewodnik konfiguracji","steps":{"welcome":{"title":"Witamy w Sokuji!","content":"Witamy w aplikacji do tumaczenia mowy w czasie rzeczywistym! Szybko skonfigurujmy Twj system dla najlepszego dowiadczenia."},"openSettings":{"title":"Otwrz panel ustawie","content":"Kliknij ten przycisk, aby otworzy panel ustawie, gdzie skonfigurujemy Twj klucz API i preferencje."},"apiKey":{"title":"Skonfiguruj klucz API OpenAI","content":"Wprowad swj klucz API OpenAI, aby wczy funkcj tumaczenia. Moesz uzyska klucz z <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>platformy OpenAI</a>."},"systemInstructions":{"title":"Dostosuj instrukcje systemowe","content":"Dodaj tutaj konkretne instrukcje, aby dostosowa zachowanie tumaczenia, takie jak ton, styl lub specjalne wymagania."},"voiceSettings":{"title":"Ustawienia gosu","content":"Wybierz preferowany model gosu i ustawienia. Te ustawienia wpyn na jako i szybko tumaczenia."},"turnDetection":{"title":"Wykrywanie kolejki","content":"Skonfiguruj ustawienia automatycznego wykrywania kolejki, aby kontrolowa, kiedy system zaczyna i przestaje sucha."},"audioSettings":{"title":"Panel ustawie audio","content":"Kliknij tutaj, aby otworzy ustawienia audio, gdzie skonfigurujemy Twoje urzdzenia mikrofonu i gonikw."},"microphoneSetup":{"title":"Wybierz urzdzenie mikrofonu","content":"Wybierz swoje prawdziwe fizyczne urzdzenie mikrofonu z listy. Unikaj wybierania urzdze wirtualnych, poniewa s one przeznaczone dla aplikacji konferencyjnych."},"speakerSetup":{"title":"Konfiguracja urzdzenia monitorujcego","content":"Wybierz urzdzenie monitorujce (takie jak suchawki lub goniki), aby sysze wyjcie tumaczenia. Zaleca si uywanie suchawek, aby unikn sprzenia zwrotnego audio. Jeli chcesz skupi si na spotkaniu bez rozpraszania przez monitorowanie, moesz wyczy funkcj monitorowania."},"startSession":{"title":"Rozpocznij swoj sesj","content":"Wszystko gotowe! Kliknij przycisk \\"Rozpocznij sesj\\", aby rozpocz tumaczenie w czasie rzeczywistym. Pamitaj, aby wybra wirtualny mikrofon Sokuji jako urzdzenie wejciowe w swojej aplikacji konferencyjnej."},"completion":{"title":"Przewodnik konfiguracji zakoczony!","content":"Ukoczye przewodnik konfiguracji! Teraz upewnij si, e rzeczywicie wprowadzisz swj klucz API i skonfigurujesz ustawienia, a nastpnie uyj wirtualnego mikrofonu Sokuji w aplikacjach konferencyjnych (takich jak Google Meet, Zoom itp.), aby rozpocz tumaczenie w czasie rzeczywistym."}}}}')},ms:{translation:JSON.parse('{"common":{"ok":"OK","cancel":"Batal","save":"Simpan","close":"Tutup","settings":"Tetapan","help":"Bantuan","loading":"Memuatkan...","error":"Ralat","success":"Berjaya","warning":"Amaran","info":"Maklumat","logs":"Log","clear":"Kosongkan"},"app":{"title":"Sokuji","description":"Aplikasi terjemahan suara masa nyata"},"menu":{"file":"Fail","edit":"Edit","view":"Lihat","window":"Tetingkap","help":"Bantuan"},"settings":{"title":"Tetapan","language":"Bahasa","audio":"Audio","translation":"Terjemahan","general":"Am","uiLanguage":"Bahasa antara muka","openaiApiKey":"Kunci API OpenAI","provider":"Penyedia perkhidmatan","providerType":"Penyedia","apiKey":"Kunci API","systemInstructions":"Arahan sistem","voice":"Suara","automaticTurnDetection":"Pengesanan giliran automatik","model":"Model","userTranscriptModel":"Model transkrip pengguna","noiseReduction":"Pengurangan bunyi bising","modelConfiguration":"Konfigurasi model","sourceLanguage":"Bahasa sumber","targetLanguage":"Bahasa sasaran","preview":"Pratonton","simple":"Mudah","advanced":"Lanjutan","normal":"Biasa","semantic":"Semantik","disabled":"Dilumpuhkan","threshold":"Ambang","prefixPadding":"Padding awalan","silenceDuration":"Tempoh senyap","eagerness":"Keinginan","temperature":"Suhu","maxTokens":"Token maksimum","saving":"Menyimpan...","validate":"Sahkan","validating":"Mengesahkan...","enterApiKey":"Masukkan kunci API OpenAI anda","enterCustomInstructions":"Masukkan arahan sistem tersuai di sini...","settingsSavedSuccessfully":"Tetapan berjaya disimpan","failedToSaveSettings":"Gagal menyimpan tetapan","validatingApiKey":"Mengesahkan kunci API...","settingSavedSuccessfully":"Tetapan berjaya disimpan: {{key}}","failedToSaveSetting":"Gagal menyimpan tetapan: {{key}}","apiKeyValidationCompleted":"Pengesahan kunci API selesai","errorValidatingApiKey":"Ralat semasa mengesahkan kunci API","sessionActiveNotice":"Tetapan dikunci semasa sesi aktif. Sila tamatkan sesi untuk mengubah tetapan.","realtimeModelAvailable":"Model masa nyata tersedia","realtimeModelNotAvailable":"Model masa nyata tidak tersedia","refreshModels":"Segar semula model yang tersedia","loadingModels":"Memuatkan model yang tersedia...","modelsFound":"{{count}} model tersedia","experimentalFeatureTooltip":"Ini adalah ciri eksperimen dan mungkin tidak stabil.","help":"Bantuan","auto":"Automatik","low":"Rendah","medium":"Sederhana","high":"Tinggi","clientId":"ID Pelanggan","clientSecret":"Rahsia Pelanggan","languageSettings":"Tetapan Bahasa","voiceSettings":"Tetapan Suara","speechProcessing":"Pemprosesan Pertuturan","silenceThreshold":"Ambang Senyap","sentenceSplitter":"Pemisah Ayat","enabled":"Didayakan","translatePartialTranscriptions":"Terjemah Transkripsi Separa","queueConfiguration":"Konfigurasi Penimbal Audio","desiredQueueLevel":"Penimbal Audio Sasaran","maxQueueLevel":"Penimbal Audio Maksimum","autoTempo":"Kelajuan Pertuturan Adaptif","apiKeyValidated":"Kunci API disahkan","realtimeTranslationAvailable":"Perkhidmatan terjemahan masa nyata tersedia"},"audioPanel":{"title":"Tetapan Audio","audioInputDevice":"Peranti input audio","virtualSpeakerMonitorDevice":"Peranti monitor pembesar suara maya","availableInputDevices":"Peranti input yang tersedia","availableMonitorDevices":"Peranti monitor yang tersedia","loadingDevices":"Memuatkan peranti...","noDeviceSelected":"Tiada peranti dipilih","turnOn":"Hidupkan","turnOff":"Matikan","refreshInputDevices":"Segar semula peranti input","refreshMonitorDevices":"Segar semula peranti monitor","virtualMicrophone":"Mikrofon maya","virtualSpeaker":"Pembesar suara maya","virtualMicrophoneNotice":"Notis mikrofon maya","virtualSpeakerNotice":"Notis pembesar suara maya","iUnderstand":"Saya faham","virtualMicWarningTitle":"Ini adalah mikrofon maya yang dicipta oleh Sokuji.","virtualMicWarningText1":"Sila jangan pilih peranti ini di sini. Sebaliknya, gunakan mikrofon maya ini dalam aplikasi persidangan video anda (seperti Google Meet, Zoom, Microsoft Teams, dll.) untuk menerima output terjemahan suara masa nyata.","virtualMicWarningText2":"Untuk Sokuji berfungsi dengan betul, pilih mikrofon fizikal sebenar anda dari senarai.","virtualSpeakerWarningTitle":"Ini adalah pembesar suara maya yang dicipta oleh Sokuji.","virtualSpeakerWarningText1":"Sila jangan pilih peranti ini sebagai monitor anda. Sokuji_Virtual_Speaker digunakan oleh Sokuji untuk menghantar audio ke aplikasi persidangan anda.","virtualSpeakerWarningText2":"Menyambungkan monitor anda ke peranti output Sokuji akan mencipta gelung maklum balas audio, menyebabkan input anda mengandungi output monitor anda sendiri.","virtualSpeakerWarningText3":"Suis \\"Hidupkan\\" menyambungkan pembesar suara maya ke peranti monitor pilihan anda, membolehkan anda mendengar apa yang dihantar ke aplikasi persidangan anda. Suis \\"Matikan\\" memutuskan sambungan monitor ini.","virtualSpeakerWarningText4":"Untuk operasi yang betul, pilih peranti monitor yang berbeza (seperti fon kepala atau pembesar suara anda) dari senarai.","realVoicePassthrough":"Laluan Audio Asal","enableRealVoicePassthrough":"Dayakan Laluan Audio Asal","realVoicePassthroughDescription":"Hantar audio asal anda (suara penutur) terus ke mikrofon maya supaya pendengar boleh mendengar kedua-dua audio asal dan terjemahan","realVoiceVolume":"Volum Audio Asal"},"logsPanel":{"title":"Log","autoScrollOn":"Auto-skrol hidup","autoScrollOff":"Auto-skrol mati","enableAutoScroll":"Aktifkan auto-skrol","disableAutoScroll":"Nyahaktifkan auto-skrol","logsPlaceholder":"Log akan muncul di sini","client":"klien","server":"pelayan","event":"Peristiwa","of":"daripada","unknown":"tidak diketahui"},"translation":{"start":"Mula terjemahan","stop":"Henti terjemahan","listening":"Mendengar...","translating":"Menterjemah...","sourceLanguage":"Bahasa sumber","targetLanguage":"Bahasa sasaran"},"mainPanel":{"conversationPlaceholder":"Perbualan akan muncul di sini","audioContent":"Kandungan audio","function":"Fungsi","input":"Input","output":"Output","release":"lepaskan","pushToTalk":"tekan untuk bercakap (Space)","inputDeviceOff":"peranti input mati","endSession":"Tamat sesi","startSession":"Mula sesi","initializing":"Memulakan...","stopDebug":"Henti nyahpepijat","debug":"Nyahpepijat","apiKeyRequired":"Sila tambah kunci API OpenAI yang sah dalam tetapan terlebih dahulu","modelsRequired":"Model diperlukan. Sila sahkan kunci API anda terlebih dahulu untuk memuatkan model yang tersedia.","modelsLoading":"Memuatkan model yang tersedia, sila tunggu..."},"errors":{"microphoneAccess":"Akses mikrofon ditolak","networkError":"Ralat sambungan rangkaian","translationFailed":"Terjemahan gagal","audioError":"Ralat pemprosesan audio"},"onboarding":{"back":"Kembali","close":"Tutup","finish":"Selesai","next":"Seterusnya","nextWithProgress":"Seterusnya ({step}/{steps})","open":"Buka","skip":"Langkau","restartTour":"Mula semula panduan persediaan","steps":{"welcome":{"title":"Selamat datang ke Sokuji!","content":"Selamat datang ke aplikasi terjemahan suara masa nyata! Mari kita sediakan sistem anda dengan pantas untuk pengalaman terbaik."},"openSettings":{"title":"Buka panel tetapan","content":"Klik butang ini untuk membuka panel tetapan, di mana kita akan mengkonfigurasi kunci API dan pilihan anda."},"apiKey":{"title":"Sediakan kunci API OpenAI","content":"Masukkan kunci API OpenAI anda untuk mengaktifkan fungsi terjemahan. Anda boleh mendapatkan kunci dari <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'>platform OpenAI</a>."},"systemInstructions":{"title":"Sesuaikan arahan sistem","content":"Tambahkan sebarang arahan khusus di sini untuk menyesuaikan tingkah laku terjemahan, seperti nada, gaya, atau keperluan khas."},"voiceSettings":{"title":"Tetapan suara","content":"Pilih model suara dan tetapan pilihan anda. Tetapan ini akan mempengaruhi kualiti dan kelajuan terjemahan."},"turnDetection":{"title":"Pengesanan giliran","content":"Konfigurasikan tetapan pengesanan giliran automatik untuk mengawal bila sistem mula dan berhenti mendengar."},"audioSettings":{"title":"Panel tetapan audio","content":"Klik di sini untuk membuka tetapan audio, di mana kita akan menyediakan peranti mikrofon dan pembesar suara anda."},"microphoneSetup":{"title":"Pilih peranti mikrofon","content":"Pilih peranti mikrofon fizikal sebenar anda dari senarai. Elakkan memilih peranti maya kerana ini digunakan untuk aplikasi persidangan."},"speakerSetup":{"title":"Persediaan peranti monitor","content":"Pilih peranti monitor (seperti fon kepala atau pembesar suara) untuk mendengar output terjemahan. Disyorkan menggunakan fon kepala untuk mengelakkan maklum balas audio. Jika anda ingin fokus pada mesyuarat tanpa gangguan pemantauan, anda boleh mematikan ciri pemantauan."},"startSession":{"title":"Mulakan sesi anda","content":"Semuanya sudah sedia! Klik butang \\"Mula sesi\\" untuk memulakan terjemahan masa nyata. Ingat untuk memilih mikrofon maya Sokuji sebagai peranti input dalam aplikasi persidangan anda."},"completion":{"title":"Panduan persediaan selesai!","content":"Anda telah menyelesaikan panduan persediaan! Sekarang pastikan untuk benar-benar memasukkan kunci API dan mengkonfigurasi tetapan anda, kemudian gunakan mikrofon maya Sokuji dalam aplikasi persidangan (seperti Google Meet, Zoom, dll.) untuk memulakan terjemahan masa nyata."}}}}')},he:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":"...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"    "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":" ","openaiApiKey":" API  OpenAI","provider":" ","providerType":"","apiKey":" API","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":" ","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":" ","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":" ","silenceDuration":" ","eagerness":"","temperature":"","maxTokens":" ","saving":"...","validate":"","validating":"...","enterApiKey":"   -API  OpenAI ","enterCustomInstructions":"     ...","settingsSavedSuccessfully":"  ","failedToSaveSettings":"  ","validatingApiKey":"  API...","settingSavedSuccessfully":"  : {{key}}","failedToSaveSetting":"  : {{key}}","apiKeyValidationCompleted":"  API ","errorValidatingApiKey":"   API","sessionActiveNotice":"    .       .","realtimeModelAvailable":"   ","realtimeModelNotAvailable":"    ","refreshModels":"  ","loadingModels":"  ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"      .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":"  ","desiredQueueLevel":"  ","maxQueueLevel":"  ","autoTempo":"  ","apiKeyValidated":" API ","realtimeTranslationAvailable":"    "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"  ","availableMonitorDevices":"  ","loadingDevices":" ...","noDeviceSelected":"  ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"  ","virtualSpeakerNotice":"  ","iUnderstand":" ","virtualMicWarningTitle":"      Sokuji.","virtualMicWarningText1":"     .  ,         ( Google Meet, Zoom, Microsoft Teams \')       .","virtualMicWarningText2":" -Sokuji  ,       .","virtualSpeakerWarningTitle":"      Sokuji.","virtualSpeakerWarningText1":"      . Sokuji_Virtual_Speaker   Sokuji     .","virtualSpeakerWarningText2":"      Sokuji    ,         .","virtualSpeakerWarningText3":" \\"\\"       ,         .  \\"\\"     .","virtualSpeakerWarningText4":" ,     (    ) .","realVoicePassthrough":"  ","enableRealVoicePassthrough":"   ","realVoicePassthroughDescription":"     ( )              ","realVoiceVolume":"  "},"logsPanel":{"title":"","autoScrollOn":"  ","autoScrollOff":"  ","enableAutoScroll":"  ","disableAutoScroll":"  ","logsPlaceholder":"  ","client":"","server":"","event":"","of":"","unknown":" "},"translation":{"start":" ","stop":" ","listening":"...","translating":"...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"  ","audioContent":" ","function":"","input":"","output":"","release":"","pushToTalk":"   ()","inputDeviceOff":"  ","endSession":" ","startSession":" ","initializing":"...","stopDebug":"  ","debug":" ","apiKeyRequired":"    API   OpenAI ","modelsRequired":" .      -API     .","modelsLoading":"  ,  ..."},"errors":{"microphoneAccess":"  ","networkError":"  ","translationFailed":" ","audioError":"  "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"    ","steps":{"welcome":{"title":"  -Sokuji!","content":"      !        ."},"openSettings":{"title":"  ","content":"             -API ."},"apiKey":{"title":"  API  OpenAI","content":"   -API  OpenAI     .    <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'> OpenAI</a>."},"systemInstructions":{"title":"  ","content":"         ,  ,    ."},"voiceSettings":{"title":" ","content":"      .       ."},"turnDetection":{"title":" ","content":"            ."},"audioSettings":{"title":"  ","content":"             ."},"microphoneSetup":{"title":"  ","content":"       .         ."},"speakerSetup":{"title":"  ","content":"   (   )     .       .         ,     ."},"startSession":{"title":"   ","content":" !    \\" \\"     .       Sokuji     ."},"completion":{"title":"  !","content":"   !       -API     ,      Sokuji   ( Google Meet, Zoom \')     ."}}}}')},ar:{translation:JSON.parse('{"common":{"ok":"","cancel":"","save":"","close":"","settings":"","help":"","loading":" ...","error":"","success":"","warning":"","info":"","logs":"","clear":""},"app":{"title":"Sokuji","description":"   "},"menu":{"file":"","edit":"","view":"","window":"","help":""},"settings":{"title":"","language":"","audio":"","translation":"","general":"","uiLanguage":" ","openaiApiKey":" OpenAI API","provider":" ","providerType":" ","apiKey":" API","systemInstructions":" ","voice":"","automaticTurnDetection":"  ","model":"","userTranscriptModel":"  ","noiseReduction":" ","modelConfiguration":" ","sourceLanguage":" ","targetLanguage":" ","preview":"","simple":"","advanced":"","normal":"","semantic":"","disabled":"","threshold":"","prefixPadding":" ","silenceDuration":" ","eagerness":"","temperature":" ","maxTokens":"  ","saving":" ...","validate":"","validating":" ...","enterApiKey":"  OpenAI API  ","enterCustomInstructions":"    ...","settingsSavedSuccessfully":"   ","failedToSaveSettings":"   ","validatingApiKey":"    API...","settingSavedSuccessfully":"   : {{key}}","failedToSaveSetting":"   : {{key}}","apiKeyValidationCompleted":"    API ","errorValidatingApiKey":"     API","sessionActiveNotice":"    .     .","realtimeModelAvailable":"   ","realtimeModelNotAvailable":"    ","refreshModels":"  ","loadingModels":"   ...","modelsFound":"{{count}}  ","experimentalFeatureTooltip":"      .","help":"","auto":"","low":"","medium":"","high":"","clientId":" ","clientSecret":" ","languageSettings":" ","voiceSettings":" ","speechProcessing":" ","silenceThreshold":" ","sentenceSplitter":" ","enabled":"","translatePartialTranscriptions":"  ","queueConfiguration":"   ","desiredQueueLevel":"   ","maxQueueLevel":"   ","autoTempo":"  ","apiKeyValidated":"    API","realtimeTranslationAvailable":"   "},"audioPanel":{"title":" ","audioInputDevice":"  ","virtualSpeakerMonitorDevice":"   ","availableInputDevices":"  ","availableMonitorDevices":"  ","loadingDevices":"  ...","noDeviceSelected":"   ","turnOn":"","turnOff":"","refreshInputDevices":"  ","refreshMonitorDevices":"  ","virtualMicrophone":" ","virtualSpeaker":" ","virtualMicrophoneNotice":"  ","virtualSpeakerNotice":"  ","iUnderstand":"","virtualMicWarningTitle":"      Sokuji.","virtualMicWarningText1":"     .              ( Google Meet Zoom Microsoft Teams   )     .","virtualMicWarningText2":"  Sokuji          .","virtualSpeakerWarningTitle":"      Sokuji.","virtualSpeakerWarningText1":"      .   Sokuji_Virtual_Speaker  Sokuji       .","virtualSpeakerWarningText2":"      Sokuji                 .","virtualSpeakerWarningText3":" \\"\\"                  .  \\"\\"    .","virtualSpeakerWarningText4":"      (      )  .","realVoicePassthrough":"  ","enableRealVoicePassthrough":"   ","realVoicePassthroughDescription":"   ( )             ","realVoiceVolume":"  "},"logsPanel":{"title":"","autoScrollOn":"  ","autoScrollOff":"  ","enableAutoScroll":"  ","disableAutoScroll":"  ","logsPlaceholder":"  ","client":"","server":"","event":"","of":"","unknown":" "},"translation":{"start":" ","stop":" ","listening":" ...","translating":" ...","sourceLanguage":" ","targetLanguage":" "},"mainPanel":{"conversationPlaceholder":"  ","audioContent":" ","function":"","input":"","output":"","release":"","pushToTalk":"  ()","inputDeviceOff":"  ","endSession":" ","startSession":" ","initializing":" ...","stopDebug":" ","debug":"","apiKeyRequired":"   OpenAI API    ","modelsRequired":" .      API      .","modelsLoading":"     ..."},"errors":{"microphoneAccess":"    ","networkError":"   ","translationFailed":" ","audioError":"   "},"onboarding":{"back":"","close":"","finish":"","next":"","nextWithProgress":" ({step}/{steps})","open":"","skip":"","restartTour":"   ","steps":{"welcome":{"title":"   Sokuji!","content":"      !         ."},"openSettings":{"title":"  ","content":"           API   ."},"apiKey":{"title":"  OpenAI API","content":"  OpenAI API     .      <a href=\'https://platform.openai.com/api-keys\' target=\'_blank\'> OpenAI</a>."},"systemInstructions":{"title":"  ","content":"              ."},"voiceSettings":{"title":" ","content":"     .       ."},"turnDetection":{"title":" ","content":"             ."},"audioSettings":{"title":"  ","content":"            ."},"microphoneSetup":{"title":"  ","content":"        .        ."},"speakerSetup":{"title":"  ","content":"   (    )   .        .              ."},"startSession":{"title":" ","content":"  !    \\" \\"   .    Sokuji        ."},"completion":{"title":"  !","content":"   !      API       Sokuji     ( Google Meet Zoom   )   ."}}}}')}};W.use(Ie).use(oe).init({resources:Ae,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator","htmlTag"],caches:["localStorage"]},react:{useSuspense:!1}});const Ee=W,Oe=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,((e,t,n)=>n?n.toUpperCase():t.toLowerCase())))(e);return t.charAt(0).toUpperCase()+t.slice(1)},_e=(...e)=>e.filter(((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t)).join(" ").trim(),Ne=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var Me={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Re=(0,i.forwardRef)((({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:a="",children:r,iconNode:s,...l},c)=>(0,i.createElement)("svg",{ref:c,...Me,width:t,height:t,stroke:e,strokeWidth:o?24*Number(n)/Number(t):n,className:_e("lucide",a),...!r&&!Ne(l)&&{"aria-hidden":"true"},...l},[...s.map((([e,t])=>(0,i.createElement)(e,t))),...Array.isArray(r)?r:[r]]))),je=(e,t)=>{const n=(0,i.forwardRef)((({className:n,...o},a)=>{return(0,i.createElement)(Re,{ref:a,iconNode:t,className:_e(`lucide-${r=Oe(e),r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...o});var r}));return n.displayName=Oe(e),n},De=je("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),Le=je("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),Fe=je("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ze=je("mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Ue=je("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Ve=je("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Be=je("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),qe=je("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);var Ke=n(5072),He=n.n(Ke),We=n(7825),Ge=n.n(We),$e=n(7659),Je=n.n($e),Qe=n(5056),Ye=n.n(Qe),Ze=n(540),Xe=n.n(Ze),et=n(1113),tt=n.n(et),nt=n(4648),it={};it.styleTagTransform=tt(),it.setAttributes=Ye(),it.insert=Je().bind(null,"head"),it.domAPI=Ge(),it.insertStyleElement=Xe(),He()(nt.A,it),nt.A&&nt.A.locals&&nt.A.locals;class ot{static floatTo16BitPCM(e){const t=new ArrayBuffer(2*e.length),n=new DataView(t);let i=0;for(let t=0;t<e.length;t++,i+=2){let o=Math.max(-1,Math.min(1,e[t]));n.setInt16(i,o<0?32768*o:32767*o,!0)}return t}static mergeBuffers(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}_packData(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}pack(e,t){if(!t?.bitsPerSample)throw new Error('Missing "bitsPerSample"');if(!t?.channels)throw new Error('Missing "channels"');if(!t?.data)throw new Error('Missing "data"');const{bitsPerSample:n,channels:i,data:o}=t,a=["RIFF",this._packData(1,52),"WAVE","fmt ",this._packData(1,16),this._packData(0,1),this._packData(0,i.length),this._packData(1,e),this._packData(1,e*i.length*n/8),this._packData(0,i.length*n/8),this._packData(0,n),"data",this._packData(1,i[0].length*i.length*n/8),o],r=new Blob(a,{type:"audio/mpeg"});return{blob:r,url:URL.createObjectURL(r),channelCount:i.length,sampleRate:e,duration:o.byteLength/(i.length*e*2)}}}globalThis.WavPacker=ot;const at=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],rt=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],st=[],lt=[];for(let e=1;e<=8;e++)for(let t=0;t<at.length;t++){const n=at[t];st.push(n/Math.pow(2,8-e)),lt.push(rt[t]+e)}const ct=[32,2e3],ut=st.filter(((e,t)=>st[t]>ct[0]&&st[t]<ct[1])),dt=lt.filter(((e,t)=>st[t]>ct[0]&&st[t]<ct[1]));class pt{static getFrequencies(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frequency",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-100,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-30;n||(n=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(n));const r=t/2,s=1/n.length*r;let l,c,u;if("music"===i||"voice"===i){const e="voice"===i?ut:st,t=Array(e.length).fill(o);for(let i=0;i<n.length;i++){const o=i*s,a=n[i];for(let n=e.length-1;n>=0;n--)if(o>e[n]){t[n]=Math.max(t[n],a);break}}l=t,c="voice"===i?ut:st,u="voice"===i?dt:lt}else l=Array.from(n),c=l.map(((e,t)=>s*t)),u=c.map((e=>`${e.toFixed(2)} Hz`));const d=l.map((e=>Math.max(0,Math.min((e-o)/(a-o),1))));return{values:new Float32Array(d),frequencies:c,labels:u}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.fftResults=[],t){const{length:n,sampleRate:i}=t,o=new OfflineAudioContext({length:n,sampleRate:i}),a=o.createBufferSource();a.buffer=t;const r=o.createAnalyser();r.fftSize=8192,r.smoothingTimeConstant=.1,a.connect(r);const s=1/60,l=n/i,c=e=>{const t=s*e;t<l&&o.suspend(t).then((()=>{const t=new Float32Array(r.frequencyBinCount);r.getFloatFrequencyData(t),this.fftResults.push(t),c(e+1)})),1===e?o.startRendering():o.resume()};a.start(0),c(1),this.audio=e,this.context=o,this.analyser=r,this.sampleRate=i,this.audioBuffer=t}else{const t=new AudioContext,n=t.createMediaElementSource(e),i=t.createAnalyser();i.fftSize=8192,i.smoothingTimeConstant=.1,n.connect(i),i.connect(t.destination),this.audio=e,this.context=t,this.analyser=i,this.sampleRate=this.context.sampleRate,this.audioBuffer=null}}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30,i=null;if(this.audioBuffer&&this.fftResults.length){const e=this.audio.currentTime/this.audio.duration,t=Math.min(e*this.fftResults.length|0,this.fftResults.length-1);i=this.fftResults[t]}return pt.getFrequencies(this.analyser,this.sampleRate,i,e,t,n)}async resumeIfSuspended(){return"suspended"===this.context.state&&await this.context.resume(),!0}}globalThis.AudioAnalysis=pt;const ht="undefined"!=typeof window&&void 0!==window.chrome&&void 0!==window.chrome.runtime&&"function"==typeof window.chrome.runtime.getURL?window.chrome.runtime.getURL("worklets/stream_processor_worklet.js"):new URL(n(9059),n.b).href;class gt{constructor(){let{sampleRate:e=44100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=ht,this.sampleRate=e,this.context=null,this.stream=null,this.analyser=null,this.trackSampleOffsets={},this.interruptedTrackIds={}}async connect(){this.context=new AudioContext({sampleRate:this.sampleRate}),"suspended"===this.context.state&&await this.context.resume();try{await this.context.audioWorklet.addModule(this.scriptSrc)}catch(e){throw console.error("[Sokuji] [WavStreamPlayer]",e),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const e=this.context.createAnalyser();return e.fftSize=8192,e.smoothingTimeConstant=.1,this.analyser=e,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.analyser)throw new Error("Not connected, please call .connect() first");return pt.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}_start(){const e=new AudioWorkletNode(this.context,"stream_processor");return e.connect(this.context.destination),e.port.onmessage=t=>{const{event:n}=t.data;if("stop"===n)e.disconnect(),this.stream=null;else if("offset"===n){const{requestId:e,trackId:n,offset:i}=t.data,o=i/this.sampleRate;this.trackSampleOffsets[e]={trackId:n,offset:i,currentTime:o}}},this.analyser.disconnect(),e.connect(this.analyser),this.stream=e,!0}add16BitPCM(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if("string"!=typeof n)throw new Error("trackId must be a string");if(!this.interruptedTrackIds[n]){if(this.stream||this._start(),e instanceof Int16Array)t=e;else{if(!(e instanceof ArrayBuffer))throw new Error("argument must be Int16Array or ArrayBuffer");t=new Int16Array(e)}if(1!==i){const e=t;t=new Int16Array(e.length);for(let n=0;n<e.length;n++)t[n]=Math.round(e[n]*i)}return this.stream.port.postMessage({event:"write",buffer:t,trackId:n}),t}}addImmediatePCM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.add16BitPCM(e,"immediate",t)}async getTrackSampleOffset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.stream)return null;const t=crypto.randomUUID();let n;for(this.stream.port.postMessage({event:e?"interrupt":"offset",requestId:t});!n;)n=this.trackSampleOffsets[t],await new Promise((e=>setTimeout((()=>e()),1)));const{trackId:i}=n;return e&&i&&(this.interruptedTrackIds[i]=!0),n}async interrupt(){return this.getTrackSampleOffset(!0)}}globalThis.WavStreamPlayer=gt;const mt="undefined"!=typeof window&&void 0!==window.chrome&&void 0!==window.chrome.runtime&&"function"==typeof window.chrome.runtime.getURL?window.chrome.runtime.getURL("worklets/audio_processor_worklet.js"):new URL(n(1469),n.b).href;class ft{constructor(){let{sampleRate:e=44100,outputToSpeakers:t=!1,debug:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scriptSrc=mt,this.sampleRate=e,this.outputToSpeakers=t,this.debug=!!n,this._deviceChangeCallback=null,this._devices=[],this.stream=null,this.processor=null,this.source=null,this.node=null,this.recording=!1,this._lastEventId=0,this.eventReceipts={},this.eventTimeout=5e3,this._chunkProcessor=()=>{},this._chunkProcessorSize=void 0,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this._passthroughPlayer=null,this._passthroughEnabled=!1,this._passthroughVolume=.2}setupPassthrough(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;return this._passthroughPlayer=e,this._passthroughEnabled=t,this._passthroughVolume=Math.max(0,Math.min(1,n)),this.log(`Passthrough setup: enabled=${t}, volume=${this._passthroughVolume}`),!0}setPassthroughEnabled(e){return this._passthroughEnabled=e,this.log("Passthrough "+(e?"enabled":"disabled")),!0}setPassthroughVolume(e){return this._passthroughVolume=Math.max(0,Math.min(1,e)),this.log(`Passthrough volume set to: ${this._passthroughVolume}`),!0}handlePassthrough(e){if(this._passthroughEnabled&&this._passthroughPlayer&&e.mono)try{this._passthroughPlayer.addImmediatePCM(e.mono,this._passthroughVolume)}catch(e){console.error("[Sokuji] [WavRecorder] Passthrough error:",e)}}static async decode(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const n=new AudioContext({sampleRate:arguments.length>1&&void 0!==arguments[1]?arguments[1]:44100});let i,o;if(e instanceof Blob){if(-1!==t)throw new Error('Can not specify "fromSampleRate" when reading from Blob');o=e,i=await o.arrayBuffer()}else if(e instanceof ArrayBuffer){if(-1!==t)throw new Error('Can not specify "fromSampleRate" when reading from ArrayBuffer');i=e,o=new Blob([i],{type:"audio/wav"})}else{let n,a;if(e instanceof Int16Array){a=e,n=new Float32Array(e.length);for(let t=0;t<e.length;t++)n[t]=e[t]/32768}else if(e instanceof Float32Array)n=e;else{if(!(e instanceof Array))throw new Error('"audioData" must be one of: Blob, Float32Arrray, Int16Array, ArrayBuffer, Array<number>');n=new Float32Array(e)}if(-1===t)throw new Error('Must specify "fromSampleRate" when reading from Float32Array, In16Array or Array');if(t<3e3)throw new Error('Minimum "fromSampleRate" is 3000 (3kHz)');a||(a=ot.floatTo16BitPCM(n));const r={bitsPerSample:16,channels:[n],data:a};o=(new ot).pack(t,r).blob,i=await o.arrayBuffer()}const a=await n.decodeAudioData(i),r=a.getChannelData(0);return{blob:o,url:URL.createObjectURL(o),values:r,audioBuffer:a}}log(){return this.debug&&console.log("[Sokuji] [WavRecorder]",...arguments),!0}getSampleRate(){return this.sampleRate}getStatus(){return this.processor?this.recording?"recording":"paused":"ended"}async _event(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n=n||this.processor,!n)throw new Error("Can not send events without recording first");const i={event:e,id:this._lastEventId++,data:t};n.port.postMessage(i);const o=(new Date).valueOf();for(;!this.eventReceipts[i.id];){if((new Date).valueOf()-o>this.eventTimeout)throw new Error(`Timeout waiting for "${e}" event`);await new Promise((e=>setTimeout((()=>e(!0)),1)))}const a=this.eventReceipts[i.id];return delete this.eventReceipts[i.id],a}listenForDeviceChange(e){if(null===e&&this._deviceChangeCallback)navigator.mediaDevices.removeEventListener("devicechange",this._deviceChangeCallback),this._deviceChangeCallback=null;else if(null!==e){let t=0,n=[];const i=e=>e.map((e=>e.deviceId)).sort().join(","),o=async()=>{let o=++t;const a=await this.listDevices();o===t&&i(n)!==i(a)&&(n=a,e(a.slice()))};navigator.mediaDevices.addEventListener("devicechange",o),o(),this._deviceChangeCallback=o}return!0}async requestPermission(){const e=await navigator.permissions.query({name:"microphone"});if("denied"===e.state)window.alert("You must grant microphone access to use this feature.");else if("prompt"===e.state)try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach((e=>e.stop()))}catch(e){window.alert("You must grant microphone access to use this feature.")}return!0}async listDevices(){if(!navigator.mediaDevices||!("enumerateDevices"in navigator.mediaDevices))throw new Error("Could not request user devices");await this.requestPermission();const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind)),t=e.findIndex((e=>"default"===e.deviceId)),n=[];if(-1!==t){let i=e.splice(t,1)[0],o=e.findIndex((e=>e.groupId===i.groupId));-1!==o&&(i=e.splice(o,1)[0]),i.default=!0,n.push(i)}return n.concat(e)}async begin(e){if(this.processor)throw new Error("WavRecorder: Already connected: please call .end() to start over");const t={audio:{deviceId:e?{exact:e}:void 0,sampleRate:this.sampleRate,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:1,latency:.02,suppressLocalAudioPlayback:!0,googEchoCancellation:!0,googAutoGainControl:!0,googNoiseSuppression:!0,googHighpassFilter:!0,googTypingNoiseDetection:!0,googAudioMirroring:!1}};try{const e=await navigator.mediaDevices.getUserMedia(t);this.stream=e,this.log("Got stream, setting up recording")}catch(e){return console.error("[Sokuji] [WavRecorder] Could not start audio recording",e),!1}const n=new AudioContext({sampleRate:this.sampleRate}),i=n.createMediaStreamSource(this.stream);try{await n.audioWorklet.addModule(this.scriptSrc)}catch(e){throw console.error("[Sokuji] [WavRecorder]",e),new Error(`Could not add audioWorklet module: ${this.scriptSrc}`)}const o=new AudioWorkletNode(n,"audio_processor");o.port.onmessage=e=>{const{event:t,id:n,data:i}=e.data;if("receipt"===t)this.eventReceipts[n]=i;else if("chunk"===t)if(this._chunkProcessorSize){const e=this._chunkProcessorBuffer;this._chunkProcessorBuffer={raw:ot.mergeBuffers(e.raw,i.raw),mono:ot.mergeBuffers(e.mono,i.mono)},this._chunkProcessorBuffer.mono.byteLength>=this._chunkProcessorSize&&(this.handlePassthrough(this._chunkProcessorBuffer),this._chunkProcessor(this._chunkProcessorBuffer),this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)})}else this.handlePassthrough(i),this._chunkProcessor(i)};const a=i.connect(o),r=n.createAnalyser();return r.fftSize=8192,r.smoothingTimeConstant=.1,a.connect(r),this.outputToSpeakers&&(console.warn("[Sokuji] [WavRecorder] Warning: Output to speakers may affect sound quality,\nespecially due to system audio feedback preventative measures.\nuse only for debugging"),r.connect(n.destination)),this.source=i,this.node=a,this.analyser=r,this.processor=o,!0}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frequency",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-30;if(!this.processor)throw new Error("Session ended: please call .begin() first");return pt.getFrequencies(this.analyser,this.sampleRate,null,e,t,n)}async pause(){if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!this.recording)throw new Error("Already paused: please call .record() first");return this._chunkProcessorBuffer.raw.byteLength&&(this.handlePassthrough(this._chunkProcessorBuffer),this._chunkProcessor(this._chunkProcessorBuffer)),this.log("Pausing ..."),await this._event("stop"),this.recording=!1,!0}async record(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8192;if(!this.processor)throw new Error("Session ended: please call .begin() first");if(this.recording)throw new Error("Already recording: please call .pause() first");if("function"!=typeof e)throw new Error("chunkProcessor must be a function");return this._chunkProcessor=e,this._chunkProcessorSize=t,this._chunkProcessorBuffer={raw:new ArrayBuffer(0),mono:new ArrayBuffer(0)},this.log("Recording ..."),await this._event("start"),this.recording=!0,!0}async clear(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return await this._event("clear"),!0}async read(){if(!this.processor)throw new Error("Session ended: please call .begin() first");return this.log("Reading ..."),await this._event("read")}async save(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.processor)throw new Error("Session ended: please call .begin() first");if(!e&&this.recording)throw new Error("Currently recording: please call .pause() first, or call .save(true) to force");this.log("Exporting ...");const t=await this._event("export");return(new ot).pack(this.sampleRate,t.audio)}async end(){if(!this.processor)throw new Error("Session ended: please call .begin() first");const e=this.processor;this.log("Stopping ..."),await this._event("stop"),this.recording=!1,this.stream.getTracks().forEach((e=>e.stop())),this.log("Exporting ...");const t=await this._event("export",{},e);return this.processor.disconnect(),this.source.disconnect(),this.node.disconnect(),this.analyser.disconnect(),this.stream=null,this.processor=null,this.source=null,this.node=null,(new ot).pack(this.sampleRate,t.audio)}async quit(){return this.listenForDeviceChange(null),this.processor&&await this.end(),!0}}globalThis.WavRecorder=ft;class vt{wavStreamPlayer=(()=>new gt({sampleRate:24e3}))();interruptedTrackIds={};async initialize(){}getWavStreamPlayer(){return this.wavStreamPlayer}addAudioData(e,t){this.wavStreamPlayer.add16BitPCM(e,t)}async interruptAudio(){const e=await this.wavStreamPlayer.interrupt();return e&&null!==e.trackId?(this.interruptedTrackIds[e.trackId]=!0,{trackId:e.trackId,offset:e.offset}):null}isTrackInterrupted(e){return!!this.interruptedTrackIds[e]}clearInterruptedTracks(){this.interruptedTrackIds={};try{const e=this.wavStreamPlayer;e&&"object"==typeof e.interruptedTrackIds&&(console.debug("[Sokuji] [ElectronAudio] WavStreamPlayer previous interruptedTrackIds:",e.interruptedTrackIds),e.interruptedTrackIds={},console.debug("[Sokuji] [ElectronAudio] Cleared WavStreamPlayer interruptedTrackIds"))}catch(e){console.error("[Sokuji] [ElectronAudio] Error clearing WavStreamPlayer interruptedTrackIds:",e)}}async getDevices(){try{await navigator.mediaDevices.getUserMedia({audio:!0});const e=await navigator.mediaDevices.enumerateDevices(),t=e.filter((e=>"audioinput"===e.kind)).filter((e=>"default"!==e.deviceId)).map((e=>({deviceId:e.deviceId,label:e.label||`Microphone ${e.deviceId.substring(0,5)}...`,isVirtual:e.label.toLowerCase().includes("sokuji")||e.label.toLowerCase().includes("virtual")}))),n=e.filter((e=>"audiooutput"===e.kind)).filter((e=>"default"!==e.deviceId)).map((e=>({deviceId:e.deviceId,label:e.label||`Speaker ${e.deviceId.substring(0,5)}...`,isVirtual:e.label.toLowerCase().includes("sokuji")||e.label.toLowerCase().includes("virtual")})));return{inputs:t,outputs:n}}catch(e){return console.error("[Sokuji] [ElectronAudio] Failed to get audio devices:",e),{inputs:[],outputs:[]}}}async selectInputDevice(e){return{success:!0,message:"Input device selected"}}async connectMonitoringDevice(e,t){try{const n=await window.electron.invoke("connect-virtual-speaker-to-output",{deviceId:e,label:t});return{success:n.success,message:n.message,error:n.error}}catch(e){return{success:!1,error:e.message||"Failed to connect monitoring device"}}}async disconnectMonitoringDevices(){try{const e=await window.electron.invoke("disconnect-virtual-speaker-outputs");return{success:e.success,message:e.message,error:e.error}}catch(e){return{success:!1,error:e.message||"Failed to disconnect monitoring devices"}}}async createVirtualDevices(){try{const e=await window.electron.invoke("create-virtual-speaker");return{success:e.success,message:e.message,error:e.error}}catch(e){return{success:!1,error:e.message||"Failed to create virtual devices"}}}supportsVirtualDevices(){return!0}async setupVirtualAudioOutput(e){const t=e||this.wavStreamPlayer;if(!t.context){try{await t.connect()}catch(e){return console.error("[Sokuji] [ElectronAudio] Failed to connect WavStreamPlayer:",e),!1}if(!t.context)return console.warn("[Sokuji] [ElectronAudio] Cannot setup virtual audio output: WavStreamPlayer context is not available after connecting."),!1}const n=t.context;try{const e=(await navigator.mediaDevices.enumerateDevices()).find((e=>"audiooutput"===e.kind&&e.label.toLowerCase().includes("sokuji_virtual_speaker")));if(e&&e.deviceId){const t=n;if(t&&"function"==typeof t.setSinkId)try{return await t.setSinkId(e.deviceId),console.info("[Sokuji] [ElectronAudio] AudioContext output device set to sokuji_virtual_speaker:",e.deviceId),!0}catch(e){return console.error("[Sokuji] [ElectronAudio] Failed to set output device with both methods:",e),!1}}return console.info("[Sokuji] [ElectronAudio] Virtual output device not found. Using default output device."),!1}catch(e){return console.error("[Sokuji] [ElectronAudio] Failed to set up virtual audio output:",e),!1}}}class yt extends gt{constructor(e,t){super(e),this.audioService=t}add16BitPCM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=super.add16BitPCM(e,t,n);return this.audioService.sendPcmDataToTabs(i,t),i}}class bt{externalAudioContext=null;interruptedTrackIds={};targetTabId=null;constructor(){this.wavStreamPlayer=new yt({sampleRate:24e3},this)}async initialize(){try{const e=new URLSearchParams(window.location.search).get("tabId");e&&(this.targetTabId=parseInt(e,10),console.info(`[Sokuji] [BrowserAudio] BrowserAudioService initialized with target tabId: ${this.targetTabId}`))}catch(e){console.error("[Sokuji] [BrowserAudio] Error parsing URL parameters:",e)}}async getDevices(){try{try{await navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){console.error("[Sokuji] [BrowserAudio] Microphone permission denied:",e);const t=e.name||"Error";let n="Unable to access your microphone. ";if("NotAllowedError"===t||"PermissionDeniedError"===t){let e="";chrome&&chrome.runtime&&chrome.runtime.getURL&&(e=chrome.runtime.getURL("permission.html")),n+="Please allow microphone access to use this extension. ",e&&(n+=`<a href="${e}" target="_blank" style="color: white; text-decoration: underline; font-weight: bold;">Click here</a> to grant microphone permission, or `),n+="click the camera/microphone icon in your browser address bar and grant permission."}else n+="NotFoundError"===t?"No microphone was found on your device.":"NotReadableError"===t?"Your microphone is already in use by another application.":`Error details: ${e.message||t}`;if("undefined"!=typeof window){let e=document.getElementById("sokuji-mic-error");if(!e){e=document.createElement("div"),e.id="sokuji-mic-error",e.style.cssText="position:fixed; top:10px; left:50%; transform:translateX(-50%); background:#f44336; color:white; padding:12px 24px; border-radius:4px; z-index:9999; max-width:80%; text-align:center; box-shadow:0 2px 5px rgba(0,0,0,0.3); font-family:sans-serif;";const t=document.createElement("button");t.innerHTML="&times;",t.style.cssText="background:none; border:none; color:white; font-size:20px; position:absolute; right:5px; top:5px; cursor:pointer; padding:0 5px;",t.onclick=()=>e?.remove(),e.appendChild(t),document.body.appendChild(e)}e.innerHTML=`<div>${n}</div>`,setTimeout((()=>e?.remove()),15e3)}return{inputs:[],outputs:[]}}const e=await navigator.mediaDevices.enumerateDevices(),t=e.filter((e=>"audioinput"===e.kind)).filter((e=>"default"!==e.deviceId)).map((e=>({deviceId:e.deviceId,label:e.label||`Microphone ${e.deviceId.substring(0,5)}...`,isVirtual:!1}))),n=e.filter((e=>"audiooutput"===e.kind)).filter((e=>"default"!==e.deviceId)).map((e=>({deviceId:e.deviceId,label:e.label||`Speaker ${e.deviceId.substring(0,5)}...`,isVirtual:!1})));return{inputs:t,outputs:n}}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to get audio devices:",e),{inputs:[],outputs:[]}}}async selectInputDevice(e){try{return console.info(`[Sokuji] [BrowserAudio] Selecting input device: ${e}`),{success:!0,message:"Input device selected"}}catch(e){return console.error("[Sokuji] [BrowserAudio] Error selecting input device:",e),{success:!1,error:e.message||"Failed to select input device"}}}async connectMonitoringDevice(e,t){console.info(`[Sokuji] [BrowserAudio] Connecting monitoring device: ${t} (${e})`);try{if(!this.externalAudioContext)return console.error("[Sokuji] [BrowserAudio] Cannot connect monitoring device: No external AudioContext available"),{success:!1,error:"No audio context available"};console.info(`[Sokuji] [BrowserAudio] Connecting monitoring device: ${t} (${e})`);const n=this.externalAudioContext;if(!n||"function"!=typeof n.setSinkId)return console.warn("[Sokuji] [BrowserAudio] AudioContext.setSinkId is not supported in this browser"),{success:!1,error:"setSinkId not supported in this browser"};try{return await n.setSinkId(e),console.info(`[Sokuji] [BrowserAudio] AudioContext output device set to: ${t}`),{success:!0,message:`Connected to monitoring device: ${t}`}}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to set output device:",e),{success:!1,error:e.message||"Failed to set output device"}}}catch(e){return console.error("[Sokuji] [BrowserAudio] Error connecting monitoring device:",e),{success:!1,error:e.message||"Failed to connect monitoring device"}}}async disconnectMonitoringDevices(){try{if(this.externalAudioContext){const e=this.externalAudioContext;if(e&&"function"==typeof e.setSinkId)try{await e.setSinkId({type:"none"}),console.info("[Sokuji] [BrowserAudio] AudioContext output device set back to virtual (none type)")}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to reset output device:",e),{success:!1,error:"Failed to reset output device"}}}return{success:!0,message:"Disconnected from all monitoring devices"}}catch(e){return{success:!1,error:e.message||"Failed to disconnect monitoring devices"}}}async createVirtualDevices(){return{success:!0,message:"Created virtual audio processing pipeline using Web Audio API"}}supportsVirtualDevices(){return!1}async setupVirtualAudioOutput(e){const t=e||this.wavStreamPlayer;if(!t.context){try{await t.connect()}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to connect WavStreamPlayer:",e),!1}if(!t.context)return console.warn("[Sokuji] [BrowserAudio] Cannot setup virtual audio output: WavStreamPlayer context is not available after connecting."),!1}const n=t.context;try{this.externalAudioContext=n;const e=n;if(!e||"function"!=typeof e.setSinkId)return console.warn("[Sokuji] [BrowserAudio] AudioContext.setSinkId is not supported in this browser"),!1;try{await e.setSinkId({type:"none"}),console.info("[Sokuji] [BrowserAudio] AudioContext output device set to virtual (none type)")}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to set output device:",e),!1}return console.info("[Sokuji] [BrowserAudio] Virtual audio output setup complete. Audio data will be sent directly from addAudioData."),!0}catch(e){return console.error("[Sokuji] [BrowserAudio] Failed to set up virtual audio output:",e),!1}}getWavStreamPlayer(){return this.wavStreamPlayer}addAudioData(e,t){this.wavStreamPlayer.add16BitPCM(e,t)}sendPcmDataToTabs(e,t){if(!e||0===e.length)return void console.info("[Sokuji] [BrowserAudio] Attempted to send empty audio data");const n=this.wavStreamPlayer?.sampleRate||24e3,i=e.length>48e3,o=i?4800:9600,a=Math.ceil(e.length/o);i&&console.info(`[Sokuji] [BrowserAudio] Sending audio data (${e.length} samples, ~${(e.length/n).toFixed(2)}s) in ${a} chunks`);const r=i=>{const s=i*o,l=Math.min(s+o,e.length),c=e.slice(s,l),u={type:"PCM_DATA",pcmData:Array.from(c),chunkIndex:i,totalChunks:a,sampleRate:n,trackId:t||"default",timestamp:Date.now()};this.sendMessageToTabs(u),i<a-1&&r(i+1)};r(0)}sendMessageToTabs(e){"undefined"!=typeof chrome&&chrome.tabs&&chrome.tabs.query&&(null===this.targetTabId?this.sendToAllTabs(e):this.sendMessageToTab(this.targetTabId,e))}sendMessageToTab(e,t){chrome.tabs.get(e,(n=>{chrome.runtime.lastError?this.sendToAllTabs(t):n?chrome.tabs.sendMessage(e,t,(t=>{chrome.runtime.lastError&&console.warn(`[Sokuji] [BrowserAudio] Error sending to tab ${e}: ${chrome.runtime.lastError.message}`)})):this.sendToAllTabs(t)}))}sendToAllTabs(e){chrome.tabs.query({},(t=>{if(!chrome.runtime.lastError&&t&&0!==t.length)for(const n of t)!n.url||n.url.startsWith("chrome://")||n.url.startsWith("chrome-extension://")||chrome.tabs.sendMessage(n.id,e,(e=>{chrome.runtime.lastError&&console.debug(`[Sokuji] [BrowserAudio] Tab ${n.id} not ready: ${chrome.runtime.lastError.message}`)}))}))}async interruptAudio(){const e=await this.wavStreamPlayer.interrupt();return e&&null!==e.trackId?(this.interruptedTrackIds[e.trackId]=!0,{trackId:e.trackId,offset:e.offset}):null}isTrackInterrupted(e){return!!this.interruptedTrackIds[e]}clearInterruptedTracks(){this.interruptedTrackIds={};try{const e=this.wavStreamPlayer;e&&"object"==typeof e.interruptedTrackIds&&(e.interruptedTrackIds={},console.debug("[Sokuji] [BrowserAudio] Cleared WavStreamPlayer interruptedTrackIds"))}catch(e){console.error("[Sokuji] [BrowserAudio] Error clearing WavStreamPlayer interruptedTrackIds:",e)}}}const kt=globalThis.atob,St=globalThis.btoa;class wt{static floatTo16BitPCM(e){const t=new ArrayBuffer(2*e.length),n=new DataView(t);let i=0;for(let t=0;t<e.length;t++,i+=2){let o=Math.max(-1,Math.min(1,e[t]));n.setInt16(i,o<0?32768*o:32767*o,!0)}return t}static base64ToArrayBuffer(e){const t=kt(e),n=t.length,i=new Uint8Array(n);for(let e=0;e<n;e++)i[e]=t.charCodeAt(e);return i.buffer}static arrayBufferToBase64(e){e instanceof Float32Array?e=this.floatTo16BitPCM(e):e instanceof Int16Array&&(e=e.buffer);let t="",n=new Uint8Array(e);for(let e=0;e<n.length;e+=32768){let i=n.subarray(e,e+32768);t+=String.fromCharCode.apply(null,i)}return St(t)}static mergeInt16Arrays(e,t){if(e instanceof ArrayBuffer&&(e=new Int16Array(e)),t instanceof ArrayBuffer&&(t=new Int16Array(t)),!(e instanceof Int16Array&&t instanceof Int16Array))throw new Error("Both items must be Int16Array");const n=new Int16Array(e.length+t.length);for(let t=0;t<e.length;t++)n[t]=e[t];for(let i=0;i<t.length;i++)n[e.length+i]=t[i];return n}static generateId(e,t=21){return`${e}${Array(t-e.length).fill(0).map((e=>"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[Math.floor(58*Math.random())])).join("")}`}}const Tt=e=>new Promise((t=>setTimeout((()=>t()),e)));class Ct{constructor(){this.eventHandlers={},this.nextEventHandlers={}}clearEventHandlers(){return this.eventHandlers={},this.nextEventHandlers={},!0}on(e,t){return this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t),t}onNext(e,t){return this.nextEventHandlers[e]=this.nextEventHandlers[e]||[],this.nextEventHandlers[e].push(t),t}off(e,t){const n=this.eventHandlers[e]||[];if(t){const i=n.indexOf(t);if(-1===i)throw new Error(`Could not turn off specified event listener for "${e}": not found as a listener`);n.splice(i,1)}else delete this.eventHandlers[e];return!0}offNext(e,t){const n=this.nextEventHandlers[e]||[];if(t){const i=n.indexOf(t);if(-1===i)throw new Error(`Could not turn off specified next event listener for "${e}": not found as a listener`);n.splice(i,1)}else delete this.nextEventHandlers[e];return!0}async waitForNext(e,t=null){const n=Date.now();let i;for(this.onNext(e,(e=>i=e));!i;){if(t&&Date.now()-n>t)return null;await Tt(1)}return i}dispatch(e,t){const n=[].concat(this.eventHandlers[e]||[]);for(const e of n)e(t);const i=[].concat(this.nextEventHandlers[e]||[]);for(const e of i)e(t);return delete this.nextEventHandlers[e],!0}}class Pt extends Ct{constructor({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}={}){if(super(),this.defaultUrl="wss://api.openai.com/v1/realtime",this.url=e||this.defaultUrl,this.apiKey=t||null,this.debug=!!i,this.ws=null,globalThis.document&&this.apiKey&&!n)throw new Error('Can not provide API key in the browser without "dangerouslyAllowAPIKeyInBrowser" set to true')}isConnected(){return!!this.ws}log(...e){const t=[`[Websocket/${(new Date).toISOString()}]`].concat(e).map((e=>"object"==typeof e&&null!==e?JSON.stringify(e,null,2):e));return this.debug&&console.log(...t),!0}async connect({model:e}={model:"gpt-4o-realtime-preview-2024-10-01"}){if(this.apiKey||this.url!==this.defaultUrl||console.warn(`No apiKey provided for connection to "${this.url}"`),this.isConnected())throw new Error("Already connected");if(globalThis.WebSocket){globalThis.document&&this.apiKey&&console.warn("Warning: Connecting using API key in the browser, this is not recommended");const t=new(0,globalThis.WebSocket)(`${this.url}${e?`?model=${e}`:""}`,["realtime",`openai-insecure-api-key.${this.apiKey}`,"openai-beta.realtime-v1"]);return t.addEventListener("message",(e=>{const t=JSON.parse(e.data);this.receive(t.type,t)})),new Promise(((e,n)=>{const i=()=>{this.disconnect(t),n(new Error(`Could not connect to "${this.url}"`))};t.addEventListener("error",i),t.addEventListener("open",(()=>{this.log(`Connected to "${this.url}"`),t.removeEventListener("error",i),t.addEventListener("error",(()=>{this.disconnect(t),this.log(`Error, disconnected from "${this.url}"`),this.dispatch("close",{error:!0})})),t.addEventListener("close",(()=>{this.disconnect(t),this.log(`Disconnected from "${this.url}"`),this.dispatch("close",{error:!1})})),this.ws=t,e(!0)}))}))}{const e="ws",t=new(0,(await import(e)).default)("wss://api.openai.com/v1/realtime?model=gpt-4o-realtime-preview-2024-10-01",[],{finishRequest:e=>{e.setHeader("Authorization",`Bearer ${this.apiKey}`),e.setHeader("OpenAI-Beta","realtime=v1"),e.end()}});return t.on("message",(e=>{const t=JSON.parse(e.toString());this.receive(t.type,t)})),new Promise(((e,n)=>{const i=()=>{this.disconnect(t),n(new Error(`Could not connect to "${this.url}"`))};t.on("error",i),t.on("open",(()=>{this.log(`Connected to "${this.url}"`),t.removeListener("error",i),t.on("error",(()=>{this.disconnect(t),this.log(`Error, disconnected from "${this.url}"`),this.dispatch("close",{error:!0})})),t.on("close",(()=>{this.disconnect(t),this.log(`Disconnected from "${this.url}"`),this.dispatch("close",{error:!1})})),this.ws=t,e(!0)}))}))}}disconnect(e){if(!e||this.ws===e)return this.ws&&this.ws.close(),this.ws=null,!0}receive(e,t){return this.log("received:",e,t),this.dispatch(`server.${e}`,t),this.dispatch("server.*",t),!0}send(e,t){if(!this.isConnected())throw new Error("RealtimeAPI is not connected");if("object"!=typeof(t=t||{}))throw new Error("data must be an object");const n={event_id:wt.generateId("evt_"),type:e,...t};return this.dispatch(`client.${e}`,n),this.dispatch("client.*",n),this.log("sent:",e,n),this.ws.send(JSON.stringify(n)),!0}}class xt{defaultFrequency=24e3;EventProcessors={"conversation.item.created":e=>{const{item:t}=e,n=JSON.parse(JSON.stringify(t));if(this.itemLookup[n.id]||(this.itemLookup[n.id]=n,this.items.push(n)),n.formatted={},n.formatted.audio=new Int16Array(0),n.formatted.text="",n.formatted.transcript="",this.queuedSpeechItems[n.id]&&(n.formatted.audio=this.queuedSpeechItems[n.id].audio,delete this.queuedSpeechItems[n.id]),n.content){const e=n.content.filter((e=>["text","input_text"].includes(e.type)));for(const t of e)n.formatted.text+=t.text}return this.queuedTranscriptItems[n.id]&&(n.formatted.transcript=this.queuedTranscriptItems.transcript,delete this.queuedTranscriptItems[n.id]),"message"===n.type?"user"===n.role?(n.status="completed",this.queuedInputAudio&&(n.formatted.audio=this.queuedInputAudio,this.queuedInputAudio=null)):n.status="in_progress":"function_call"===n.type?(n.formatted.tool={type:"function",name:n.name,call_id:n.call_id,arguments:""},n.status="in_progress"):"function_call_output"===n.type&&(n.status="completed",n.formatted.output=n.output),{item:n,delta:null}},"conversation.item.truncated":e=>{const{item_id:t,audio_end_ms:n}=e,i=this.itemLookup[t];if(!i)throw new Error(`item.truncated: Item "${t}" not found`);const o=Math.floor(n*this.defaultFrequency/1e3);return i.formatted.transcript="",i.formatted.audio=i.formatted.audio.slice(0,o),{item:i,delta:null}},"conversation.item.deleted":e=>{const{item_id:t}=e,n=this.itemLookup[t];if(!n)throw new Error(`item.deleted: Item "${t}" not found`);delete this.itemLookup[n.id];const i=this.items.indexOf(n);return i>-1&&this.items.splice(i,1),{item:n,delta:null}},"conversation.item.input_audio_transcription.completed":e=>{const{item_id:t,content_index:n,transcript:i}=e,o=this.itemLookup[t],a=i||" ";return o?(o.content[n].transcript=i,o.formatted.transcript=a,{item:o,delta:{transcript:i}}):(this.queuedTranscriptItems[t]={transcript:a},{item:null,delta:null})},"input_audio_buffer.speech_started":e=>{const{item_id:t,audio_start_ms:n}=e;return this.queuedSpeechItems[t]={audio_start_ms:n},{item:null,delta:null}},"input_audio_buffer.speech_stopped":(e,t)=>{const{item_id:n,audio_end_ms:i}=e;this.queuedSpeechItems[n]||(this.queuedSpeechItems[n]={audio_start_ms:i});const o=this.queuedSpeechItems[n];if(o.audio_end_ms=i,t){const e=Math.floor(o.audio_start_ms*this.defaultFrequency/1e3),n=Math.floor(o.audio_end_ms*this.defaultFrequency/1e3);o.audio=t.slice(e,n)}return{item:null,delta:null}},"response.created":e=>{const{response:t}=e;return this.responseLookup[t.id]||(this.responseLookup[t.id]=t,this.responses.push(t)),{item:null,delta:null}},"response.output_item.added":e=>{const{response_id:t,item:n}=e,i=this.responseLookup[t];if(!i)throw new Error(`response.output_item.added: Response "${t}" not found`);return i.output.push(n.id),{item:null,delta:null}},"response.output_item.done":e=>{const{item:t}=e;if(!t)throw new Error('response.output_item.done: Missing "item"');const n=this.itemLookup[t.id];if(!n)throw new Error(`response.output_item.done: Item "${t.id}" not found`);return n.status=t.status,{item:n,delta:null}},"response.content_part.added":e=>{const{item_id:t,part:n}=e,i=this.itemLookup[t];if(!i)throw new Error(`response.content_part.added: Item "${t}" not found`);return i.content.push(n),{item:i,delta:null}},"response.audio_transcript.delta":e=>{const{item_id:t,content_index:n,delta:i}=e,o=this.itemLookup[t];if(!o)throw new Error(`response.audio_transcript.delta: Item "${t}" not found`);return o.content[n].transcript+=i,o.formatted.transcript+=i,{item:o,delta:{transcript:i}}},"response.audio.delta":e=>{const{item_id:t,content_index:n,delta:i}=e,o=this.itemLookup[t];if(!o)throw new Error(`response.audio.delta: Item "${t}" not found`);const a=wt.base64ToArrayBuffer(i),r=new Int16Array(a);return o.formatted.audio=wt.mergeInt16Arrays(o.formatted.audio,r),{item:o,delta:{audio:r}}},"response.text.delta":e=>{const{item_id:t,content_index:n,delta:i}=e,o=this.itemLookup[t];if(!o)throw new Error(`response.text.delta: Item "${t}" not found`);return o.content[n].text+=i,o.formatted.text+=i,{item:o,delta:{text:i}}},"response.function_call_arguments.delta":e=>{const{item_id:t,delta:n}=e,i=this.itemLookup[t];if(!i)throw new Error(`response.function_call_arguments.delta: Item "${t}" not found`);return i.arguments+=n,i.formatted.tool.arguments+=n,{item:i,delta:{arguments:n}}}};constructor(){this.clear()}clear(){return this.itemLookup={},this.items=[],this.responseLookup={},this.responses=[],this.queuedSpeechItems={},this.queuedTranscriptItems={},this.queuedInputAudio=null,!0}queueInputAudio(e){return this.queuedInputAudio=e,e}processEvent(e,...t){if(!e.event_id)throw console.error(e),new Error('Missing "event_id" on event');if(!e.type)throw console.error(e),new Error('Missing "type" on event');const n=this.EventProcessors[e.type];if(!n)throw new Error(`Missing conversation event processor for "${e.type}"`);return n.call(this,e,...t)}getItem(e){return this.itemLookup[e]||null}getItems(){return this.items.slice()}}class It extends Ct{constructor({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}={}){super(),this.defaultSessionConfig={modalities:["text","audio"],instructions:"",voice:"verse",input_audio_format:"pcm16",output_audio_format:"pcm16",input_audio_transcription:null,turn_detection:null,tools:[],tool_choice:"auto",temperature:.8,max_response_output_tokens:4096},this.sessionConfig={},this.transcriptionModels=[{model:"whisper-1"}],this.defaultServerVadConfig={type:"server_vad",threshold:.5,prefix_padding_ms:300,silence_duration_ms:200},this.realtime=new Pt({url:e,apiKey:t,dangerouslyAllowAPIKeyInBrowser:n,debug:i}),this.conversation=new xt,this._resetConfig(),this._addAPIEventHandlers()}_resetConfig(){return this.sessionCreated=!1,this.tools={},this.sessionConfig=JSON.parse(JSON.stringify(this.defaultSessionConfig)),this.inputAudioBuffer=new Int16Array(0),!0}_addAPIEventHandlers(){this.realtime.on("client.*",(e=>{const t={time:(new Date).toISOString(),source:"client",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.*",(e=>{const t={time:(new Date).toISOString(),source:"server",event:e};this.dispatch("realtime.event",t)})),this.realtime.on("server.session.created",(()=>this.sessionCreated=!0));const e=(e,...t)=>{const{item:n,delta:i}=this.conversation.processEvent(e,...t);return{item:n,delta:i}},t=(t,...n)=>{const{item:i,delta:o}=e(t,...n);return i&&this.dispatch("conversation.updated",{item:i,delta:o}),{item:i,delta:o}},n=async e=>{try{const t=JSON.parse(e.arguments),n=this.tools[e.name];if(!n)throw new Error(`Tool "${e.name}" has not been added`);const i=await n.handler(t);this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify(i)}})}catch(t){this.realtime.send("conversation.item.create",{item:{type:"function_call_output",call_id:e.call_id,output:JSON.stringify({error:t.message})}})}this.createResponse()};return this.realtime.on("server.response.created",e),this.realtime.on("server.response.output_item.added",e),this.realtime.on("server.response.content_part.added",e),this.realtime.on("server.input_audio_buffer.speech_started",(t=>{e(t),this.dispatch("conversation.interrupted")})),this.realtime.on("server.input_audio_buffer.speech_stopped",(t=>e(t,this.inputAudioBuffer))),this.realtime.on("server.conversation.item.created",(e=>{const{item:n}=t(e);this.dispatch("conversation.item.appended",{item:n}),"completed"===n.status&&this.dispatch("conversation.item.completed",{item:n})})),this.realtime.on("server.conversation.item.truncated",t),this.realtime.on("server.conversation.item.deleted",t),this.realtime.on("server.conversation.item.input_audio_transcription.completed",t),this.realtime.on("server.response.audio_transcript.delta",t),this.realtime.on("server.response.audio.delta",t),this.realtime.on("server.response.text.delta",t),this.realtime.on("server.response.function_call_arguments.delta",t),this.realtime.on("server.response.output_item.done",(async e=>{const{item:i}=t(e);"completed"===i.status&&this.dispatch("conversation.item.completed",{item:i}),i.formatted.tool&&n(i.formatted.tool)})),!0}isConnected(){return this.realtime.isConnected()}reset(){return this.disconnect(),this.clearEventHandlers(),this.realtime.clearEventHandlers(),this._resetConfig(),this._addAPIEventHandlers(),!0}async connect(){if(this.isConnected())throw new Error("Already connected, use .disconnect() first");return await this.realtime.connect(),this.updateSession(),!0}async waitForSessionCreated(){if(!this.isConnected())throw new Error("Not connected, use .connect() first");for(;!this.sessionCreated;)await new Promise((e=>setTimeout((()=>e()),1)));return!0}disconnect(){this.sessionCreated=!1,this.realtime.isConnected()&&this.realtime.disconnect(),this.conversation.clear()}getTurnDetectionType(){return this.sessionConfig.turn_detection?.type||null}addTool(e,t){if(!e?.name)throw new Error("Missing tool name in definition");const n=e?.name;if(this.tools[n])throw new Error(`Tool "${n}" already added. Please use .removeTool("${n}") before trying to add again.`);if("function"!=typeof t)throw new Error(`Tool "${n}" handler must be a function`);return this.tools[n]={definition:e,handler:t},this.updateSession(),this.tools[n]}removeTool(e){if(!this.tools[e])throw new Error(`Tool "${e}" does not exist, can not be removed.`);return delete this.tools[e],!0}deleteItem(e){return this.realtime.send("conversation.item.delete",{item_id:e}),!0}updateSession({modalities:e,instructions:t,voice:n,input_audio_format:i,output_audio_format:o,input_audio_transcription:a,turn_detection:r,tools:s,tool_choice:l,temperature:c,max_response_output_tokens:u}={}){void 0!==e&&(this.sessionConfig.modalities=e),void 0!==t&&(this.sessionConfig.instructions=t),void 0!==n&&(this.sessionConfig.voice=n),void 0!==i&&(this.sessionConfig.input_audio_format=i),void 0!==o&&(this.sessionConfig.output_audio_format=o),void 0!==a&&(this.sessionConfig.input_audio_transcription=a),void 0!==r&&(this.sessionConfig.turn_detection=r),void 0!==s&&(this.sessionConfig.tools=s),void 0!==l&&(this.sessionConfig.tool_choice=l),void 0!==c&&(this.sessionConfig.temperature=c),void 0!==u&&(this.sessionConfig.max_response_output_tokens=u);const d=[].concat((s||[]).map((e=>{const t={type:"function",...e};if(this.tools[t?.name])throw new Error(`Tool "${t?.name}" has already been defined`);return t})),Object.keys(this.tools).map((e=>({type:"function",...this.tools[e].definition})))),p={...this.sessionConfig};return p.tools=d,this.realtime.isConnected()&&this.realtime.send("session.update",{session:p}),!0}sendUserMessageContent(e=[]){if(e.length){for(const t of e)"input_audio"===t.type&&(t.audio instanceof ArrayBuffer||t.audio instanceof Int16Array)&&(t.audio=wt.arrayBufferToBase64(t.audio));this.realtime.send("conversation.item.create",{item:{type:"message",role:"user",content:e}})}return this.createResponse(),!0}appendInputAudio(e){return e.byteLength>0&&(this.realtime.send("input_audio_buffer.append",{audio:wt.arrayBufferToBase64(e)}),this.inputAudioBuffer=wt.mergeInt16Arrays(this.inputAudioBuffer,e)),!0}createResponse(){return null===this.getTurnDetectionType()&&this.inputAudioBuffer.byteLength>0&&(this.realtime.send("input_audio_buffer.commit"),this.conversation.queueInputAudio(this.inputAudioBuffer),this.inputAudioBuffer=new Int16Array(0)),this.realtime.send("response.create"),!0}cancelResponse(e,t=0){if(!e)return this.realtime.send("response.cancel"),{item:null};if(e){const n=this.conversation.getItem(e);if(!n)throw new Error(`Could not find item "${e}"`);if("message"!==n.type)throw new Error('Can only cancelResponse messages with type "message"');if("assistant"!==n.role)throw new Error('Can only cancelResponse messages with role "assistant"');this.realtime.send("response.cancel");const i=n.content.findIndex((e=>"audio"===e.type));if(-1===i)throw new Error("Could not find audio on item to cancel");return this.realtime.send("conversation.item.truncate",{item_id:e,content_index:i,audio_end_ms:Math.floor(t/this.conversation.defaultFrequency*1e3)}),{item:n}}}async waitForNextItem(){const e=await this.waitForNext("conversation.item.appended"),{item:t}=e;return{item:t}}async waitForNextCompletedItem(){const e=await this.waitForNext("conversation.item.completed"),{item:t}=e;return{item:t}}}let At=function(e){return e.OPENAI="openai",e.GEMINI="gemini",e.COMET_API="cometapi",e.PALABRA_AI="palabraai",e}({});const Et=[At.OPENAI,At.GEMINI,At.COMET_API,At.PALABRA_AI],Ot=[At.OPENAI,At.COMET_API];function _t(e){return Ot.includes(e)}class Nt{static DEFAULT_API_HOST="https://api.openai.com";eventHandlers={};constructor(e,t){this.apiKey=e,this.apiHost=t||Nt.DEFAULT_API_HOST,this.apiHost=this.apiHost.replace(/\/$/,""),this.client=new It({apiKey:e,dangerouslyAllowAPIKeyInBrowser:!0,url:`${this.apiHost}/v1/realtime`}),this.setupEventListeners()}static async validateApiKeyAndFetchModels(e,t){try{if(!e||""===e.trim())return{validation:{valid:!1,message:Ee.t("settings.errorValidatingApiKey"),validating:!1},models:[]};const n=`${(t||this.DEFAULT_API_HOST).replace(/\/$/,"")}/v1/models`,i=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(console.info("[Sokuji] [OpenAIClient] Validation response:",i),!i.ok){const e=await i.json().catch((()=>({})));return{validation:{valid:!1,message:e.error?.message||Ee.t("settings.errorValidatingApiKey"),validating:!1},models:[]}}const o=(await i.json()).data||[],a=this.checkRealtimeModelAvailability(o);console.info("[Sokuji] [OpenAIClient] Available models:",o),console.info("[Sokuji] [OpenAIClient] Has realtime model:",a);const r=this.filterRelevantModels(o);return{validation:this.buildValidationResult(a),models:r}}catch(e){return console.error("[Sokuji] [OpenAIClient] API key validation error:",e),{validation:{valid:!1,message:e.message||Ee.t("settings.errorValidatingApiKey"),validating:!1},models:[]}}}static getLatestRealtimeModel(e){const t=e.filter((e=>"realtime"===e.type));return t.length>0?t[0].id:"gpt-4o-mini-realtime-preview"}static checkRealtimeModelAvailability(e){return e.some((e=>{const t=e.id?.toLowerCase()||"";return t.includes("realtime")&&t.includes("4o")}))}static buildValidationResult(e){return e?{valid:!0,message:Ee.t("settings.apiKeyValidationCompleted")+" "+Ee.t("settings.realtimeModelAvailable"),validating:!1,hasRealtimeModel:!0}:{valid:!1,message:Ee.t("settings.realtimeModelNotAvailable"),validating:!1,hasRealtimeModel:!1}}static filterRelevantModels(e){const t=[];return e.forEach((e=>{const n=e.id.toLowerCase();n.includes("realtime")&&(n.includes("4o")||n.includes("gpt-4"))?t.push({id:e.id,type:"realtime",created:e.created}):n.includes("audio")&&(n.includes("4o")||n.includes("gpt-4"))&&t.push({id:e.id,type:"audio",created:e.created})})),t.sort(((e,t)=>t.created!==e.created?t.created-e.created:e.id.localeCompare(t.id)))}setupEventListeners(){this.client.on("realtime.event",(e=>{const t={source:"server",event:{type:e.event?.type||"unknown",data:e,...e}};this.eventHandlers.onRealtimeEvent?.(t)})),this.client.on("error",(e=>{this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.error",data:{message:e.message||e.toString(),type:e.type||"error",error:e.error?e.error.toString():void 0,stack:e.stack,timestamp:e.timeStamp||Date.now(),original:e}}}),this.eventHandlers.onError?.(e)})),this.client.on("conversation.interrupted",(()=>{this.eventHandlers.onConversationInterrupted?.()})),this.client.on("conversation.updated",(async e=>{let{item:t,delta:n}=e;const i=this.convertToConversationItem(t);this.eventHandlers.onConversationUpdated?.({item:i,delta:n})}))}convertToConversationItem(e){const t=e;return{id:e.id,role:e.role,type:e.type,status:t.status||"completed",formatted:e.formatted?{text:e.formatted.text,transcript:e.formatted.transcript,audio:e.formatted.audio,tool:e.formatted.tool?{name:e.formatted.tool.name,arguments:e.formatted.tool.arguments}:void 0,output:e.formatted.output,file:e.formatted.file}:void 0,content:t.content||[]}}async connect(e){this.client=new It({apiKey:this.apiKey,dangerouslyAllowAPIKeyInBrowser:!0,url:`${this.apiHost}/v1/realtime`}),this.setupEventListeners(),this.updateSession(e),await this.client.realtime.connect({model:e.model}),this.client.updateSession(),this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.opened",data:{status:"connected",provider:"openai",model:e.model,timestamp:Date.now(),voice:e.voice,temperature:e.temperature,apiHost:this.apiHost}}}),this.eventHandlers.onOpen?.()}async disconnect(){this.client.reset(),this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.closed",data:{status:"disconnected",provider:"openai",timestamp:Date.now(),reason:"client_disconnect"}}}),this.eventHandlers.onClose?.({})}isConnected(){return this.client.isConnected()}updateSession(e){const t={};if(e.model&&(t.model=e.model),e.voice&&(t.voice=e.voice),e.instructions&&(t.instructions=e.instructions),void 0!==e.temperature&&(t.temperature=e.temperature),void 0!==e.maxTokens&&(t.max_response_output_tokens=e.maxTokens),e.turnDetection){const n=e.turnDetection;"none"===n.type||("server_vad"===n.type?(t.turn_detection={create_response:n.createResponse??!0,type:"server_vad",interrupt_response:n.interruptResponse??!1,prefix_padding_ms:void 0!==n.prefixPadding?Math.round(1e3*n.prefixPadding):void 0,silence_duration_ms:void 0!==n.silenceDuration?Math.round(1e3*n.silenceDuration):void 0,threshold:n.threshold},Object.keys(t.turn_detection).forEach((e=>void 0===t.turn_detection[e]&&delete t.turn_detection[e]))):"semantic_vad"===n.type&&(t.turn_detection={create_response:n.createResponse??!0,type:"semantic_vad",interrupt_response:n.interruptResponse??!1,eagerness:n.eagerness?.toLowerCase()},Object.keys(t.turn_detection).forEach((e=>void 0===t.turn_detection[e]&&delete t.turn_detection[e]))))}e.inputAudioNoiseReduction&&(t.input_audio_noise_reduction={type:"near_field"===e.inputAudioNoiseReduction.type?"near_field":"far_field"===e.inputAudioNoiseReduction.type?"far_field":void 0},t.input_audio_noise_reduction.type||delete t.input_audio_noise_reduction),e.inputAudioTranscription&&(t.input_audio_transcription={model:e.inputAudioTranscription.model}),this.client.updateSession(t)}reset(){this.client.reset()}appendInputAudio(e){this.client.appendInputAudio(e)}createResponse(){this.client.createResponse()}cancelResponse(e,t){e&&void 0!==t&&this.client.cancelResponse(e,t)}getConversationItems(){return this.client.conversation.getItems().map((e=>this.convertToConversationItem(e)))}setEventHandlers(e){this.eventHandlers={...e}}getProvider(){return At.OPENAI}}class Mt{}function Rt(e,t){return e.replace(/\{([^}]+)\}/g,((e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)}))}function jt(e,t,n){for(let i=0;i<t.length-1;i++){const o=t[i];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${o}`);e[a]=Array.from({length:n.length},(()=>({})))}if(Array.isArray(e[a])){const o=e[a];if(Array.isArray(n))for(let e=0;e<o.length;e++)jt(o[e],t.slice(i+1),n[e]);else for(const e of o)jt(e,t.slice(i+1),n)}return}if(o.endsWith("[0]")){const a=o.slice(0,-3);return a in e||(e[a]=[{}]),void jt(e[a][0],t.slice(i+1),n)}e[o]&&"object"==typeof e[o]||(e[o]={}),e=e[o]}const i=t[t.length-1],o=e[i];if(void 0!==o){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===o)return;if("object"!=typeof o||"object"!=typeof n||null===o||null===n)throw new Error(`Cannot set value for an existing key. Key: ${i}`);Object.assign(o,n)}else e[i]=n}function Dt(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;const i=t[n];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in e){const i=e[o];if(!Array.isArray(i))return;return i.map((e=>Dt(e,t.slice(n+1))))}return}e=e[i]}return e}catch(e){if(e instanceof TypeError)return;throw e}}function Lt(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Ft(e,t){const n=Lt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function zt(e,t){return Array.isArray(t)?t.map((e=>Ut(0,e))):[Ut(0,t)]}function Ut(e,t){if("object"==typeof t&&null!==t)return t;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof t)}function Vt(e,t){if(null==t)throw new Error("PartUnion is required");if("object"==typeof t)return t;if("string"==typeof t)return{text:t};throw new Error("Unsupported part type: "+typeof t)}function Bt(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map((e=>Vt(0,e))):[Vt(0,t)]}function qt(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function Kt(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function Ht(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function Wt(e,t){if(null==t)throw new Error("ContentUnion is required");return qt(t)?t:{role:"user",parts:Bt(0,t)}}function Gt(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap((e=>{const t=Wt(0,e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]}));if(e.isVertexAI()){const e=Wt(0,t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map((e=>Wt(0,e))):[Wt(0,t)]}function $t(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw new Error("contents are required");if(!Array.isArray(t)){if(Kt(t)||Ht(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Wt(0,t)]}const n=[],i=[],o=qt(t[0]);for(const e of t){const t=qt(e);if(t!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(t)n.push(e);else{if(Kt(e)||Ht(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");i.push(e)}}return o||n.push({role:"user",parts:Bt(0,i)}),n}function Jt(e,t){return t}function Qt(e,t){if("object"==typeof t)return t;if("string"==typeof t)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error("Unsupported speechConfig type: "+typeof t)}function Yt(e,t){return t}function Zt(e,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function Xt(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,i=1){const o=!t.startsWith(`${n}/`)&&t.split("/").length===i;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:o?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:o?`${n}/${t}`:t}(e,t,"cachedContents")}function en(e,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function tn(e,t){if("string"!=typeof t)throw new Error("fromImageBytes must be a string");return t}function nn(e,t){var n;let i;var o;if(null!=(o=t)&&"object"==typeof o&&"name"in o&&(i=t.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(t)&&(i=t.uri,void 0===i)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(t)&&(i=null===(n=t.video)||void 0===n?void 0:n.uri,void 0===i))){if("string"==typeof t&&(i=t),void 0===i)throw new Error("Could not extract file name from the provided input.");if(i.startsWith("https://")){const e=i.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${i}`);i=e[0]}else i.startsWith("files/")&&(i=i.split("files/")[1]);return i}}function on(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function an(e,t){for(const e of["models","tunedModels","publisherModels"])if(null!==(n=t)&&"object"==typeof n&&e in n)return t[e];var n;return[]}function rn(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["videoMetadata"]))throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=Dt(t,["thought"]);null!=i&&jt(n,["thought"],i);const o=Dt(t,["inlineData"]);null!=o&&jt(n,["inlineData"],function(e,t){const n={};if(void 0!==Dt(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=Dt(t,["data"]);null!=i&&jt(n,["data"],i);const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,o));const a=Dt(t,["codeExecutionResult"]);null!=a&&jt(n,["codeExecutionResult"],a);const r=Dt(t,["executableCode"]);null!=r&&jt(n,["executableCode"],r);const s=Dt(t,["fileData"]);null!=s&&jt(n,["fileData"],s);const l=Dt(t,["functionCall"]);null!=l&&jt(n,["functionCall"],l);const c=Dt(t,["functionResponse"]);null!=c&&jt(n,["functionResponse"],c);const u=Dt(t,["text"]);return null!=u&&jt(n,["text"],u),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}function sn(e,t,n){const i=Dt(t,["ttl"]);void 0!==n&&null!=i&&jt(n,["ttl"],i);const o=Dt(t,["expireTime"]);void 0!==n&&null!=o&&jt(n,["expireTime"],o);const a=Dt(t,["displayName"]);void 0!==n&&null!=a&&jt(n,["displayName"],a);const r=Dt(t,["contents"]);if(void 0!==n&&null!=r){let e=$t(0,r);Array.isArray(e)&&(e=e.map((e=>rn(0,e)))),jt(n,["contents"],e)}const s=Dt(t,["systemInstruction"]);void 0!==n&&null!=s&&jt(n,["systemInstruction"],rn(0,Wt(0,s)));const l=Dt(t,["tools"]);if(void 0!==n&&null!=l){let e=l;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const i=Dt(t,["googleSearchRetrieval"]);if(null!=i&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,i)),void 0!==Dt(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==Dt(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");const o=Dt(t,["codeExecution"]);null!=o&&jt(n,["codeExecution"],o);const a=Dt(t,["functionDeclarations"]);return null!=a&&jt(n,["functionDeclarations"],a),n}(0,e)))),jt(n,["tools"],e)}const c=Dt(t,["toolConfig"]);return void 0!==n&&null!=c&&jt(n,["toolConfig"],function(e,t){const n={},i=Dt(t,["functionCallingConfig"]);if(null!=i&&jt(n,["functionCallingConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["allowedFunctionNames"]);return null!=o&&jt(n,["allowedFunctionNames"],o),n}(0,i)),void 0!==Dt(t,["retrievalConfig"]))throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}(0,c)),{}}function ln(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["videoMetadata"]);null!=i&&jt(n,["videoMetadata"],i);const o=Dt(t,["thought"]);null!=o&&jt(n,["thought"],o);const a=Dt(t,["inlineData"]);null!=a&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["displayName"]);null!=i&&jt(n,["displayName"],i);const o=Dt(t,["data"]);null!=o&&jt(n,["data"],o);const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,a));const r=Dt(t,["codeExecutionResult"]);null!=r&&jt(n,["codeExecutionResult"],r);const s=Dt(t,["executableCode"]);null!=s&&jt(n,["executableCode"],s);const l=Dt(t,["fileData"]);null!=l&&jt(n,["fileData"],l);const c=Dt(t,["functionCall"]);null!=c&&jt(n,["functionCall"],c);const u=Dt(t,["functionResponse"]);null!=u&&jt(n,["functionResponse"],u);const d=Dt(t,["text"]);return null!=d&&jt(n,["text"],d),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}function cn(e,t){const n={},i=Dt(t,["retrieval"]);null!=i&&jt(n,["retrieval"],i),null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const o=Dt(t,["googleSearchRetrieval"]);null!=o&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,o)),null!=Dt(t,["enterpriseWebSearch"])&&jt(n,["enterpriseWebSearch"],{});const a=Dt(t,["googleMaps"]);null!=a&&jt(n,["googleMaps"],function(e,t){const n={},i=Dt(t,["authConfig"]);return null!=i&&jt(n,["authConfig"],function(e,t){const n={},i=Dt(t,["apiKeyConfig"]);null!=i&&jt(n,["apiKeyConfig"],function(e,t){const n={},i=Dt(t,["apiKeyString"]);return null!=i&&jt(n,["apiKeyString"],i),n}(0,i));const o=Dt(t,["authType"]);null!=o&&jt(n,["authType"],o);const a=Dt(t,["googleServiceAccountConfig"]);null!=a&&jt(n,["googleServiceAccountConfig"],a);const r=Dt(t,["httpBasicAuthConfig"]);null!=r&&jt(n,["httpBasicAuthConfig"],r);const s=Dt(t,["oauthConfig"]);null!=s&&jt(n,["oauthConfig"],s);const l=Dt(t,["oidcConfig"]);return null!=l&&jt(n,["oidcConfig"],l),n}(0,i)),n}(0,a));const r=Dt(t,["codeExecution"]);null!=r&&jt(n,["codeExecution"],r);const s=Dt(t,["functionDeclarations"]);return null!=s&&jt(n,["functionDeclarations"],s),n}function un(e,t){const n={},i=Dt(t,["functionCallingConfig"]);null!=i&&jt(n,["functionCallingConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["allowedFunctionNames"]);return null!=o&&jt(n,["allowedFunctionNames"],o),n}(0,i));const o=Dt(t,["retrievalConfig"]);return null!=o&&jt(n,["retrievalConfig"],function(e,t){const n={},i=Dt(t,["latLng"]);return null!=i&&jt(n,["latLng"],function(e,t){const n={},i=Dt(t,["latitude"]);null!=i&&jt(n,["latitude"],i);const o=Dt(t,["longitude"]);return null!=o&&jt(n,["longitude"],o),n}(0,i)),n}(0,o)),n}function dn(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["model"]);null!=a&&jt(n,["model"],a);const r=Dt(t,["createTime"]);null!=r&&jt(n,["createTime"],r);const s=Dt(t,["updateTime"]);null!=s&&jt(n,["updateTime"],s);const l=Dt(t,["expireTime"]);null!=l&&jt(n,["expireTime"],l);const c=Dt(t,["usageMetadata"]);return null!=c&&jt(n,["usageMetadata"],c),n}function pn(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["model"]);null!=a&&jt(n,["model"],a);const r=Dt(t,["createTime"]);null!=r&&jt(n,["createTime"],r);const s=Dt(t,["updateTime"]);null!=s&&jt(n,["updateTime"],s);const l=Dt(t,["expireTime"]);null!=l&&jt(n,["expireTime"],l);const c=Dt(t,["usageMetadata"]);return null!=c&&jt(n,["usageMetadata"],c),n}var hn,gn,mn,fn,vn,yn,bn,kn,Sn,wn,Tn,Cn,Pn,xn,In,An,En,On,_n,Nn,Mn,Rn,jn,Dn,Ln,Fn,zn,Un,Vn,Bn,qn,Kn,Hn,Wn,Gn;!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(hn||(hn={}));class $n{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};a=n?"object"==typeof n?Object.assign({},n):n:{config:{}},a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=null!==(o=null===(i=a.config)||void 0===i?void 0:i.pageSize)&&void 0!==o?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(gn||(gn={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(mn||(mn={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"}(fn||(fn={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(vn||(vn={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(yn||(yn={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(bn||(bn={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(kn||(kn={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"}(Sn||(Sn={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"}(wn||(wn={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(Tn||(Tn={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(Cn||(Cn={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"}(Pn||(Pn={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(xn||(xn={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(In||(In={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(An||(An={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(En||(En={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(On||(On={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(_n||(_n={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(Nn||(Nn={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"}(Mn||(Mn={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(Rn||(Rn={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(jn||(jn={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"}(Dn||(Dn={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(Ln||(Ln={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(Fn||(Fn={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(zn||(zn={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(Un||(Un={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(Vn||(Vn={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}(Bn||(Bn={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(qn||(qn={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(Kn||(Kn={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(Hn||(Hn={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(Wn||(Wn={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(Gn||(Gn={}));class Jn{get text(){var e,t,n,i,o,a,r,s;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",c=!1;const u=[];for(const e of null!==(s=null===(r=null===(a=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)&&void 0!==s?s:[]){for(const[t,n]of Object.entries(e))"text"===t||"thought"===t||null===n&&void 0===n||u.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;c=!0,l+=e.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?l:void 0}get data(){var e,t,n,i,o,a,r,s;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="";const c=[];for(const e of null!==(s=null===(r=null===(a=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)&&void 0!==s?s:[]){for(const[t,n]of Object.entries(e))"inlineData"===t||null===n&&void 0===n||c.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(l+=atob(e.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,i,o,a,r,s;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const l=null===(s=null===(r=null===(a=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)||void 0===s?void 0:s.filter((e=>e.functionCall)).map((e=>e.functionCall)).filter((e=>void 0!==e));return 0!==(null==l?void 0:l.length)?l:void 0}get executableCode(){var e,t,n,i,o,a,r,s,l;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=null===(s=null===(r=null===(a=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)||void 0===s?void 0:s.filter((e=>e.executableCode)).map((e=>e.executableCode)).filter((e=>void 0!==e));return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.code:void 0}get codeExecutionResult(){var e,t,n,i,o,a,r,s,l;if(0===(null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=null===(s=null===(r=null===(a=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===a?void 0:a.content)||void 0===r?void 0:r.parts)||void 0===s?void 0:s.filter((e=>e.codeExecutionResult)).map((e=>e.codeExecutionResult)).filter((e=>void 0!==e));return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.output:void 0}}class Qn{}class Yn{}class Zn{}class Xn{}class ei{}class ti{}class ni{}class ii{}class oi{}class ai{}class ri{}class si{}class li{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ci{}class ui{}class di{get text(){var e,t,n;let i="",o=!1;const a=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"text"!==e&&"thought"!==e&&null!==t&&a.push(e);if("string"==typeof r.text){if("boolean"==typeof r.thought&&r.thought)continue;o=!0,i+=r.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,t,n;let i="";const o=[];for(const a of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(a))"inlineData"!==e&&null!==t&&o.push(e);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class pi extends Mt{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new $n(hn.PAGED_ITEM_CACHED_CONTENTS,(e=>this.listInternal(e)),await this.listInternal(e),e)}async create(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["model"],Ft(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],function(e,t,n){const i=Dt(t,["ttl"]);void 0!==n&&null!=i&&jt(n,["ttl"],i);const o=Dt(t,["expireTime"]);void 0!==n&&null!=o&&jt(n,["expireTime"],o);const a=Dt(t,["displayName"]);void 0!==n&&null!=a&&jt(n,["displayName"],a);const r=Dt(t,["contents"]);if(void 0!==n&&null!=r){let e=$t(0,r);Array.isArray(e)&&(e=e.map((e=>ln(0,e)))),jt(n,["contents"],e)}const s=Dt(t,["systemInstruction"]);void 0!==n&&null!=s&&jt(n,["systemInstruction"],ln(0,Wt(0,s)));const l=Dt(t,["tools"]);if(void 0!==n&&null!=l){let e=l;Array.isArray(e)&&(e=e.map((e=>cn(0,e)))),jt(n,["tools"],e)}const c=Dt(t,["toolConfig"]);return void 0!==n&&null!=c&&jt(n,["toolConfig"],un(0,c)),{}}(0,o,n)),n}(this.apiClient,e);return r=Rt("cachedContents",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>pn(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["model"],Ft(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],sn(0,o,n)),n}(this.apiClient,e);return r=Rt("cachedContents",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>dn(this.apiClient,e)))}}async get(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>pn(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>dn(this.apiClient,e)))}}async delete(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((()=>{const e=new ai;return Object.assign(e,{}),e}))}{const t=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((()=>{const e=new ai;return Object.assign(e,{}),e}))}}async update(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],function(e,t,n){const i=Dt(t,["ttl"]);void 0!==n&&null!=i&&jt(n,["ttl"],i);const o=Dt(t,["expireTime"]);return void 0!==n&&null!=o&&jt(n,["expireTime"],o),{}}(0,o,n)),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>pn(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],Xt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],function(e,t,n){const i=Dt(t,["ttl"]);void 0!==n&&null!=i&&jt(n,["ttl"],i);const o=Dt(t,["expireTime"]);return void 0!==n&&null!=o&&jt(n,["expireTime"],o),{}}(0,o,n)),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>dn(this.apiClient,e)))}}async listInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);return void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o),{}}(0,i,n)),n}(this.apiClient,e);return r=Rt("cachedContents",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>pn(0,e)))),jt(n,["cachedContents"],e)}return n}(this.apiClient,e),n=new ri;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);return void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o),{}}(0,i,n)),n}(this.apiClient,e);return r=Rt("cachedContents",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>dn(0,e)))),jt(n,["cachedContents"],e)}return n}(this.apiClient,e),n=new ri;return Object.assign(n,t),n}))}}}function hi(e){return this instanceof hi?(this.v=e,this):new hi(e)}function gi(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n.apply(e,t||[]),a=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),r("next"),r("throw"),r("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),i[Symbol.asyncIterator]=function(){return this},i;function r(e,t){o[e]&&(i[e]=function(t){return new Promise((function(n,i){a.push([e,t,n,i])>1||s(e,t)}))},t&&(i[e]=t(i[e])))}function s(e,t){try{(n=o[e](t)).value instanceof hi?Promise.resolve(n.value.v).then(l,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function mi(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,o,(t=e[n](t)).done,t.value)}))}}}function fi(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&vi(n)}function vi(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts){if(void 0===t||0===Object.keys(t).length)return!1;if(void 0!==t.text&&""===t.text)return!1}return!0}"function"==typeof SuppressedError&&SuppressedError;class yi{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new bi(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}class bi{constructor(e,t,n,i={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){if("user"!==e[0].role)throw new Error("History must start with a user turn.");for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}}(o)}async sendMessage(e){var t;await this.sendPromise;const n=Wt(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t;const o=null===(t=null===(e=(await i).candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=o?[o]:[];this.recordHistory(n,a)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const n=Wt(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=i.then((()=>{})).catch((()=>{}));const o=await i;return this.processStreamResponse(o,n)}getHistory(e=!1){return e?function(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let i=0,o=e[0];for(;i<n;)if("user"===e[i].role)o=e[i],i++;else{const a=[];let r=!0;for(;i<n&&"model"===e[i].role;)a.push(e[i]),r&&!vi(e[i])&&(r=!1),i++;r&&(t.push(o),t.push(...a))}return t}(this.history):this.history}processStreamResponse(e,t){var n,i;return gi(this,arguments,(function*(){var o,a,r,s;const l=[];try{for(var c,u=!0,d=mi(e);!(o=(c=yield hi(d.next())).done);u=!0){s=c.value,u=!1;const e=s;if(fi(e)){const t=null===(i=null===(n=e.candidates)||void 0===n?void 0:n[0])||void 0===i?void 0:i.content;void 0!==t&&l.push(t)}yield yield hi(e)}}catch(e){a={error:e}}finally{try{u||o||!(r=d.return)||(yield hi(r.call(d)))}finally{if(a)throw a.error}}this.recordHistory(t,l)}))}recordHistory(e,t){let n=[];t.length>0&&t.every((e=>"model"===e.role))?n=t:n.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...n)}}function ki(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["mimeType"]);null!=a&&jt(n,["mimeType"],a);const r=Dt(t,["sizeBytes"]);null!=r&&jt(n,["sizeBytes"],r);const s=Dt(t,["createTime"]);null!=s&&jt(n,["createTime"],s);const l=Dt(t,["expirationTime"]);null!=l&&jt(n,["expirationTime"],l);const c=Dt(t,["updateTime"]);null!=c&&jt(n,["updateTime"],c);const u=Dt(t,["sha256Hash"]);null!=u&&jt(n,["sha256Hash"],u);const d=Dt(t,["uri"]);null!=d&&jt(n,["uri"],d);const p=Dt(t,["downloadUri"]);null!=p&&jt(n,["downloadUri"],p);const h=Dt(t,["state"]);null!=h&&jt(n,["state"],h);const g=Dt(t,["source"]);null!=g&&jt(n,["source"],g);const m=Dt(t,["videoMetadata"]);null!=m&&jt(n,["videoMetadata"],m);const f=Dt(t,["error"]);return null!=f&&jt(n,["error"],function(e,t){const n={},i=Dt(t,["details"]);null!=i&&jt(n,["details"],i);const o=Dt(t,["message"]);null!=o&&jt(n,["message"],o);const a=Dt(t,["code"]);return null!=a&&jt(n,["code"],a),n}(0,f)),n}class Si extends Mt{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new $n(hn.PAGED_ITEM_FILES,(e=>this.listInternal(e)),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then((e=>ki(this.apiClient,e)))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);return void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o),{}}(0,i,n)),n}(this.apiClient,e);return o=Rt("files",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["files"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>ki(0,e)))),jt(n,["files"],e)}return n}(this.apiClient,e),n=new si;return Object.assign(n,t),n}))}}async createInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},i=Dt(t,["file"]);null!=i&&jt(n,["file"],function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["mimeType"]);null!=a&&jt(n,["mimeType"],a);const r=Dt(t,["sizeBytes"]);null!=r&&jt(n,["sizeBytes"],r);const s=Dt(t,["createTime"]);null!=s&&jt(n,["createTime"],s);const l=Dt(t,["expirationTime"]);null!=l&&jt(n,["expirationTime"],l);const c=Dt(t,["updateTime"]);null!=c&&jt(n,["updateTime"],c);const u=Dt(t,["sha256Hash"]);null!=u&&jt(n,["sha256Hash"],u);const d=Dt(t,["uri"]);null!=d&&jt(n,["uri"],d);const p=Dt(t,["downloadUri"]);null!=p&&jt(n,["downloadUri"],p);const h=Dt(t,["state"]);null!=h&&jt(n,["state"],h);const g=Dt(t,["source"]);null!=g&&jt(n,["source"],g);const m=Dt(t,["videoMetadata"]);null!=m&&jt(n,["videoMetadata"],m);const f=Dt(t,["error"]);return null!=f&&jt(n,["error"],function(e,t){const n={},i=Dt(t,["details"]);null!=i&&jt(n,["details"],i);const o=Dt(t,["message"]);null!=o&&jt(n,["message"],o);const a=Dt(t,["code"]);return null!=a&&jt(n,["code"],a),n}(0,f)),n}(0,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return o=Rt("upload/v1beta/files",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((()=>{const e=new ci;return Object.assign(e,{}),e}))}}async get(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","file"],nn(0,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return o=Rt("files/{file}",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>ki(this.apiClient,e)))}}async delete(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","file"],nn(0,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return o=Rt("files/{file}",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((()=>{const e=new ui;return Object.assign(e,{}),e}))}}}function wi(e,t){const n={},i=Dt(t,["retrieval"]);null!=i&&jt(n,["retrieval"],i),null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const o=Dt(t,["googleSearchRetrieval"]);null!=o&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,o)),null!=Dt(t,["enterpriseWebSearch"])&&jt(n,["enterpriseWebSearch"],{});const a=Dt(t,["googleMaps"]);null!=a&&jt(n,["googleMaps"],function(e,t){const n={},i=Dt(t,["authConfig"]);return null!=i&&jt(n,["authConfig"],function(e,t){const n={},i=Dt(t,["apiKeyConfig"]);null!=i&&jt(n,["apiKeyConfig"],function(e,t){const n={},i=Dt(t,["apiKeyString"]);return null!=i&&jt(n,["apiKeyString"],i),n}(0,i));const o=Dt(t,["authType"]);null!=o&&jt(n,["authType"],o);const a=Dt(t,["googleServiceAccountConfig"]);null!=a&&jt(n,["googleServiceAccountConfig"],a);const r=Dt(t,["httpBasicAuthConfig"]);null!=r&&jt(n,["httpBasicAuthConfig"],r);const s=Dt(t,["oauthConfig"]);null!=s&&jt(n,["oauthConfig"],s);const l=Dt(t,["oidcConfig"]);return null!=l&&jt(n,["oidcConfig"],l),n}(0,i)),n}(0,a));const r=Dt(t,["codeExecution"]);null!=r&&jt(n,["codeExecution"],r);const s=Dt(t,["functionDeclarations"]);return null!=s&&jt(n,["functionDeclarations"],s),n}function Ti(e,t,n){const i=Dt(t,["generationConfig"]);void 0!==n&&null!=i&&jt(n,["setup","generationConfig"],i);const o=Dt(t,["responseModalities"]);void 0!==n&&null!=o&&jt(n,["setup","generationConfig","responseModalities"],o);const a=Dt(t,["temperature"]);void 0!==n&&null!=a&&jt(n,["setup","generationConfig","temperature"],a);const r=Dt(t,["topP"]);void 0!==n&&null!=r&&jt(n,["setup","generationConfig","topP"],r);const s=Dt(t,["topK"]);void 0!==n&&null!=s&&jt(n,["setup","generationConfig","topK"],s);const l=Dt(t,["maxOutputTokens"]);void 0!==n&&null!=l&&jt(n,["setup","generationConfig","maxOutputTokens"],l);const c=Dt(t,["mediaResolution"]);void 0!==n&&null!=c&&jt(n,["setup","generationConfig","mediaResolution"],c);const u=Dt(t,["seed"]);void 0!==n&&null!=u&&jt(n,["setup","generationConfig","seed"],u);const d=Dt(t,["speechConfig"]);void 0!==n&&null!=d&&jt(n,["setup","generationConfig","speechConfig"],d);const p=Dt(t,["systemInstruction"]);void 0!==n&&null!=p&&jt(n,["setup","systemInstruction"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["videoMetadata"]))throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=Dt(t,["thought"]);null!=i&&jt(n,["thought"],i);const o=Dt(t,["inlineData"]);null!=o&&jt(n,["inlineData"],function(e,t){const n={};if(void 0!==Dt(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=Dt(t,["data"]);null!=i&&jt(n,["data"],i);const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,o));const a=Dt(t,["codeExecutionResult"]);null!=a&&jt(n,["codeExecutionResult"],a);const r=Dt(t,["executableCode"]);null!=r&&jt(n,["executableCode"],r);const s=Dt(t,["fileData"]);null!=s&&jt(n,["fileData"],s);const l=Dt(t,["functionCall"]);null!=l&&jt(n,["functionCall"],l);const c=Dt(t,["functionResponse"]);null!=c&&jt(n,["functionResponse"],c);const u=Dt(t,["text"]);return null!=u&&jt(n,["text"],u),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,Wt(0,p)));const h=Dt(t,["tools"]);if(void 0!==n&&null!=h){let e=Zt(0,h);Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const i=Dt(t,["googleSearchRetrieval"]);if(null!=i&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,i)),void 0!==Dt(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==Dt(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");const o=Dt(t,["codeExecution"]);null!=o&&jt(n,["codeExecution"],o);const a=Dt(t,["functionDeclarations"]);return null!=a&&jt(n,["functionDeclarations"],a),n}(0,Yt(0,e))))),jt(n,["setup","tools"],e)}const g=Dt(t,["sessionResumption"]);void 0!==n&&null!=g&&jt(n,["setup","sessionResumption"],function(e,t){const n={},i=Dt(t,["handle"]);if(null!=i&&jt(n,["handle"],i),void 0!==Dt(t,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return n}(0,g));const m=Dt(t,["inputAudioTranscription"]);void 0!==n&&null!=m&&jt(n,["setup","inputAudioTranscription"],{});const f=Dt(t,["outputAudioTranscription"]);void 0!==n&&null!=f&&jt(n,["setup","outputAudioTranscription"],{});const v=Dt(t,["realtimeInputConfig"]);void 0!==n&&null!=v&&jt(n,["setup","realtimeInputConfig"],function(e,t){const n={},i=Dt(t,["automaticActivityDetection"]);null!=i&&jt(n,["automaticActivityDetection"],function(e,t){const n={},i=Dt(t,["disabled"]);null!=i&&jt(n,["disabled"],i);const o=Dt(t,["startOfSpeechSensitivity"]);null!=o&&jt(n,["startOfSpeechSensitivity"],o);const a=Dt(t,["endOfSpeechSensitivity"]);null!=a&&jt(n,["endOfSpeechSensitivity"],a);const r=Dt(t,["prefixPaddingMs"]);null!=r&&jt(n,["prefixPaddingMs"],r);const s=Dt(t,["silenceDurationMs"]);return null!=s&&jt(n,["silenceDurationMs"],s),n}(0,i));const o=Dt(t,["activityHandling"]);null!=o&&jt(n,["activityHandling"],o);const a=Dt(t,["turnCoverage"]);return null!=a&&jt(n,["turnCoverage"],a),n}(0,v));const y=Dt(t,["contextWindowCompression"]);return void 0!==n&&null!=y&&jt(n,["setup","contextWindowCompression"],function(e,t){const n={},i=Dt(t,["triggerTokens"]);null!=i&&jt(n,["triggerTokens"],i);const o=Dt(t,["slidingWindow"]);return null!=o&&jt(n,["slidingWindow"],function(e,t){const n={},i=Dt(t,["targetTokens"]);return null!=i&&jt(n,["targetTokens"],i),n}(0,o)),n}(0,y)),{}}function Ci(e,t,n){const i=Dt(t,["generationConfig"]);void 0!==n&&null!=i&&jt(n,["setup","generationConfig"],i);const o=Dt(t,["responseModalities"]);void 0!==n&&null!=o&&jt(n,["setup","generationConfig","responseModalities"],o);const a=Dt(t,["temperature"]);void 0!==n&&null!=a&&jt(n,["setup","generationConfig","temperature"],a);const r=Dt(t,["topP"]);void 0!==n&&null!=r&&jt(n,["setup","generationConfig","topP"],r);const s=Dt(t,["topK"]);void 0!==n&&null!=s&&jt(n,["setup","generationConfig","topK"],s);const l=Dt(t,["maxOutputTokens"]);void 0!==n&&null!=l&&jt(n,["setup","generationConfig","maxOutputTokens"],l);const c=Dt(t,["mediaResolution"]);void 0!==n&&null!=c&&jt(n,["setup","generationConfig","mediaResolution"],c);const u=Dt(t,["seed"]);void 0!==n&&null!=u&&jt(n,["setup","generationConfig","seed"],u);const d=Dt(t,["speechConfig"]);void 0!==n&&null!=d&&jt(n,["setup","generationConfig","speechConfig"],d);const p=Dt(t,["systemInstruction"]);void 0!==n&&null!=p&&jt(n,["setup","systemInstruction"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["videoMetadata"]);null!=i&&jt(n,["videoMetadata"],i);const o=Dt(t,["thought"]);null!=o&&jt(n,["thought"],o);const a=Dt(t,["inlineData"]);null!=a&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["displayName"]);null!=i&&jt(n,["displayName"],i);const o=Dt(t,["data"]);null!=o&&jt(n,["data"],o);const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,a));const r=Dt(t,["codeExecutionResult"]);null!=r&&jt(n,["codeExecutionResult"],r);const s=Dt(t,["executableCode"]);null!=s&&jt(n,["executableCode"],s);const l=Dt(t,["fileData"]);null!=l&&jt(n,["fileData"],l);const c=Dt(t,["functionCall"]);null!=c&&jt(n,["functionCall"],c);const u=Dt(t,["functionResponse"]);null!=u&&jt(n,["functionResponse"],u);const d=Dt(t,["text"]);return null!=d&&jt(n,["text"],d),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,Wt(0,p)));const h=Dt(t,["tools"]);if(void 0!==n&&null!=h){let e=Zt(0,h);Array.isArray(e)&&(e=e.map((e=>wi(0,Yt(0,e))))),jt(n,["setup","tools"],e)}const g=Dt(t,["sessionResumption"]);void 0!==n&&null!=g&&jt(n,["setup","sessionResumption"],function(e,t){const n={},i=Dt(t,["handle"]);null!=i&&jt(n,["handle"],i);const o=Dt(t,["transparent"]);return null!=o&&jt(n,["transparent"],o),n}(0,g));const m=Dt(t,["inputAudioTranscription"]);void 0!==n&&null!=m&&jt(n,["setup","inputAudioTranscription"],{});const f=Dt(t,["outputAudioTranscription"]);void 0!==n&&null!=f&&jt(n,["setup","outputAudioTranscription"],{});const v=Dt(t,["realtimeInputConfig"]);void 0!==n&&null!=v&&jt(n,["setup","realtimeInputConfig"],function(e,t){const n={},i=Dt(t,["automaticActivityDetection"]);null!=i&&jt(n,["automaticActivityDetection"],function(e,t){const n={},i=Dt(t,["disabled"]);null!=i&&jt(n,["disabled"],i);const o=Dt(t,["startOfSpeechSensitivity"]);null!=o&&jt(n,["startOfSpeechSensitivity"],o);const a=Dt(t,["endOfSpeechSensitivity"]);null!=a&&jt(n,["endOfSpeechSensitivity"],a);const r=Dt(t,["prefixPaddingMs"]);null!=r&&jt(n,["prefixPaddingMs"],r);const s=Dt(t,["silenceDurationMs"]);return null!=s&&jt(n,["silenceDurationMs"],s),n}(0,i));const o=Dt(t,["activityHandling"]);null!=o&&jt(n,["activityHandling"],o);const a=Dt(t,["turnCoverage"]);return null!=a&&jt(n,["turnCoverage"],a),n}(0,v));const y=Dt(t,["contextWindowCompression"]);return void 0!==n&&null!=y&&jt(n,["setup","contextWindowCompression"],function(e,t){const n={},i=Dt(t,["triggerTokens"]);null!=i&&jt(n,["triggerTokens"],i);const o=Dt(t,["slidingWindow"]);return null!=o&&jt(n,["slidingWindow"],function(e,t){const n={},i=Dt(t,["targetTokens"]);return null!=i&&jt(n,["targetTokens"],i),n}(0,o)),n}(0,y)),{}}function Pi(e,t){const n={},i=Dt(t,["media"]);null!=i&&jt(n,["mediaChunks"],zt(0,i));const o=Dt(t,["audio"]);null!=o&&jt(n,["audio"],function(e,t){const n=Ut(0,t);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}(0,o));const a=Dt(t,["audioStreamEnd"]);null!=a&&jt(n,["audioStreamEnd"],a);const r=Dt(t,["video"]);null!=r&&jt(n,["video"],function(e,t){const n=Ut(0,t);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}(0,r));const s=Dt(t,["text"]);return null!=s&&jt(n,["text"],s),null!=Dt(t,["activityStart"])&&jt(n,["activityStart"],{}),null!=Dt(t,["activityEnd"])&&jt(n,["activityEnd"],{}),n}function xi(e,t){const n={},i=Dt(t,["media"]);if(null!=i&&jt(n,["mediaChunks"],zt(0,i)),void 0!==Dt(t,["audio"]))throw new Error("audio parameter is not supported in Vertex AI.");const o=Dt(t,["audioStreamEnd"]);if(null!=o&&jt(n,["audioStreamEnd"],o),void 0!==Dt(t,["video"]))throw new Error("video parameter is not supported in Vertex AI.");if(void 0!==Dt(t,["text"]))throw new Error("text parameter is not supported in Vertex AI.");return null!=Dt(t,["activityStart"])&&jt(n,["activityStart"],{}),null!=Dt(t,["activityEnd"])&&jt(n,["activityEnd"],{}),n}function Ii(e,t){const n={},i=Dt(t,["text"]);null!=i&&jt(n,["text"],i);const o=Dt(t,["finished"]);return null!=o&&jt(n,["finished"],o),n}function Ai(e,t){const n={},i=Dt(t,["text"]);null!=i&&jt(n,["text"],i);const o=Dt(t,["finished"]);return null!=o&&jt(n,["finished"],o),n}function Ei(e,t){const n={},i=Dt(t,["modelTurn"]);null!=i&&jt(n,["modelTurn"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["thought"]);null!=i&&jt(n,["thought"],i);const o=Dt(t,["inlineData"]);null!=o&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["data"]);null!=i&&jt(n,["data"],i);const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,o));const a=Dt(t,["codeExecutionResult"]);null!=a&&jt(n,["codeExecutionResult"],a);const r=Dt(t,["executableCode"]);null!=r&&jt(n,["executableCode"],r);const s=Dt(t,["fileData"]);null!=s&&jt(n,["fileData"],s);const l=Dt(t,["functionCall"]);null!=l&&jt(n,["functionCall"],l);const c=Dt(t,["functionResponse"]);null!=c&&jt(n,["functionResponse"],c);const u=Dt(t,["text"]);return null!=u&&jt(n,["text"],u),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,i));const o=Dt(t,["turnComplete"]);null!=o&&jt(n,["turnComplete"],o);const a=Dt(t,["interrupted"]);null!=a&&jt(n,["interrupted"],a);const r=Dt(t,["groundingMetadata"]);null!=r&&jt(n,["groundingMetadata"],r);const s=Dt(t,["generationComplete"]);null!=s&&jt(n,["generationComplete"],s);const l=Dt(t,["inputTranscription"]);null!=l&&jt(n,["inputTranscription"],Ii(0,l));const c=Dt(t,["outputTranscription"]);return null!=c&&jt(n,["outputTranscription"],Ii(0,c)),n}function Oi(e,t){const n={},i=Dt(t,["modelTurn"]);null!=i&&jt(n,["modelTurn"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["videoMetadata"]);null!=i&&jt(n,["videoMetadata"],i);const o=Dt(t,["thought"]);null!=o&&jt(n,["thought"],o);const a=Dt(t,["inlineData"]);null!=a&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["displayName"]);null!=i&&jt(n,["displayName"],i);const o=Dt(t,["data"]);null!=o&&jt(n,["data"],o);const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,a));const r=Dt(t,["codeExecutionResult"]);null!=r&&jt(n,["codeExecutionResult"],r);const s=Dt(t,["executableCode"]);null!=s&&jt(n,["executableCode"],s);const l=Dt(t,["fileData"]);null!=l&&jt(n,["fileData"],l);const c=Dt(t,["functionCall"]);null!=c&&jt(n,["functionCall"],c);const u=Dt(t,["functionResponse"]);null!=u&&jt(n,["functionResponse"],u);const d=Dt(t,["text"]);return null!=d&&jt(n,["text"],d),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,i));const o=Dt(t,["turnComplete"]);null!=o&&jt(n,["turnComplete"],o);const a=Dt(t,["interrupted"]);null!=a&&jt(n,["interrupted"],a);const r=Dt(t,["groundingMetadata"]);null!=r&&jt(n,["groundingMetadata"],r);const s=Dt(t,["generationComplete"]);null!=s&&jt(n,["generationComplete"],s);const l=Dt(t,["inputTranscription"]);null!=l&&jt(n,["inputTranscription"],Ai(0,l));const c=Dt(t,["outputTranscription"]);return null!=c&&jt(n,["outputTranscription"],Ai(0,c)),n}function _i(e,t){const n={},i=Dt(t,["modality"]);null!=i&&jt(n,["modality"],i);const o=Dt(t,["tokenCount"]);return null!=o&&jt(n,["tokenCount"],o),n}function Ni(e,t){const n={},i=Dt(t,["modality"]);null!=i&&jt(n,["modality"],i);const o=Dt(t,["tokenCount"]);return null!=o&&jt(n,["tokenCount"],o),n}function Mi(e,t){const n={};null!=Dt(t,["setupComplete"])&&jt(n,["setupComplete"],{});const i=Dt(t,["serverContent"]);null!=i&&jt(n,["serverContent"],Ei(0,i));const o=Dt(t,["toolCall"]);null!=o&&jt(n,["toolCall"],function(e,t){const n={},i=Dt(t,["functionCalls"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["id"]);null!=i&&jt(n,["id"],i);const o=Dt(t,["args"]);null!=o&&jt(n,["args"],o);const a=Dt(t,["name"]);return null!=a&&jt(n,["name"],a),n}(0,e)))),jt(n,["functionCalls"],e)}return n}(0,o));const a=Dt(t,["toolCallCancellation"]);null!=a&&jt(n,["toolCallCancellation"],function(e,t){const n={},i=Dt(t,["ids"]);return null!=i&&jt(n,["ids"],i),n}(0,a));const r=Dt(t,["usageMetadata"]);null!=r&&jt(n,["usageMetadata"],function(e,t){const n={},i=Dt(t,["promptTokenCount"]);null!=i&&jt(n,["promptTokenCount"],i);const o=Dt(t,["cachedContentTokenCount"]);null!=o&&jt(n,["cachedContentTokenCount"],o);const a=Dt(t,["responseTokenCount"]);null!=a&&jt(n,["responseTokenCount"],a);const r=Dt(t,["toolUsePromptTokenCount"]);null!=r&&jt(n,["toolUsePromptTokenCount"],r);const s=Dt(t,["thoughtsTokenCount"]);null!=s&&jt(n,["thoughtsTokenCount"],s);const l=Dt(t,["totalTokenCount"]);null!=l&&jt(n,["totalTokenCount"],l);const c=Dt(t,["promptTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map((e=>_i(0,e)))),jt(n,["promptTokensDetails"],e)}const u=Dt(t,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map((e=>_i(0,e)))),jt(n,["cacheTokensDetails"],e)}const d=Dt(t,["responseTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map((e=>_i(0,e)))),jt(n,["responseTokensDetails"],e)}const p=Dt(t,["toolUsePromptTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map((e=>_i(0,e)))),jt(n,["toolUsePromptTokensDetails"],e)}return n}(0,r));const s=Dt(t,["goAway"]);null!=s&&jt(n,["goAway"],function(e,t){const n={},i=Dt(t,["timeLeft"]);return null!=i&&jt(n,["timeLeft"],i),n}(0,s));const l=Dt(t,["sessionResumptionUpdate"]);return null!=l&&jt(n,["sessionResumptionUpdate"],function(e,t){const n={},i=Dt(t,["newHandle"]);null!=i&&jt(n,["newHandle"],i);const o=Dt(t,["resumable"]);null!=o&&jt(n,["resumable"],o);const a=Dt(t,["lastConsumedClientMessageIndex"]);return null!=a&&jt(n,["lastConsumedClientMessageIndex"],a),n}(0,l)),n}function Ri(e,t){const n={};null!=Dt(t,["setupComplete"])&&jt(n,["setupComplete"],{});const i=Dt(t,["serverContent"]);null!=i&&jt(n,["serverContent"],Oi(0,i));const o=Dt(t,["toolCall"]);null!=o&&jt(n,["toolCall"],function(e,t){const n={},i=Dt(t,["functionCalls"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["args"]);null!=i&&jt(n,["args"],i);const o=Dt(t,["name"]);return null!=o&&jt(n,["name"],o),n}(0,e)))),jt(n,["functionCalls"],e)}return n}(0,o));const a=Dt(t,["toolCallCancellation"]);null!=a&&jt(n,["toolCallCancellation"],function(e,t){const n={},i=Dt(t,["ids"]);return null!=i&&jt(n,["ids"],i),n}(0,a));const r=Dt(t,["usageMetadata"]);null!=r&&jt(n,["usageMetadata"],function(e,t){const n={},i=Dt(t,["promptTokenCount"]);null!=i&&jt(n,["promptTokenCount"],i);const o=Dt(t,["cachedContentTokenCount"]);null!=o&&jt(n,["cachedContentTokenCount"],o);const a=Dt(t,["candidatesTokenCount"]);null!=a&&jt(n,["responseTokenCount"],a);const r=Dt(t,["toolUsePromptTokenCount"]);null!=r&&jt(n,["toolUsePromptTokenCount"],r);const s=Dt(t,["thoughtsTokenCount"]);null!=s&&jt(n,["thoughtsTokenCount"],s);const l=Dt(t,["totalTokenCount"]);null!=l&&jt(n,["totalTokenCount"],l);const c=Dt(t,["promptTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map((e=>Ni(0,e)))),jt(n,["promptTokensDetails"],e)}const u=Dt(t,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map((e=>Ni(0,e)))),jt(n,["cacheTokensDetails"],e)}const d=Dt(t,["candidatesTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map((e=>Ni(0,e)))),jt(n,["responseTokensDetails"],e)}const p=Dt(t,["toolUsePromptTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map((e=>Ni(0,e)))),jt(n,["toolUsePromptTokensDetails"],e)}const h=Dt(t,["trafficType"]);return null!=h&&jt(n,["trafficType"],h),n}(0,r));const s=Dt(t,["goAway"]);null!=s&&jt(n,["goAway"],function(e,t){const n={},i=Dt(t,["timeLeft"]);return null!=i&&jt(n,["timeLeft"],i),n}(0,s));const l=Dt(t,["sessionResumptionUpdate"]);return null!=l&&jt(n,["sessionResumptionUpdate"],function(e,t){const n={},i=Dt(t,["newHandle"]);null!=i&&jt(n,["newHandle"],i);const o=Dt(t,["resumable"]);null!=o&&jt(n,["resumable"],o);const a=Dt(t,["lastConsumedClientMessageIndex"]);return null!=a&&jt(n,["lastConsumedClientMessageIndex"],a),n}(0,l)),n}function ji(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["videoMetadata"]))throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=Dt(t,["thought"]);null!=i&&jt(n,["thought"],i);const o=Dt(t,["inlineData"]);null!=o&&jt(n,["inlineData"],function(e,t){const n={};if(void 0!==Dt(t,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const i=Dt(t,["data"]);null!=i&&jt(n,["data"],i);const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,o));const a=Dt(t,["codeExecutionResult"]);null!=a&&jt(n,["codeExecutionResult"],a);const r=Dt(t,["executableCode"]);null!=r&&jt(n,["executableCode"],r);const s=Dt(t,["fileData"]);null!=s&&jt(n,["fileData"],s);const l=Dt(t,["functionCall"]);null!=l&&jt(n,["functionCall"],l);const c=Dt(t,["functionResponse"]);null!=c&&jt(n,["functionResponse"],c);const u=Dt(t,["text"]);return null!=u&&jt(n,["text"],u),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}function Di(e,t,n){const i={},o=Dt(t,["systemInstruction"]);void 0!==n&&null!=o&&jt(n,["systemInstruction"],ji(0,Wt(0,o)));const a=Dt(t,["temperature"]);null!=a&&jt(i,["temperature"],a);const r=Dt(t,["topP"]);null!=r&&jt(i,["topP"],r);const s=Dt(t,["topK"]);null!=s&&jt(i,["topK"],s);const l=Dt(t,["candidateCount"]);null!=l&&jt(i,["candidateCount"],l);const c=Dt(t,["maxOutputTokens"]);null!=c&&jt(i,["maxOutputTokens"],c);const u=Dt(t,["stopSequences"]);null!=u&&jt(i,["stopSequences"],u);const d=Dt(t,["responseLogprobs"]);null!=d&&jt(i,["responseLogprobs"],d);const p=Dt(t,["logprobs"]);null!=p&&jt(i,["logprobs"],p);const h=Dt(t,["presencePenalty"]);null!=h&&jt(i,["presencePenalty"],h);const g=Dt(t,["frequencyPenalty"]);null!=g&&jt(i,["frequencyPenalty"],g);const m=Dt(t,["seed"]);null!=m&&jt(i,["seed"],m);const f=Dt(t,["responseMimeType"]);null!=f&&jt(i,["responseMimeType"],f);const v=Dt(t,["responseSchema"]);if(null!=v&&jt(i,["responseSchema"],Jt(0,v)),void 0!==Dt(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==Dt(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=Dt(t,["safetySettings"]);if(void 0!==n&&null!=y){let e=y;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["method"]))throw new Error("method parameter is not supported in Gemini API.");const i=Dt(t,["category"]);null!=i&&jt(n,["category"],i);const o=Dt(t,["threshold"]);return null!=o&&jt(n,["threshold"],o),n}(0,e)))),jt(n,["safetySettings"],e)}const b=Dt(t,["tools"]);if(void 0!==n&&null!=b){let e=Zt(0,b);Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={};if(void 0!==Dt(t,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const i=Dt(t,["googleSearchRetrieval"]);if(null!=i&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,i)),void 0!==Dt(t,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==Dt(t,["googleMaps"]))throw new Error("googleMaps parameter is not supported in Gemini API.");const o=Dt(t,["codeExecution"]);null!=o&&jt(n,["codeExecution"],o);const a=Dt(t,["functionDeclarations"]);return null!=a&&jt(n,["functionDeclarations"],a),n}(0,Yt(0,e))))),jt(n,["tools"],e)}const k=Dt(t,["toolConfig"]);if(void 0!==n&&null!=k&&jt(n,["toolConfig"],function(e,t){const n={},i=Dt(t,["functionCallingConfig"]);if(null!=i&&jt(n,["functionCallingConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["allowedFunctionNames"]);return null!=o&&jt(n,["allowedFunctionNames"],o),n}(0,i)),void 0!==Dt(t,["retrievalConfig"]))throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}(0,k)),void 0!==Dt(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const S=Dt(t,["cachedContent"]);void 0!==n&&null!=S&&jt(n,["cachedContent"],Xt(e,S));const w=Dt(t,["responseModalities"]);null!=w&&jt(i,["responseModalities"],w);const T=Dt(t,["mediaResolution"]);null!=T&&jt(i,["mediaResolution"],T);const C=Dt(t,["speechConfig"]);if(null!=C&&jt(i,["speechConfig"],function(e,t){const n={},i=Dt(t,["voiceConfig"]);null!=i&&jt(n,["voiceConfig"],function(e,t){const n={},i=Dt(t,["prebuiltVoiceConfig"]);return null!=i&&jt(n,["prebuiltVoiceConfig"],function(e,t){const n={},i=Dt(t,["voiceName"]);return null!=i&&jt(n,["voiceName"],i),n}(0,i)),n}(0,i));const o=Dt(t,["languageCode"]);return null!=o&&jt(n,["languageCode"],o),n}(0,Qt(0,C))),void 0!==Dt(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=Dt(t,["thinkingConfig"]);return null!=P&&jt(i,["thinkingConfig"],function(e,t){const n={},i=Dt(t,["includeThoughts"]);null!=i&&jt(n,["includeThoughts"],i);const o=Dt(t,["thinkingBudget"]);return null!=o&&jt(n,["thinkingBudget"],o),n}(0,P)),i}function Li(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);if(null!=o){let e=$t(0,o);Array.isArray(e)&&(e=e.map((e=>ji(0,e)))),jt(n,["contents"],e)}const a=Dt(t,["config"]);return null!=a&&jt(n,["generationConfig"],Di(e,a,n)),n}function Fi(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["videoMetadata"]);null!=i&&jt(n,["videoMetadata"],i);const o=Dt(t,["thought"]);null!=o&&jt(n,["thought"],o);const a=Dt(t,["inlineData"]);null!=a&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["displayName"]);null!=i&&jt(n,["displayName"],i);const o=Dt(t,["data"]);null!=o&&jt(n,["data"],o);const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,a));const r=Dt(t,["codeExecutionResult"]);null!=r&&jt(n,["codeExecutionResult"],r);const s=Dt(t,["executableCode"]);null!=s&&jt(n,["executableCode"],s);const l=Dt(t,["fileData"]);null!=l&&jt(n,["fileData"],l);const c=Dt(t,["functionCall"]);null!=c&&jt(n,["functionCall"],c);const u=Dt(t,["functionResponse"]);null!=u&&jt(n,["functionResponse"],u);const d=Dt(t,["text"]);return null!=d&&jt(n,["text"],d),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}function zi(e,t){const n={},i=Dt(t,["retrieval"]);null!=i&&jt(n,["retrieval"],i),null!=Dt(t,["googleSearch"])&&jt(n,["googleSearch"],{});const o=Dt(t,["googleSearchRetrieval"]);null!=o&&jt(n,["googleSearchRetrieval"],function(e,t){const n={},i=Dt(t,["dynamicRetrievalConfig"]);return null!=i&&jt(n,["dynamicRetrievalConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["dynamicThreshold"]);return null!=o&&jt(n,["dynamicThreshold"],o),n}(0,i)),n}(0,o)),null!=Dt(t,["enterpriseWebSearch"])&&jt(n,["enterpriseWebSearch"],{});const a=Dt(t,["googleMaps"]);null!=a&&jt(n,["googleMaps"],function(e,t){const n={},i=Dt(t,["authConfig"]);return null!=i&&jt(n,["authConfig"],function(e,t){const n={},i=Dt(t,["apiKeyConfig"]);null!=i&&jt(n,["apiKeyConfig"],function(e,t){const n={},i=Dt(t,["apiKeyString"]);return null!=i&&jt(n,["apiKeyString"],i),n}(0,i));const o=Dt(t,["authType"]);null!=o&&jt(n,["authType"],o);const a=Dt(t,["googleServiceAccountConfig"]);null!=a&&jt(n,["googleServiceAccountConfig"],a);const r=Dt(t,["httpBasicAuthConfig"]);null!=r&&jt(n,["httpBasicAuthConfig"],r);const s=Dt(t,["oauthConfig"]);null!=s&&jt(n,["oauthConfig"],s);const l=Dt(t,["oidcConfig"]);return null!=l&&jt(n,["oidcConfig"],l),n}(0,i)),n}(0,a));const r=Dt(t,["codeExecution"]);null!=r&&jt(n,["codeExecution"],r);const s=Dt(t,["functionDeclarations"]);return null!=s&&jt(n,["functionDeclarations"],s),n}function Ui(e,t){const n={},i=Dt(t,["functionCallingConfig"]);null!=i&&jt(n,["functionCallingConfig"],function(e,t){const n={},i=Dt(t,["mode"]);null!=i&&jt(n,["mode"],i);const o=Dt(t,["allowedFunctionNames"]);return null!=o&&jt(n,["allowedFunctionNames"],o),n}(0,i));const o=Dt(t,["retrievalConfig"]);return null!=o&&jt(n,["retrievalConfig"],function(e,t){const n={},i=Dt(t,["latLng"]);return null!=i&&jt(n,["latLng"],function(e,t){const n={},i=Dt(t,["latitude"]);null!=i&&jt(n,["latitude"],i);const o=Dt(t,["longitude"]);return null!=o&&jt(n,["longitude"],o),n}(0,i)),n}(0,o)),n}function Vi(e,t,n){const i={},o=Dt(t,["systemInstruction"]);void 0!==n&&null!=o&&jt(n,["systemInstruction"],Fi(0,Wt(0,o)));const a=Dt(t,["temperature"]);null!=a&&jt(i,["temperature"],a);const r=Dt(t,["topP"]);null!=r&&jt(i,["topP"],r);const s=Dt(t,["topK"]);null!=s&&jt(i,["topK"],s);const l=Dt(t,["candidateCount"]);null!=l&&jt(i,["candidateCount"],l);const c=Dt(t,["maxOutputTokens"]);null!=c&&jt(i,["maxOutputTokens"],c);const u=Dt(t,["stopSequences"]);null!=u&&jt(i,["stopSequences"],u);const d=Dt(t,["responseLogprobs"]);null!=d&&jt(i,["responseLogprobs"],d);const p=Dt(t,["logprobs"]);null!=p&&jt(i,["logprobs"],p);const h=Dt(t,["presencePenalty"]);null!=h&&jt(i,["presencePenalty"],h);const g=Dt(t,["frequencyPenalty"]);null!=g&&jt(i,["frequencyPenalty"],g);const m=Dt(t,["seed"]);null!=m&&jt(i,["seed"],m);const f=Dt(t,["responseMimeType"]);null!=f&&jt(i,["responseMimeType"],f);const v=Dt(t,["responseSchema"]);null!=v&&jt(i,["responseSchema"],Jt(0,v));const y=Dt(t,["routingConfig"]);null!=y&&jt(i,["routingConfig"],y);const b=Dt(t,["modelSelectionConfig"]);null!=b&&jt(i,["modelConfig"],function(e,t){const n={},i=Dt(t,["featureSelectionPreference"]);return null!=i&&jt(n,["featureSelectionPreference"],i),n}(0,b));const k=Dt(t,["safetySettings"]);if(void 0!==n&&null!=k){let e=k;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["method"]);null!=i&&jt(n,["method"],i);const o=Dt(t,["category"]);null!=o&&jt(n,["category"],o);const a=Dt(t,["threshold"]);return null!=a&&jt(n,["threshold"],a),n}(0,e)))),jt(n,["safetySettings"],e)}const S=Dt(t,["tools"]);if(void 0!==n&&null!=S){let e=Zt(0,S);Array.isArray(e)&&(e=e.map((e=>zi(0,Yt(0,e))))),jt(n,["tools"],e)}const w=Dt(t,["toolConfig"]);void 0!==n&&null!=w&&jt(n,["toolConfig"],Ui(0,w));const T=Dt(t,["labels"]);void 0!==n&&null!=T&&jt(n,["labels"],T);const C=Dt(t,["cachedContent"]);void 0!==n&&null!=C&&jt(n,["cachedContent"],Xt(e,C));const P=Dt(t,["responseModalities"]);null!=P&&jt(i,["responseModalities"],P);const x=Dt(t,["mediaResolution"]);null!=x&&jt(i,["mediaResolution"],x);const I=Dt(t,["speechConfig"]);null!=I&&jt(i,["speechConfig"],function(e,t){const n={},i=Dt(t,["voiceConfig"]);null!=i&&jt(n,["voiceConfig"],function(e,t){const n={},i=Dt(t,["prebuiltVoiceConfig"]);return null!=i&&jt(n,["prebuiltVoiceConfig"],function(e,t){const n={},i=Dt(t,["voiceName"]);return null!=i&&jt(n,["voiceName"],i),n}(0,i)),n}(0,i));const o=Dt(t,["languageCode"]);return null!=o&&jt(n,["languageCode"],o),n}(0,Qt(0,I)));const A=Dt(t,["audioTimestamp"]);null!=A&&jt(i,["audioTimestamp"],A);const E=Dt(t,["thinkingConfig"]);return null!=E&&jt(i,["thinkingConfig"],function(e,t){const n={},i=Dt(t,["includeThoughts"]);null!=i&&jt(n,["includeThoughts"],i);const o=Dt(t,["thinkingBudget"]);return null!=o&&jt(n,["thinkingBudget"],o),n}(0,E)),i}function Bi(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);if(null!=o){let e=$t(0,o);Array.isArray(e)&&(e=e.map((e=>Fi(0,e)))),jt(n,["contents"],e)}const a=Dt(t,["config"]);return null!=a&&jt(n,["generationConfig"],Vi(e,a,n)),n}function qi(e,t){const n={},i=Dt(t,["gcsUri"]);null!=i&&jt(n,["gcsUri"],i);const o=Dt(t,["imageBytes"]);null!=o&&jt(n,["bytesBase64Encoded"],tn(0,o));const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}function Ki(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["prompt"]);null!=o&&jt(n,["instances[0]","prompt"],o);const a=Dt(t,["referenceImages"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["referenceImage"]);null!=i&&jt(n,["referenceImage"],qi(0,i));const o=Dt(t,["referenceId"]);null!=o&&jt(n,["referenceId"],o);const a=Dt(t,["referenceType"]);null!=a&&jt(n,["referenceType"],a);const r=Dt(t,["maskImageConfig"]);null!=r&&jt(n,["maskImageConfig"],function(e,t){const n={},i=Dt(t,["maskMode"]);null!=i&&jt(n,["maskMode"],i);const o=Dt(t,["segmentationClasses"]);null!=o&&jt(n,["maskClasses"],o);const a=Dt(t,["maskDilation"]);return null!=a&&jt(n,["dilation"],a),n}(0,r));const s=Dt(t,["controlImageConfig"]);null!=s&&jt(n,["controlImageConfig"],function(e,t){const n={},i=Dt(t,["controlType"]);null!=i&&jt(n,["controlType"],i);const o=Dt(t,["enableControlImageComputation"]);return null!=o&&jt(n,["computeControl"],o),n}(0,s));const l=Dt(t,["styleImageConfig"]);null!=l&&jt(n,["styleImageConfig"],function(e,t){const n={},i=Dt(t,["styleDescription"]);return null!=i&&jt(n,["styleDescription"],i),n}(0,l));const c=Dt(t,["subjectImageConfig"]);return null!=c&&jt(n,["subjectImageConfig"],function(e,t){const n={},i=Dt(t,["subjectType"]);null!=i&&jt(n,["subjectType"],i);const o=Dt(t,["subjectDescription"]);return null!=o&&jt(n,["subjectDescription"],o),n}(0,c)),n}(0,e)))),jt(n,["instances[0]","referenceImages"],e)}const r=Dt(t,["config"]);return null!=r&&jt(n,["config"],function(e,t,n){const i=Dt(t,["outputGcsUri"]);void 0!==n&&null!=i&&jt(n,["parameters","storageUri"],i);const o=Dt(t,["negativePrompt"]);void 0!==n&&null!=o&&jt(n,["parameters","negativePrompt"],o);const a=Dt(t,["numberOfImages"]);void 0!==n&&null!=a&&jt(n,["parameters","sampleCount"],a);const r=Dt(t,["aspectRatio"]);void 0!==n&&null!=r&&jt(n,["parameters","aspectRatio"],r);const s=Dt(t,["guidanceScale"]);void 0!==n&&null!=s&&jt(n,["parameters","guidanceScale"],s);const l=Dt(t,["seed"]);void 0!==n&&null!=l&&jt(n,["parameters","seed"],l);const c=Dt(t,["safetyFilterLevel"]);void 0!==n&&null!=c&&jt(n,["parameters","safetySetting"],c);const u=Dt(t,["personGeneration"]);void 0!==n&&null!=u&&jt(n,["parameters","personGeneration"],u);const d=Dt(t,["includeSafetyAttributes"]);void 0!==n&&null!=d&&jt(n,["parameters","includeSafetyAttributes"],d);const p=Dt(t,["includeRaiReason"]);void 0!==n&&null!=p&&jt(n,["parameters","includeRaiReason"],p);const h=Dt(t,["language"]);void 0!==n&&null!=h&&jt(n,["parameters","language"],h);const g=Dt(t,["outputMimeType"]);void 0!==n&&null!=g&&jt(n,["parameters","outputOptions","mimeType"],g);const m=Dt(t,["outputCompressionQuality"]);void 0!==n&&null!=m&&jt(n,["parameters","outputOptions","compressionQuality"],m);const f=Dt(t,["editMode"]);void 0!==n&&null!=f&&jt(n,["parameters","editMode"],f);const v=Dt(t,["baseSteps"]);return void 0!==n&&null!=v&&jt(n,["parameters","editConfig","baseSteps"],v),{}}(0,r,n)),n}function Hi(e,t){const n={},i=Dt(t,["content"]);null!=i&&jt(n,["content"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["thought"]);null!=i&&jt(n,["thought"],i);const o=Dt(t,["inlineData"]);null!=o&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["data"]);null!=i&&jt(n,["data"],i);const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,o));const a=Dt(t,["codeExecutionResult"]);null!=a&&jt(n,["codeExecutionResult"],a);const r=Dt(t,["executableCode"]);null!=r&&jt(n,["executableCode"],r);const s=Dt(t,["fileData"]);null!=s&&jt(n,["fileData"],s);const l=Dt(t,["functionCall"]);null!=l&&jt(n,["functionCall"],l);const c=Dt(t,["functionResponse"]);null!=c&&jt(n,["functionResponse"],c);const u=Dt(t,["text"]);return null!=u&&jt(n,["text"],u),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,i));const o=Dt(t,["citationMetadata"]);null!=o&&jt(n,["citationMetadata"],function(e,t){const n={},i=Dt(t,["citationSources"]);return null!=i&&jt(n,["citations"],i),n}(0,o));const a=Dt(t,["tokenCount"]);null!=a&&jt(n,["tokenCount"],a);const r=Dt(t,["finishReason"]);null!=r&&jt(n,["finishReason"],r);const s=Dt(t,["avgLogprobs"]);null!=s&&jt(n,["avgLogprobs"],s);const l=Dt(t,["groundingMetadata"]);null!=l&&jt(n,["groundingMetadata"],l);const c=Dt(t,["index"]);null!=c&&jt(n,["index"],c);const u=Dt(t,["logprobsResult"]);null!=u&&jt(n,["logprobsResult"],u);const d=Dt(t,["safetyRatings"]);return null!=d&&jt(n,["safetyRatings"],d),n}function Wi(e,t){const n={},i=Dt(t,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>Hi(0,e)))),jt(n,["candidates"],e)}const o=Dt(t,["modelVersion"]);null!=o&&jt(n,["modelVersion"],o);const a=Dt(t,["promptFeedback"]);null!=a&&jt(n,["promptFeedback"],a);const r=Dt(t,["usageMetadata"]);return null!=r&&jt(n,["usageMetadata"],r),n}function Gi(e,t){const n={},i=Dt(t,["safetyAttributes","categories"]);null!=i&&jt(n,["categories"],i);const o=Dt(t,["safetyAttributes","scores"]);null!=o&&jt(n,["scores"],o);const a=Dt(t,["contentType"]);return null!=a&&jt(n,["contentType"],a),n}function $i(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["description"]);null!=a&&jt(n,["description"],a);const r=Dt(t,["version"]);null!=r&&jt(n,["version"],r);const s=Dt(t,["_self"]);null!=s&&jt(n,["tunedModelInfo"],function(e,t){const n={},i=Dt(t,["baseModel"]);null!=i&&jt(n,["baseModel"],i);const o=Dt(t,["createTime"]);null!=o&&jt(n,["createTime"],o);const a=Dt(t,["updateTime"]);return null!=a&&jt(n,["updateTime"],a),n}(0,s));const l=Dt(t,["inputTokenLimit"]);null!=l&&jt(n,["inputTokenLimit"],l);const c=Dt(t,["outputTokenLimit"]);null!=c&&jt(n,["outputTokenLimit"],c);const u=Dt(t,["supportedGenerationMethods"]);return null!=u&&jt(n,["supportedActions"],u),n}function Ji(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["metadata"]);null!=o&&jt(n,["metadata"],o);const a=Dt(t,["done"]);null!=a&&jt(n,["done"],a);const r=Dt(t,["error"]);null!=r&&jt(n,["error"],r);const s=Dt(t,["response","generateVideoResponse"]);return null!=s&&jt(n,["response"],function(e,t){const n={},i=Dt(t,["generatedSamples"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["_self"]);return null!=i&&jt(n,["video"],function(e,t){const n={},i=Dt(t,["video","uri"]);null!=i&&jt(n,["uri"],i);const o=Dt(t,["video","encodedVideo"]);null!=o&&jt(n,["videoBytes"],tn(0,o));const a=Dt(t,["encoding"]);return null!=a&&jt(n,["mimeType"],a),n}(0,i)),n}(0,e)))),jt(n,["generatedVideos"],e)}const o=Dt(t,["raiMediaFilteredCount"]);null!=o&&jt(n,["raiMediaFilteredCount"],o);const a=Dt(t,["raiMediaFilteredReasons"]);return null!=a&&jt(n,["raiMediaFilteredReasons"],a),n}(0,s)),n}function Qi(e,t){const n={},i=Dt(t,["content"]);null!=i&&jt(n,["content"],function(e,t){const n={},i=Dt(t,["parts"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["videoMetadata"]);null!=i&&jt(n,["videoMetadata"],i);const o=Dt(t,["thought"]);null!=o&&jt(n,["thought"],o);const a=Dt(t,["inlineData"]);null!=a&&jt(n,["inlineData"],function(e,t){const n={},i=Dt(t,["displayName"]);null!=i&&jt(n,["displayName"],i);const o=Dt(t,["data"]);null!=o&&jt(n,["data"],o);const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,a));const r=Dt(t,["codeExecutionResult"]);null!=r&&jt(n,["codeExecutionResult"],r);const s=Dt(t,["executableCode"]);null!=s&&jt(n,["executableCode"],s);const l=Dt(t,["fileData"]);null!=l&&jt(n,["fileData"],l);const c=Dt(t,["functionCall"]);null!=c&&jt(n,["functionCall"],c);const u=Dt(t,["functionResponse"]);null!=u&&jt(n,["functionResponse"],u);const d=Dt(t,["text"]);return null!=d&&jt(n,["text"],d),n}(0,e)))),jt(n,["parts"],e)}const o=Dt(t,["role"]);return null!=o&&jt(n,["role"],o),n}(0,i));const o=Dt(t,["citationMetadata"]);null!=o&&jt(n,["citationMetadata"],function(e,t){const n={},i=Dt(t,["citations"]);return null!=i&&jt(n,["citations"],i),n}(0,o));const a=Dt(t,["finishMessage"]);null!=a&&jt(n,["finishMessage"],a);const r=Dt(t,["finishReason"]);null!=r&&jt(n,["finishReason"],r);const s=Dt(t,["avgLogprobs"]);null!=s&&jt(n,["avgLogprobs"],s);const l=Dt(t,["groundingMetadata"]);null!=l&&jt(n,["groundingMetadata"],l);const c=Dt(t,["index"]);null!=c&&jt(n,["index"],c);const u=Dt(t,["logprobsResult"]);null!=u&&jt(n,["logprobsResult"],u);const d=Dt(t,["safetyRatings"]);return null!=d&&jt(n,["safetyRatings"],d),n}function Yi(e,t){const n={},i=Dt(t,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>Qi(0,e)))),jt(n,["candidates"],e)}const o=Dt(t,["createTime"]);null!=o&&jt(n,["createTime"],o);const a=Dt(t,["responseId"]);null!=a&&jt(n,["responseId"],a);const r=Dt(t,["modelVersion"]);null!=r&&jt(n,["modelVersion"],r);const s=Dt(t,["promptFeedback"]);null!=s&&jt(n,["promptFeedback"],s);const l=Dt(t,["usageMetadata"]);return null!=l&&jt(n,["usageMetadata"],l),n}function Zi(e,t){const n={},i=Dt(t,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["values"]);null!=i&&jt(n,["values"],i);const o=Dt(t,["statistics"]);return null!=o&&jt(n,["statistics"],function(e,t){const n={},i=Dt(t,["truncated"]);null!=i&&jt(n,["truncated"],i);const o=Dt(t,["token_count"]);return null!=o&&jt(n,["tokenCount"],o),n}(0,o)),n}(0,e)))),jt(n,["embeddings"],e)}const o=Dt(t,["metadata"]);return null!=o&&jt(n,["metadata"],function(e,t){const n={},i=Dt(t,["billableCharacterCount"]);return null!=i&&jt(n,["billableCharacterCount"],i),n}(0,o)),n}function Xi(e,t){const n={},i=Dt(t,["safetyAttributes","categories"]);null!=i&&jt(n,["categories"],i);const o=Dt(t,["safetyAttributes","scores"]);null!=o&&jt(n,["scores"],o);const a=Dt(t,["contentType"]);return null!=a&&jt(n,["contentType"],a),n}function eo(e,t){const n={},i=Dt(t,["_self"]);null!=i&&jt(n,["image"],function(e,t){const n={},i=Dt(t,["gcsUri"]);null!=i&&jt(n,["gcsUri"],i);const o=Dt(t,["bytesBase64Encoded"]);null!=o&&jt(n,["imageBytes"],tn(0,o));const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,i));const o=Dt(t,["raiFilteredReason"]);null!=o&&jt(n,["raiFilteredReason"],o);const a=Dt(t,["_self"]);null!=a&&jt(n,["safetyAttributes"],Xi(0,a));const r=Dt(t,["prompt"]);return null!=r&&jt(n,["enhancedPrompt"],r),n}function to(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["displayName"]);null!=o&&jt(n,["displayName"],o);const a=Dt(t,["description"]);null!=a&&jt(n,["description"],a);const r=Dt(t,["versionId"]);null!=r&&jt(n,["version"],r);const s=Dt(t,["deployedModels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["endpoint"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["deployedModelId"]);return null!=o&&jt(n,["deployedModelId"],o),n}(0,e)))),jt(n,["endpoints"],e)}const l=Dt(t,["labels"]);null!=l&&jt(n,["labels"],l);const c=Dt(t,["_self"]);null!=c&&jt(n,["tunedModelInfo"],function(e,t){const n={},i=Dt(t,["labels","google-vertex-llm-tuning-base-model-id"]);null!=i&&jt(n,["baseModel"],i);const o=Dt(t,["createTime"]);null!=o&&jt(n,["createTime"],o);const a=Dt(t,["updateTime"]);return null!=a&&jt(n,["updateTime"],a),n}(0,c));const u=Dt(t,["defaultCheckpointId"]);null!=u&&jt(n,["defaultCheckpointId"],u);const d=Dt(t,["checkpoints"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["checkpointId"]);null!=i&&jt(n,["checkpointId"],i);const o=Dt(t,["epoch"]);null!=o&&jt(n,["epoch"],o);const a=Dt(t,["step"]);return null!=a&&jt(n,["step"],a),n}(0,e)))),jt(n,["checkpoints"],e)}return n}function no(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["metadata"]);null!=o&&jt(n,["metadata"],o);const a=Dt(t,["done"]);null!=a&&jt(n,["done"],a);const r=Dt(t,["error"]);null!=r&&jt(n,["error"],r);const s=Dt(t,["response"]);return null!=s&&jt(n,["response"],function(e,t){const n={},i=Dt(t,["videos"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["_self"]);return null!=i&&jt(n,["video"],function(e,t){const n={},i=Dt(t,["gcsUri"]);null!=i&&jt(n,["uri"],i);const o=Dt(t,["bytesBase64Encoded"]);null!=o&&jt(n,["videoBytes"],tn(0,o));const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,i)),n}(0,e)))),jt(n,["generatedVideos"],e)}const o=Dt(t,["raiMediaFilteredCount"]);null!=o&&jt(n,["raiMediaFilteredCount"],o);const a=Dt(t,["raiMediaFilteredReasons"]);return null!=a&&jt(n,["raiMediaFilteredReasons"],a),n}(0,s)),n}class io{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n,i,o;const a=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion();let s;const l=function(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}(this.apiClient.getDefaultHeaders());this.apiClient.isVertexAI()?(s=`${a}/ws/google.cloud.aiplatform.${r}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(l)):s=`${a}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateContent?key=${this.apiClient.getApiKey()}`;let c=()=>{};const u=new Promise((e=>{c=e})),d=e.callbacks,p=this.apiClient,h={onopen:function(){var e;null===(e=null==d?void 0:d.onopen)||void 0===e||e.call(d),c({})},onmessage:e=>{!async function(e,t,n){const i=new di;let o;if(o=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),e.isVertexAI()){const e=Ri(0,o);Object.assign(i,e)}else{const e=Mi(0,o);Object.assign(i,e)}t(i)}(p,d.onmessage,e)},onerror:null!==(t=null==d?void 0:d.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==d?void 0:d.onclose)&&void 0!==n?n:function(e){}},g=this.webSocketFactory.create(s,function(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}(l),h);g.connect(),await u;let m=Lt(this.apiClient,e.model);this.apiClient.isVertexAI()&&m.startsWith("publishers/")&&(m=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+m);let f={};this.apiClient.isVertexAI()&&void 0===(null===(i=e.config)||void 0===i?void 0:i.responseModalities)&&(void 0===e.config?e.config={responseModalities:[In.AUDIO]}:e.config.responseModalities=[In.AUDIO]),(null===(o=e.config)||void 0===o?void 0:o.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const v={model:m,config:e.config,callbacks:e.callbacks};return f=this.apiClient.isVertexAI()?function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["setup","model"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],Ci(0,o,n)),n}(this.apiClient,v):function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["setup","model"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],Ti(0,o,n)),n}(this.apiClient,v),delete f.config,g.send(JSON.stringify(f)),new ao(g,this.apiClient)}}const oo={turnComplete:!0};class ao{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=$t(0,t.turns),n=e.isVertexAI()?n.map((e=>Fi(0,e))):n.map((e=>ji(0,e)))}catch(e){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw new Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},oo),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:xi(this.apiClient,e)}:{realtimeInput:Pi(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}class ro extends Mt{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then((e=>{var t;let n;const i=[];if(null==e?void 0:e.generatedImages)for(const o of e.generatedImages)o&&(null==o?void 0:o.safetyAttributes)&&"Positive Prompt"===(null===(t=null==o?void 0:o.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==o?void 0:o.safetyAttributes:i.push(o);let o;return o=n?{generatedImages:i,positivePromptSafetyAttributes:n}:{generatedImages:i},o})),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new $n(hn.PAGED_ITEM_MODELS,(e=>this.listInternal(e)),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map((e=>e.toReferenceImageAPI()))),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)}}async generateContentInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=Bi(this.apiClient,e);return r=Rt("{model}:generateContent",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=Yi(this.apiClient,e),n=new Jn;return Object.assign(n,t),n}))}{const t=Li(this.apiClient,e);return r=Rt("{model}:generateContent",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=Wi(this.apiClient,e),n=new Jn;return Object.assign(n,t),n}))}}async generateContentStreamInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=Bi(this.apiClient,e);r=Rt("{model}:streamGenerateContent?alt=sse",i._url),s=i._query,delete i.config,delete i._url,delete i._query;return a=this.apiClient.requestStream({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),a.then((function(e){return gi(this,arguments,(function*(){var t,n,i,o;try{for(var a,r=!0,s=mi(e);!(t=(a=yield hi(s.next())).done);r=!0){o=a.value,r=!1;const e=o,t=Yi(0,yield hi(e.json())),n=new Jn;Object.assign(n,t),yield yield hi(n)}}catch(e){n={error:e}}finally{try{r||t||!(i=s.return)||(yield hi(i.call(s)))}finally{if(n)throw n.error}}}))}))}{const t=Li(this.apiClient,e);r=Rt("{model}:streamGenerateContent?alt=sse",t._url),s=t._query,delete t.config,delete t._url,delete t._query;return a=this.apiClient.requestStream({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}),a.then((function(e){return gi(this,arguments,(function*(){var t,n,i,o;try{for(var a,r=!0,s=mi(e);!(t=(a=yield hi(s.next())).done);r=!0){o=a.value,r=!1;const e=o,t=Wi(0,yield hi(e.json())),n=new Jn;Object.assign(n,t),yield yield hi(n)}}catch(e){n={error:e}}finally{try{r||t||!(i=s.return)||(yield hi(i.call(s)))}finally{if(n)throw n.error}}}))}))}}async embedContent(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);null!=o&&jt(n,["instances[]","content"],Gt(e,o));const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){const i=Dt(t,["taskType"]);void 0!==n&&null!=i&&jt(n,["instances[]","task_type"],i);const o=Dt(t,["title"]);void 0!==n&&null!=o&&jt(n,["instances[]","title"],o);const a=Dt(t,["outputDimensionality"]);void 0!==n&&null!=a&&jt(n,["parameters","outputDimensionality"],a);const r=Dt(t,["mimeType"]);void 0!==n&&null!=r&&jt(n,["instances[]","mimeType"],r);const s=Dt(t,["autoTruncate"]);return void 0!==n&&null!=s&&jt(n,["parameters","autoTruncate"],s),{}}(0,a,n)),n}(this.apiClient,e);return r=Rt("{model}:predict",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=Zi(this.apiClient,e),n=new Qn;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);null!=o&&jt(n,["requests[]","content"],Gt(e,o));const a=Dt(t,["config"]);null!=a&&jt(n,["config"],function(e,t,n){const i=Dt(t,["taskType"]);void 0!==n&&null!=i&&jt(n,["requests[]","taskType"],i);const o=Dt(t,["title"]);void 0!==n&&null!=o&&jt(n,["requests[]","title"],o);const a=Dt(t,["outputDimensionality"]);if(void 0!==n&&null!=a&&jt(n,["requests[]","outputDimensionality"],a),void 0!==Dt(t,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==Dt(t,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(0,a,n));const r=Dt(t,["model"]);return void 0!==r&&jt(n,["requests[]","model"],Lt(e,r)),n}(this.apiClient,e);return r=Rt("{model}:batchEmbedContents",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["values"]);return null!=i&&jt(n,["values"],i),n}(0,e)))),jt(n,["embeddings"],e)}return null!=Dt(t,["metadata"])&&jt(n,["metadata"],{}),n}(this.apiClient,e),n=new Qn;return Object.assign(n,t),n}))}}async generateImagesInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["prompt"]);null!=o&&jt(n,["instances[0]","prompt"],o);const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){const i=Dt(t,["outputGcsUri"]);void 0!==n&&null!=i&&jt(n,["parameters","storageUri"],i);const o=Dt(t,["negativePrompt"]);void 0!==n&&null!=o&&jt(n,["parameters","negativePrompt"],o);const a=Dt(t,["numberOfImages"]);void 0!==n&&null!=a&&jt(n,["parameters","sampleCount"],a);const r=Dt(t,["aspectRatio"]);void 0!==n&&null!=r&&jt(n,["parameters","aspectRatio"],r);const s=Dt(t,["guidanceScale"]);void 0!==n&&null!=s&&jt(n,["parameters","guidanceScale"],s);const l=Dt(t,["seed"]);void 0!==n&&null!=l&&jt(n,["parameters","seed"],l);const c=Dt(t,["safetyFilterLevel"]);void 0!==n&&null!=c&&jt(n,["parameters","safetySetting"],c);const u=Dt(t,["personGeneration"]);void 0!==n&&null!=u&&jt(n,["parameters","personGeneration"],u);const d=Dt(t,["includeSafetyAttributes"]);void 0!==n&&null!=d&&jt(n,["parameters","includeSafetyAttributes"],d);const p=Dt(t,["includeRaiReason"]);void 0!==n&&null!=p&&jt(n,["parameters","includeRaiReason"],p);const h=Dt(t,["language"]);void 0!==n&&null!=h&&jt(n,["parameters","language"],h);const g=Dt(t,["outputMimeType"]);void 0!==n&&null!=g&&jt(n,["parameters","outputOptions","mimeType"],g);const m=Dt(t,["outputCompressionQuality"]);void 0!==n&&null!=m&&jt(n,["parameters","outputOptions","compressionQuality"],m);const f=Dt(t,["addWatermark"]);void 0!==n&&null!=f&&jt(n,["parameters","addWatermark"],f);const v=Dt(t,["enhancePrompt"]);return void 0!==n&&null!=v&&jt(n,["parameters","enhancePrompt"],v),{}}(0,a,n)),n}(this.apiClient,e);return r=Rt("{model}:predict",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>eo(0,e)))),jt(n,["generatedImages"],e)}const o=Dt(t,["positivePromptSafetyAttributes"]);return null!=o&&jt(n,["positivePromptSafetyAttributes"],Xi(0,o)),n}(this.apiClient,e),n=new Yn;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["prompt"]);null!=o&&jt(n,["instances[0]","prompt"],o);const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){if(void 0!==Dt(t,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Dt(t,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=Dt(t,["numberOfImages"]);void 0!==n&&null!=i&&jt(n,["parameters","sampleCount"],i);const o=Dt(t,["aspectRatio"]);void 0!==n&&null!=o&&jt(n,["parameters","aspectRatio"],o);const a=Dt(t,["guidanceScale"]);if(void 0!==n&&null!=a&&jt(n,["parameters","guidanceScale"],a),void 0!==Dt(t,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const r=Dt(t,["safetyFilterLevel"]);void 0!==n&&null!=r&&jt(n,["parameters","safetySetting"],r);const s=Dt(t,["personGeneration"]);void 0!==n&&null!=s&&jt(n,["parameters","personGeneration"],s);const l=Dt(t,["includeSafetyAttributes"]);void 0!==n&&null!=l&&jt(n,["parameters","includeSafetyAttributes"],l);const c=Dt(t,["includeRaiReason"]);void 0!==n&&null!=c&&jt(n,["parameters","includeRaiReason"],c);const u=Dt(t,["language"]);void 0!==n&&null!=u&&jt(n,["parameters","language"],u);const d=Dt(t,["outputMimeType"]);void 0!==n&&null!=d&&jt(n,["parameters","outputOptions","mimeType"],d);const p=Dt(t,["outputCompressionQuality"]);if(void 0!==n&&null!=p&&jt(n,["parameters","outputOptions","compressionQuality"],p),void 0!==Dt(t,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==Dt(t,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(0,a,n)),n}(this.apiClient,e);return r=Rt("{model}:predict",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["_self"]);null!=i&&jt(n,["image"],function(e,t){const n={},i=Dt(t,["bytesBase64Encoded"]);null!=i&&jt(n,["imageBytes"],tn(0,i));const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,i));const o=Dt(t,["raiFilteredReason"]);null!=o&&jt(n,["raiFilteredReason"],o);const a=Dt(t,["_self"]);return null!=a&&jt(n,["safetyAttributes"],Gi(0,a)),n}(0,e)))),jt(n,["generatedImages"],e)}const o=Dt(t,["positivePromptSafetyAttributes"]);return null!=o&&jt(n,["positivePromptSafetyAttributes"],Gi(0,o)),n}(this.apiClient,e),n=new Yn;return Object.assign(n,t),n}))}}async editImageInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI()){const r=Ki(this.apiClient,e);return o=Rt("{model}:predict",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>{const t=function(e,t){const n={},i=Dt(t,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>eo(0,e)))),jt(n,["generatedImages"],e)}return n}(this.apiClient,e),n=new Zn;return Object.assign(n,t),n}))}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["image"]);null!=o&&jt(n,["instances[0]","image"],qi(0,o));const a=Dt(t,["upscaleFactor"]);null!=a&&jt(n,["parameters","upscaleConfig","upscaleFactor"],a);const r=Dt(t,["config"]);return null!=r&&jt(n,["config"],function(e,t,n){const i=Dt(t,["includeRaiReason"]);void 0!==n&&null!=i&&jt(n,["parameters","includeRaiReason"],i);const o=Dt(t,["outputMimeType"]);void 0!==n&&null!=o&&jt(n,["parameters","outputOptions","mimeType"],o);const a=Dt(t,["outputCompressionQuality"]);void 0!==n&&null!=a&&jt(n,["parameters","outputOptions","compressionQuality"],a);const r=Dt(t,["numberOfImages"]);void 0!==n&&null!=r&&jt(n,["parameters","sampleCount"],r);const s=Dt(t,["mode"]);return void 0!==n&&null!=s&&jt(n,["parameters","mode"],s),{}}(0,r,n)),n}(this.apiClient,e);return o=Rt("{model}:predict",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>{const t=function(e,t){const n={},i=Dt(t,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>eo(0,e)))),jt(n,["generatedImages"],e)}return n}(this.apiClient,e),n=new Xn;return Object.assign(n,t),n}))}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","name"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>to(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","name"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>$i(this.apiClient,e)))}}async listInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o);const a=Dt(t,["filter"]);void 0!==n&&null!=a&&jt(n,["_query","filter"],a);const r=Dt(t,["queryBase"]);return void 0!==n&&null!=r&&jt(n,["_url","models_url"],on(e,r)),{}}(e,i,n)),n}(this.apiClient,e);return r=Rt("{models_url}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["_self"]);if(null!=o){let e=an(0,o);Array.isArray(e)&&(e=e.map((e=>to(0,e)))),jt(n,["models"],e)}return n}(this.apiClient,e),n=new ei;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o);const a=Dt(t,["filter"]);void 0!==n&&null!=a&&jt(n,["_query","filter"],a);const r=Dt(t,["queryBase"]);return void 0!==n&&null!=r&&jt(n,["_url","models_url"],on(e,r)),{}}(e,i,n)),n}(this.apiClient,e);return r=Rt("{models_url}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["_self"]);if(null!=o){let e=an(0,o);Array.isArray(e)&&(e=e.map((e=>$i(0,e)))),jt(n,["models"],e)}return n}(this.apiClient,e),n=new ei;return Object.assign(n,t),n}))}}async update(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],function(e,t,n){const i=Dt(t,["displayName"]);void 0!==n&&null!=i&&jt(n,["displayName"],i);const o=Dt(t,["description"]);void 0!==n&&null!=o&&jt(n,["description"],o);const a=Dt(t,["defaultCheckpointId"]);return void 0!==n&&null!=a&&jt(n,["defaultCheckpointId"],a),{}}(0,o,n)),n}(this.apiClient,e);return r=Rt("{model}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>to(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","name"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],function(e,t,n){const i=Dt(t,["displayName"]);void 0!==n&&null!=i&&jt(n,["displayName"],i);const o=Dt(t,["description"]);void 0!==n&&null!=o&&jt(n,["description"],o);const a=Dt(t,["defaultCheckpointId"]);return void 0!==n&&null!=a&&jt(n,["defaultCheckpointId"],a),{}}(0,o,n)),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>$i(this.apiClient,e)))}}async delete(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","name"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((()=>{const e=new ti;return Object.assign(e,{}),e}))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","name"],Lt(e,i));const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((()=>{const e=new ti;return Object.assign(e,{}),e}))}}async countTokens(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);if(null!=o){let e=$t(0,o);Array.isArray(e)&&(e=e.map((e=>Fi(0,e)))),jt(n,["contents"],e)}const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){const i=Dt(t,["systemInstruction"]);void 0!==n&&null!=i&&jt(n,["systemInstruction"],Fi(0,Wt(0,i)));const o=Dt(t,["tools"]);if(void 0!==n&&null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>zi(0,e)))),jt(n,["tools"],e)}const a=Dt(t,["generationConfig"]);return void 0!==n&&null!=a&&jt(n,["generationConfig"],a),{}}(0,a,n)),n}(this.apiClient,e);return r=Rt("{model}:countTokens",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["totalTokens"]);return null!=i&&jt(n,["totalTokens"],i),n}(this.apiClient,e),n=new ni;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);if(null!=o){let e=$t(0,o);Array.isArray(e)&&(e=e.map((e=>ji(0,e)))),jt(n,["contents"],e)}const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t){if(void 0!==Dt(t,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==Dt(t,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==Dt(t,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.");return{}}(0,a)),n}(this.apiClient,e);return r=Rt("{model}:countTokens",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["totalTokens"]);null!=i&&jt(n,["totalTokens"],i);const o=Dt(t,["cachedContentTokenCount"]);return null!=o&&jt(n,["cachedContentTokenCount"],o),n}(this.apiClient,e),n=new ni;return Object.assign(n,t),n}))}}async computeTokens(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["contents"]);if(null!=o){let e=$t(0,o);Array.isArray(e)&&(e=e.map((e=>Fi(0,e)))),jt(n,["contents"],e)}const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],a),n}(this.apiClient,e);return o=Rt("{model}:computeTokens",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>{const t=function(e,t){const n={},i=Dt(t,["tokensInfo"]);return null!=i&&jt(n,["tokensInfo"],i),n}(this.apiClient,e),n=new ii;return Object.assign(n,t),n}))}throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["prompt"]);null!=o&&jt(n,["instances[0]","prompt"],o);const a=Dt(t,["image"]);null!=a&&jt(n,["instances[0]","image"],qi(0,a));const r=Dt(t,["config"]);return null!=r&&jt(n,["config"],function(e,t,n){const i=Dt(t,["numberOfVideos"]);void 0!==n&&null!=i&&jt(n,["parameters","sampleCount"],i);const o=Dt(t,["outputGcsUri"]);void 0!==n&&null!=o&&jt(n,["parameters","storageUri"],o);const a=Dt(t,["fps"]);void 0!==n&&null!=a&&jt(n,["parameters","fps"],a);const r=Dt(t,["durationSeconds"]);void 0!==n&&null!=r&&jt(n,["parameters","durationSeconds"],r);const s=Dt(t,["seed"]);void 0!==n&&null!=s&&jt(n,["parameters","seed"],s);const l=Dt(t,["aspectRatio"]);void 0!==n&&null!=l&&jt(n,["parameters","aspectRatio"],l);const c=Dt(t,["resolution"]);void 0!==n&&null!=c&&jt(n,["parameters","resolution"],c);const u=Dt(t,["personGeneration"]);void 0!==n&&null!=u&&jt(n,["parameters","personGeneration"],u);const d=Dt(t,["pubsubTopic"]);void 0!==n&&null!=d&&jt(n,["parameters","pubsubTopic"],d);const p=Dt(t,["negativePrompt"]);void 0!==n&&null!=p&&jt(n,["parameters","negativePrompt"],p);const h=Dt(t,["enhancePrompt"]);return void 0!==n&&null!=h&&jt(n,["parameters","enhancePrompt"],h),{}}(0,r,n)),n}(this.apiClient,e);return r=Rt("{model}:predictLongRunning",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>no(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["_url","model"],Lt(e,i));const o=Dt(t,["prompt"]);null!=o&&jt(n,["instances[0]","prompt"],o);const a=Dt(t,["image"]);null!=a&&jt(n,["instances[0]","image"],function(e,t){const n={};if(void 0!==Dt(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const i=Dt(t,["imageBytes"]);null!=i&&jt(n,["bytesBase64Encoded"],tn(0,i));const o=Dt(t,["mimeType"]);return null!=o&&jt(n,["mimeType"],o),n}(0,a));const r=Dt(t,["config"]);return null!=r&&jt(n,["config"],function(e,t,n){const i=Dt(t,["numberOfVideos"]);if(void 0!==n&&null!=i&&jt(n,["parameters","sampleCount"],i),void 0!==Dt(t,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Dt(t,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const o=Dt(t,["durationSeconds"]);if(void 0!==n&&null!=o&&jt(n,["parameters","durationSeconds"],o),void 0!==Dt(t,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const a=Dt(t,["aspectRatio"]);if(void 0!==n&&null!=a&&jt(n,["parameters","aspectRatio"],a),void 0!==Dt(t,["resolution"]))throw new Error("resolution parameter is not supported in Gemini API.");const r=Dt(t,["personGeneration"]);if(void 0!==n&&null!=r&&jt(n,["parameters","personGeneration"],r),void 0!==Dt(t,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const s=Dt(t,["negativePrompt"]);if(void 0!==n&&null!=s&&jt(n,["parameters","negativePrompt"],s),void 0!==Dt(t,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(0,r,n)),n}(this.apiClient,e);return r=Rt("{model}:predictLongRunning",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>Ji(this.apiClient,e)))}}}function so(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["metadata"]);null!=o&&jt(n,["metadata"],o);const a=Dt(t,["done"]);null!=a&&jt(n,["done"],a);const r=Dt(t,["error"]);null!=r&&jt(n,["error"],r);const s=Dt(t,["response","generateVideoResponse"]);return null!=s&&jt(n,["response"],function(e,t){const n={},i=Dt(t,["generatedSamples"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["_self"]);return null!=i&&jt(n,["video"],function(e,t){const n={},i=Dt(t,["video","uri"]);null!=i&&jt(n,["uri"],i);const o=Dt(t,["video","encodedVideo"]);null!=o&&jt(n,["videoBytes"],tn(0,o));const a=Dt(t,["encoding"]);return null!=a&&jt(n,["mimeType"],a),n}(0,i)),n}(0,e)))),jt(n,["generatedVideos"],e)}const o=Dt(t,["raiMediaFilteredCount"]);null!=o&&jt(n,["raiMediaFilteredCount"],o);const a=Dt(t,["raiMediaFilteredReasons"]);return null!=a&&jt(n,["raiMediaFilteredReasons"],a),n}(0,s)),n}function lo(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["metadata"]);null!=o&&jt(n,["metadata"],o);const a=Dt(t,["done"]);null!=a&&jt(n,["done"],a);const r=Dt(t,["error"]);null!=r&&jt(n,["error"],r);const s=Dt(t,["response"]);return null!=s&&jt(n,["response"],function(e,t){const n={},i=Dt(t,["videos"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["_self"]);return null!=i&&jt(n,["video"],function(e,t){const n={},i=Dt(t,["gcsUri"]);null!=i&&jt(n,["uri"],i);const o=Dt(t,["bytesBase64Encoded"]);null!=o&&jt(n,["videoBytes"],tn(0,o));const a=Dt(t,["mimeType"]);return null!=a&&jt(n,["mimeType"],a),n}(0,i)),n}(0,e)))),jt(n,["generatedVideos"],e)}const o=Dt(t,["raiMediaFilteredCount"]);null!=o&&jt(n,["raiMediaFilteredCount"],o);const a=Dt(t,["raiMediaFilteredReasons"]);return null!=a&&jt(n,["raiMediaFilteredReasons"],a),n}(0,s)),n}class co extends Mt{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let i;return n&&"httpOptions"in n&&(i=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:i}})}return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["operationName"]);null!=i&&jt(n,["_url","operationName"],i);const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{operationName}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>lo(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["operationName"]);null!=i&&jt(n,["_url","operationName"],i);const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{operationName}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>so(this.apiClient,e)))}}async fetchPredictVideosOperationInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},i=Dt(t,["operationName"]);null!=i&&jt(n,["operationName"],i);const o=Dt(t,["resourceName"]);null!=o&&jt(n,["_url","resourceName"],o);const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],a),n}(this.apiClient,e);return o=Rt("{resourceName}:fetchPredictOperation",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>lo(this.apiClient,e)))}throw new Error("This method is only supported by the Vertex AI.")}}const uo=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class po extends Error{constructor(e,t){super(e,t?{cause:t}:{cause:(new Error).stack}),this.message=e,this.name="ClientError"}}class ho extends Error{constructor(e,t){super(e,t?{cause:t}:{cause:(new Error).stack}),this.message=e,this.name="ServerError"}}class go{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[t,n]of Object.entries(e.queryParams))i.searchParams.append(t,String(n));let o={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[e,i]of Object.entries(t))"object"==typeof i?n[e]=Object.assign(Object.assign({},n[e]),i):void 0!==i&&(n[e]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const i=new AbortController,o=i.signal;t.timeout&&(null==t?void 0:t.timeout)>0&&setTimeout((()=>i.abort()),t.timeout),n&&n.addEventListener("abort",(()=>{i.abort()})),e.signal=o}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then((async e=>(await mo(e),new li(e)))).catch((e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))}))}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then((async e=>(await mo(e),this.processStreamResponse(e)))).catch((e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))}))}processStreamResponse(e){var t;return gi(this,arguments,(function*(){const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";for(;;){const{done:o,value:a}=yield hi(n.read());if(o){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const r=i.decode(a);try{const e=JSON.parse(r);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,o=`got status: ${n}. ${JSON.stringify(e)}`;if(i>=400&&i<500)throw new po(o);if(i>=500&&i<600)throw new ho(o)}}catch(e){const t=e;if("ClientError"===t.name||"ServerError"===t.name)throw e}t+=r;let s=t.match(uo);for(;s;){const n=s[1];try{const i=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield hi(new li(i)),t=t.slice(s[0].length),s=t.match(uo)}catch(e){throw new Error(`exception parsing stream chunk ${n}. ${e}`)}}}}finally{n.releaseLock()}}))}async apiCall(e,t){return fetch(e,t).catch((e=>{throw new Error(`exception ${e} sending request`)}))}getDefaultHeaders(){const e={},t="google-genai-sdk/0.14.1 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e["x-goog-api-client"]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,i]of Object.entries(e.headers))t.append(n,i);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,a=await o.stat(e);i.sizeBytes=String(a.size);const r=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:a.type;if(void 0===r||""===r)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=r;const s=await this.fetchUploadUrl(i,t);return o.upload(e,s,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var n;let i={};i=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},a=await this.request({path:Rt("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:i});if(!a||!(null==a?void 0:a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const r=null===(n=null==a?void 0:a.headers)||void 0===n?void 0:n["x-goog-upload-url"];if(void 0===r)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return r}}async function mo(e){var t;if(void 0===e)throw new ho("response is undefined");if(!e.ok){const n=e.status,i=e.statusText;let o;o=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const a=`got status: ${n} ${i}. ${JSON.stringify(o)}`;if(n>=400&&n<500)throw new po(a);if(n>=500&&n<600)throw new ho(a);throw new Error(a)}}function fo(e,t){const n={},i=Dt(t,["baseModel"]);null!=i&&jt(n,["baseModel"],i);const o=Dt(t,["trainingDataset"]);null!=o&&jt(n,["tuningTask","trainingData"],function(e,t){const n={};if(void 0!==Dt(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const i=Dt(t,["examples"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["textInput"]);null!=i&&jt(n,["textInput"],i);const o=Dt(t,["output"]);return null!=o&&jt(n,["output"],o),n}(0,e)))),jt(n,["examples","examples"],e)}return n}(0,o));const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){const i={};if(void 0!==Dt(t,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const o=Dt(t,["tunedModelDisplayName"]);if(void 0!==n&&null!=o&&jt(n,["displayName"],o),void 0!==Dt(t,["description"]))throw new Error("description parameter is not supported in Gemini API.");const a=Dt(t,["epochCount"]);void 0!==n&&null!=a&&jt(n,["tuningTask","hyperparameters","epochCount"],a);const r=Dt(t,["learningRateMultiplier"]);if(null!=r&&jt(i,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==Dt(t,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==Dt(t,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const s=Dt(t,["batchSize"]);void 0!==n&&null!=s&&jt(n,["tuningTask","hyperparameters","batchSize"],s);const l=Dt(t,["learningRate"]);return void 0!==n&&null!=l&&jt(n,["tuningTask","hyperparameters","learningRate"],l),i}(0,a,n)),n}function vo(e,t){const n={},i=Dt(t,["baseModel"]);null!=i&&jt(n,["baseModel"],i);const o=Dt(t,["trainingDataset"]);null!=o&&jt(n,["supervisedTuningSpec","trainingDatasetUri"],function(e,t,n){const i=Dt(t,["gcsUri"]);if(void 0!==n&&null!=i&&jt(n,["supervisedTuningSpec","trainingDatasetUri"],i),void 0!==Dt(t,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.");return{}}(0,o,n));const a=Dt(t,["config"]);return null!=a&&jt(n,["config"],function(e,t,n){const i=Dt(t,["validationDataset"]);void 0!==n&&null!=i&&jt(n,["supervisedTuningSpec"],function(e,t){const n={},i=Dt(t,["gcsUri"]);return null!=i&&jt(n,["validationDatasetUri"],i),n}(0,i));const o=Dt(t,["tunedModelDisplayName"]);void 0!==n&&null!=o&&jt(n,["tunedModelDisplayName"],o);const a=Dt(t,["description"]);void 0!==n&&null!=a&&jt(n,["description"],a);const r=Dt(t,["epochCount"]);void 0!==n&&null!=r&&jt(n,["supervisedTuningSpec","hyperParameters","epochCount"],r);const s=Dt(t,["learningRateMultiplier"]);void 0!==n&&null!=s&&jt(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],s);const l=Dt(t,["exportLastCheckpointOnly"]);void 0!==n&&null!=l&&jt(n,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const c=Dt(t,["adapterSize"]);if(void 0!==n&&null!=c&&jt(n,["supervisedTuningSpec","hyperParameters","adapterSize"],c),void 0!==Dt(t,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==Dt(t,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");return{}}(0,a,n)),n}function yo(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["state"]);null!=o&&jt(n,["state"],en(0,o));const a=Dt(t,["createTime"]);null!=a&&jt(n,["createTime"],a);const r=Dt(t,["tuningTask","startTime"]);null!=r&&jt(n,["startTime"],r);const s=Dt(t,["tuningTask","completeTime"]);null!=s&&jt(n,["endTime"],s);const l=Dt(t,["updateTime"]);null!=l&&jt(n,["updateTime"],l);const c=Dt(t,["description"]);null!=c&&jt(n,["description"],c);const u=Dt(t,["baseModel"]);null!=u&&jt(n,["baseModel"],u);const d=Dt(t,["_self"]);null!=d&&jt(n,["tunedModel"],function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["model"],i);const o=Dt(t,["name"]);return null!=o&&jt(n,["endpoint"],o),n}(0,d));const p=Dt(t,["distillationSpec"]);null!=p&&jt(n,["distillationSpec"],p);const h=Dt(t,["experiment"]);null!=h&&jt(n,["experiment"],h);const g=Dt(t,["labels"]);null!=g&&jt(n,["labels"],g);const m=Dt(t,["pipelineJob"]);null!=m&&jt(n,["pipelineJob"],m);const f=Dt(t,["tunedModelDisplayName"]);return null!=f&&jt(n,["tunedModelDisplayName"],f),n}function bo(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["state"]);null!=o&&jt(n,["state"],en(0,o));const a=Dt(t,["createTime"]);null!=a&&jt(n,["createTime"],a);const r=Dt(t,["startTime"]);null!=r&&jt(n,["startTime"],r);const s=Dt(t,["endTime"]);null!=s&&jt(n,["endTime"],s);const l=Dt(t,["updateTime"]);null!=l&&jt(n,["updateTime"],l);const c=Dt(t,["error"]);null!=c&&jt(n,["error"],c);const u=Dt(t,["description"]);null!=u&&jt(n,["description"],u);const d=Dt(t,["baseModel"]);null!=d&&jt(n,["baseModel"],d);const p=Dt(t,["tunedModel"]);null!=p&&jt(n,["tunedModel"],function(e,t){const n={},i=Dt(t,["model"]);null!=i&&jt(n,["model"],i);const o=Dt(t,["endpoint"]);null!=o&&jt(n,["endpoint"],o);const a=Dt(t,["checkpoints"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map((e=>function(e,t){const n={},i=Dt(t,["checkpointId"]);null!=i&&jt(n,["checkpointId"],i);const o=Dt(t,["epoch"]);null!=o&&jt(n,["epoch"],o);const a=Dt(t,["step"]);null!=a&&jt(n,["step"],a);const r=Dt(t,["endpoint"]);return null!=r&&jt(n,["endpoint"],r),n}(0,e)))),jt(n,["checkpoints"],e)}return n}(0,p));const h=Dt(t,["supervisedTuningSpec"]);null!=h&&jt(n,["supervisedTuningSpec"],h);const g=Dt(t,["tuningDataStats"]);null!=g&&jt(n,["tuningDataStats"],g);const m=Dt(t,["encryptionSpec"]);null!=m&&jt(n,["encryptionSpec"],m);const f=Dt(t,["partnerModelTuningSpec"]);null!=f&&jt(n,["partnerModelTuningSpec"],f);const v=Dt(t,["distillationSpec"]);null!=v&&jt(n,["distillationSpec"],v);const y=Dt(t,["experiment"]);null!=y&&jt(n,["experiment"],y);const b=Dt(t,["labels"]);null!=b&&jt(n,["labels"],b);const k=Dt(t,["pipelineJob"]);null!=k&&jt(n,["pipelineJob"],k);const S=Dt(t,["tunedModelDisplayName"]);return null!=S&&jt(n,["tunedModelDisplayName"],S),n}class ko extends Mt{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new $n(hn.PAGED_ITEM_TUNING_JOBS,(e=>this.listInternal(e)),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const t=await this.tuneMldevInternal(e);let n="";return void 0!==t.metadata&&void 0!==t.metadata.tunedModel?n=t.metadata.tunedModel:void 0!==t.name&&t.name.includes("/operations/")&&(n=t.name.split("/operations/")[0]),{name:n,state:En.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],i);const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>bo(this.apiClient,e)))}{const t=function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["_url","name"],i);const o=Dt(t,["config"]);return null!=o&&jt(n,["config"],o),n}(this.apiClient,e);return r=Rt("{name}",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>yo(this.apiClient,e)))}}async listInternal(e){var t,n,i,o;let a,r="",s={};if(this.apiClient.isVertexAI()){const i=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o);const a=Dt(t,["filter"]);return void 0!==n&&null!=a&&jt(n,["_query","filter"],a),{}}(0,i,n)),n}(this.apiClient,e);return r=Rt("tuningJobs",i._url),s=i._query,delete i.config,delete i._url,delete i._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["tuningJobs"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>bo(0,e)))),jt(n,["tuningJobs"],e)}return n}(this.apiClient,e),n=new oi;return Object.assign(n,t),n}))}{const t=function(e,t){const n={},i=Dt(t,["config"]);return null!=i&&jt(n,["config"],function(e,t,n){const i=Dt(t,["pageSize"]);void 0!==n&&null!=i&&jt(n,["_query","pageSize"],i);const o=Dt(t,["pageToken"]);void 0!==n&&null!=o&&jt(n,["_query","pageToken"],o);const a=Dt(t,["filter"]);return void 0!==n&&null!=a&&jt(n,["_query","filter"],a),{}}(0,i,n)),n}(this.apiClient,e);return r=Rt("tunedModels",t._url),s=t._query,delete t.config,delete t._url,delete t._query,a=this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then((e=>e.json())),a.then((e=>{const t=function(e,t){const n={},i=Dt(t,["nextPageToken"]);null!=i&&jt(n,["nextPageToken"],i);const o=Dt(t,["tunedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map((e=>yo(0,e)))),jt(n,["tuningJobs"],e)}return n}(this.apiClient,e),n=new oi;return Object.assign(n,t),n}))}}async tuneInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI()){const r=vo(this.apiClient,e);return o=Rt("tuningJobs",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>bo(this.apiClient,e)))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=fo(this.apiClient,e);return o=Rt("tunedModels",r._url),a=r._query,delete r.config,delete r._url,delete r._query,i=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then((e=>e.json())),i.then((e=>function(e,t){const n={},i=Dt(t,["name"]);null!=i&&jt(n,["name"],i);const o=Dt(t,["metadata"]);null!=o&&jt(n,["metadata"],o);const a=Dt(t,["done"]);null!=a&&jt(n,["done"],a);const r=Dt(t,["error"]);return null!=r&&jt(n,["error"],r),n}(this.apiClient,e)))}}}class So{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const wo="x-goog-upload-status";function To(e){return new Promise((t=>setTimeout(t,e)))}class Co{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var i,o,a;let r=0,s=0,l=new li(new Response),c="upload";for(r=e.size;s<r;){const a=Math.min(8388608,r-s),u=e.slice(s,s+a);s+a>=r&&(c+=", finalize");let d=0,p=1e3;for(;d<3&&(l=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(s),"Content-Length":String(a)}}}),!(null===(i=null==l?void 0:l.headers)||void 0===i?void 0:i[wo]));)d++,await To(p),p*=2;if(s+=a,"active"!==(null===(o=null==l?void 0:l.headers)||void 0===o?void 0:o[wo]))break;if(r<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const u=await(null==l?void 0:l.json());if("final"!==(null===(a=null==l?void 0:l.headers)||void 0===a?void 0:a[wo]))throw new Error("Failed to upload file: Upload status is not finalized.");return u.file}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class Po{create(e,t,n){return new xo(e,t,n)}}class xo{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const Io="x-goog-api-key";class Ao{constructor(e){this.apiKey=e}async addAuthHeaders(e){null===e.get(Io)&&e.append(Io,this.apiKey)}}class Eo{constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=function(e,t,n){var i,o,a;if(!(null===(i=e.httpOptions)||void 0===i?void 0:i.baseUrl)){const i={geminiUrl:void 0,vertexUrl:void 0};return e.vertexai?null!==(o=i.vertexUrl)&&void 0!==o?o:t:null!==(a=i.geminiUrl)&&void 0!==a?a:n}return e.httpOptions.baseUrl}(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const i=new Ao(this.apiKey);this.apiClient=new go({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new Co,downloader:new So}),this.models=new ro(this.apiClient),this.live=new io(this.apiClient,i,new Po),this.chats=new yi(this.models,this.apiClient),this.caches=new pi(this.apiClient),this.files=new Si(this.apiClient),this.operations=new co(this.apiClient),this.tunings=new ko(this.apiClient)}}class Oo{static MODELS_ENDPOINT="https://generativelanguage.googleapis.com/v1beta/models";session=null;eventHandlers={};conversationItems=[];isConnectedState=!1;currentModel="";currentTurn={inputTranscription:"",modelTurnParts:[],outputTranscription:"",audioData:[],textParts:[]};constructor(e){this.apiKey=e,this.client=new Eo({apiKey:e}),this.instanceId=`gemini_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static async fetchModelsFromAPI(e){const t=[];let n;do{const i=n?`${this.MODELS_ENDPOINT}?key=${e}&pageToken=${n}`:`${this.MODELS_ENDPOINT}?key=${e}`,o=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok){const e=await o.json().catch((()=>({})));throw new Error(e.error?.message||"Failed to fetch models")}const a=await o.json(),r=a.models||[];t.push(...r),n=a.nextPageToken}while(n);return t}static isRealtimeCapableModel(e){const t=e.name?.toLowerCase()||"";return t.includes("audio")||t.includes("live")}static checkRealtimeModelAvailability(e){return e.some(this.isRealtimeCapableModel)}static buildValidationResult(e){return e?{valid:!0,message:Ee.t("settings.apiKeyValidationCompleted")+" "+Ee.t("settings.realtimeModelAvailable"),validating:!1,hasRealtimeModel:!0}:{valid:!1,message:Ee.t("settings.realtimeModelNotAvailable"),validating:!1,hasRealtimeModel:!1}}static getFallbackModels(){return[{id:"gemini-2.5-flash-preview-native-audio-dialog",type:"realtime",created:Date.now()/1e3},{id:"gemini-2.0-flash-live",type:"realtime",created:Date.now()/1e3-86400}]}static sortModels(e){return e.sort(((e,t)=>t.created!==e.created?t.created-e.created:e.id.localeCompare(t.id)))}static handleValidationError(e){return console.error("[Sokuji] [GeminiClient] API key validation error:",e),{valid:!1,message:e.message||Ee.t("settings.errorValidatingApiKey"),validating:!1}}static handleModelFetchError(e){throw console.error("[Sokuji] [GeminiClient] Error fetching models:",e),e}static validateApiKeyFormat(e){if(!e||""===e.trim())throw new Error("API key is required")}static async validateApiKeyAndFetchModels(e){try{if(!e||""===e.trim())return{validation:{valid:!1,message:Ee.t("settings.errorValidatingApiKey"),validating:!1},models:[]};const t=await this.fetchModelsFromAPI(e);console.info("[Sokuji] [GeminiClient] Validation response: success");const n=this.checkRealtimeModelAvailability(t);console.info("[Sokuji] [GeminiClient] Available models:",t),console.info("[Sokuji] [GeminiClient] Has realtime model:",n);const i=this.filterRelevantModels(t);return{validation:this.buildValidationResult(n),models:i}}catch(e){return{validation:this.handleValidationError(e),models:[]}}}static filterRelevantModels(e){const t=[];return e.forEach((e=>{if(this.isRealtimeCapableModel(e)){const n=e.name?.replace("models/","")||"";let i=Date.now()/1e3;if(e.version){const t=e.version.match(/(\d{2})-(\d{2})/);if(t){const[,e,n]=t,o=(new Date).getFullYear();i=new Date(o,parseInt(e)-1,parseInt(n)).getTime()/1e3}}t.push({id:n,type:"realtime",created:i})}})),console.info(`[Sokuji] [GeminiClient] Found ${t.length} realtime-capable models from API`),0===t.length?(console.warn("[Sokuji] [GeminiClient] No suitable models found from API, using fallback models"),this.getFallbackModels()):this.sortModels(t)}static getLatestRealtimeModel(e){const t=e.filter((e=>"realtime"===e.type));return t.length>0?t[0].id:"gemini-2.5-flash-preview-native-audio-dialog"}async connect(e){this.isConnectedState&&await this.disconnect(),this.currentModel=e.model;const t={responseModalities:[In.AUDIO],temperature:e.temperature,maxOutputTokens:"number"==typeof e.maxTokens?e.maxTokens:void 0,systemInstruction:e.instructions?{parts:[{text:e.instructions}]}:void 0,speechConfig:e.voice?{voiceConfig:{prebuiltVoiceConfig:{voiceName:e.voice}}}:void 0,inputAudioTranscription:!0,outputAudioTranscription:!0,realtimeInputConfig:{activityHandling:Wn.NO_INTERRUPTION}};try{this.session=await this.client.live.connect({model:e.model,config:t,callbacks:{onopen:()=>{console.info("[Sokuji] [GeminiClient] Session opened"),this.isConnectedState=!0,this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.opened",data:{status:"connected",provider:"gemini",model:this.currentModel,timestamp:Date.now(),config:{temperature:t.temperature,maxOutputTokens:t.maxOutputTokens,systemInstruction:t.systemInstruction?"set":"none"}}}}),this.eventHandlers.onOpen?.()},onmessage:this.handleMessage.bind(this),onerror:e=>{console.error("[Sokuji] [GeminiClient] Session error:",e),this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.error",data:{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,type:e.type,isTrusted:e.isTrusted,timestamp:e.timeStamp,error:e.error?e.error.toString():void 0}}}),this.eventHandlers.onError?.(e)},onclose:e=>{console.info("[Sokuji] [GeminiClient] Session closed",e),this.isConnectedState=!1,this.session=null,this.conversationItems=[],this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.closed",data:{code:e.code,reason:e.reason,type:e.type,wasClean:e.wasClean,isTrusted:e.isTrusted,timestamp:e.timeStamp}}}),this.eventHandlers.onClose?.(e)}}})}catch(e){throw this.isConnectedState=!1,e}}async handleMessage(e){console.info("[Sokuji] [GeminiClient] Message received:",e),e.setupComplete?this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"setupComplete",data:e.setupComplete}}):(e.usageMetadata&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"usageMetadata",data:e.usageMetadata}}),e.toolCall&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"toolCall",data:e.toolCall}}),e.toolCallCancellation&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"toolCallCancellation",data:e.toolCallCancellation}}),e.goAway&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"goAway",data:e.goAway}}),e.sessionResumptionUpdate&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"sessionResumptionUpdate",data:e.sessionResumptionUpdate}}),e.serverContent&&await this.handleServerContent(e.serverContent))}resetCurrentTurn(){this.currentTurn={inputTranscription:"",modelTurnParts:[],outputTranscription:"",audioData:[],textParts:[]}}async finalizeTurn(){if(this.currentTurn.inputTranscription.trim())if(this.currentTurn.inputTranscriptionItem&&this.currentTurn.inputTranscriptionItem.formatted)this.currentTurn.inputTranscriptionItem.formatted.transcript=this.currentTurn.inputTranscription.trim(),this.currentTurn.inputTranscriptionItem.status="completed",this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.inputTranscriptionItem});else{const e={id:this.instanceId,role:"user",type:"message",status:"completed",formatted:{transcript:this.currentTurn.inputTranscription.trim()}};this.conversationItems.push(e),this.eventHandlers.onConversationUpdated?.({item:e})}if(this.currentTurn.audioData.length>0||this.currentTurn.textParts.length>0||this.currentTurn.outputTranscription.trim()){let e;if(this.currentTurn.audioData.length>0){const t=this.currentTurn.audioData.reduce(((e,t)=>e+t.length),0);e=new Int16Array(t);let n=0;for(const t of this.currentTurn.audioData)e.set(t,n),n+=t.length}const t=this.currentTurn.textParts.join(""),n=this.currentTurn.outputTranscription.trim();if(this.currentTurn.assistantItem&&this.currentTurn.assistantItem.formatted)e&&(this.currentTurn.assistantItem.formatted.audio=e),t&&(this.currentTurn.assistantItem.formatted.text=t),n&&(this.currentTurn.assistantItem.formatted.transcript=n),this.currentTurn.assistantItem.status="completed",this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.assistantItem});else{const i={id:this.instanceId,role:"assistant",type:"message",status:"completed",formatted:{}};e&&i.formatted&&(i.formatted.audio=e),t&&i.formatted&&(i.formatted.text=t),n&&i.formatted&&(i.formatted.transcript=n),this.conversationItems.push(i),this.eventHandlers.onConversationUpdated?.({item:i})}}}async handleServerContent(e){if("interrupted"in e)return this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.interrupted",data:e.interrupted}}),this.eventHandlers.onConversationInterrupted?.(),void this.resetCurrentTurn();if("turnComplete"in e)return this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.turnComplete",data:e.turnComplete}}),await this.finalizeTurn(),void this.resetCurrentTurn();if("generationComplete"in e&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.generationComplete",data:e.generationComplete}}),"groundingMetadata"in e&&e.groundingMetadata&&this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.groundingMetadata",data:e.groundingMetadata}}),"outputTranscription"in e&&e.outputTranscription&&(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.outputTranscription",data:e.outputTranscription}}),e.outputTranscription.text&&(this.currentTurn.outputTranscription+=e.outputTranscription.text,this.currentTurn.assistantItem||(this.currentTurn.assistantItem={id:this.instanceId,role:"assistant",type:"message",status:"in_progress",formatted:{}},this.conversationItems.push(this.currentTurn.assistantItem)),this.currentTurn.assistantItem.formatted&&(this.currentTurn.assistantItem.formatted.transcript=this.currentTurn.outputTranscription,this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.assistantItem})))),"inputTranscription"in e&&e.inputTranscription&&(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.inputTranscription",data:e.inputTranscription}}),e.inputTranscription.text&&(this.currentTurn.inputTranscription+=e.inputTranscription.text,this.currentTurn.inputTranscriptionItem?this.currentTurn.inputTranscriptionItem.formatted&&(this.currentTurn.inputTranscriptionItem.formatted.transcript=this.currentTurn.inputTranscription,this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.inputTranscriptionItem})):(this.currentTurn.inputTranscriptionItem={id:this.instanceId,role:"user",type:"message",status:"in_progress",formatted:{transcript:this.currentTurn.inputTranscription}},this.conversationItems.push(this.currentTurn.inputTranscriptionItem),this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.inputTranscriptionItem})))),"modelTurn"in e&&e.modelTurn){this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"serverContent.modelTurn",data:e.modelTurn}});const t=e.modelTurn.parts||[],n=t.filter((e=>e.inlineData&&e.inlineData.mimeType?.startsWith("audio/pcm"))),i=t.filter((e=>e.text));let o=!1,a=!1,r=[];for(const e of n)if(e.inlineData?.data){const t=this.base64ToArrayBuffer(e.inlineData.data),n=new Int16Array(t);this.currentTurn.audioData.push(n),r.push(n),o=!0}for(const e of i)e.text&&(this.currentTurn.textParts.push(e.text),a=!0);if((o||a)&&(this.currentTurn.assistantItem||(this.currentTurn.assistantItem={id:this.instanceId,role:"assistant",type:"message",status:"in_progress",formatted:{}},this.conversationItems.push(this.currentTurn.assistantItem)),this.currentTurn.assistantItem.formatted)){if(this.currentTurn.audioData.length>0){const e=this.currentTurn.audioData.reduce(((e,t)=>e+t.length),0),t=new Int16Array(e);let n=0;for(const e of this.currentTurn.audioData)t.set(e,n),n+=e.length;this.currentTurn.assistantItem.formatted.audio=t}if(this.currentTurn.textParts.length>0&&(this.currentTurn.assistantItem.formatted.text=this.currentTurn.textParts.join("")),o&&r.length>0){const e=r.reduce(((e,t)=>e+t.length),0),t=new Int16Array(e);let n=0;for(const e of r)t.set(e,n),n+=e.length;this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.assistantItem,delta:{audio:t}})}else this.eventHandlers.onConversationUpdated?.({item:this.currentTurn.assistantItem})}}}base64ToArrayBuffer(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n.buffer}async disconnect(){this.session&&(this.session.close(),this.session=null),this.isConnectedState=!1,this.conversationItems=[],this.resetCurrentTurn()}isConnected(){return this.isConnectedState}updateSession(e){console.warn("[GeminiClient] Runtime session updates not supported. Reconnection required.")}reset(){this.conversationItems=[],this.resetCurrentTurn(),this.session&&(this.session=null,this.isConnectedState=!1)}appendInputAudio(e){if(!this.session)return void console.warn("[GeminiClient] No active session for audio input");const t=this.arrayBufferToBase64(e);this.session.sendRealtimeInput({media:{mimeType:"audio/pcm;rate=24000",data:t}})}arrayBufferToBase64(e){const t=new Uint8Array(e);let n="";for(let e=0;e<t.byteLength;e++)n+=String.fromCharCode(t[e]);return btoa(n)}createResponse(){console.debug("[GeminiClient] Response creation is handled automatically by Gemini Live API")}cancelResponse(e,t){console.warn("[GeminiClient] Response cancellation not supported")}getConversationItems(){return[...this.conversationItems]}setEventHandlers(e){this.eventHandlers={...e}}getProvider(){return At.GEMINI}}function _o(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}var No=Object.defineProperty,Mo=(e,t,n)=>((e,t,n)=>t in e?No(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class Ro{constructor(){Mo(this,"_locking"),Mo(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise((t=>e=()=>{this._locks-=1,t()})),n=this._locking.then((()=>e));return this._locking=this._locking.then((()=>t)),n}}function jo(e,t){if(!e)throw new Error(t)}function Do(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function Lo(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function Fo(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const zo=Symbol("@bufbuild/protobuf/enum-type");function Uo(e,t,n,i){e[zo]=Vo(t,n.map((t=>({no:t.no,name:t.name,localName:e[t.no]}))))}function Vo(e,t,n){const i=Object.create(null),o=Object.create(null),a=[];for(const e of t){const t=Bo(e);a.push(t),i[e.name]=t,o[e.no]=t}return{typeName:e,values:a,findName:e=>i[e],findNumber:e=>o[e]}}function Bo(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class qo{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,o=i.makeReadOptions(t);return i.readMessage(n,e,o,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(e){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Ko(){let e=0,t=0;for(let n=0;n<28;n+=7){let i=this.buf[this.pos++];if(e|=(127&i)<<n,!(128&i))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let i=this.buf[this.pos++];if(t|=(127&i)<<n,!(128&i))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Ho(e,t,n){for(let i=0;i<28;i+=7){const o=e>>>i,a=!(o>>>7==0&&0==t),r=255&(a?128|o:o);if(n.push(r),!a)return}const i=e>>>28&15|(7&t)<<4,o=!!(t>>3);if(n.push(255&(o?128|i:i)),o){for(let e=3;e<31;e+=7){const i=t>>>e,o=!(i>>>7==0),a=255&(o?128|i:i);if(n.push(a),!o)return}n.push(t>>>31&1)}}const Wo=4294967296;function Go(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,o=0;function a(t,a){const r=Number(e.slice(t,a));o*=n,i=i*n+r,i>=Wo&&(o+=i/Wo|0,i%=Wo)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?Qo(i,o):Jo(i,o)}function $o(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(Wo*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*i,a=n+8147497*i,r=2*i;const s=1e7;return o>=s&&(a+=Math.floor(o/s),o%=s),a>=s&&(r+=Math.floor(a/s),a%=s),r.toString()+Yo(a)+Yo(o)}function Jo(e,t){return{lo:0|e,hi:0|t}}function Qo(e,t){return t=~t,e?e=1+~e:t+=1,Jo(e,t)}const Yo=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Zo(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Xo(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}const ea=function(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>o||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>jo(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>jo(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Go(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Go(e)),dec:(e,t)=>function(e,t){let n=Jo(e,t);const i=2147483648&n.hi;i&&(n=Qo(n.lo,n.hi));const o=$o(n.lo,n.hi);return i?"-"+o:o}(e,t),uDec:(e,t)=>$o(e,t)}}();var ta,na,ia;function oa(e,t,n){if(t===n)return!0;if(e==ta.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case ta.UINT64:case ta.FIXED64:case ta.INT64:case ta.SFIXED64:case ta.SINT64:return t==n}return!1}function aa(e,t){switch(e){case ta.BOOL:return!1;case ta.UINT64:case ta.FIXED64:case ta.INT64:case ta.SFIXED64:case ta.SINT64:return 0==t?ea.zero:"0";case ta.DOUBLE:case ta.FLOAT:return 0;case ta.BYTES:return new Uint8Array(0);case ta.STRING:return"";default:return 0}}function ra(e,t){switch(e){case ta.BOOL:return!1===t;case ta.STRING:return""===t;case ta.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(ta||(ta={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(na||(na={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(ia||(ia={}));class sa{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Lo(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return Do(e),Zo(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Fo(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Lo(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Do(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Do(e),Zo(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=ea.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=ea.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=ea.enc(e);return Ho(t.lo,t.hi,this.buf),this}sint64(e){let t=ea.enc(e),n=t.hi>>31;return Ho(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=ea.uEnc(e);return Ho(t.lo,t.hi,this.buf),this}}class la{constructor(e,t){this.varint64=Ko,this.uint32=Xo,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case ia.Varint:for(;128&this.buf[this.pos++];);break;case ia.Bit64:this.pos+=4;case ia.Bit32:this.pos+=4;break;case ia.LengthDelimited:let n=this.uint32();this.pos+=n;break;case ia.StartGroup:for(;;){const[e,n]=this.tag();if(n===ia.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return ea.dec(...this.varint64())}uint64(){return ea.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,ea.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return ea.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return ea.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function ca(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return aa(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),da=[];for(let e=0;e<ua.length;e++)da[ua[e].charCodeAt(0)]=e;da["-".charCodeAt(0)]=ua.indexOf("+"),da["_".charCodeAt(0)]=ua.indexOf("/");const pa={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),o=0,a=0,r=0;for(let t=0;t<e.length;t++){if(n=da[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":a=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:r=n,a=1;break;case 1:i[o++]=r<<2|(48&n)>>4,r=n,a=2;break;case 2:i[o++]=(15&r)<<4|(60&n)>>2,r=n,a=3;break;case 3:i[o++]=(3&r)<<6|n,a=0}}if(1==a)throw Error("invalid base64 string.");return i.subarray(0,o)},enc(e){let t,n="",i=0,o=0;for(let a=0;a<e.length;a++)switch(t=e[a],i){case 0:n+=ua[t>>2],o=(3&t)<<4,i=1;break;case 1:n+=ua[o|t>>4],o=(15&t)<<2,i=2;break;case 2:n+=ua[o|t>>6],n+=ua[63&t],i=0}return i&&(n+=ua[o],n+="=",1==i&&(n+="=")),n}};function ha(e,t,n){fa(t,e);const i=t.runtime.bin.makeReadOptions(n),o=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter((e=>e.no===t.no))}(e.getType().runtime.bin.listUnknownFields(e),t.field),[a,r]=ca(t);for(const e of o)t.runtime.bin.readField(a,i.readerFactory(e.data),t.field,e.wireType,i);return r()}function ga(e,t,n,i){fa(t,e);const o=t.runtime.bin.makeReadOptions(i),a=t.runtime.bin.makeWriteOptions(i);if(ma(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter((e=>e.no!=t.field.no));e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const r=a.writerFactory();let s=t.field;s.opt||s.repeated||"enum"!=s.kind&&"scalar"!=s.kind||(s=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(s,n,r,a);const l=o.readerFactory(r.finish());for(;l.pos<l.len;){const[t,n]=l.tag(),i=l.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}function ma(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find((e=>e.no==t.field.no))}function fa(e,t){jo(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function va(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!ra(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function ya(e,t){const n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?aa(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function ba(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(qo.prototype).every((t=>t in e&&"function"==typeof e[t])))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function ka(e,t){return ba(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}ta.DOUBLE,ta.FLOAT,ta.INT64,ta.UINT64,ta.INT32,ta.UINT32,ta.BOOL,ta.STRING,ta.BYTES;const Sa={ignoreUnknownFields:!1},wa={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};const Ta=Symbol(),Ca=Symbol();function Pa(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function xa(e,t,n,i,o){let a=n.localName;if(n.repeated){if(jo("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(t)));const r=e[a];for(const e of t){if(null===e)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(e)));switch(n.kind){case"message":r.push(n.T.fromJson(e,i));break;case"enum":const t=Ea(n.T,e,i.ignoreUnknownFields,!0);t!==Ca&&r.push(t);break;case"scalar":try{r.push(Aa(n.T,e,n.L,!0))}catch(t){let i="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(e));throw t instanceof Error&&t.message.length>0&&(i+=": ".concat(t.message)),new Error(i)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(t)));const r=e[a];for(const[e,a]of Object.entries(t)){if(null===a)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: map value null"));let s;try{s=Ia(n.K,e)}catch(e){let i="cannot decode map key for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}switch(n.V.kind){case"message":r[s]=n.V.T.fromJson(a,i);break;case"enum":const e=Ea(n.V.T,a,i.ignoreUnknownFields,!0);e!==Ca&&(r[s]=e);break;case"scalar":try{r[s]=Aa(n.V.T,a,na.BIGINT,!0)}catch(e){let i="cannot decode map value for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:a},a="value"),n.kind){case"message":const r=n.T;if(null===t&&"google.protobuf.Value"!=r.typeName)return;let s=e[a];ba(s)?s.fromJson(t,i):(e[a]=s=r.fromJson(t,i),r.fieldWrapper&&!n.oneof&&(e[a]=r.fieldWrapper.unwrapField(s)));break;case"enum":const l=Ea(n.T,t,i.ignoreUnknownFields,!1);switch(l){case Ta:ya(n,e);break;case Ca:break;default:e[a]=l}break;case"scalar":try{const i=Aa(n.T,t,n.L,!1);i===Ta?ya(n,e):e[a]=i}catch(e){let i="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(Pa(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}}}function Ia(e,t){if(e===ta.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return Aa(e,t,na.BIGINT,!0).toString()}function Aa(e,t,n,i){if(null===t)return i?aa(e,n):Ta;switch(e){case ta.DOUBLE:case ta.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==ta.FLOAT&&Fo(i),i;case ta.INT32:case ta.FIXED32:case ta.SFIXED32:case ta.SINT32:case ta.UINT32:let o;if("number"==typeof t?o=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),void 0===o)break;return e==ta.UINT32||e==ta.FIXED32?Lo(o):Do(o),o;case ta.INT64:case ta.SFIXED64:case ta.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=ea.parse(t);return n?a.toString():a;case ta.FIXED64:case ta.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const r=ea.uParse(t);return n?r.toString():r;case ta.BOOL:if("boolean"!=typeof t)break;return t;case ta.STRING:if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case ta.BYTES:if(""===t)return new Uint8Array(0);if("string"!=typeof t)break;return pa.dec(t)}throw new Error}function Ea(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:Ta;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(void 0!==i)return i.no;if(n)return Ca}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(Pa(t)))}function Oa(e){return!(!e.repeated&&"map"!=e.kind&&(e.oneof||"message"==e.kind||e.opt||e.req))}function _a(e,t,n){if("map"==e.kind){jo("object"==typeof t&&null!=t);const i={},o=Object.entries(t);switch(e.V.kind){case"scalar":for(const[t,n]of o)i[t.toString()]=Ma(e.V.T,n);break;case"message":for(const[e,t]of o)i[e.toString()]=t.toJson(n);break;case"enum":const t=e.V.T;for(const[e,a]of o)i[e.toString()]=Na(t,a,n.enumAsInteger)}return n.emitDefaultValues||o.length>0?i:void 0}if(e.repeated){jo(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(Ma(e.T,t[n]));break;case"enum":for(let o=0;o<t.length;o++)i.push(Na(e.T,t[o],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return Ma(e.T,t);case"enum":return Na(e.T,t,n.enumAsInteger);case"message":return ka(e.T,t).toJson(n)}}function Na(e,t,n){var i;if(jo("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const o=e.findNumber(t);return null!==(i=null==o?void 0:o.name)&&void 0!==i?i:t}function Ma(e,t){switch(e){case ta.INT32:case ta.SFIXED32:case ta.SINT32:case ta.FIXED32:case ta.UINT32:return jo("number"==typeof t),t;case ta.FLOAT:case ta.DOUBLE:return jo("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case ta.STRING:return jo("string"==typeof t),t;case ta.BOOL:return jo("boolean"==typeof t),t;case ta.UINT64:case ta.FIXED64:case ta.INT64:case ta.SFIXED64:case ta.SINT64:return jo("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case ta.BYTES:return jo(t instanceof Uint8Array),pa.enc(t)}}const Ra=Symbol("@bufbuild/protobuf/unknown-fields"),ja={readUnknownFields:!0,readerFactory:e=>new la(e)},Da={writeUnknownFields:!0,writerFactory:()=>new sa};function La(e,t,n,i,o){let{repeated:a,localName:r}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=r&&delete e.value,e.case=r,r="value"),n.kind){case"scalar":case"enum":const s="enum"==n.kind?ta.INT32:n.T;let l=Ua;if("scalar"==n.kind&&n.L>0&&(l=za),a){let n=e[r];if(i==ia.LengthDelimited&&s!=ta.STRING&&s!=ta.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(l(t,s))}else n.push(l(t,s))}else e[r]=l(t,s);break;case"message":const c=n.T;a?e[r].push(Fa(t,new c,o,n)):ba(e[r])?Fa(t,e[r],o,n):(e[r]=Fa(t,new c,o,n),!c.fieldWrapper||n.oneof||n.repeated||(e[r]=c.fieldWrapper.unwrapField(e[r])));break;case"map":let[u,d]=function(e,t,n){const i=t.uint32(),o=t.pos+i;let a,r;for(;t.pos<o;){const[i]=t.tag();switch(i){case 1:a=Ua(t,e.K);break;case 2:switch(e.V.kind){case"scalar":r=Ua(t,e.V.T);break;case"enum":r=t.int32();break;case"message":r=Fa(t,new e.V.T,n,void 0)}}}if(void 0===a&&(a=aa(e.K,na.BIGINT)),"string"!=typeof a&&"number"!=typeof a&&(a=a.toString()),void 0===r)switch(e.V.kind){case"scalar":r=aa(e.V.T,na.BIGINT);break;case"enum":r=e.V.T.values[0].no;break;case"message":r=new e.V.T}return[a,r]}(n,t,o);e[r][u]=d}}function Fa(e,t,n,i){const o=t.getType().runtime.bin,a=null==i?void 0:i.delimited;return o.readMessage(t,e,a?i.no:e.uint32(),n,a),t}function za(e,t){const n=Ua(e,t);return"bigint"==typeof n?n.toString():n}function Ua(e,t){switch(t){case ta.STRING:return e.string();case ta.BOOL:return e.bool();case ta.DOUBLE:return e.double();case ta.FLOAT:return e.float();case ta.INT32:return e.int32();case ta.INT64:return e.int64();case ta.UINT64:return e.uint64();case ta.FIXED64:return e.fixed64();case ta.BYTES:return e.bytes();case ta.FIXED32:return e.fixed32();case ta.SFIXED32:return e.sfixed32();case ta.SFIXED64:return e.sfixed64();case ta.SINT64:return e.sint64();case ta.UINT32:return e.uint32();case ta.SINT32:return e.sint32()}}function Va(e,t,n,i){jo(void 0!==t);const o=e.repeated;switch(e.kind){case"scalar":case"enum":let a="enum"==e.kind?ta.INT32:e.T;if(o)if(jo(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,ia.LengthDelimited).fork();let[,o]=Ha(t);for(let t=0;t<i.length;t++)e[o](i[t]);e.join()}(n,a,e.no,t);else for(const i of t)Ka(n,a,e.no,i);else Ka(n,a,e.no,t);break;case"message":if(o){jo(Array.isArray(t));for(const o of t)qa(n,i,e,o)}else qa(n,i,e,t);break;case"map":jo("object"==typeof t&&null!=t);for(const[o,a]of Object.entries(t))Ba(n,i,e,o,a)}}function Ba(e,t,n,i,o){e.tag(n.no,ia.LengthDelimited),e.fork();let a=i;switch(n.K){case ta.INT32:case ta.FIXED32:case ta.UINT32:case ta.SFIXED32:case ta.SINT32:a=Number.parseInt(i);break;case ta.BOOL:jo("true"==i||"false"==i),a="true"==i}switch(Ka(e,n.K,1,a),n.V.kind){case"scalar":Ka(e,n.V.T,2,o);break;case"enum":Ka(e,ta.INT32,2,o);break;case"message":jo(void 0!==o),e.tag(2,ia.LengthDelimited).bytes(o.toBinary(t))}e.join()}function qa(e,t,n,i){const o=ka(n.T,i);n.delimited?e.tag(n.no,ia.StartGroup).raw(o.toBinary(t)).tag(n.no,ia.EndGroup):e.tag(n.no,ia.LengthDelimited).bytes(o.toBinary(t))}function Ka(e,t,n,i){jo(void 0!==i);let[o,a]=Ha(t);e.tag(n,o)[a](i)}function Ha(e){let t=ia.Varint;switch(e){case ta.BYTES:case ta.STRING:t=ia.LengthDelimited;break;case ta.DOUBLE:case ta.FIXED64:case ta.SFIXED64:t=ia.Bit64;break;case ta.FIXED32:case ta.SFIXED32:case ta.FLOAT:t=ia.Bit32}return[t,ta[e].toLowerCase()]}function Wa(e){if(void 0===e)return e;if(ba(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function Ga(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class $a{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort(((e,t)=>e.no-t.no))),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Ja(e,t){const n=Ya(e);return t?n:nr(tr(n))}const Qa=Ya;function Ya(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let o=e.charAt(i);switch(o){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),t=!1;break;default:t&&(t=!1,o=o.toUpperCase()),n.push(o)}}return n.join("")}const Za=new Set(["constructor","toString","toJSON","valueOf"]),Xa=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),er=e=>"".concat(e,"$"),tr=e=>Xa.has(e)?er(e):e,nr=e=>Za.has(e)?er(e):e;class ir{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Ja(e,!1)}addField(e){jo(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const or=(ar=e=>new $a(e,(e=>function(e){var t,n,i,o,a,r;const s=[];let l;for(const c of"function"==typeof e?e():e){const e=c;if(e.localName=Ja(c.name,void 0!==c.oneof),e.jsonName=null!==(t=c.jsonName)&&void 0!==t?t:Qa(c.name),e.repeated=null!==(n=c.repeated)&&void 0!==n&&n,"scalar"==c.kind&&(e.L=null!==(i=c.L)&&void 0!==i?i:na.BIGINT),e.delimited=null!==(o=c.delimited)&&void 0!==o&&o,e.req=null!==(a=c.req)&&void 0!==a&&a,e.opt=null!==(r=c.opt)&&void 0!==r&&r,void 0===c.packed&&(e.packed="enum"==c.kind||"scalar"==c.kind&&c.T!=ta.BYTES&&c.T!=ta.STRING),void 0!==c.oneof){const t="string"==typeof c.oneof?c.oneof:c.oneof.name;l&&l.name==t||(l=new ir(t)),e.oneof=l,l.addField(e)}s.push(e)}return s}(e))),rr=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=aa(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},Sa),e):Sa},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},wa),e):wa},readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(Pa(t)));i=null!=i?i:new e;const o=new Map,a=n.typeRegistry;for(const[r,s]of Object.entries(t)){const t=e.fields.findJsonName(r);if(t){if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=o.get(t.oneof);if(void 0!==n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(r,'"'));o.set(t.oneof,r)}xa(i,s,t,n,e)}else{let t=!1;if((null==a?void 0:a.findExtension)&&r.startsWith("[")&&r.endsWith("]")){const o=a.findExtension(r.substring(1,r.length-1));if(o&&o.extendee.typeName==e.typeName){t=!0;const[e,a]=ca(o);xa(e,s,o.field,n,o),ga(i,o,a(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(r,'" is unknown'))}}return i},writeMessage(e,t){const n=e.getType(),i={};let o;try{for(o of n.fields.byNumber()){if(!va(o,e)){if(o.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!Oa(o))continue}const n=_a(o,o.oneof?e[o.oneof.localName].value:e[o.localName],t);void 0!==n&&(i[t.useProtoFieldName?o.name:o.jsonName]=n)}const a=t.typeRegistry;if(null==a?void 0:a.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(e)){const r=a.findExtensionFor(n.typeName,o.no);if(r&&ma(e,r)){const n=ha(e,r,t),o=_a(r.field,n,t);void 0!==o&&(i[r.field.jsonName]=o)}}}catch(e){const t=o?"cannot encode field ".concat(n.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),i=e instanceof Error?e.message:String(e);throw new Error(t+(i.length>0?": ".concat(i):""))}return i},readScalar:(e,t,n)=>Aa(e,t,null!=n?n:na.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||ra(e,t)?Ma(e,t):void 0},debug:Pa},bin:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},ja),e):ja},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},Da),e):Da},listUnknownFields(e){var t;return null!==(t=e[Ra])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[Ra]},writeUnknownFields(e,t){const n=e[Ra];if(n)for(const e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,n,i){const o=e;Array.isArray(o[Ra])||(o[Ra]=[]),o[Ra].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,o){const a=e.getType(),r=o?t.len:t.pos+n;let s,l;for(;t.pos<r&&([s,l]=t.tag(),!0!==o||l!=ia.EndGroup);){const n=a.fields.find(s);if(n)La(e,t,n,l,i);else{const n=t.skip(l,s);i.readUnknownFields&&this.onUnknownField(e,s,l,n)}}if(o&&(l!=ia.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:La,writeMessage(e,t,n){const i=e.getType();for(const o of i.fields.byNumber())if(va(o,e))Va(o,o.oneof?e[o.oneof.localName].value:e[o.localName],t,n);else if(o.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(o.name," to binary: required field not set"));return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&Va(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:Uo,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,o=t,a=e;if(null!=a[n])switch(i.kind){case"oneof":const e=a[n].case;if(void 0===e)continue;const t=i.findField(e);let r=a[n].value;t&&"message"==t.kind&&!ba(r,t.T)?r=new t.T(r):t&&"scalar"===t.kind&&t.T===ta.BYTES&&(r=Ga(r)),o[n]={case:e,value:r};break;case"scalar":case"enum":let s=a[n];i.T===ta.BYTES&&(s=i.repeated?s.map(Ga):Ga(s)),o[n]=s;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===ta.BYTES)for(const[e,t]of Object.entries(a[n]))o[n][e]=Ga(t);else Object.assign(o[n],a[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(a[n])){let i=a[n][t];e.fieldWrapper||(i=new e(i)),o[n][t]=i}}break;case"message":const l=i.T;if(i.repeated)o[n]=a[n].map((e=>ba(e,l)?e:new l(e)));else{const e=a[n];l.fieldWrapper?"google.protobuf.BytesValue"===l.typeName?o[n]=Ga(e):o[n]=e:o[n]=ba(e,l)?e:new l(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every((e=>{const i=t[e.localName],o=n[e.localName];if(e.repeated){if(i.length!==o.length)return!1;switch(e.kind){case"message":return i.every(((t,n)=>e.T.equals(t,o[n])));case"scalar":return i.every(((t,n)=>oa(e.T,t,o[n])));case"enum":return i.every(((e,t)=>oa(ta.INT32,e,o[t])))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":let t=i,n=o;return e.T.fieldWrapper&&(void 0===t||ba(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||ba(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return oa(ta.INT32,i,o);case"scalar":return oa(e.T,i,o);case"oneof":if(i.case!==o.case)return!1;const a=e.findField(i.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(i.value,o.value);case"enum":return oa(ta.INT32,i.value,o.value);case"scalar":return oa(a.T,i.value,o.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":const r=Object.keys(i).concat(Object.keys(o));switch(e.V.kind){case"message":const t=e.V.T;return r.every((e=>t.equals(i[e],o[e])));case"enum":return r.every((e=>oa(ta.INT32,i[e],o[e])));case"scalar":const n=e.V.T;return r.every((e=>oa(n,i[e],o[e])))}}})),clone(e){const t=e.getType(),n=new t,i=n;for(const n of t.fields.byMember()){const t=e[n.localName];let o;if(n.repeated)o=t.map(Wa);else if("map"==n.kind){o=i[n.localName];for(const[e,n]of Object.entries(t))o[e]=Wa(n)}else o="oneof"==n.kind?n.findField(t.case)?{case:t.case,value:Wa(t.value)}:{case:void 0}:Wa(t);i[n.localName]=o}for(const n of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(i,n.no,n.wireType,n.data);return n}}),{newFieldList:ar,initFields:rr}),makeMessageType(e,t,n){return function(e,t,n,i){var o;const a=null!==(o=null==i?void 0:i.localName)&&void 0!==o?o:t.substring(t.lastIndexOf(".")+1),r={[a]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[a];return Object.setPrototypeOf(r.prototype,new qo),Object.assign(r,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new r).fromBinary(e,t),fromJson:(e,t)=>(new r).fromJson(e,t),fromJsonString:(e,t)=>(new r).fromJsonString(e,t),equals:(t,n)=>e.util.equals(r,t,n)}),r}(this,e,t,n)},makeEnum:function(e,t,n){const i={};for(const e of t){const t=Bo(e);i[t.localName]=t.no,i[t.no]=t.localName}return Uo(i,e,t),i},makeEnumType:Vo,getEnumType:function(e){const t=e[zo];return jo(t,"missing enum type on enum object"),t},makeExtension(e,t,n){return function(e,t,n,i){let o;return{typeName:t,extendee:n,get field(){if(!o){const n="function"==typeof i?i():i;n.name=t.split(".").pop(),n.jsonName="[".concat(t,"]"),o=e.util.newFieldList([n]).list()[0]}return o},runtime:e}}(this,e,t,n)}});var ar,rr;class sr extends qo{constructor(e){super(),this.seconds=ea.zero,this.nanos=0,or.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(or.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=ea.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return sr.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new sr({seconds:ea.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new sr).fromBinary(e,t)}static fromJson(e,t){return(new sr).fromJson(e,t)}static fromJsonString(e,t){return(new sr).fromJsonString(e,t)}static equals(e,t){return or.util.equals(sr,e,t)}}sr.runtime=or,sr.typeName="google.protobuf.Timestamp",sr.fields=or.util.newFieldList((()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]));const lr=or.makeMessageType("livekit.MetricsBatch",(()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:sr},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:cr,repeated:!0},{no:5,name:"events",kind:"message",T:dr,repeated:!0}])),cr=or.makeMessageType("livekit.TimeSeriesMetric",(()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:ur,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}])),ur=or.makeMessageType("livekit.MetricSample",(()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:sr},{no:3,name:"value",kind:"scalar",T:2}])),dr=or.makeMessageType("livekit.EventMetric",(()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:sr},{no:7,name:"normalized_end_timestamp",kind:"message",T:sr,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}])),pr=or.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),hr=or.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),gr=or.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),mr=or.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),fr=or.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),vr=or.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),yr=or.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),br=or.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),kr=or.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Sr=or.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),wr=or.makeMessageType("livekit.Room",(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Tr,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:es}])),Tr=or.makeMessageType("livekit.Codec",(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}])),Cr=or.makeMessageType("livekit.ParticipantPermission",(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:or.getEnumType(gr),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}])),Pr=or.makeMessageType("livekit.ParticipantInfo",(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:or.getEnumType(xr)},{no:4,name:"tracks",kind:"message",T:_r,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Cr},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:or.getEnumType(Ir)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:or.getEnumType(yr)},{no:18,name:"kind_details",kind:"enum",T:or.getEnumType(Ar),repeated:!0}])),xr=or.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Ir=or.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),Ar=or.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Er=or.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),Or=or.makeMessageType("livekit.SimulcastCodecInfo",(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Nr,repeated:!0}])),_r=or.makeMessageType("livekit.TrackInfo",(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:or.getEnumType(hr)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:or.getEnumType(gr)},{no:10,name:"layers",kind:"message",T:Nr,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Or,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:or.getEnumType(Er)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:es},{no:19,name:"audio_features",kind:"enum",T:or.getEnumType(Sr),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:or.getEnumType(pr)}])),Nr=or.makeMessageType("livekit.VideoLayer",(()=>[{no:1,name:"quality",kind:"enum",T:or.getEnumType(mr)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}])),Mr=or.makeMessageType("livekit.DataPacket",(()=>[{no:1,name:"kind",kind:"enum",T:or.getEnumType(Rr)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Lr,oneof:"value"},{no:3,name:"speaker",kind:"message",T:jr,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Fr,oneof:"value"},{no:7,name:"transcription",kind:"message",T:zr,oneof:"value"},{no:8,name:"metrics",kind:"message",T:lr,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Vr,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Br,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:qr,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Kr,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:os,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:as,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:rs,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}])),Rr=or.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),jr=or.makeMessageType("livekit.ActiveSpeakerUpdate",(()=>[{no:1,name:"speakers",kind:"message",T:Dr,repeated:!0}])),Dr=or.makeMessageType("livekit.SpeakerInfo",(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}])),Lr=or.makeMessageType("livekit.UserPacket",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}])),Fr=or.makeMessageType("livekit.SipDTMF",(()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}])),zr=or.makeMessageType("livekit.Transcription",(()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Ur,repeated:!0}])),Ur=or.makeMessageType("livekit.TranscriptionSegment",(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}])),Vr=or.makeMessageType("livekit.ChatMessage",(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}])),Br=or.makeMessageType("livekit.RpcRequest",(()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}])),qr=or.makeMessageType("livekit.RpcAck",(()=>[{no:1,name:"request_id",kind:"scalar",T:9}])),Kr=or.makeMessageType("livekit.RpcResponse",(()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Hr,oneof:"value"}])),Hr=or.makeMessageType("livekit.RpcError",(()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}])),Wr=or.makeMessageType("livekit.ParticipantTracks",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}])),Gr=or.makeMessageType("livekit.ServerInfo",(()=>[{no:1,name:"edition",kind:"enum",T:or.getEnumType($r)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}])),$r=or.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Jr=or.makeMessageType("livekit.ClientInfo",(()=>[{no:1,name:"sdk",kind:"enum",T:or.getEnumType(Qr)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}])),Qr=or.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Yr=or.makeMessageType("livekit.ClientConfiguration",(()=>[{no:1,name:"video",kind:"message",T:Zr},{no:2,name:"screen",kind:"message",T:Zr},{no:3,name:"resume_connection",kind:"enum",T:or.getEnumType(vr)},{no:4,name:"disabled_codecs",kind:"message",T:Xr},{no:5,name:"force_relay",kind:"enum",T:or.getEnumType(vr)}])),Zr=or.makeMessageType("livekit.VideoConfiguration",(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:or.getEnumType(vr)}])),Xr=or.makeMessageType("livekit.DisabledCodecs",(()=>[{no:1,name:"codecs",kind:"message",T:Tr,repeated:!0},{no:2,name:"publish",kind:"message",T:Tr,repeated:!0}])),es=or.makeMessageType("livekit.TimedVersion",(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}])),ts=or.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),ns=or.makeMessageType("livekit.DataStream.TextHeader",(()=>[{no:1,name:"operation_type",kind:"enum",T:or.getEnumType(ts)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}]),{localName:"DataStream_TextHeader"}),is=or.makeMessageType("livekit.DataStream.ByteHeader",(()=>[{no:1,name:"name",kind:"scalar",T:9}]),{localName:"DataStream_ByteHeader"}),os=or.makeMessageType("livekit.DataStream.Header",(()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:or.getEnumType(Er)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:ns,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:is,oneof:"content_header"}]),{localName:"DataStream_Header"}),as=or.makeMessageType("livekit.DataStream.Chunk",(()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}]),{localName:"DataStream_Chunk"}),rs=or.makeMessageType("livekit.DataStream.Trailer",(()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}]),{localName:"DataStream_Trailer"}),ss=or.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),ls=or.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),cs=or.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),us=or.makeMessageType("livekit.SignalRequest",(()=>[{no:1,name:"offer",kind:"message",T:ks,oneof:"message"},{no:2,name:"answer",kind:"message",T:ks,oneof:"message"},{no:3,name:"trickle",kind:"message",T:gs,oneof:"message"},{no:4,name:"add_track",kind:"message",T:hs,oneof:"message"},{no:5,name:"mute",kind:"message",T:ms,oneof:"message"},{no:6,name:"subscription",kind:"message",T:ws,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Ts,oneof:"message"},{no:8,name:"leave",kind:"message",T:xs,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:As,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Vs,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Ks,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Gs,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Es,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:$s,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Cs,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:Ps,oneof:"message"}])),ds=or.makeMessageType("livekit.SignalResponse",(()=>[{no:1,name:"join",kind:"message",T:fs,oneof:"message"},{no:2,name:"answer",kind:"message",T:ks,oneof:"message"},{no:3,name:"offer",kind:"message",T:ks,oneof:"message"},{no:4,name:"trickle",kind:"message",T:gs,oneof:"message"},{no:5,name:"update",kind:"message",T:Ss,oneof:"message"},{no:6,name:"track_published",kind:"message",T:ys,oneof:"message"},{no:8,name:"leave",kind:"message",T:xs,oneof:"message"},{no:9,name:"mute",kind:"message",T:ms,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:_s,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ns,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Rs,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Ds,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:zs,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Bs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:bs,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:vs,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Js,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Zs,oneof:"message"},{no:22,name:"request_response",kind:"message",T:Xs,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:tl,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:qs,oneof:"message"}])),ps=or.makeMessageType("livekit.SimulcastCodec",(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}])),hs=or.makeMessageType("livekit.AddTrackRequest",(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:or.getEnumType(hr)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:or.getEnumType(gr)},{no:9,name:"layers",kind:"message",T:Nr,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:ps,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:or.getEnumType(Er)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:or.getEnumType(pr)},{no:17,name:"audio_features",kind:"enum",T:or.getEnumType(Sr),repeated:!0}])),gs=or.makeMessageType("livekit.TrickleRequest",(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:or.getEnumType(ss)},{no:3,name:"final",kind:"scalar",T:8}])),ms=or.makeMessageType("livekit.MuteTrackRequest",(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}])),fs=or.makeMessageType("livekit.JoinResponse",(()=>[{no:1,name:"room",kind:"message",T:wr},{no:2,name:"participant",kind:"message",T:Pr},{no:3,name:"other_participants",kind:"message",T:Pr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Os,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Yr},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Gr},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Tr,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}])),vs=or.makeMessageType("livekit.ReconnectResponse",(()=>[{no:1,name:"ice_servers",kind:"message",T:Os,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Yr},{no:3,name:"server_info",kind:"message",T:Gr},{no:4,name:"last_message_seq",kind:"scalar",T:13}])),ys=or.makeMessageType("livekit.TrackPublishedResponse",(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:_r}])),bs=or.makeMessageType("livekit.TrackUnpublishedResponse",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}])),ks=or.makeMessageType("livekit.SessionDescription",(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}])),Ss=or.makeMessageType("livekit.ParticipantUpdate",(()=>[{no:1,name:"participants",kind:"message",T:Pr,repeated:!0}])),ws=or.makeMessageType("livekit.UpdateSubscription",(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Wr,repeated:!0}])),Ts=or.makeMessageType("livekit.UpdateTrackSettings",(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:or.getEnumType(mr)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}])),Cs=or.makeMessageType("livekit.UpdateLocalAudioTrack",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:or.getEnumType(Sr),repeated:!0}])),Ps=or.makeMessageType("livekit.UpdateLocalVideoTrack",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}])),xs=or.makeMessageType("livekit.LeaveRequest",(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:or.getEnumType(yr)},{no:3,name:"action",kind:"enum",T:or.getEnumType(Is)},{no:4,name:"regions",kind:"message",T:Qs}])),Is=or.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),As=or.makeMessageType("livekit.UpdateVideoLayers",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Nr,repeated:!0}])),Es=or.makeMessageType("livekit.UpdateParticipantMetadata",(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}])),Os=or.makeMessageType("livekit.ICEServer",(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}])),_s=or.makeMessageType("livekit.SpeakersChanged",(()=>[{no:1,name:"speakers",kind:"message",T:Dr,repeated:!0}])),Ns=or.makeMessageType("livekit.RoomUpdate",(()=>[{no:1,name:"room",kind:"message",T:wr}])),Ms=or.makeMessageType("livekit.ConnectionQualityInfo",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:or.getEnumType(fr)},{no:3,name:"score",kind:"scalar",T:2}])),Rs=or.makeMessageType("livekit.ConnectionQualityUpdate",(()=>[{no:1,name:"updates",kind:"message",T:Ms,repeated:!0}])),js=or.makeMessageType("livekit.StreamStateInfo",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:or.getEnumType(ls)}])),Ds=or.makeMessageType("livekit.StreamStateUpdate",(()=>[{no:1,name:"stream_states",kind:"message",T:js,repeated:!0}])),Ls=or.makeMessageType("livekit.SubscribedQuality",(()=>[{no:1,name:"quality",kind:"enum",T:or.getEnumType(mr)},{no:2,name:"enabled",kind:"scalar",T:8}])),Fs=or.makeMessageType("livekit.SubscribedCodec",(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Ls,repeated:!0}])),zs=or.makeMessageType("livekit.SubscribedQualityUpdate",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Ls,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Fs,repeated:!0}])),Us=or.makeMessageType("livekit.TrackPermission",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}])),Vs=or.makeMessageType("livekit.SubscriptionPermission",(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Us,repeated:!0}])),Bs=or.makeMessageType("livekit.SubscriptionPermissionUpdate",(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}])),qs=or.makeMessageType("livekit.RoomMovedResponse",(()=>[{no:1,name:"room",kind:"message",T:wr},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Pr},{no:4,name:"other_participants",kind:"message",T:Pr,repeated:!0}])),Ks=or.makeMessageType("livekit.SyncState",(()=>[{no:1,name:"answer",kind:"message",T:ks},{no:2,name:"subscription",kind:"message",T:ws},{no:3,name:"publish_tracks",kind:"message",T:ys,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ws,repeated:!0},{no:5,name:"offer",kind:"message",T:ks},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Hs,repeated:!0}])),Hs=or.makeMessageType("livekit.DataChannelReceiveState",(()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}])),Ws=or.makeMessageType("livekit.DataChannelInfo",(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:or.getEnumType(ss)}])),Gs=or.makeMessageType("livekit.SimulateScenario",(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:or.getEnumType(cs),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}])),$s=or.makeMessageType("livekit.Ping",(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}])),Js=or.makeMessageType("livekit.Pong",(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}])),Qs=or.makeMessageType("livekit.RegionSettings",(()=>[{no:1,name:"regions",kind:"message",T:Ys,repeated:!0}])),Ys=or.makeMessageType("livekit.RegionInfo",(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}])),Zs=or.makeMessageType("livekit.SubscriptionResponse",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:or.getEnumType(kr)}])),Xs=or.makeMessageType("livekit.RequestResponse",(()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:or.getEnumType(el)},{no:3,name:"message",kind:"scalar",T:9}])),el=or.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),tl=or.makeMessageType("livekit.TrackSubscribed",(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]));function nl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var il,ol,al,rl,sl,ll,cl={exports:{}},ul=(il||(il=1,sl=cl.exports,ll=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],o={},a=null;function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(){for(var n=this.getLevel(),o=0;o<i.length;o++){var a=i[o];this[a]=o<n?e:this.methodFactory(a,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function c(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function u(i,o,a){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):e)}(i)||c.apply(this,arguments)}function d(e,n){var r,s,c,d=this,p="loglevel";function h(){var e;if(typeof window!==t&&p){try{e=window.localStorage[p]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(p),o=n.indexOf(i+"=");-1!==o&&(e=/^([^;]+)/.exec(n.slice(o+i.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function g(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?p+=":"+e:"symbol"==typeof e&&(p=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=c?c:null!=s?s:r},d.setLevel=function(e,n){return c=g(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&p){try{return void(window.localStorage[p]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"="+n+";"}catch(e){}}}(c),l.call(d)},d.setDefaultLevel=function(e){s=g(e),h()||d.setLevel(e,!1)},d.resetLevel=function(){c=null,function(){if(typeof window!==t&&p){try{window.localStorage.removeItem(p)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),l.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(a!==d&&(r=g(a.getLevel())),l.call(d),a===d)for(var e in o)o[e].rebuild()},r=g(a?a.getLevel():"WARN");var m=h();null!=m&&(c=g(m)),l.call(d)}(a=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new d(e,a.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=p),a},a.getLoggers=function(){return o},a.default=a,a},(ol=cl).exports?ol.exports=ll():sl.log=ll()),cl.exports);!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(al||(al={})),function(e){e.Default="livekit",e.Room="livekit-room",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}(rl||(rl={}));let dl=ul.getLogger("livekit");const pl=Object.values(rl).map((e=>ul.getLogger(e)));function hl(e){const t=ul.getLogger(e);return t.setDefaultLevel(dl.getLevel()),t}dl.setDefaultLevel(al.info);const gl=ul.getLogger("lk-e2ee"),ml=7e3,fl=[0,300,1200,2700,4800,ml,ml,ml,ml,ml];function vl(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))}function yl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,o,(t=e[n](t)).done,t.value)}))}}}"function"==typeof SuppressedError&&SuppressedError;var bl,kl={exports:{}},Sl=function(){if(bl)return kl.exports;bl=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}kl.exports=o,kl.exports.once=function(e,t){return new Promise((function(n,i){function o(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,o)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function r(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function l(e,t,n,i){var o,a,l,c;if(r(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),l=a[t]),void 0===l)l=a[t]=n,++e._eventsCount;else if("function"==typeof l?l=a[t]=i?[n,l]:[l,n]:i?l.unshift(n):l.push(n),(o=s(e))>0&&l.length>o&&!l.warned){l.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=l.length,c=u,console&&console.warn&&console.warn(c)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=c.bind(i);return o.listener=n,i.wrapFn=o,o}function d(e,t,n){var i=e._events;if(void 0===i)return[];var o=i[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):h(o,o.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function g(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(a){i.once&&e.removeEventListener(t,o),n(a)}))}}return Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return s(this)},o.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var o="error"===e,a=this._events;if(void 0!==a)o=o&&void 0===a.error;else if(!o)return!1;if(o){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var c=l.length,u=h(l,c);for(i=0;i<c;++i)n(u[i],this,t)}return!0},o.prototype.addListener=function(e,t){return l(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return l(this,e,t,!0)},o.prototype.once=function(e,t){return r(t),this.on(e,u(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return r(t),this.prependListener(e,u(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,o,a,s;if(r(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(o=a[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},kl.exports}();let wl=!0,Tl=!0;function Cl(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function Pl(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return o.apply(this,arguments);const a=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,a),o.apply(this,[e,a])};const a=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function xl(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(wl=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Il(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Tl=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Al(){if("object"==typeof window){if(wl)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function El(e,t){Tl&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Ol(e){return"[object Object]"===Object.prototype.toString.call(e)}function _l(e){return Ol(e)?Object.keys(e).reduce((function(t,n){const i=Ol(e[n]),o=i?_l(e[n]):e[n],a=i&&!Object.keys(o).length;return void 0===o||a?t:Object.assign(t,{[n]:o})}),{}):e}function Nl(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?Nl(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{Nl(e,e.get(t),n)}))})))}function Ml(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;const a=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&Nl(e,n,o)}))})),o}const Rl=Al;function jl(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[o("min",n)]=i.ideal,t.optional.push(e),e={},e[o("max",n)]=i.ideal,t.optional.push(e)):(e[o("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(t.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const r=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||r)){let t;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let r=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!r&&n.length&&t.includes("back")&&(r=n[n.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=i(e.video),Rl("chrome: "+JSON.stringify(e)),o(e)}))}e.video=i(e.video)}return Rl("chrome: "+JSON.stringify(e)),o(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){o(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(a(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(a(e))))))}}}function Dl(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Ll(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],this.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Pl(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function Fl(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function zl(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Ml(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Pl(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Ml(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Ul(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),o.apply(this,arguments)}}function Vl(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Ul(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function a(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(o.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=a(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>a(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const r=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],o=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),r.apply(this,arguments)):r.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Bl(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function ql(e,t){Pl(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var Kl=Object.freeze({__proto__:null,fixNegotiationNeeded:ql,shimAddTrackRemoveTrack:Vl,shimAddTrackRemoveTrackWithNative:Ul,shimGetSendersWithDtmf:Fl,shimGetUserMedia:jl,shimMediaStream:Dl,shimOnTrack:Ll,shimPeerConnection:Bl,shimSenderReceiverGetStats:zl});function Hl(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){El("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Wl(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Gl(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,o,a]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!o)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(o,a)}}function $l(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Jl(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Pl(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ql(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){El("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function Yl(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Zl(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function Xl(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function ec(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function tc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var nc=Object.freeze({__proto__:null,shimAddTransceiver:Zl,shimCreateAnswer:tc,shimCreateOffer:ec,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:Xl,shimGetUserMedia:Hl,shimOnTrack:Wl,shimPeerConnection:Gl,shimRTCDataChannel:Yl,shimReceiverGetStats:Jl,shimRemoveStream:Ql,shimSenderGetStats:$l});function ic(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function oc(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function ac(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,r=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[i]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};let s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function rc(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(sc(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function sc(e){return e&&void 0!==e.video?Object.assign({},e,{video:_l(e.video)}):e}function lc(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(El("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function cc(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function uc(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function dc(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var pc,hc=Object.freeze({__proto__:null,shimAudioContext:dc,shimCallbacksAPI:ac,shimConstraints:sc,shimCreateOfferLegacy:uc,shimGetUserMedia:rc,shimLocalStreamsAPI:ic,shimRTCIceServerUrls:lc,shimRemoteStreamsAPI:oc,shimTrackEventTransceiver:cc}),gc={exports:{}},mc=(pc||(pc=1,function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<i.length;e++)n=i[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],o=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let o=3;o<i.length;o++){const a=i[o],r=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(r){const i=t.parseRtpMap(r),o=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(i.parameters=o.length?t.parseFmtp(o[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const o=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{o.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let o=0;return n.codecs.forEach((e=>{e.maxptime>o&&(o=e.maxptime)})),o>0&&(i+="a=maxptime:"+o+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),s=r.length>0&&r[0].ssrc;let l;const c=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));c.length>0&&c[0].length>1&&c[0][0]===s&&(l=c[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&l&&(t.rtx={ssrc:l}),n.push(t),o&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const o=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=0===o.length;const a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return o.length>0?(n=o[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const r=t.matchPrefix(e,"a=sctpmap:");if(r.length>0){const e=r[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:o}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let o;const a=void 0!==n?n:2;return o=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+o+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let e=0;e<i.length;e++)switch(i[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t}(gc)),gc.exports),fc=nl(mc),vc=_o({__proto__:null,default:fc},[mc]);function yc(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=fc.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Pl(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function bc(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Pl(e,"icecandidate",(e=>{if(e.candidate){const t=fc.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function kc(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=fc.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=fc.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const o=fc.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let o;o=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this._sctp=a}return n.apply(this,arguments)}}function Sc(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],o=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Pl(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function wc(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Tc(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Cc(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Pc(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}var xc=Object.freeze({__proto__:null,removeExtmapAllowMixed:Tc,shimAddIceCandidateNullOrEmpty:Cc,shimConnectionState:wc,shimMaxMessageSize:kc,shimParameterlessSetLocalDescription:Pc,shimRTCIceCandidate:yc,shimRTCIceCandidateRelayProtocol:bc,shimSendThrowTypeError:Sc});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Al,i=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find((e=>"Chromium"===e.brand));if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(Cl(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(Cl(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(Cl(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=Cl(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),o={browserDetails:i,commonShim:xc,extractVersion:Cl,disableLog:xl,disableWarnings:Il,sdp:vc};switch(i.browser){case"chrome":if(!Kl||!Bl||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=Kl,Cc(e,i),Pc(e),jl(e,i),Dl(e),Bl(e,i),Ll(e),Vl(e,i),Fl(e),zl(e),ql(e,i),yc(e),bc(e),wc(e),kc(e,i),Sc(e),Tc(e,i);break;case"firefox":if(!nc||!Gl||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=nc,Cc(e,i),Pc(e),Hl(e,i),Gl(e,i),Wl(e),Ql(e),$l(e),Jl(e),Yl(e),Zl(e),Xl(e),ec(e),tc(e),yc(e),wc(e),kc(e,i),Sc(e);break;case"safari":if(!hc||!t.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=hc,Cc(e,i),Pc(e),lc(e),uc(e),ac(e),ic(e),oc(e),cc(e),rc(e),dc(e),yc(e),bc(e),kc(e,i),Sc(e),Tc(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});const Ic="lk_e2ee";var Ac,Ec,Oc,_c,Nc,Mc,Rc,jc,Dc,Lc,Fc;function zc(){return void 0!==window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(Ac||(Ac={})),function(e){e.KeyRatcheted="keyRatcheted"}(Ec||(Ec={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(Oc||(Oc={})),function(e){e.Error="cryptorError"}(_c||(_c={})),Sl.EventEmitter;class Uc extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}!function(e){e[e.NotAllowed=0]="NotAllowed",e[e.ServerUnreachable=1]="ServerUnreachable",e[e.InternalError=2]="InternalError",e[e.Cancelled=3]="Cancelled",e[e.LeaveRequest=4]="LeaveRequest",e[e.Timeout=5]="Timeout"}(Nc||(Nc={}));class Vc extends Uc{constructor(e,t,n,i){super(1,e),this.name="ConnectionError",this.status=n,this.reason=t,this.context=i,this.reasonName=Nc[t]}}class Bc extends Uc{constructor(e){super(21,null!=e?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class qc extends Uc{constructor(e){super(20,null!=e?e:"track is invalid"),this.name="TrackInvalidError"}}class Kc extends Uc{constructor(e){super(10,null!=e?e:"unsupported server"),this.name="UnsupportedServer"}}class Hc extends Uc{constructor(e){super(12,null!=e?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Wc extends Uc{constructor(e){super(13,null!=e?e:"unable to negotiate"),this.name="NegotiationError"}}class Gc extends Uc{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class $c extends Uc{constructor(e,t){super(15,e),this.reason=t,this.reasonName="string"==typeof t?t:el[t]}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(Mc||(Mc={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(Mc||(Mc={})),function(e){e[e.InvalidKey=0]="InvalidKey",e[e.MissingKey=1]="MissingKey",e[e.InternalError=2]="InternalError"}(Rc||(Rc={})),function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.Moved="moved",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.ParticipantAttributesChanged="participantAttributesChanged",e.ParticipantActive="participantActive",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged",e.ChatMessage="chatMessage",e.LocalTrackSubscribed="localTrackSubscribed",e.MetricsReceived="metricsReceived"}(jc||(jc={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackCpuConstrained="localTrackCpuConstrained",e.LocalSenderCreated="localSenderCreated",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.TrackCpuConstrained="trackCpuConstrained",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded",e.AttributesChanged="attributesChanged",e.LocalTrackSubscribed="localTrackSubscribed",e.ChatMessage="chatMessage",e.Active="active"}(Dc||(Dc={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackSubscribed="localTrackSubscribed",e.Offline="offline",e.SignalRequestResponse="signalRequestResponse",e.SignalConnected="signalConnected",e.RoomMoved="roomMoved"}(Lc||(Lc={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.CpuConstrained="cpuConstrained",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed",e.TrackProcessorUpdate="trackProcessorUpdate",e.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",e.TranscriptionReceived="transcriptionReceived",e.TimeSyncUpdate="timeSyncUpdate",e.PreConnectBufferFlushed="preConnectBufferFlushed"}(Fc||(Fc={}));const Jc=/version\/(\d+(\.?_?\d+)+)/i;let Qc;function Yc(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e&&"undefined"==typeof navigator)return;const n=(null!=e?e:navigator.userAgent).toLowerCase();if(void 0===Qc||t){const e=Zc.find((e=>{let{test:t}=e;return t.test(n)}));Qc=null==e?void 0:e.describe(n)}return Qc}const Zc=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:Xc(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:eu(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:Xc(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:eu(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:Xc(Jc,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:eu(e)})}];function Xc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}function eu(e){return e.includes("mac os")?Xc(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class tu{}tu.setTimeout=function(){return setTimeout(...arguments)},tu.setInterval=function(){return setInterval(...arguments)},tu.clearTimeout=function(){return clearTimeout(...arguments)},tu.clearInterval=function(){return clearInterval(...arguments)};const nu=[];var iu;!function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH"}(iu||(iu={}));class ou extends Sl.EventEmitter{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=ou.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=dl,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout((()=>this.handleAppVisibilityChanged()),5e3):this.handleAppVisibilityChanged()},this.log=hl(null!==(i=n.loggerName)&&void 0!==i?i:rl.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=ou.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),ud(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===ou.Kind.Video&&(t="video"),0===this.attachedElements.length&&this.kind===ou.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(nu.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&nu.splice(nu.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),au(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some((e=>"audio"===e.kind));return e.play().then((()=>{this.emit(i?Fc.AudioPlaybackStarted:Fc.VideoPlaybackStarted)})).catch((t=>{"NotAllowedError"===t.name?this.emit(i?Fc.AudioPlaybackFailed:Fc.VideoPlaybackFailed,t):"AbortError"===t.name?dl.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):dl.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some((e=>"video"===e.kind))&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch((()=>{})))})),this.emit(Fc.ElementAttached,e),e}detach(e){try{if(e){ru(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(Fc.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach((e=>{ru(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(Fc.ElementDetached,e)})),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=hl(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),nu.forEach((e=>{e.parentElement||(t=!1)})),t&&nu.push(e)}}handleAppVisibilityChanged(){return vl(this,void 0,void 0,(function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==ou.Kind.Video||setTimeout((()=>this.attachedElements.forEach((e=>e.play().catch((()=>{}))))),0)}))}addAppVisibilityListener(){xu()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){xu()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function au(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach((e=>{n.removeTrack(e)})),n.addTrack(e)),Tu()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(Tu()||wu())&&t instanceof HTMLVideoElement&&setTimeout((()=>{t.srcObject=n,t.play().catch((()=>{}))}),0))}function ru(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return hr.AUDIO;case t.Video:return hr.VIDEO;default:return hr.DATA}},e.kindFromProto=function(e){switch(e){case hr.AUDIO:return t.Audio;case hr.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return gr.CAMERA;case n.Microphone:return gr.MICROPHONE;case n.ScreenShare:return gr.SCREEN_SHARE;case n.ScreenShareAudio:return gr.SCREEN_SHARE_AUDIO;default:return gr.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case gr.CAMERA:return n.Camera;case gr.MICROPHONE:return n.Microphone;case gr.SCREEN_SHARE:return n.ScreenShare;case gr.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case ls.ACTIVE:return i.Active;case ls.PAUSED:return i.Paused;default:return i.Unknown}}}(ou||(ou={}));class su{constructor(e,t,n,i,o){if("object"==typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else{if(void 0===t||void 0===n)throw new TypeError("Unsupported options: provide at least width, height and maxBitrate");this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:o}}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const lu=["vp8","h264"],cu=["vp8","h264","vp9","av1","h265"];function uu(e){return!!lu.find((t=>t===e))}var du,pu;!function(e){e[e.PREFER_REGRESSION=0]="PREFER_REGRESSION",e[e.SIMULCAST=1]="SIMULCAST",e[e.REGRESSION=2]="REGRESSION"}(du||(du={})),function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:24e3},e.music={maxBitrate:48e3},e.musicStereo={maxBitrate:64e3},e.musicHighQuality={maxBitrate:96e3},e.musicHighQualityStereo={maxBitrate:128e3}}(pu||(pu={}));const hu={h90:new su(160,90,9e4,20),h180:new su(320,180,16e4,20),h216:new su(384,216,18e4,20),h360:new su(640,360,45e4,20),h540:new su(960,540,8e5,25),h720:new su(1280,720,17e5,30),h1080:new su(1920,1080,3e6,30),h1440:new su(2560,1440,5e6,30),h2160:new su(3840,2160,8e6,30)},gu={h120:new su(160,120,7e4,20),h180:new su(240,180,125e3,20),h240:new su(320,240,14e4,20),h360:new su(480,360,33e4,20),h480:new su(640,480,5e5,20),h540:new su(720,540,6e5,25),h720:new su(960,720,13e5,30),h1080:new su(1440,1080,23e5,30),h1440:new su(1920,1440,38e5,30)},mu={h360fps3:new su(640,360,2e5,3,"medium"),h360fps15:new su(640,360,4e5,15,"medium"),h720fps5:new su(1280,720,8e5,5,"medium"),h720fps15:new su(1280,720,15e5,15,"medium"),h720fps30:new su(1280,720,2e6,30,"medium"),h1080fps15:new su(1920,1080,25e5,15,"medium"),h1080fps30:new su(1920,1080,5e6,30,"medium"),original:new su(0,0,7e6,30,"medium")},fu="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function vu(e){return vl(this,void 0,void 0,(function*(){return new Promise((t=>tu.setTimeout(t,e)))}))}function yu(){return"addTransceiver"in RTCPeerConnection.prototype}function bu(){return"addTrack"in RTCPeerConnection.prototype}function ku(e){return"av1"===e||"vp9"===e}function Su(e){return!!document&&(e||(e=document.createElement("audio")),"setSinkId"in e)}function wu(){var e;return"Firefox"===(null===(e=Yc())||void 0===e?void 0:e.name)}function Tu(){var e;return"Safari"===(null===(e=Yc())||void 0===e?void 0:e.name)}function Cu(){const e=Yc();return"Safari"===(null==e?void 0:e.name)||"iOS"===(null==e?void 0:e.os)}function Pu(){var e,t;return!!xu()&&(null!==(t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.mobile)&&void 0!==t?t:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function xu(){return"undefined"!=typeof document}function Iu(){return"ReactNative"==navigator.product}function Au(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function Eu(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Ou(){if(!Iu())return;let e=Eu();return e?e.platform:void 0}function _u(){if(xu())return window.devicePixelRatio;if(Iu()){let e=Eu();if(e)return e.devicePixelRatio}return 1}function Nu(e,t){const n=e.split("."),i=t.split("."),o=Math.min(n.length,i.length);for(let e=0;e<o;++e){const t=parseInt(n[e],10),a=parseInt(i[e],10);if(t>a)return 1;if(t<a)return-1;if(e===o-1&&t===a)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function Mu(e){for(const t of e)t.target.handleResize(t)}function Ru(e){for(const t of e)t.target.handleVisibilityChanged(t)}let ju=null;const Du=()=>(ju||(ju=new ResizeObserver(Mu)),ju);let Lu=null;const Fu=()=>(Lu||(Lu=new IntersectionObserver(Ru,{root:null,rootMargin:"0px"})),Lu);let zu;function Uu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=document.createElement("canvas");o.width=e,o.height=t;const a=o.getContext("2d");null==a||a.fillRect(0,0,o.width,o.height),i&&a&&(a.beginPath(),a.arc(e/2,t/2,50,0,2*Math.PI,!0),a.closePath(),a.fillStyle="grey",a.fill());const r=o.captureStream(),[s]=r.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function Vu(){if(!zu){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[zu]=i.stream.getAudioTracks(),!zu)throw Error("Could not get empty media stream audio track");zu.enabled=!1}return zu.clone()}class Bu{constructor(e,t){this.onFinally=t,this.promise=new Promise(((t,n)=>vl(this,void 0,void 0,(function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})))).finally((()=>{var e;return null===(e=this.onFinally)||void 0===e?void 0:e.call(this)}))}}function qu(e){if("string"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function Ku(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}function Hu(e){switch(e.reason){case Nc.LeaveRequest:return e.context;case Nc.Cancelled:return yr.CLIENT_INITIATED;case Nc.NotAllowed:return yr.USER_REJECTED;case Nc.ServerUnreachable:return yr.JOIN_FAILURE;default:return yr.UNKNOWN_REASON}}function Wu(e){return void 0!==e?Number(e):void 0}function Gu(e){return void 0!==e?BigInt(e):void 0}function $u(e){return!!e&&!(e instanceof MediaStreamTrack)&&e.isLocal}function Ju(e){return!!e&&e.kind==ou.Kind.Audio}function Qu(e){return!!e&&e.kind==ou.Kind.Video}function Yu(e){return $u(e)&&Qu(e)}function Zu(e){return $u(e)&&Ju(e)}function Xu(e){return!!e&&!e.isLocal}function ed(e){return!!e&&!e.isLocal}function td(e){return Xu(e)&&Qu(e)}function nd(e,t,n){var i,o,a,r;const{optionsWithoutProcessor:s,audioProcessor:l,videoProcessor:c}=dd(null!=e?e:{}),u=null==t?void 0:t.processor,d=null==n?void 0:n.processor,p=null!=s?s:{};return!0===p.audio&&(p.audio={}),!0===p.video&&(p.video={}),p.audio&&(id(p.audio,t),null!==(i=(a=p.audio).deviceId)&&void 0!==i||(a.deviceId={ideal:"default"}),(l||u)&&(p.audio.processor=null!=l?l:u)),p.video&&(id(p.video,n),null!==(o=(r=p.video).deviceId)&&void 0!==o||(r.deviceId={ideal:"default"}),(c||d)&&(p.video.processor=null!=c?c:d)),p}function id(e,t){return Object.keys(t).forEach((n=>{void 0===e[n]&&(e[n]=t[n])})),e}function od(e){var t,n,i,o;const a={};if(e.video)if("object"==typeof e.video){const n={},o=n,r=e.video;Object.keys(r).forEach((e=>{"resolution"===e?id(o,r.resolution):o[e]=r[e]})),a.video=n,null!==(t=(i=a.video).deviceId)&&void 0!==t||(i.deviceId={ideal:"default"})}else a.video=!!e.video&&{deviceId:{ideal:"default"}};else a.video=!1;return e.audio?"object"==typeof e.audio?(a.audio=e.audio,null!==(n=(o=a.audio).deviceId)&&void 0!==n||(o.deviceId={ideal:"default"})):a.audio={deviceId:{ideal:"default"}}:a.audio=!1,a}function ad(){var e;const t="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext);if(t){const n=new t({latencyHint:"interactive"});if("suspended"===n.state&&"undefined"!=typeof window&&(null===(e=window.document)||void 0===e?void 0:e.body)){const e=()=>vl(this,void 0,void 0,(function*(){var t;try{"suspended"===n.state&&(yield n.resume())}catch(e){console.warn("Error trying to auto-resume audio context",e)}null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e)}));window.document.body.addEventListener("click",e)}return n}}function rd(e){return"audioinput"===e?ou.Source.Microphone:"videoinput"===e?ou.Source.Camera:ou.Source.Unknown}function sd(e){return e===ou.Source.Microphone?"audioinput":e===ou.Source.Camera?"videoinput":void 0}function ld(e){return e.split("/")[1].toLowerCase()}function cd(e){const t=[];return e.forEach((e=>{void 0!==e.track&&t.push(new ys({cid:e.track.mediaStreamID,track:e.trackInfo}))})),t}function ud(e){return"mediaStreamTrack"in e?{trackID:e.sid,source:e.source,muted:e.isMuted,enabled:e.mediaStreamTrack.enabled,kind:e.kind,streamID:e.mediaStreamID,streamTrackID:e.mediaStreamTrack.id}:{trackID:e.trackSid,enabled:e.isEnabled,muted:e.isMuted,trackInfo:Object.assign({mimeType:e.mimeType,name:e.trackName,encrypted:e.isEncrypted,kind:e.kind,source:e.source},e.track?ud(e.track):{})}}function dd(e){const t=Object.assign({},e);let n,i;return"object"==typeof t.audio&&t.audio.processor&&(n=t.audio.processor,t.audio=Object.assign(Object.assign({},t.audio),{processor:void 0})),"object"==typeof t.video&&t.video.processor&&(i=t.video.processor,t.video=Object.assign(Object.assign({},t.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:(o=t,void 0===o?o:"function"==typeof structuredClone?"object"==typeof o&&null!==o?structuredClone(Object.assign({},o)):structuredClone(o):JSON.parse(JSON.stringify(o)))};var o}function pd(e,t){return e.width*e.height<t.width*t.height}class hd extends Sl.EventEmitter{constructor(e){super(),this.onWorkerMessage=e=>{var t,n;const{kind:i,data:o}=e.data;switch(i){case"error":dl.error(o.error.message),this.emit(Oc.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)}));break;case"enable":if(o.enabled&&this.keyProvider.getKeys().forEach((e=>{this.postKey(e)})),this.encryptionEnabled!==o.enabled&&o.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(Oc.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(o.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Oc.ParticipantEncryptionStatusChanged,o.enabled,e)}break;case"ratchetKey":this.keyProvider.emit(Ac.KeyRatcheted,o.ratchetResult,o.participantIdentity,o.keyIndex)}},this.onWorkerError=e=>{dl.error("e2ee worker encountered an error:",{error:e.error}),this.emit(Oc.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!(void 0!==window.RTCRtpSender&&void 0!==window.RTCRtpSender.prototype.createEncodedStreams||zc()))throw new Bc("tried to setup end-to-end encryption on an unsupported browser");if(dl.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:gl.getLevel()}};this.worker&&(dl.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){dl.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):dl.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(Lc.RTPVideoMapUpdate,(e=>{this.postRTPMap(e)}))}setupEventListeners(e,t){e.on(jc.TrackPublished,((e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==Er.NONE,t.identity))),e.on(jc.ConnectionStateChanged,(t=>{t===Ep.Connected&&e.remoteParticipants.forEach((e=>{e.trackPublications.forEach((t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==Er.NONE,e.identity)}))}))})).on(jc.TrackUnsubscribed,((e,t,n)=>{var i;const o={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(o)})).on(jc.TrackSubscribed,((e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)})).on(jc.SignalConnected,(()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach((e=>{this.postKey(e)})),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)})),e.localParticipant.on(Dc.LocalSenderCreated,((e,t)=>vl(this,void 0,void 0,(function*(){this.setupE2EESender(t,e)})))),t.on(Ac.SetKey,(e=>this.postKey(e))).on(Ac.RatchetRequest,((e,t)=>this.postRatchetRequest(e,t)))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const a={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(o=this.room)||void 0===o?void 0:o.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(a)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null==n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?ld(n.mimeType):void 0)}}setupE2EESender(e,t){$u(e)&&t?this.handleSender(t,e.mediaStreamID,void 0):t||dl.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return vl(this,void 0,void 0,(function*(){if(this.worker){if(zc()){const o={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(Ic in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let o=e.writableStream,a=e.readableStream;if(!o||!a){const t=e.createEncodedStreams();e.writableStream=t.writable,o=t.writable,e.readableStream=t.readable,a=t.readable}const r={kind:"decode",data:{readableStream:a,writableStream:o,trackId:t,codec:i,participantIdentity:n,isReuse:Ic in e}};this.worker.postMessage(r,[a,o])}e[Ic]=!0}}))}handleSender(e,t,n){var i;if(!(Ic in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(zc()){dl.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{dl.info("initialize encoded streams");const i=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(o,[i.readable,i.writable])}e[Ic]=!0}}}const gd="default";class md{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new md),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;if((null===(i=md.userMediaPromiseMap)||void 0===i?void 0:i.size)>0){dl.debug("awaiting getUserMedia promise");try{e?yield md.userMediaPromiseMap.get(e):yield Promise.all(md.userMediaPromiseMap.values())}catch(e){dl.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(n&&(!Tu()||!t.hasDeviceInUse(e))){const t=0===o.filter((t=>t.kind===e)).length||o.some((t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i}));if(t){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e&&{deviceId:{ideal:"default"}}},n=yield navigator.mediaDevices.getUserMedia(t);o=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach((e=>{e.stop()}))}}return t._previousDevices=o,e&&(o=o.filter((t=>t.kind===e))),o}()}))}normalizeDeviceId(e,t,n){return vl(this,void 0,void 0,(function*(){if(t!==gd)return t;const i=yield this.getDevices(e),o=i.find((e=>e.deviceId===gd));if(!o)return void dl.warn("could not reliably determine default device");const a=i.find((e=>e.deviceId!==gd&&e.groupId===(null!=n?n:o.groupId)));if(a)return null==a?void 0:a.deviceId;dl.warn("could not reliably determine default device")}))}hasDeviceInUse(e){return e?md.userMediaPromiseMap.has(e):md.userMediaPromiseMap.size>0}}var fd;md.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],md.userMediaPromiseMap=new Map,function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(fd||(fd={}));class vd{constructor(){this.pendingTasks=new Map,this.taskMutex=new Ro,this.nextTaskIndex=0}run(e){return vl(this,void 0,void 0,(function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:fd.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=fd.RUNNING,yield e()}finally{t.status=fd.COMPLETED,this.pendingTasks.delete(t.id),n()}}))}flush(){return vl(this,void 0,void 0,(function*(){return this.run((()=>vl(this,void 0,void 0,(function*(){}))))}))}snapshot(){return Array.from(this.pendingTasks.values())}}function yd(e,t){return e.pathname="".concat(function(e){return e.endsWith("/")?e:"".concat(e,"/")}(e.pathname)).concat(t),e.toString()}const bd=["syncState","trickle","offer","answer","simulate","leave"];var kd;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(kd||(kd={}));class Sd{get currentState(){return this.state}get isDisconnected(){return this.state===kd.DISCONNECTING||this.state===kd.DISCONNECTED}get isEstablishingConnection(){return this.state===kd.CONNECTING||this.state===kd.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=kd.DISCONNECTED,this.log=dl,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=hl(null!==(n=t.loggerName)&&void 0!==n?n:rl.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new vd,this.queuedRequests=[],this.closingLock=new Ro,this.connectionLock=new Ro,this.state=kd.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return vl(this,void 0,void 0,(function*(){return this.state=kd.CONNECTING,this.options=n,yield this.connect(e,t,n,i)}))}reconnect(e,t,n,i){return vl(this,void 0,void 0,(function*(){if(this.options)return this.state=kd.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}));this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext)}))}connect(e,t,n,i){this.connectOptions=n;const o=function(e,t,n){var i;const o=new URLSearchParams;return o.set("access_token",e),n.reconnect&&(o.set("reconnect","1"),n.sid&&o.set("sid",n.sid)),o.set("auto_subscribe",n.autoSubscribe?"1":"0"),o.set("sdk",Iu()?"reactnative":"js"),o.set("version",t.version),o.set("protocol",t.protocol.toString()),t.deviceModel&&o.set("device_model",t.deviceModel),t.os&&o.set("os",t.os),t.osVersion&&o.set("os_version",t.osVersion),t.browser&&o.set("browser",t.browser),t.browserVersion&&o.set("browser_version",t.browserVersion),n.adaptiveStream&&o.set("adaptive_stream","1"),n.reconnectReason&&o.set("reconnect_reason",n.reconnectReason.toString()),(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&o.set("network",navigator.connection.type),o}(t,function(){var e;const t=new Jr({sdk:Qr.JS,protocol:16,version:"2.15.2"});return Iu()&&(t.os=null!==(e=Ou())&&void 0!==e?e:""),t}(),n),a=function(e,t){const n=new URL(function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e));return t.forEach(((e,t)=>{n.searchParams.set(t,e)})),yd(n,"rtc")}(e,o),r=yd(new URL(Ku(a)),"validate");return new Promise(((e,t)=>vl(this,void 0,void 0,(function*(){const o=yield this.connectionLock.lock();try{const o=()=>vl(this,void 0,void 0,(function*(){this.close(),clearTimeout(s),t(new Vc("room connection has been cancelled (signal)",Nc.Cancelled))})),s=setTimeout((()=>{this.close(),t(new Vc("room connection has timed out (signal)",Nc.ServerUnreachable))}),n.websocketTimeout);(null==i?void 0:i.aborted)&&o(),null==i||i.addEventListener("abort",o);const l=new URL(a);l.searchParams.has("access_token")&&l.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(l),Object.assign({reconnect:n.reconnect,reconnectReason:n.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(a),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(s)},this.ws.onerror=e=>vl(this,void 0,void 0,(function*(){if(this.state===kd.CONNECTED)this.handleWSError(e);else{this.state=kd.DISCONNECTED,clearTimeout(s);try{const n=yield fetch(r);if(n.status.toFixed(0).startsWith("4")){const e=yield n.text();t(new Vc(e,Nc.NotAllowed,n.status))}else t(new Vc("Encountered unknown websocket error during connection: ".concat(e.toString()),Nc.InternalError,n.status))}catch(e){t(new Vc(e instanceof Error?e.message:"server was not reachable",Nc.ServerUnreachable))}}})),this.ws.onmessage=a=>vl(this,void 0,void 0,(function*(){var r,s,l;let c;if("string"==typeof a.data){const e=JSON.parse(a.data);c=ds.fromJson(e,{ignoreUnknownFields:!0})}else{if(!(a.data instanceof ArrayBuffer))return void this.log.error("could not decode websocket message: ".concat(typeof a.data),this.logContext);c=ds.fromBinary(new Uint8Array(a.data))}if(this.state!==kd.CONNECTED){let a=!1;if("join"===(null===(r=c.message)||void 0===r?void 0:r.case)?(this.state=kd.CONNECTED,null==i||i.removeEventListener("abort",o),this.pingTimeoutDuration=c.message.value.pingTimeout,this.pingIntervalDuration=c.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),e(c.message.value)):this.state===kd.RECONNECTING&&"leave"!==c.message.case?(this.state=kd.CONNECTED,null==i||i.removeEventListener("abort",o),this.startPingInterval(),"reconnect"===(null===(s=c.message)||void 0===s?void 0:s.case)?e(c.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),e(void 0),a=!0)):this.isEstablishingConnection&&"leave"===c.message.case?t(new Vc("Received leave request while trying to (re)connect",Nc.LeaveRequest,void 0,c.message.value.reason)):n.reconnect||t(new Vc("did not receive join response, got ".concat(null===(l=c.message)||void 0===l?void 0:l.case," instead"),Nc.InternalError)),!a)return}this.signalLatency&&(yield vu(this.signalLatency)),this.handleSignalResponse(c)})),this.ws.onclose=e=>{this.isEstablishingConnection&&t(new Vc("Websocket got closed during a (re)connection attempt",Nc.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,code:e.code,wasClean:e.wasClean,state:this.state})),this.handleOnClose(e.reason)}}finally{o()}}))))}close(){return vl(this,arguments,void 0,(function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){const n=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=kd.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const t=new Promise((t=>{e.ws?e.ws.onclose=()=>{t()}:t()}));e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([t,vu(250)])),e.ws=void 0}}finally{t&&(e.state=kd.DISCONNECTED),n()}}()}))}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Td(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Td(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new gs({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new ms({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return vl(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){const o=n.getNextRequestId();return yield n.sendRequest({case:"updateMetadata",value:new Es({requestId:o,metadata:e,name:t,attributes:i})}),o}()}))}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new As({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new Vs({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:ea.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new $s({timestamp:ea.parse(Date.now()),rtt:ea.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new Cs({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new xs({reason:yr.CLIENT_INITIATED,action:Is.DISCONNECT})})}sendRequest(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const i=!n&&!function(e){const t=bd.indexOf(e.case)>=0;return dl.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(i&&t.state===kd.RECONNECTING)return void t.queuedRequests.push((()=>vl(t,void 0,void 0,(function*(){yield this.sendRequest(e,!0)}))));if(n||(yield t.requestQueue.flush()),t.signalLatency&&(yield vu(t.signalLatency)),!t.ws||t.ws.readyState!==t.ws.OPEN)return void t.log.error("cannot send signal request before connected, type: ".concat(null==e?void 0:e.case),t.logContext);const o=new us({message:e});try{t.useJSON?t.ws.send(o.toJsonString()):t.ws.send(o.toBinary())}catch(e){t.log.error("error sending signal message",Object.assign(Object.assign({},t.logContext),{error:e}))}}()}))}handleSignalResponse(e){var t,n;const i=e.message;if(null==i)return void this.log.debug("received unsupported message",this.logContext);let o=!1;if("answer"===i.case){const e=wd(i.value);this.onAnswer&&this.onAnswer(e,i.value.id)}else if("offer"===i.case){const e=wd(i.value);this.onOffer&&this.onOffer(e,i.value.id)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):"requestResponse"===i.case?this.onRequestResponse&&this.onRequestResponse(i.value):"trackSubscribed"===i.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):"roomMoved"===i.case?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return vl(this,void 0,void 0,(function*(){if(this.state===kd.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)}))}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=tu.setTimeout((()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")}),1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&tu.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=tu.setInterval((()=>{this.sendPing()}),1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&tu.clearInterval(this.pingInterval)}}function wd(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function Td(e,t){return new ks({sdp:e.sdp,type:e.type,id:t})}class Cd{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Pd{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const n=Date.now();n-this._lastCleanup>this.ttl/2&&this.cleanup();const i=n+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(!(t.expiresAt<Date.now()))return t.value;this._map.delete(e)}}has(e){const t=this._map.get(e);return!(!t||t.expiresAt<Date.now()&&(this._map.delete(e),1))}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,n]of this._map.entries())n.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e(n.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],n=this.asValueMap();for(const[i,o]of n.entries())t.push(e(o,i,n));return t}asValueMap(){const e=new Map;for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e.set(t,n.value);return e}}var xd,Id,Ad,Ed,Od,_d={},Nd={},Md={exports:{}};function Rd(){if(xd)return Md.exports;xd=1;var e=Md.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(e).forEach((function(t){e[t].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))})),Md.exports}function jd(){return Id||(Id=1,function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var o=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:o&&!n[e.name]&&(n[e.name]={});var a=e.push?{}:o?n[e.name]:n;!function(e,n,i,o){if(o&&!i)n[o]=t(e[1]);else for(var a=0;a<i.length;a+=1)null!=e[a+1]&&(n[i[a]]=t(e[a+1]))}(i.match(e.reg),a,e.names,e.name),e.push&&n[e.push].push(a)},i=Rd(),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},a=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(a.push({rtp:[],fmtp:[]}),r=a[a.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var l=i[t][s];if(l.reg.test(o))return n(l,r,o)}})),t.media=a,t};var a=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),o=0;o<i.length;o+=3)n.push({component:i[o],ip:i[o+1],port:i[o+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}}))}))}}(Nd)),Nd}function Dd(){if(Ed)return Ad;Ed=1;var e=Rd(),t=/%[sdv%]/g,n=function(e){var n=1,i=arguments,o=i.length;return e.replace(t,(function(e){if(n>=o)return e;var t=i[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}}))},i=function(e,t,i){var o=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var a=0;a<t.names.length;a+=1){var r=t.names[a];t.name?o.push(i[t.name][r]):o.push(i[t.names[a]])}else o.push(i[t.name]);return n.apply(null,o)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return Ad=function(t,n){n=n||{},null==t.version&&(t.version=0),null==t.name&&(t.name=" "),t.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=n.outerOrder||o,s=n.innerOrder||a,l=[];return r.forEach((function(n){e[n].forEach((function(e){e.name in t&&null!=t[e.name]?l.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach((function(t){l.push(i(n,e,t))}))}))})),t.media.forEach((function(t){l.push(i("m",e.m[0],t)),s.forEach((function(n){e[n].forEach((function(e){e.name in t&&null!=t[e.name]?l.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach((function(t){l.push(i(n,e,t))}))}))}))})),l.join("\r\n")+"\r\n"},Ad}var Ld=function(){if(Od)return _d;Od=1;var e=jd(),t=Dd(),n=Rd();return _d.grammar=n,_d.write=t,_d.parse=e.parse,_d.parseParams=e.parseParams,_d.parseFmtpConfig=e.parseFmtpConfig,_d.parsePayloads=e.parsePayloads,_d.parseRemoteCandidates=e.parseRemoteCandidates,_d.parseImageAttributes=e.parseImageAttributes,_d.parseSimulcastStreamList=e.parseSimulcastStreamList,_d}();function Fd(e,t,n){var i,o,a;void 0===t&&(t=50),void 0===n&&(n={});var r=null!=(i=n.isImmediate)&&i,s=null!=(o=n.callback)&&o,l=n.maxWait,c=Date.now(),u=[];function d(){if(void 0!==l){var e=Date.now()-c;if(e+t>=l)return l-e}return t}var p=function(){var t=[].slice.call(arguments),n=this;return new Promise((function(i,o){var l=r&&void 0===a;if(void 0!==a&&clearTimeout(a),a=setTimeout((function(){if(a=void 0,c=Date.now(),!r){var i=e.apply(n,t);s&&s(i),u.forEach((function(e){return(0,e.resolve)(i)})),u=[]}}),d()),l){var p=e.apply(n,t);return s&&s(p),i(p)}u.push({resolve:i,reject:o})}))};return p.cancel=function(e){void 0!==a&&clearTimeout(a),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},p}const zd="negotiationStarted",Ud="negotiationComplete",Vd="rtpVideoPayloadTypes";class Bd extends Sl.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.log=dl,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Fd((e=>vl(this,void 0,void 0,(function*(){this.emit(zd);try{yield this.createAndSendOffer()}catch(t){if(!e)throw t;e(t)}}))),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=hl(null!==(n=t.loggerName)&&void 0!==n?n:rl.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new Ro}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return vl(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e,t){return vl(this,void 0,void 0,(function*(){var n;if("answer"===e.type&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],o=Ld.parse(null!==(t=e.sdp)&&void 0!==t?t:"");let a=0;return o.media.forEach((e=>{var t;"audio"===e.type&&(e.rtp.some((e=>"opus"===e.codec&&(a=e.payload,!0))),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some((e=>e.payload===a&&"nack"===e.type)))&&i.push(e.mid),e.fmtp.some((t=>t.payload===a&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0))))})),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const t=Ld.parse(null!==(n=e.sdp)&&void 0!==n?n:"");t.media.forEach((e=>{"audio"===e.type&&this.trackBitrates.some((t=>{if(!t.transceiver||e.mid!=t.transceiver.mid)return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;let i=!1;for(const o of e.fmtp)if(o.payload===n){o.config=o.config.split(";").filter((e=>!e.includes("maxaveragebitrate"))).join(";"),t.maxbr>0&&(o.config+=";maxaveragebitrate=".concat(1e3*t.maxbr)),i=!0;break}return i||t.maxbr>0&&e.fmtp.push({payload:n,config:"maxaveragebitrate=".concat(1e3*t.maxbr)}),!0}))})),i=Ld.write(t)}return yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):"answer"===e.type&&(this.emit(Ud),e.sdp)&&Ld.parse(e.sdp).media.forEach((e=>{"video"===e.type&&this.emit(Vd,e.rtp)})),!0}))}createAndSendOffer(e){return vl(this,void 0,void 0,(function*(){var t;const n=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null==e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null==e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=this.latestOfferId+1;this.latestOfferId=n;const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const o=Ld.parse(null!==(t=i.sdp)&&void 0!==t?t:"");if(o.media.forEach((e=>{Kd(e),"audio"===e.type?qd(e,[],[]):"video"===e.type&&this.trackBitrates.some((t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some((e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0))),0===n)return!0;if(ku(t.codec)&&this.ensureVideoDDExtensionForSVC(e,o),"av1"!==t.codec)return!0;const i=Math.round(.7*t.maxbr);for(const t of e.fmtp)if(t.payload===n){t.config.includes("x-google-start-bitrate")||(t.config+=";x-google-start-bitrate=".concat(i));break}return!0}))})),this.latestOfferId>n)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:n}));yield this.setMungedSDP(i,Ld.write(o)),this.onOffer(i,this.latestOfferId)}finally{n()}}))}createAndSetAnswer(){return vl(this,void 0,void 0,(function*(){var e;const t=yield this.pc.createAnswer(),n=Ld.parse(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach((e=>{Kd(e),"audio"===e.type&&qd(e,this.remoteStereoMids,this.remoteNackMids)})),yield this.setMungedSDP(t,Ld.write(n)),t}))}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Hc("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Hc("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return vl(this,void 0,void 0,(function*(){var e;if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach((e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}})),""===t)return;const o=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==o?i.get(o):void 0}))}setMungedSDP(e,t,n){return vl(this,void 0,void 0,(function*(){if(t){const i=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(n){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:n,sdp:t})),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(t){let i="unknown error";t instanceof Error?i=t.message:"string"==typeof t&&(i=t);const o={error:i,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new Wc(i)}}))}ensureVideoDDExtensionForSVC(e,t){var n,i;if(!(null===(n=e.ext)||void 0===n?void 0:n.some((e=>e.uri===fu)))){if(0===this.ddExtID){let e=0;t.media.forEach((t=>{var n;"video"===t.type&&(null===(n=t.ext)||void 0===n||n.forEach((t=>{t.value>e&&(e=t.value)})))})),this.ddExtID=e+1}null===(i=e.ext)||void 0===i||i.push({value:this.ddExtID,uri:fu})}}}function qd(e,t,n){let i=0;e.rtp.some((e=>"opus"===e.codec&&(i=e.payload,!0))),i>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some((e=>e.payload===i&&"nack"===e.type))&&e.rtcpFb.push({payload:i,type:"nack"}),t.includes(e.mid)&&e.fmtp.some((e=>e.payload===i&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0))))}function Kd(e){if(e.connection){const t=e.connection.ip.indexOf(":")>=0;(4===e.connection.version&&t||6===e.connection.version&&!t)&&(e.connection.ip="0.0.0.0",e.connection.version=4)}}const Hd="vp8",Wd={audioPreset:pu.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:mu.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Hd,backupCodec:!0,preConnectBuffer:!1},Gd={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},$d={deviceId:{ideal:"default"},resolution:hu.h720.resolution},Jd={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:fl}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1},Qd={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Yd;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(Yd||(Yd={}));class Zd{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,n){var i;this.peerConnectionTimeout=Qd.peerConnectionTimeout,this.log=dl,this.updateState=()=>{var e;const t=this.state,n=this.requiredTransports.map((e=>e.getConnectionState()));n.every((e=>"connected"===e))?this.state=Yd.CONNECTED:n.some((e=>"failed"===e))?this.state=Yd.FAILED:n.some((e=>"connecting"===e))?this.state=Yd.CONNECTING:n.every((e=>"closed"===e))?this.state=Yd.CLOSED:n.some((e=>"closed"===e))?this.state=Yd.CLOSING:n.every((e=>"new"===e))&&(this.state=Yd.NEW),t!==this.state&&(this.log.debug("pc state change: from ".concat(Yd[t]," to ").concat(Yd[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=hl(null!==(i=n.loggerName)&&void 0!==i?i:rl.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t,this.publisher=new Bd(e,n),this.subscriber=new Bd(e,n),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,ss.PUBLISHER)},this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,ss.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=(e,t)=>{var n;null===(n=this.onPublisherOffer)||void 0===n||n.call(this,e,t)},this.state=Yd.NEW,this.connectionLock=new Ro,this.remoteOfferLock=new Ro}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return vl(this,void 0,void 0,(function*(){if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(e){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:e}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()}))}triggerIceRestart(){return vl(this,void 0,void 0,(function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))}))}addIceCandidate(e,t){return vl(this,void 0,void 0,(function*(){t===ss.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)}))}createSubscriberAnswerFromOffer(e,t){return vl(this,void 0,void 0,(function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{if(!(yield this.subscriber.setRemoteDescription(e,t)))return;return yield this.subscriber.createAndSetAnswer()}finally{n()}}))}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return vl(this,void 0,void 0,(function*(){var n;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map((n=>this.ensureTransportConnected(n,e,t))))}finally{i()}}))}negotiate(e){return vl(this,void 0,void 0,(function*(){return new Promise(((t,n)=>vl(this,void 0,void 0,(function*(){const i=setTimeout((()=>{n("negotiation timed out")}),this.peerConnectionTimeout);e.signal.addEventListener("abort",(()=>{clearTimeout(i),n("negotiation aborted")})),this.publisher.once(zd,(()=>{e.signal.aborted||this.publisher.once(Ud,(()=>{clearTimeout(i),t()}))})),yield this.publisher.negotiate((e=>{clearTimeout(i),n(e)}))}))))}))}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===ss.PUBLISHER||e===ss.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return vl(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==e.getConnectionState())return new Promise(((e,o)=>vl(n,void 0,void 0,(function*(){const n=()=>{this.log.warn("abort transport connection",this.logContext),tu.clearTimeout(a),o(new Vc("room connection has been cancelled",Nc.Cancelled))};(null==t?void 0:t.signal.aborted)&&n(),null==t||t.signal.addEventListener("abort",n);const a=tu.setTimeout((()=>{null==t||t.signal.removeEventListener("abort",n),o(new Vc("could not establish pc connection",Nc.InternalError))}),i);for(;this.state!==Yd.CONNECTED;)if(yield vu(50),null==t?void 0:t.signal.aborted)return void o(new Vc("room connection has been cancelled",Nc.Cancelled));tu.clearTimeout(a),null==t||t.signal.removeEventListener("abort",n),e()}))))}()}))}}class Xd extends Error{constructor(e,t,n){super(t),this.code=e,this.message=tp(t,Xd.MAX_MESSAGE_BYTES),this.data=n?tp(n,Xd.MAX_DATA_BYTES):void 0}static fromProto(e){return new Xd(e.code,e.message,e.data)}toProto(){return new Hr({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Xd(Xd.ErrorCode[e],Xd.ErrorMessage[e],t)}}function ep(e){return(new TextEncoder).encode(e).length}function tp(e,t){if(ep(e)<=t)return e;let n=0,i=e.length;const o=new TextEncoder;for(;n<i;){const a=Math.floor((n+i+1)/2);o.encode(e.slice(0,a)).length<=t?n=a:i=a-1}return e.slice(0,n)}Xd.MAX_MESSAGE_BYTES=256,Xd.MAX_DATA_BYTES=15360,Xd.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},Xd.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const np=2e3;function ip(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}const op="undefined"!=typeof MediaRecorder,ap=op?MediaRecorder:class{constructor(){throw new Error("MediaRecorder is not available in this environment")}};class rp extends ap{constructor(e,t){if(!op)throw new Error("MediaRecorder is not available in this environment");let n,i;super(new MediaStream([e.mediaStreamTrack]),t);const o=()=>{this.removeEventListener("dataavailable",n),this.removeEventListener("stop",o),this.removeEventListener("error",a),null==i||i.close(),i=void 0},a=e=>{null==i||i.error(e),this.removeEventListener("dataavailable",n),this.removeEventListener("stop",o),this.removeEventListener("error",a),i=void 0};this.byteStream=new ReadableStream({start:e=>{i=e,n=t=>vl(this,void 0,void 0,(function*(){const n=yield t.data.arrayBuffer();void 0!==i&&e.enqueue(new Uint8Array(n))})),this.addEventListener("dataavailable",n)},cancel:()=>{o()}}),this.addEventListener("stop",o),this.addEventListener("error",a)}}class sp extends ou{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch((()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext))),this.debouncedTrackMuteHandler=Fd((()=>vl(this,void 0,void 0,(function*(){yield this.pauseUpstream()}))),5e3),this.handleTrackUnmuteEvent=()=>vl(this,void 0,void 0,(function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()})),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(Fc.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Ro,this.pauseUpstreamLock=new Ro,this.processorLock=new Ro,this.restartLock=new Ro,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==ou.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return vl(this,void 0,void 0,(function*(){var n;if(e===this._mediaStreamTrack&&!t)return;let i;if(this._mediaStreamTrack&&(this.attachedElements.forEach((e=>{ru(this._mediaStreamTrack,e)})),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e){const t=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(au(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}finally{t()}}this.sender&&"closed"!==(null===(n=this.sender.transport)||void 0===n?void 0:n.state)&&(yield this.sender.replaceTrack(null!=i?i:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach((t=>{au(null!=i?i:e,t)})))}))}waitForDimensions(){return vl(this,arguments,void 0,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var n;if(e.kind===ou.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(n=Yc())||void 0===n?void 0:n.os)&&(yield vu(10));const i=Date.now();for(;Date.now()-i<t;){const t=e.dimensions;if(t)return t;yield vu(50)}throw new qc("unable to get track dimensions after timeout")}()}))}setDeviceId(e){return vl(this,void 0,void 0,(function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===qu(e)||(this._constraints.deviceId=e,!!this.isMuted||(yield this.restartTrack(),qu(e)===this._mediaStreamTrack.getSettings().deviceId))}))}getDeviceId(){return vl(this,arguments,void 0,(function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){if(e.source===ou.Source.ScreenShare)return;const{deviceId:n,groupId:i}=e._mediaStreamTrack.getSettings(),o=e.kind===ou.Kind.Audio?"audioinput":"videoinput";return t?md.getInstance().normalizeDeviceId(o,n,i):n}()}))}mute(){return vl(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return vl(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}replaceTrack(e,t){return vl(this,void 0,void 0,(function*(){if(!this.sender)throw new qc("unable to replace an unpublished track");let n,i;return"boolean"==typeof t?n=t:void 0!==t&&(n=t.userProvidedTrack,i=t.stopProcessor),this.providedByUser=null==n||n,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.stopProcessor()),this}))}restart(e){return vl(this,void 0,void 0,(function*(){this.manuallyStopped=!1;const t=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:t,facingMode:n}=e,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const o={audio:!1,video:!1};this.kind===ou.Kind.Video?o.video=!t&&!n||{deviceId:t,facingMode:n}:o.audio=!t||{deviceId:t},this.attachedElements.forEach((e=>{ru(this.mediaStreamTrack,e)})),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const a=(yield navigator.mediaDevices.getUserMedia(o)).getTracks()[0];return yield a.applyConstraints(i),a.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(a),this._constraints=e,this.emit(Fc.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}}))}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Fc.Muted:Fc.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return vl(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Pu()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))}))}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return vl(this,void 0,void 0,(function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(Fc.UpstreamPaused,this);const t=Yc();if("Safari"===(null==t?void 0:t.name)&&Nu(t.version,"12.0")<0)throw new Bc("pauseUpstream is not supported on Safari < 12.");"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(null))}finally{t()}}))}resumeUpstream(){return vl(this,void 0,void 0,(function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(Fc.UpstreamResumed,this),"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}}))}getRTCStatsReport(){return vl(this,void 0,void 0,(function*(){var e;if(null===(e=this.sender)||void 0===e?void 0:e.getStats)return yield this.sender.getStats()}))}setProcessor(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;const o=yield t.processorLock.lock();try{t.log.debug("setting up processor",t.logContext);const o=document.createElement(t.kind),a={kind:t.kind,track:t._mediaStreamTrack,element:o,audioContext:t.audioContext};if(yield e.init(a),t.log.debug("processor initialized",t.logContext),t.processor&&(yield t.stopProcessor()),"unknown"===t.kind)throw TypeError("cannot set processor on track of unknown kind");if(au(t._mediaStreamTrack,o),o.muted=!0,o.play().catch((e=>t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{error:e})))),t.processor=e,t.processorElement=o,t.processor.processedTrack){for(const e of t.attachedElements)e!==t.processorElement&&n&&(ru(t._mediaStreamTrack,e),au(t.processor.processedTrack,e));yield null===(i=t.sender)||void 0===i?void 0:i.replaceTrack(t.processor.processedTrack)}t.emit(Fc.TrackProcessorUpdate,t.processor)}finally{o()}}()}))}getProcessor(){return this.processor}stopProcessor(){return vl(this,arguments,void 0,(function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i;e.processor&&(e.log.debug("stopping processor",e.logContext),null===(n=e.processor.processedTrack)||void 0===n||n.stop(),yield e.processor.destroy(),e.processor=void 0,t||(null===(i=e.processorElement)||void 0===i||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(Fc.TrackProcessorUpdate))}()}))}startPreConnectBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;op?this.localTrackRecorder?this.log.warn("preconnect buffer already started"):(this.localTrackRecorder=new rp(this,{mimeType:"audio/webm;codecs=opus"}),this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout((()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()}),1e4)):this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.byteStream}}class lp extends sp{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,ou.Kind.Audio,t,n,o),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>vl(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:e}))}e&&this.prevStats&&(this._currentBitrate=ip(e,this.prevStats)),this.prevStats=e})),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(Fc.AudioTrackFeatureUpdate,this,Sr.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(Fc.AudioTrackFeatureUpdate,this,Sr.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return vl(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===ou.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return vl(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==qu(this._constraints.deviceId);return this.source!==ou.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}}))}restartTrack(e){return vl(this,void 0,void 0,(function*(){let t;if(e){const n=od({audio:e});"boolean"!=typeof n.audio&&(t=n.audio)}yield this.restart(t)}))}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return vl(this,void 0,void 0,(function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n}))}startMonitor(){xu()&&(this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),np)))}setProcessor(e){return vl(this,void 0,void 0,(function*(){var t;const n=yield this.processorLock.lock();try{if(!Iu()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(Fc.TrackProcessorUpdate,this.processor)}finally{n()}}))}setAudioContext(e){this.audioContext=e}getSenderStats(){return vl(this,void 0,void 0,(function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach((e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})})),t}))}checkForSilence(){return vl(this,void 0,void 0,(function*(){const e=yield function(e){return vl(this,arguments,void 0,(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){const n=ad();if(n){const i=n.createAnalyser();i.fftSize=2048;const o=i.frequencyBinCount,a=new Uint8Array(o);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield vu(t),i.getByteTimeDomainData(a);const r=a.some((e=>128!==e&&0!==e));return n.close(),!r}return!1}()}))}(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(Fc.AudioSilenceDetected)),e}))}}const cp=Object.values(hu),up=Object.values(gu),dp=Object.values(mu),pp=[hu.h180,hu.h360],hp=[gu.h180,gu.h360],gp=["q","h","f"];function mp(e,t,n,i){var o,a;let r=null==i?void 0:i.videoEncoding;e&&(r=null==i?void 0:i.screenShareEncoding);const s=null==i?void 0:i.simulcast,l=null==i?void 0:i.scalabilityMode,c=null==i?void 0:i.videoCodec;if(!r&&!s&&!l||!t||!n)return[{}];r||(r=function(e,t,n,i){const o=function(e,t,n){if(e)return dp;const i=t>n?t/n:n/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?cp:up}(e,t,n);let{encoding:a}=o[0];const r=Math.max(t,n);for(let e=0;e<o.length;e+=1){const t=o[e];if(a=t.encoding,t.width>=r)break}if(i)switch(i){case"av1":case"h265":a=Object.assign({},a),a.maxBitrate=.7*a.maxBitrate;break;case"vp9":a=Object.assign({},a),a.maxBitrate=.85*a.maxBitrate}return a}(e,t,n,c),dl.debug("using video encoding",r));const u=r.maxFramerate,d=new su(t,n,r.maxBitrate,r.maxFramerate,r.priority);if(l&&ku(c)){const e=new bp(l),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));const n=Yc();if(Cu()||Iu()||"Chrome"===(null==n?void 0:n.name)&&Nu(null==n?void 0:n.version,"113")<0){const i="h"==e.suffix?2:3,o=function(e){return e||(e=Yc()),"Safari"===(null==e?void 0:e.name)&&Nu(e.version,"18.3")>0||"iOS"===(null==e?void 0:e.os)&&!!(null==e?void 0:e.osVersion)&&Nu(e.osVersion,"18.3")>0}(n);for(let n=0;n<e.spatial;n+=1)t.push({rid:gp[2-n],maxBitrate:r.maxBitrate/Math.pow(i,n),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:o?Math.pow(2,n):void 0});t[0].scalabilityMode=l}else t.push({maxBitrate:r.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:l});return d.encoding.priority&&(t[0].priority=d.encoding.priority,t[0].networkPriority=d.encoding.priority),dl.debug("using svc encoding",{encodings:t}),t}if(!s)return[r];let p,h=[];if(h=e?null!==(o=yp(null==i?void 0:i.screenShareSimulcastLayers))&&void 0!==o?o:fp(e,d):null!==(a=yp(null==i?void 0:i.videoSimulcastLayers))&&void 0!==a?a:fp(e,d),h.length>0){const e=h[0];h.length>1&&([,p]=h);const i=Math.max(t,n);if(i>=960&&p)return vp(t,n,[e,p,d],u);if(i>=480)return vp(t,n,[e,d],u)}return vp(t,n,[d])}function fp(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map((e=>{var t,i;return new su(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)}));var n;const{width:i,height:o}=t,a=i>o?i/o:o/i;return Math.abs(a-16/9)<Math.abs(a-4/3)?pp:hp}function vp(e,t,n,i){const o=[];if(n.forEach(((n,a)=>{if(a>=gp.length)return;const r=Math.min(e,t),s={rid:gp[a],scaleResolutionDownBy:Math.max(1,r/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate},l=i&&n.encoding.maxFramerate?Math.min(i,n.encoding.maxFramerate):n.encoding.maxFramerate;l&&(s.maxFramerate=l);const c=wu()||0===a;n.encoding.priority&&c&&(s.priority=n.encoding.priority,s.networkPriority=n.encoding.priority),o.push(s)})),Iu()&&"ios"===Ou()){let e;o.forEach((t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate}));let t=!0;o.forEach((n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,dl.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),dl.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)}))}return o}function yp(e){if(e)return e.sort(((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0}))}class bp{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class kp extends sp{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,ou.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>vl(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:e}))}const t=new Map(e.map((e=>[e.rid,e]))),n=e.some((e=>"cpu"===e.qualityLimitationReason));if(n!==this.isCpuConstrained&&(this.isCpuConstrained=n,this.isCpuConstrained&&this.emit(Fc.CpuConstrained)),this.prevStats){let e=0;t.forEach(((t,n)=>{var i;const o=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=ip(t,o)})),this._currentBitrate=e}this.prevStats=t})),this.senderLock=new Ro}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!xu())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval((()=>{this.monitorSender()}),np))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach((e=>{e.mediaStreamTrack.stop()})),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return vl(this,void 0,void 0,(function*(){var t,n,i,o,a;yield e.pauseUpstream.call(this);try{for(var r,s=!0,l=yl(this.simulcastCodecs.values());!(t=(r=yield l.next()).done);s=!0){o=r.value,s=!1;const e=o;yield null===(a=e.sender)||void 0===a?void 0:a.replaceTrack(null)}}catch(e){n={error:e}}finally{try{s||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}}))}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return vl(this,void 0,void 0,(function*(){var t,n,i,o,a;yield e.resumeUpstream.call(this);try{for(var r,s=!0,l=yl(this.simulcastCodecs.values());!(t=(r=yield l.next()).done);s=!0){o=r.value,s=!1;const e=o;yield null===(a=e.sender)||void 0===a?void 0:a.replaceTrack(e.mediaStreamTrack)}}catch(e){n={error:e}}finally{try{s||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return vl(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source!==ou.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return vl(this,void 0,void 0,(function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source!==ou.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}}))}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return vl(this,void 0,void 0,(function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach((e=>{var i;if("outbound-rtp"===e.type){const o={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,framesPerSecond:e.framesPerSecond,framesSent:e.framesSent,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationDurations:e.qualityLimitationDurations,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,targetBitrate:e.targetBitrate,timestamp:e.timestamp},a=n.get(e.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),t.push(o)}})),t.sort(((e,t)=>{var n,i;return(null!==(n=t.frameWidth)&&void 0!==n?n:0)-(null!==(i=e.frameWidth)&&void 0!==i?i:0)})),t}))}setPublishingQuality(e){const t=[];for(let n=iu.LOW;n<=iu.HIGH;n+=1)t.push(new Ls({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(ku(this.codec),t)}restartTrack(e){return vl(this,void 0,void 0,(function*(){var t,n,i,o,a;let r;if(e){const t=od({video:e});"boolean"!=typeof t.video&&(r=t.video)}yield this.restart(r),this.isCpuConstrained=!1;try{for(var s,l=!0,c=yl(this.simulcastCodecs.values());!(t=(s=yield c.next()).done);l=!0){o=s.value,l=!1;const e=o;e.sender&&"closed"!==(null===(a=e.sender.transport)||void 0===a?void 0:a.state)&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(e){n={error:e}}finally{try{l||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}}))}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return vl(this,arguments,void 0,(function(e){var n=this;let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var o,a,r,s,l,c;if(yield t.setProcessor.call(n,e,i),null===(l=n.processor)||void 0===l?void 0:l.processedTrack)try{for(var u,d=!0,p=yl(n.simulcastCodecs.values());!(o=(u=yield p.next()).done);d=!0){s=u.value,d=!1;const e=s;yield null===(c=e.sender)||void 0===c?void 0:c.replaceTrack(n.processor.processedTrack)}}catch(e){a={error:e}}finally{try{d||o||!(r=p.return)||(yield r.call(p))}finally{if(a)throw a.error}}}()}))}setDegradationPreference(e){return vl(this,void 0,void 0,(function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(e){this.log.warn("failed to set degradationPreference",Object.assign({error:e},this.logContext))}}))}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))return void this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout((()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)}),5e3))}setPublishingCodecs(e){return vl(this,void 0,void 0,(function*(){var t,n,i,o,a,r,s;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(ku(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(t=!0,n=yl(e);!(o=(i=yield n.next()).done);t=!0){s=i.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield Sp(t.sender,t.encodings,e.qualities,this.senderLock,ku(e.codec),this.log,this.logContext));else for(const t of e.qualities)if(t.enabled){l.push(e.codec);break}}else yield this.setPublishingLayers(ku(e.codec),e.qualities)}}catch(e){a={error:e}}finally{try{t||o||!(r=n.return)||(yield r.call(n))}finally{if(a)throw a.error}}return l}))}setPublishingLayers(e,t){return vl(this,void 0,void 0,(function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),this.sender&&this.encodings&&(yield Sp(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext)))}))}prioritizePerformance(){return vl(this,void 0,void 0,(function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const e=this.sender.getParameters();e.encodings=e.encodings.map(((e,t)=>{var n;return Object.assign(Object.assign({},e),{active:0===t,scaleResolutionDownBy:Math.max(1,Math.ceil((null!==(n=this.mediaStreamTrack.getSettings().height)&&void 0!==n?n:360)/360)),scalabilityMode:0===t&&ku(this.codec)?"L1T3":void 0,maxFramerate:0===t?15:0,maxBitrate:0===t?e.maxBitrate:0})})),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:e.encodings})),this.encodings=e.encodings,yield this.sender.setParameters(e)}catch(e){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:e})),this.optimizeForPerformance=!1}finally{e()}}))}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return vl(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),Pu()&&this.isInBackground&&this.source===ou.Source.Camera&&(this._mediaStreamTrack.enabled=!1)}))}}function Sp(e,t,n,i,o,a,r){return vl(this,void 0,void 0,(function*(){const s=yield i.lock();a.debug("setPublishingLayersForSender",Object.assign(Object.assign({},r),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:s}=i;if(!s)return;if(s.length!==t.length)return void a.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},r),{encodings:s,senderEncodings:t}));let l=!1;o&&n.some((e=>e.enabled))&&n.forEach((e=>e.enabled=!0)),s.forEach(((e,i)=>{var o;let s=null!==(o=e.rid)&&void 0!==o?o:"";""===s&&(s="q");const c=wp(s),u=n.find((e=>e.quality===c));u&&e.active!==u.enabled&&(l=!0,e.active=u.enabled,a.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),r),wu()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})),l&&(i.encodings=s,a.debug("setting encodings",Object.assign(Object.assign({},r),{encodings:i.encodings})),yield e.setParameters(i))}finally{s()}}))}function wp(e){switch(e){case"f":default:return iu.HIGH;case"h":return iu.MEDIUM;case"q":return iu.LOW}}function Tp(e,t,n,i){if(!n)return[new Nr({quality:iu.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,o=new bp(i),a=[],r="h"==o.suffix?1.5:2,s="h"==o.suffix?2:3;for(let i=0;i<o.spatial;i+=1)a.push(new Nr({quality:Math.min(iu.HIGH,o.spatial-1)-i,width:Math.ceil(e/Math.pow(r,i)),height:Math.ceil(t/Math.pow(r,i)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(s,i)):0,ssrc:0}));return a}return n.map((n=>{var i,o,a;const r=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let s=wp(null!==(o=n.rid)&&void 0!==o?o:"");return new Nr({quality:s,width:Math.ceil(e/r),height:Math.ceil(t/r),bitrate:null!==(a=n.maxBitrate)&&void 0!==a?a:0,ssrc:0})}))}const Cp="_lossy",Pp="_reliable",xp="leave-reconnect";var Ip,Ap,Ep,Op;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Ip||(Ip={}));class _p extends Sl.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Qd.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Ip.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=dl,this.reliableDataSequence=1,this.reliableMessageBuffer=new Cd,this.reliableReceivedState=new Pd(3e4),this.handleDataChannel=e=>vl(this,[e],void 0,(function(e){var t=this;let{channel:n}=e;return function*(){if(n){if(n.label===Pp)t.reliableDCSub=n;else{if(n.label!==Cp)return;t.lossyDCSub=n}t.log.debug("on data channel ".concat(n.id,", ").concat(n.label),t.logContext),n.onmessage=t.handleDataMessage}}()})),this.handleDataMessage=e=>vl(this,void 0,void 0,(function*(){var t,n;const i=yield this.dataProcessLock.lock();try{let i;if(e.data instanceof ArrayBuffer)i=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));i=yield e.data.arrayBuffer()}const o=Mr.fromBinary(new Uint8Array(i));if(o.sequence>0&&""!==o.participantSid){const e=this.reliableReceivedState.get(o.participantSid);if(e&&o.sequence<=e)return;this.reliableReceivedState.set(o.participantSid,o.sequence)}"speaker"===(null===(t=o.value)||void 0===t?void 0:t.case)?this.emit(Lc.ActiveSpeakersUpdate,o.value.value.speakers):("user"===(null===(n=o.value)||void 0===n?void 0:n.case)&&function(e,t){const n=e.participantIdentity?e.participantIdentity:t.participantIdentity;e.participantIdentity=n,t.participantIdentity=n;const i=0!==e.destinationIdentities.length?e.destinationIdentities:t.destinationIdentities;e.destinationIdentities=i,t.destinationIdentities=i}(o,o.value.value),this.emit(Lc.DataPacketReceived,o))}finally{i()}})),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?Rr.LOSSY:Rr.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=Date.now()-this.reconnectStart;let i=this.getNextRetryDelay({elapsedMs:n,retryCount:this.reconnectAttempts});null!==i?(e===xp&&(i=0),this.log.debug("reconnecting in ".concat(i,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=tu.setTimeout((()=>this.attemptReconnect(t).finally((()=>this.reconnectTimeout=void 0))),i)):(e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(Lc.Disconnected),this.close()})(n)},this.waitForRestarted=()=>new Promise(((e,t)=>{this.pcState===Ip.Connected&&e();const n=()=>{this.off(Lc.Disconnected,i),e()},i=()=>{this.off(Lc.Restarted,n),t()};this.once(Lc.Restarted,n),this.once(Lc.Disconnected,i)})),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);void 0!==t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(Lc.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return e===Rr.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(t.bufferedAmount),t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===kd.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(br.RR_SIGNAL_DISCONNECTED))},this.log=hl(null!==(t=e.loggerName)&&void 0!==t?t:rl.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Sd(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Ro,this.dataProcessLock=new Ro,this.dcBufferStatus=new Map([[Rr.LOSSY,!0],[Rr.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(Lc.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(Lc.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(Lc.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(Lc.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(Lc.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(Lc.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(Lc.StreamStateChanged,e),this.client.onRequestResponse=e=>this.emit(Lc.SignalRequestResponse,e)}get logContext(){var e,t,n,i,o,a;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomID:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,participant:null===(a=null===(o=this.latestJoinResponse)||void 0===o?void 0:o.participant)||void 0===a?void 0:a.identity,pID:this.participantSid}}join(e,t,n,i){return vl(this,void 0,void 0,(function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,t,n,i);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),this.subscriberPrimary&&!o.fastPublish||this.negotiate(),this.clientConfiguration=o.clientConfiguration,this.emit(Lc.SignalConnected,o),o}catch(o){if(o instanceof Vc&&o.reason===Nc.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,i);throw o}}))}close(){return vl(this,void 0,void 0,(function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.joinAttempts=0,this.emit(Lc.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}}))}cleanupPeerConnections(){return vl(this,void 0,void 0,(function*(){var e;yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Cd,this.reliableDataSequence=1,this.reliableReceivedState.clear()}))}cleanupClient(){return vl(this,void 0,void 0,(function*(){yield this.client.close(),this.client.resetCallbacks()}))}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new qc("a track with the same ID has already been published");return new Promise(((t,n)=>{const i=setTimeout((()=>{delete this.pendingTrackResolvers[e.cid],n(new Vc("publication of local track timed out, no response from server",Nc.Timeout))}),1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)}))}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(e){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:e}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return vl(this,void 0,void 0,(function*(){var e;return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()}))}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return vl(this,void 0,void 0,(function*(){var t,n;if(this.pcManager&&this.pcManager.currentState!==Yd.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const i=this.makeRTCConfiguration(e);var o;this.pcManager=new Zd(i,e.subscriberPrimary,this.loggerOptions),this.emit(Lc.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=(e,t)=>{this.client.sendOffer(e,t)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>vl(this,void 0,void 0,(function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),["closed","disconnected","failed"].includes(n)&&(this.publisherConnectionPromise=void 0),t===Yd.CONNECTED){const t=this.pcState===Ip.New;this.pcState=Ip.Connected,t&&this.emit(Lc.Connected,e)}else t===Yd.FAILED&&this.pcState===Ip.Connected&&(this.pcState=Ip.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?br.RR_SUBSCRIBER_FAILED:br.RR_PUBLISHER_FAILED));const o=this.client.isDisconnected||this.client.currentState===kd.RECONNECTING,a=[Yd.FAILED,Yd.CLOSING,Yd.CLOSED].includes(t);o&&a&&!this._isClosed&&this.emit(Lc.Offline)})),this.pcManager.onTrack=e=>{this.emit(Lc.MediaTrackAdded,e.track,e.streams[0],e.receiver)},void 0!==(o=null===(n=e.serverInfo)||void 0===n?void 0:n.protocol)&&o>13||this.createDataChannels()}))}setupSignalClientCallbacks(){this.client.onAnswer=(e,t)=>vl(this,void 0,void 0,(function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,t))})),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t)=>vl(this,void 0,void 0,(function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);n&&this.client.sendAnswer(n,t)})),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Lc.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Lc.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Lc.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Lc.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Lc.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",br.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null==e?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Is.DISCONNECT:this.emit(Lc.Disconnected,null==e?void 0:e.reason),this.close();break;case Is.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(xp);break;case Is.RESUME:this.handleDisconnect(xp)}}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach((e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)})),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===vr.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Cp,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Pp,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,n){return vl(this,void 0,void 0,(function*(){if(yu())return yield this.createTransceiverRTCRtpSender(e,t,n);if(bu())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Hc("Required webRTC APIs not supported on this device")}))}createSimulcastSender(e,t,n,i){return vl(this,void 0,void 0,(function*(){if(yu())return this.createSimulcastTransceiverSender(e,t,n,i);if(bu())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Hc("Cannot stream on this device")}))}createTransceiverRTCRtpSender(e,t,n){return vl(this,void 0,void 0,(function*(){if(!this.pcManager)throw new Hc("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),Qu(e)&&(e.codec=t.videoCodec);const o={direction:"sendonly",streams:i};return n&&(o.sendEncodings=n),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o)).sender}))}createSimulcastTransceiverSender(e,t,n,i){return vl(this,void 0,void 0,(function*(){if(!this.pcManager)throw new Hc("publisher is closed");const o={direction:"sendonly"};i&&(o.sendEncodings=i);const a=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,o);if(n.videoCodec)return e.setSimulcastTrackSender(n.videoCodec,a.sender),a.sender}))}createRTCRtpSender(e){return vl(this,void 0,void 0,(function*(){if(!this.pcManager)throw new Hc("publisher is closed");return this.pcManager.addPublisherTrack(e)}))}attemptReconnect(e){return vl(this,void 0,void 0,(function*(){var t,n,i;if(!this._isClosed)if(this.attemptingReconnect)dl.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==vr.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:Yd.NEW)!==Yd.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(e){this.reconnectAttempts+=1;let t=!0;e instanceof Hc?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:e})),t=!1):e instanceof Np||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",br.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Lc.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}}))}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(e){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:e}))}return null}restartConnection(e){return vl(this,void 0,void 0,(function*(){var t,n,i;try{if(!this.url||!this.token)throw new Hc("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Lc.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Np;n=yield this.join(null!=e?e:this.url,this.token,this.signalOpts)}catch(e){if(e instanceof Vc&&e.reason===Nc.NotAllowed)throw new Hc("could not reconnect, token might be expired");throw new Np}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Lc.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==kd.CONNECTED)throw new Np("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(Lc.Restarted)}catch(e){const t=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(t)return void(yield this.restartConnection(t));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),e}}))}resumeConnection(e){return vl(this,void 0,void 0,(function*(){var t;if(!this.url||!this.token)throw new Hc("could not reconnect, url or token not saved");if(!this.pcManager)throw new Hc("publisher and subscriber connections unset");let n;this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Lc.Resuming);try{this.setupSignalClientCallbacks(),n=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(e){let t="";if(e instanceof Error&&(t=e.message,this.log.error(e.message,Object.assign(Object.assign({},this.logContext),{error:e}))),e instanceof Vc&&e.reason===Nc.NotAllowed)throw new Hc("could not reconnect, token might be expired");if(e instanceof Vc&&e.reason===Nc.LeaveRequest)throw e;throw new Np(t)}if(this.emit(Lc.SignalResumed),n){const e=this.makeRTCConfiguration(n);this.pcManager.updateConfiguration(e),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=n.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==kd.CONNECTED)throw new Np("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),(null==n?void 0:n.lastMessageSeq)&&this.resendReliableMessagesForResume(n.lastMessageSeq),this.emit(Lc.Resumed)}))}waitForPCInitialConnection(e,t){return vl(this,void 0,void 0,(function*(){if(!this.pcManager)throw new Hc("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)}))}waitForPCReconnected(){return vl(this,void 0,void 0,(function*(){this.pcState=Ip.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield vu(2e3),!this.pcManager)throw new Hc("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Ip.Connected}catch(e){throw this.pcState=Ip.Disconnected,new Vc("could not establish PC connection, ".concat(e.message),Nc.InternalError)}}))}publishRpcResponse(e,t,n,i){return vl(this,void 0,void 0,(function*(){const o=new Mr({destinationIdentities:[e],kind:Rr.RELIABLE,value:{case:"rpcResponse",value:new Kr({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:null!=n?n:""}})}});yield this.sendDataPacket(o,Rr.RELIABLE)}))}publishRpcAck(e,t){return vl(this,void 0,void 0,(function*(){const n=new Mr({destinationIdentities:[e],kind:Rr.RELIABLE,value:{case:"rpcAck",value:new qr({requestId:t})}});yield this.sendDataPacket(n,Rr.RELIABLE)}))}sendDataPacket(e,t){return vl(this,void 0,void 0,(function*(){yield this.ensurePublisherConnected(t),t===Rr.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const n=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===Rr.RELIABLE&&this.reliableMessageBuffer.push({data:n,sequence:e.sequence}),this.attemptingReconnect)return;i.send(n)}this.updateAndEmitDCBufferStatus(t)}))}resendReliableMessagesForResume(e){return vl(this,void 0,void 0,(function*(){yield this.ensurePublisherConnected(Rr.RELIABLE);const t=this.dataChannelForKind(Rr.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach((e=>{t.send(e.data)}))),this.updateAndEmitDCBufferStatus(Rr.RELIABLE)}))}waitForBufferStatusLow(e){return new Promise(((t,n)=>vl(this,void 0,void 0,(function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>n("Engine closed");for(this.once(Lc.Closing,i);!this.dcBufferStatus.get(e);)yield vu(10);this.off(Lc.Closing,i),t()}}))))}ensureDataTransportConnected(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var i;if(!t.pcManager)throw new Hc("PC manager is closed");const o=n?t.pcManager.subscriber:t.pcManager.publisher,a=n?"Subscriber":"Publisher";if(!o)throw new Vc("".concat(a," connection not set"),Nc.InternalError);let r=!1;n||t.dataChannelForKind(e,n)||(t.createDataChannels(),r=!0),r||n||t.pcManager.publisher.isICEConnected||"checking"===t.pcManager.publisher.getICEConnectionState()||(r=!0),r&&t.negotiate();const s=t.dataChannelForKind(e,n);if("open"===(null==s?void 0:s.readyState))return;const l=(new Date).getTime()+t.peerConnectionTimeout;for(;(new Date).getTime()<l;){if(o.isICEConnected&&"open"===(null===(i=t.dataChannelForKind(e,n))||void 0===i?void 0:i.readyState))return;yield vu(50)}throw new Vc("could not establish ".concat(a," connection, state: ").concat(o.getICEConnectionState()),Nc.InternalError)}()}))}ensurePublisherConnected(e){return vl(this,void 0,void 0,(function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise}))}verifyTransport(){return!!this.pcManager&&this.pcManager.currentState===Yd.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return vl(this,void 0,void 0,(function*(){return new Promise(((e,t)=>vl(this,void 0,void 0,(function*(){if(!this.pcManager)return void t(new Wc("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Lc.Closing,i),this.pcManager.publisher.once(Vd,(e=>{const t=new Map;e.forEach((e=>{const n=e.codec.toLowerCase();var i;i=n,cu.includes(i)&&t.set(e.payload,n)})),this.emit(Lc.RTPVideoMapUpdate,t)}));try{yield this.pcManager.negotiate(n),e()}catch(e){e instanceof Wc&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",br.RR_UNKNOWN),t(e)}finally{this.off(Lc.Closing,i)}}))))}))}dataChannelForKind(e,t){if(t){if(e===Rr.LOSSY)return this.lossyDCSub;if(e===Rr.RELIABLE)return this.reliableDCSub}else{if(e===Rr.LOSSY)return this.lossyDC;if(e===Rr.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const o=this.pcManager.subscriber.getLocalDescription(),a=this.pcManager.subscriber.getRemoteDescription(),r=null===(i=null===(n=this.signalOpts)||void 0===n?void 0:n.autoSubscribe)||void 0===i||i,s=new Array,l=new Array;e.forEach((e=>{e.isDesired!==r&&s.push(e.trackSid),e.isEnabled||l.push(e.trackSid)})),this.client.sendSyncState(new Ks({answer:o?Td({sdp:o.sdp,type:o.type}):void 0,offer:a?Td({sdp:a.sdp,type:a.type}):void 0,subscription:new ws({trackSids:s,subscribe:!r,participantTracks:[]}),publishTracks:cd(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:l,datachannelReceiveStates:this.reliableReceivedState.map(((e,t)=>new Hs({publisherSid:t,lastSeq:e})))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null==t?void 0:t.id)&&null!==t.id&&e.push(new Ws({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(Rr.LOSSY),ss.PUBLISHER),t(this.dataChannelForKind(Rr.RELIABLE),ss.PUBLISHER),t(this.dataChannelForKind(Rr.LOSSY,!0),ss.SUBSCRIBER),t(this.dataChannelForKind(Rr.RELIABLE,!0),ss.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&tu.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){xu()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){xu()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Np extends Error{}class Mp{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Au(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return vl(this,void 0,void 0,(function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter((e=>!this.attemptedRegions.find((t=>t.url===e.url))));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),dl.debug("next region: ".concat(e.region)),e.url}return null}))}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return vl(this,void 0,void 0,(function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new Vc("Could not fetch region settings: ".concat(t.statusText),401===t.status?Nc.NotAllowed:Nc.InternalError,t.status)}))}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}class Rp{get info(){return this._info}constructor(e,t,n){this.reader=t,this.totalByteSize=n,this._info=e,this.bytesReceived=0}}class jp extends Rp{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength;const n=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,n)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>vl(this,void 0,void 0,(function*(){try{const{done:t,value:n}=yield e.read();return t?{done:!0,value:void 0}:(this.handleChunkReceived(n),{done:!1,value:n.content})}catch(e){return{done:!0,value:void 0}}})),return(){return vl(this,void 0,void 0,(function*(){return e.releaseLock(),{done:!0,value:void 0}}))}}}readAll(){return vl(this,void 0,void 0,(function*(){var e,t,n,i;let o=new Set;try{for(var a,r=!0,s=yl(this);!(e=(a=yield s.next()).done);r=!0){i=a.value,r=!1;const e=i;o.add(e)}}catch(e){t={error:e}}finally{try{r||e||!(n=s.return)||(yield n.call(s))}finally{if(t)throw t.error}}return Array.from(o)}))}}class Dp extends Rp{constructor(e,t,n){super(e,t,n),this.receivedChunks=new Map}handleChunkReceived(e){var t;const n=Wu(e.chunkIndex),i=this.receivedChunks.get(n);if(i&&i.version>e.version)return;this.receivedChunks.set(n,e),this.bytesReceived+=e.content.byteLength;const o=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,o)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder;return{next:()=>vl(this,void 0,void 0,(function*(){try{const{done:n,value:i}=yield e.read();return n?{done:!0,value:void 0}:(this.handleChunkReceived(i),{done:!1,value:t.decode(i.content)})}catch(e){return{done:!0,value:void 0}}})),return(){return vl(this,void 0,void 0,(function*(){return e.releaseLock(),{done:!0,value:void 0}}))}}}readAll(){return vl(this,void 0,void 0,(function*(){var e,t,n,i;let o="";try{for(var a,r=!0,s=yl(this);!(e=(a=yield s.next()).done);r=!0)i=a.value,r=!1,o+=i}catch(e){t={error:e}}finally{try{r||e||!(n=s.return)||(yield n.call(s))}finally{if(t)throw t.error}}return o}))}}class Lp{constructor(e,t,n){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=n,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return vl(this,void 0,void 0,(function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null===(e=this.onClose)||void 0===e||e.call(this)}))}}class Fp extends Lp{}class zp extends Lp{}class Up extends ou{constructor(e,t,n,i,o){super(e,n,o),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Fc.Muted:Fc.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(Fc.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return vl(this,void 0,void 0,(function*(){var e;if(null===(e=this.receiver)||void 0===e?void 0:e.getStats)return yield this.receiver.getStats()}))}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval((()=>this.monitorReceiver()),np)),"undefined"!=typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame((()=>e()));const n=null===(t=this.receiver)||void 0===t?void 0:t.getSynchronizationSources()[0];if(n){const{timestamp:e,rtpTimestamp:t}=n;t&&this.rtpTimestamp!==t&&(this.emit(Fc.TimeSyncUpdate,{timestamp:e,rtpTimestamp:t}),this.rtpTimestamp=t)}};e()}}class Vp extends Up{constructor(e,t,n,i,o,a){super(e,t,ou.Kind.Audio,n,a),this.monitorReceiver=()=>vl(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=ip(e,this.prevStats)),this.prevStats=e})),this.audioContext=i,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;Iu()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Iu())return 1;let e=0;return this.attachedElements.forEach((t=>{t.volume>e&&(e=t.volume)})),e}setSinkId(e){return vl(this,void 0,void 0,(function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map((t=>{if(Su(t))return t.setSinkId(e)})))}))}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&Su(e)&&e.setSinkId(this.sinkId).catch((e=>{this.log.error("Failed to set sink id on remote audio track",e,this.logContext)})),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach((e=>{n.connect(e),n=e})),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then((()=>{"running"!==e.state&&this.emit(Fc.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))})).catch((e=>{this.emit(Fc.AudioPlaybackFailed,e)}))}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return vl(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}class Bp extends Up{constructor(e,t,n,i,o){super(e,t,ou.Kind.Video,n,o),this.elementInfos=[],this.monitorReceiver=()=>vl(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=ip(e,this.prevStats)),this.prevStats=e})),this.debouncedHandleResize=Fd((()=>{this.updateDimensions()}),100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?ru(this._mediaStreamTrack,t):au(this._mediaStreamTrack,t)}))}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t.element===e))){const t=new qp(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find((t=>t===e))?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter((t=>t===e));for(const e of t)e.stopObserving();this.elementInfos=this.elementInfos.filter((t=>t!==e)),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const e of t)this.stopObservingElement(e);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return vl(this,void 0,void 0,(function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach((e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",streamId:e.id,framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)})),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t}))}stopObservingElement(e){const t=this.elementInfos.filter((t=>t.element===e));for(const e of t)this.stopObservingElementInfo(e)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return vl(this,void 0,void 0,(function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()}))}updateVisibility(){var e,t;const n=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),i=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,o=this.elementInfos.some((e=>e.pictureInPicture)),a=this.elementInfos.some((e=>e.visible))&&!i||o;this.lastVisible!==a&&(!a&&Date.now()-n<100?tu.setTimeout((()=>{this.updateVisibility()}),100):(this.lastVisible=a,this.emit(Fc.VisibilityChanged,a,this)))}updateDimensions(){var e,t;let n=0,i=0;const o=this.getPixelDensity();for(const e of this.elementInfos){const t=e.width()*o,a=e.height()*o;t+a>n+i&&(n=t,i=a)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(Fc.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;return"screen"===t?_u():t||(_u()>2?2:1)}}class qp{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.isPiP=Kp(this.element),this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e,t,n;null===(t=null===(e=window.documentPictureInPicture)||void 0===e?void 0:e.window)||void 0===t||t.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Kp(this.element),null===(n=this.handleVisibilityChanged)||void 0===n||n.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=Kp(this.element),null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!=t?t:Hp(e),this.isPiP=xu()&&Kp(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,n;this.isIntersecting=Hp(this.element),this.isPiP=Kp(this.element),this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Fu().observe(this.element),Du().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null===(e=window.documentPictureInPicture)||void 0===e||e.addEventListener("enter",this.onEnterPiP),null===(n=null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)||void 0===n||n.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,n,i,o;null===(e=Fu())||void 0===e||e.unobserve(this.element),null===(t=Du())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null===(n=window.documentPictureInPicture)||void 0===n||n.removeEventListener("enter",this.onEnterPiP),null===(o=null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)||void 0===o||o.removeEventListener("pagehide",this.onLeavePiP)}}function Kp(e){var t,n;return document.pictureInPictureElement===e||!!(null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)&&Hp(e,null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.window)}function Hp(e,t){const n=t||window;let i=e.offsetTop,o=e.offsetLeft;const a=e.offsetWidth,r=e.offsetHeight,{hidden:s}=e,{display:l}=getComputedStyle(e);for(;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,o+=e.offsetLeft;return i<n.pageYOffset+n.innerHeight&&o<n.pageXOffset+n.innerWidth&&i+r>n.pageYOffset&&o+a>n.pageXOffset&&!s&&"none"!==l}class Wp extends Sl.EventEmitter{constructor(e,t,n,i){var o;super(),this.metadataMuted=!1,this.encryption=Er.NONE,this.log=dl,this.handleMuted=()=>{this.emit(Fc.Muted)},this.handleUnmuted=()=>{this.emit(Fc.Unmuted)},this.log=hl(null!==(o=null==i?void 0:i.loggerName)&&void 0!==o?o:rl.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=ou.Source.Unknown}setTrack(e){this.track&&(this.track.off(Fc.Muted,this.handleMuted),this.track.off(Fc.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(Fc.Muted,this.handleMuted),e.on(Fc.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),ud(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==Er.NONE}get audioTrack(){if(Ju(this.track))return this.track}get videoTrack(){if(Qu(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=ou.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===ou.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Wp||(Wp={}));class Gp extends Wp{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(Fc.Ended)},this.handleCpuConstrained=()=>{this.track&&Qu(this.track)&&this.emit(Fc.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&(this.track.off(Fc.Ended,this.handleTrackEnded),this.track.off(Fc.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(Fc.Ended,this.handleTrackEnded),e.on(Fc.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return vl(this,void 0,void 0,(function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){return vl(this,void 0,void 0,(function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}pauseUpstream(){return vl(this,void 0,void 0,(function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()}))}resumeUpstream(){return vl(this,void 0,void 0,(function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()}))}getTrackFeatures(){var e;if(Ju(this.track)){const t=this.track.getSourceTrackSettings(),n=new Set;return t.autoGainControl&&n.add(Sr.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&n.add(Sr.TF_ECHO_CANCELLATION),t.noiseSuppression&&n.add(Sr.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&n.add(Sr.TF_STEREO),(null===(e=this.options)||void 0===e?void 0:e.dtx)||n.add(Sr.TF_NO_DTX),this.track.enhancedNoiseCancellation&&n.add(Sr.TF_ENHANCED_NOISE_CANCELLATION),Array.from(n.values())}return[]}}function $p(e,t){return vl(this,void 0,void 0,(function*(){null!=e||(e={});let n=!1;const{audioProcessor:i,videoProcessor:o,optionsWithoutProcessor:a}=dd(e);let r=a.audio,s=a.video;if(i&&"object"==typeof a.audio&&(a.audio.processor=i),o&&"object"==typeof a.video&&(a.video.processor=o),e.audio&&"object"==typeof a.audio&&"string"==typeof a.audio.deviceId){const e=a.audio.deviceId;a.audio.deviceId={exact:e},n=!0,r=Object.assign(Object.assign({},a.audio),{deviceId:{ideal:e}})}if(a.video&&"object"==typeof a.video&&"string"==typeof a.video.deviceId){const e=a.video.deviceId;a.video.deviceId={exact:e},n=!0,s=Object.assign(Object.assign({},a.video),{deviceId:{ideal:e}})}(!0===a.audio||"object"==typeof a.audio&&!a.audio.deviceId)&&(a.audio={deviceId:"default"}),!0===a.video?a.video={deviceId:"default"}:"object"!=typeof a.video||a.video.deviceId||(a.video.deviceId="default");const l=nd(a,Gd,$d),c=od(l),u=navigator.mediaDevices.getUserMedia(c);a.audio&&(md.userMediaPromiseMap.set("audioinput",u),u.catch((()=>md.userMediaPromiseMap.delete("audioinput")))),a.video&&(md.userMediaPromiseMap.set("videoinput",u),u.catch((()=>md.userMediaPromiseMap.delete("videoinput"))));try{const e=yield u;return yield Promise.all(e.getTracks().map((n=>vl(this,void 0,void 0,(function*(){const a="audio"===n.kind;let r,s=a?l.audio:l.video;"boolean"!=typeof s&&s||(s={});const u=a?c.audio:c.video;"boolean"!=typeof u&&(r=u);const d=n.getSettings().deviceId;(null==r?void 0:r.deviceId)&&qu(r.deviceId)!==d?r.deviceId=d:r||(r={deviceId:d});const p=function(e,t,n){switch(e.kind){case"audio":return new lp(e,t,!1,void 0,n);case"video":return new kp(e,t,!1,n);default:throw new qc("unsupported track type: ".concat(e.kind))}}(n,r,t);return p.kind===ou.Kind.Video?p.source=ou.Source.Camera:p.kind===ou.Kind.Audio&&(p.source=ou.Source.Microphone),p.mediaStream=e,Ju(p)&&i?yield p.setProcessor(i):Qu(p)&&o&&(yield p.setProcessor(o)),p})))))}catch(i){if(!n)throw i;return $p(Object.assign(Object.assign({},e),{audio:r,video:s}),t)}}))}!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(Ap||(Ap={}));class Jp extends Sl.EventEmitter{get logContext(){var e,t;return Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every((e=>e.isEncrypted))}get isAgent(){var e;return(null===(e=this.permissions)||void 0===e?void 0:e.agent)||this.kind===Ir.AGENT}get isActive(){var e;return(null===(e=this.participantInfo)||void 0===e?void 0:e.state)===xr.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,n,i,o,a){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ir.STANDARD;var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ap.Unknown,this.log=dl,this.log=hl(null!==(s=null==a?void 0:a.loggerName)&&void 0!==s?s:rl.Participant),this.loggerOptions=a,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=r,this._attributes=null!=o?o:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new Bu,this.once(Dc.Active,(()=>{var e,t;null===(t=null===(e=this.activeFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.activeFuture=void 0}))),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(ou.Source.Camera);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(ou.Source.Microphone);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(ou.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){var t;return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version||(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===xr.ACTIVE&&(null===(t=this.participantInfo)||void 0===t?void 0:t.state)!==xr.ACTIVE&&this.emit(Dc.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,0))}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Dc.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Dc.ParticipantNameChanged,e)}_setAttributes(e){const t=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={});const i=[...Object.keys(t),...Object.keys(e)],o={};for(const a of i)e[a]!==t[a]&&(o[a]=null!==(n=t[a])&&void 0!==n?n:"");return o}(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Dc.AttributesChanged,t)}setPermissions(e){var t,n,i,o,a,r;const s=this.permissions,l=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(o=this.permissions)||void 0===o?void 0:o.hidden)||e.recorder!==(null===(a=this.permissions)||void 0===a?void 0:a.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some(((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])}))||e.canSubscribeMetrics!==(null===(r=this.permissions)||void 0===r?void 0:r.canSubscribeMetrics);return this.permissions=e,l&&this.emit(Dc.ParticipantPermissionsChanged,s),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Dc.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case fr.EXCELLENT:return Ap.Excellent;case fr.GOOD:return Ap.Good;case fr.POOR:return Ap.Poor;case fr.LOST:return Ap.Lost;default:return Ap.Unknown}}(e),t!==this._connectionQuality&&this.emit(Dc.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&(null===(t=(e=this.activeFuture).reject)||void 0===t||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach((t=>Ju(t.track)&&t.track.setAudioContext(e)))}addTrackPublication(e){e.on(Fc.Muted,(()=>{this.emit(Dc.TrackMuted,e)})),e.on(Fc.Unmuted,(()=>{this.emit(Dc.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case ou.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case ou.Kind.Video:this.videoTrackPublications.set(e.trackSid,e)}}}class Qp extends Jp{constructor(e,t,n,i,o){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Er.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Bu)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var e,t,n,i,o,a;this.reconnectFuture&&(this.reconnectFuture.promise.catch((e=>this.log.warn(e.message,this.logContext))),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null===(i=(n=this.signalConnectedFuture).reject)||void 0===i||i.call(n,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),null===(a=null===(o=this.activeAgentFuture)||void 0===o?void 0:o.reject)||void 0===a||a.call(o,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=e=>{var t,n;e.participant&&this.updateInfo(e.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Bu),null===(n=(t=this.signalConnectedFuture).resolve)||void 0===n||n.call(t)},this.handleSignalRequestResponse=e=>{const{requestId:t,reason:n,message:i}=e,o=this.pendingSignalRequests.get(t);o&&(n!==el.OK&&o.reject(new $c(i,n)),this.pendingSignalRequests.delete(t))},this.handleDataPacket=e=>{switch(e.value.case){case"rpcResponse":let t=e.value.value,n=null,i=null;"payload"===t.value.case?n=t.value.value:"error"===t.value.case&&(i=Xd.fromProto(t.value.value)),this.handleIncomingRpcResponse(t.requestId,n,i);break;case"rpcAck":let o=e.value.value;this.handleIncomingRpcAck(o.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map((e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Us({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e))))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),ud(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),ud(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),ud(e))),this.onTrackMuted(e,e.isMuted)},this.onTrackFeatureUpdate=e=>{const t=this.audioTrackPublications.get(e.sid);t?this.engine.client.sendUpdateLocalAudioTrack(t.trackSid,t.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(e.sid),this.logContext)},this.onTrackCpuConstrained=(e,t)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),ud(t))),this.emit(Dc.LocalTrackCpuConstrained,e,t)},this.handleSubscribedQualityUpdate=e=>vl(this,void 0,void 0,(function*(){var t,n,i,o,a;if(!(null===(a=this.roomOptions)||void 0===a?void 0:a.dynacast))return;const r=this.videoTrackPublications.get(e.trackSid);if(!r)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}));if(!r.videoTrack)return;const s=yield r.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var l,c=!0,u=yl(s);!(t=(l=yield u.next()).done);c=!0){o=l.value,c=!1;const e=o;uu(e)&&(this.log.debug("publish ".concat(e," for ").concat(r.videoTrack.sid),Object.assign(Object.assign({},this.logContext),ud(r))),yield this.publishAdditionalCodecForTrack(r.videoTrack,e,r.options))}}catch(e){n={error:e}}finally{try{c||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}})),this.handleLocalTrackUnpublished=e=>{const t=this.trackPublications.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>vl(this,void 0,void 0,(function*(){if(e.source===ou.Source.ScreenShare||e.source===ou.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),ud(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(Zu(e)||Yu(e))try{if(xu())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===ou.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),ud(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(e){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),ud(e))),Zu(e)?yield e.restartTrack({deviceId:"default"}):yield e.restartTrack())}catch(t){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),ud(e))),yield e.mute()}})),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Er.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){this.engine=e,this.engine.on(Lc.RemoteMute,((e,t)=>{const n=this.trackPublications.get(e);n&&n.track&&(t?n.mute():n.unmute())})),this.engine.on(Lc.Connected,this.handleReconnected).on(Lc.SignalConnected,this.handleSignalConnected).on(Lc.SignalRestarted,this.handleReconnected).on(Lc.SignalResumed,this.handleReconnected).on(Lc.Restarting,this.handleReconnecting).on(Lc.Resuming,this.handleReconnecting).on(Lc.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Lc.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Lc.Disconnected,this.handleDisconnected).on(Lc.SignalRequestResponse,this.handleSignalRequestResponse).on(Lc.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return vl(this,void 0,void 0,(function*(){yield this.requestMetadataUpdate({metadata:e})}))}setName(e){return vl(this,void 0,void 0,(function*(){yield this.requestMetadataUpdate({name:e})}))}setAttributes(e){return vl(this,void 0,void 0,(function*(){yield this.requestMetadataUpdate({attributes:e})}))}requestMetadataUpdate(e){return vl(this,arguments,void 0,(function(e){var t=this;let{metadata:n,name:i,attributes:o}=e;return function*(){return new Promise(((e,a)=>vl(t,void 0,void 0,(function*(){var t,r;try{let s=!1;const l=yield this.engine.client.sendUpdateLocalMetadata(null!==(t=null!=n?n:this.metadata)&&void 0!==t?t:"",null!==(r=null!=i?i:this.name)&&void 0!==r?r:"",o),c=performance.now();for(this.pendingSignalRequests.set(l,{resolve:e,reject:e=>{a(e),s=!0},values:{name:i,metadata:n,attributes:o}});performance.now()-c<5e3&&!s;){if((!i||this.name===i)&&(!n||this.metadata===n)&&(!o||Object.entries(o).every((e=>{let[t,n]=e;return this.attributes[t]===n||""===n&&!this.attributes[t]}))))return this.pendingSignalRequests.delete(l),void e();yield vu(50)}a(new $c("Request to update local metadata timed out","TimeoutError"))}catch(e){e instanceof Error&&a(e)}}))))}()}))}setCameraEnabled(e,t,n){return this.setTrackEnabled(ou.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(ou.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(ou.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(Dc.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return vl(this,void 0,void 0,(function*(){this.encryptionType=e?Er.GCM:Er.NONE,yield this.republishAllTracks(void 0,!1)}))}setTrackEnabled(e,t,n,i){return vl(this,void 0,void 0,(function*(){var o,a;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let r=this.getTrackPublication(e);if(t)if(r)yield r.unmute();else{let t;if(this.pendingPublishing.has(e)){const t=yield this.waitForPendingPublicationOfSource(e);return t||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield null==t?void 0:t.unmute(),t}this.pendingPublishing.add(e);try{switch(e){case ou.Source.Camera:t=yield this.createTracks({video:null===(o=n)||void 0===o||o});break;case ou.Source.Microphone:t=yield this.createTracks({audio:null===(a=n)||void 0===a||a});break;case ou.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new qc(e)}}catch(n){throw null==t||t.forEach((e=>{e.stop()})),n instanceof Error&&this.emit(Dc.MediaDevicesError,n,sd(e)),this.pendingPublishing.delete(e),n}for(const n of t)e===ou.Source.Microphone&&Ju(n)&&(null==i?void 0:i.preConnectBuffer)&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),n.startPreConnectBuffer());try{const e=[];for(const n of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),ud(n))),e.push(this.publishTrack(n,i));const n=yield Promise.all(e);[r]=n}catch(e){throw null==t||t.forEach((e=>{e.stop()})),e}finally{this.pendingPublishing.delete(e)}}else if(!(null==r?void 0:r.track)&&this.pendingPublishing.has(e)&&(r=yield this.waitForPendingPublicationOfSource(e),r||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),r&&r.track)if(e===ou.Source.ScreenShare){r=yield this.unpublishTrack(r.track);const e=this.getTrackPublication(ou.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield r.mute();return r}))}enableCameraAndMicrophone(){return vl(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(ou.Source.Camera)&&!this.pendingPublishing.has(ou.Source.Microphone)){this.pendingPublishing.add(ou.Source.Camera),this.pendingPublishing.add(ou.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(ou.Source.Camera),this.pendingPublishing.delete(ou.Source.Microphone)}}}))}createTracks(e){return vl(this,void 0,void 0,(function*(){var t,n;null!=e||(e={});const i=nd(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults);try{return(yield $p(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map((e=>(Ju(e)&&(this.microphoneError=void 0,e.setAudioContext(this.audioContext),e.source=ou.Source.Microphone,this.emit(Dc.AudioStreamAcquired)),Qu(e)&&(this.cameraError=void 0,e.source=ou.Source.Camera),e)))}catch(t){throw t instanceof Error&&(e.audio&&(this.microphoneError=t),e.video&&(this.cameraError=t)),t}}))}createScreenTracks(e){return vl(this,void 0,void 0,(function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new Bc("getDisplayMedia not supported");void 0!==e.resolution||function(){const e=Yc();return"Safari"===(null==e?void 0:e.name)&&e.version.startsWith("17.")||"iOS"===(null==e?void 0:e.os)&&!!(null==e?void 0:e.osVersion)&&Nu(e.osVersion,"17")>=0}()||(e.resolution=mu.h1080fps30.resolution);const t=function(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"==typeof i?{}:i,i=Tu()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio,preferCurrentTab:e.preferCurrentTab}}(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new qc("no video track found");const o=new kp(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=ou.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const a=[o];if(n.getAudioTracks().length>0){this.emit(Dc.AudioStreamAcquired);const e=new lp(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=ou.Source.ScreenShareAudio,a.push(e)}return a}))}publishTrack(e,t){return vl(this,void 0,void 0,(function*(){return this.publishOrRepublishTrack(e,t)}))}publishOrRepublishTrack(e,t){return vl(this,arguments,void 0,(function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var o,a,r,s;let l,c;if(Zu(e)&&e.setAudioContext(n.audioContext),yield null===(o=n.reconnectFuture)||void 0===o?void 0:o.promise,n.republishPromise&&!i&&(yield n.republishPromise),$u(e)&&n.pendingPublishPromises.has(e)&&(yield n.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)l=e.getConstraints();else{let t;switch(l=e.constraints,e.source){case ou.Source.Microphone:t="audioinput";break;case ou.Source.Camera:t="videoinput"}t&&n.activeDeviceMap.has(t)&&(l=Object.assign(Object.assign({},l),{deviceId:n.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new lp(e,l,!0,n.audioContext,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;case"video":e=new kp(e,l,!0,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;default:throw new qc("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});if(n.trackPublications.forEach((t=>{t.track&&t.track===e&&(c=t)})),c)return n.log.warn("track has already been published, skipping",Object.assign(Object.assign({},n.logContext),ud(c))),c;const u="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,d=null!==(a=null==t?void 0:t.forceStereo)&&void 0!==a?a:u;d&&(t||(t={}),void 0===t.dtx&&n.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},n.logContext),ud(e))),void 0===t.red&&n.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(r=t.dtx)&&void 0!==r||(t.dtx=!1),null!==(s=t.red)&&void 0!==s||(t.red=!1));const p=Object.assign(Object.assign({},n.roomOptions.publishDefaults),t);!function(){const e=Yc(),t="17.2";if(e)return"Safari"!==e.name&&"iOS"!==e.os||!!("iOS"===e.os&&e.osVersion&&Nu(t,e.osVersion)>=0)||"Safari"===e.name&&Nu(t,e.version)>=0}()&&n.roomOptions.e2ee&&(n.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},n.logContext)),p.simulcast=!1),p.source&&(e.source=p.source);const h=new Promise(((t,i)=>vl(n,void 0,void 0,(function*(){try{if(this.engine.client.currentState!==kd.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:ud(e)}));const n=setTimeout((()=>{i(new Gc("publishing rejected as engine not connected within timeout",408))}),15e3);yield this.waitUntilEngineConnected(),clearTimeout(n);const o=yield this.publish(e,p,d);t(o)}else try{const n=yield this.publish(e,p,d);t(n)}catch(e){i(e)}}catch(e){i(e)}}))));n.pendingPublishPromises.set(e,h);try{return yield h}catch(e){throw e}finally{n.pendingPublishPromises.delete(e)}}()}))}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Bu),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),ud(e))),!1;const{canPublish:t,canPublishSources:n}=this.permissions;return!(!t||0!==n.length&&!n.map((e=>function(e){switch(e){case gr.CAMERA:return ou.Source.Camera;case gr.MICROPHONE:return ou.Source.Microphone;case gr.SCREEN_SHARE:return ou.Source.ScreenShare;case gr.SCREEN_SHARE_AUDIO:return ou.Source.ScreenShareAudio;default:return ou.Source.Unknown}}(e))).includes(e.source))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),ud(e))),!1)}publish(e,t,n){return vl(this,void 0,void 0,(function*(){var i,o,a,r,s,l,c,u,d,p;if(!this.hasPermissionsToPublish(e))throw new Gc("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find((t=>$u(e)&&t.source===e.source))&&e.source!==ou.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),ud(e))),t.stopMicTrackOnMute&&Ju(e)&&(e.stopOnMute=!0),e.source===ou.Source.ScreenShare&&wu()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(Tu())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/AV1"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(wu())return!1;if(Tu()){const e=Yc();if((null==e?void 0:e.version)&&Nu(e.version,"16")<0)return!1;if("iOS"===(null==e?void 0:e.os)&&(null==e?void 0:e.osVersion)&&Nu(e.osVersion,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/VP9"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=Hd),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some((e=>t.videoCodec===ld(e.mime)))||(t.videoCodec=ld(this.enabledPublishVideoCodecs[0].mime)));const h=t.videoCodec;e.on(Fc.Muted,this.onTrackMuted),e.on(Fc.Unmuted,this.onTrackUnmuted),e.on(Fc.Ended,this.handleTrackEnded),e.on(Fc.UpstreamPaused,this.onTrackUpstreamPaused),e.on(Fc.UpstreamResumed,this.onTrackUpstreamResumed),e.on(Fc.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const g=[],m=!(null===(i=t.dtx)||void 0===i||i),f=e.getSourceTrackSettings();f.autoGainControl&&g.push(Sr.TF_AUTO_GAIN_CONTROL),f.echoCancellation&&g.push(Sr.TF_ECHO_CANCELLATION),f.noiseSuppression&&g.push(Sr.TF_NOISE_SUPPRESSION),f.channelCount&&f.channelCount>1&&g.push(Sr.TF_STEREO),m&&g.push(Sr.TF_NO_DTX),Zu(e)&&e.hasPreConnectBuffer&&g.push(Sr.TF_PRECONNECT_BUFFER);const v=new hs({cid:e.mediaStreamTrack.id,name:t.name,type:ou.kindToProto(e.kind),muted:e.isMuted,source:ou.sourceToProto(e.source),disableDtx:m,encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(o=t.red)||void 0===o||o),stream:null==t?void 0:t.stream,backupCodecPolicy:null==t?void 0:t.backupCodecPolicy,audioFeatures:g});let y;if(e.kind===ou.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(t){const i=null!==(r=null===(a=this.roomOptions.videoCaptureDefaults)||void 0===a?void 0:a.resolution)&&void 0!==r?r:hu.h720.resolution;n={width:i.width,height:i.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),ud(e)),{dims:n}))}v.width=n.width,v.height=n.height,Yu(e)&&(ku(h)&&(e.source===ou.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),ud(e))))),t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),v.simulcastCodecs=[new ps({codec:h,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:Hd}),t.backupCodec&&h!==t.backupCodec.codec&&v.encryption===Er.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new ps({codec:t.backupCodec.codec,cid:""})))),y=mp(e.source===ou.Source.ScreenShare,v.width,v.height,t),v.layers=Tp(v.width,v.height,y,ku(t.videoCodec))}else e.kind===ou.Kind.Audio&&(y=[{maxBitrate:null===(l=t.audioPreset)||void 0===l?void 0:l.maxBitrate,priority:null!==(u=null===(c=t.audioPreset)||void 0===c?void 0:c.priority)&&void 0!==u?u:"high",networkPriority:null!==(p=null===(d=t.audioPreset)||void 0===d?void 0:d.priority)&&void 0!==p?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Hc("cannot publish track when not connected");const b=()=>vl(this,void 0,void 0,(function*(){var n,i,o;if(!this.engine.pcManager)throw new Hc("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,y),this.emit(Dc.LocalSenderCreated,e.sender,e),Yu(e)&&(null!==(n=t.degradationPreference)&&void 0!==n||(t.degradationPreference=function(e){return e.source===ou.Source.ScreenShare||e.constraints.height&&qu(e.constraints.height)>=1080?"maintain-resolution":"balanced"}(e)),e.setDegradationPreference(t.degradationPreference)),y)if(wu()&&e.kind===ou.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(i=y[0])||void 0===i?void 0:i.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&ku(e.codec)&&(null===(o=y[0])||void 0===o?void 0:o.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});yield this.engine.negotiate()}));let k;const S=new Promise(((t,n)=>vl(this,void 0,void 0,(function*(){var i;try{k=yield this.engine.addTrack(v),t(k)}catch(t){e.sender&&(null===(i=this.engine.pcManager)||void 0===i?void 0:i.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch((t=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),ud(e)),{error:t}))}))),n(t)}}))));if(this.enabledPublishVideoCodecs.length>0){const e=yield Promise.all([S,b()]);k=e[0]}else{let n;if(k=yield S,k.codecs.forEach((e=>{void 0===n&&(n=e.mimeType)})),n&&e.kind===ou.Kind.Video){const i=ld(n);i!==h&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),ud(e)),{codec:i})),t.videoCodec=i,y=mp(e.source===ou.Source.ScreenShare,v.width,v.height,t))}yield b()}const w=new Gp(e.kind,k,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(w.on(Fc.CpuConstrained,(e=>this.onTrackCpuConstrained(e,w))),w.options=t,e.sid=k.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:k})),Yu(e)?e.startMonitor(this.engine.client):Zu(e)&&e.startMonitor(),this.addTrackPublication(w),this.emit(Dc.LocalTrackPublished,w),Zu(e)&&k.audioFeatures.includes(Sr.TF_PRECONNECT_BUFFER)){const t=e.getPreConnectBuffer();if(this.on(Dc.LocalTrackSubscribed,(t=>{if(t.trackSid===k.sid){if(!e.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),ud(e))),e.stopPreConnectBuffer()}})),t){const n=new Promise(((n,i)=>vl(this,void 0,void 0,(function*(){var o,a,r,s,l,c;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),ud(e)));const h=setTimeout((()=>{i(new Error("agent not active within 10 seconds"))}),1e4),g=yield this.waitUntilActiveAgentPresent();clearTimeout(h),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),ud(e)));const m=yield this.streamBytes({name:"preconnect-buffer",mimeType:"audio/opus",topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[g.identity],attributes:{trackId:w.trackSid,sampleRate:String(null!==(l=f.sampleRate)&&void 0!==l?l:"48000"),channels:String(null!==(c=f.channelCount)&&void 0!==c?c:"1")}});try{for(var u,d=!0,p=yl(t);!(o=(u=yield p.next()).done);d=!0){s=u.value,d=!1;const e=s;yield m.write(e)}}catch(e){a={error:e}}finally{try{d||o||!(r=p.return)||(yield r.call(p))}finally{if(a)throw a.error}}yield m.close(),n()}catch(e){i(e)}}))));n.then((()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),ud(e)))})).catch((t=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),ud(e)),{error:t}))}))}}return w}))}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){return vl(this,void 0,void 0,(function*(){var i;if(this.encryptionType!==Er.NONE)return;let o;if(this.trackPublications.forEach((t=>{t.track&&t.track===e&&(o=t)})),!o)throw new qc("track is not published");if(!Yu(e))throw new qc("track is not a video track");const a=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),r=function(e,t,n){var i,o,a,r;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&dl.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),l=null!==(i=s.width)&&void 0!==i?i:null===(o=e.dimensions)||void 0===o?void 0:o.width,c=null!==(a=s.height)&&void 0!==a?a:null===(r=e.dimensions)||void 0===r?void 0:r.height;return e.source===ou.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),mp(e.source===ou.Source.ScreenShare,l,c,n)}(e,t,a);if(!r)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),ud(e)));const s=e.addSimulcastTrack(t,r);if(!s)return;const l=new hs({cid:s.mediaStreamTrack.id,type:ou.kindToProto(e.kind),muted:e.isMuted,source:ou.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:a.videoCodec,cid:s.mediaStreamTrack.id}]});if(l.layers=Tp(l.width,l.height,r),!this.engine||this.engine.isClosed)throw new Hc("cannot publish track when not connected");const c=(yield Promise.all([this.engine.addTrack(l),(()=>vl(this,void 0,void 0,(function*(){yield this.engine.createSimulcastSender(e,s,a,r),yield this.engine.negotiate()})))()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:r,trackInfo:c}))}))}unpublishTrack(e,t){return vl(this,void 0,void 0,(function*(){var n,i;if($u(e)){const t=this.pendingPublishPromises.get(e);t&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),ud(e))),yield t)}const o=this.getPublicationForTrack(e),a=o?ud(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),a)),!o||!o.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),a));(e=o.track).off(Fc.Muted,this.onTrackMuted),e.off(Fc.Unmuted,this.onTrackUnmuted),e.off(Fc.Ended,this.handleTrackEnded),e.off(Fc.UpstreamPaused,this.onTrackUpstreamPaused),e.off(Fc.UpstreamResumed,this.onTrackUpstreamResumed),e.off(Fc.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t?e.stop():e.stopMonitor();let r=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Yd.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",r=!0);if(this.engine.removeTrack(s)&&(r=!0),Yu(e)){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(r=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(e){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),a),{error:e}))}switch(this.trackPublications.delete(o.trackSid),o.kind){case ou.Kind.Audio:this.audioTrackPublications.delete(o.trackSid);break;case ou.Kind.Video:this.videoTrackPublications.delete(o.trackSid)}return this.emit(Dc.LocalTrackUnpublished,o),o.setTrack(void 0),r&&(yield this.engine.negotiate()),o}))}unpublishTracks(e){return vl(this,void 0,void 0,(function*(){return(yield Promise.all(e.map((e=>this.unpublishTrack(e))))).filter((e=>!!e))}))}republishAllTracks(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){t.republishPromise&&(yield t.republishPromise),t.republishPromise=new Promise(((i,o)=>vl(t,void 0,void 0,(function*(){try{const t=[];this.trackPublications.forEach((n=>{n.track&&(e&&(n.options=Object.assign(Object.assign({},n.options),e)),t.push(n))})),yield Promise.all(t.map((e=>vl(this,void 0,void 0,(function*(){const t=e.track;yield this.unpublishTrack(t,!1),!n||t.isMuted||t.source===ou.Source.ScreenShare||t.source===ou.Source.ScreenShareAudio||!Zu(t)&&!Yu(t)||t.isUserProvided||(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield t.restartTrack()),yield this.publishOrRepublishTrack(t,e.options,!0)}))))),i()}catch(e){o(e)}finally{this.republishPromise=void 0}})))),yield t.republishPromise}()}))}publishData(e){return vl(this,arguments,void 0,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const i=n.reliable?Rr.RELIABLE:Rr.LOSSY,o=n.destinationIdentities,a=n.topic,r=new Mr({kind:i,value:{case:"user",value:new Lr({participantIdentity:t.identity,payload:e,destinationIdentities:o,topic:a})}});yield t.engine.sendDataPacket(r,i)}()}))}publishDtmf(e,t){return vl(this,void 0,void 0,(function*(){const n=new Mr({kind:Rr.RELIABLE,value:{case:"sipDtmf",value:new Fr({code:e,digit:t})}});yield this.engine.sendDataPacket(n,Rr.RELIABLE)}))}sendChatMessage(e,t){return vl(this,void 0,void 0,(function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:null==t?void 0:t.attachments},i=new Mr({value:{case:"chatMessage",value:new Vr(Object.assign(Object.assign({},n),{timestamp:ea.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,Rr.RELIABLE),this.emit(Dc.ChatMessage,n),n}))}editChatMessage(e,t){return vl(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new Mr({value:{case:"chatMessage",value:new Vr(Object.assign(Object.assign({},n),{timestamp:ea.parse(n.timestamp),editTimestamp:ea.parse(n.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,Rr.RELIABLE),this.emit(Dc.ChatMessage,n),n}))}sendText(e,t){return vl(this,void 0,void 0,(function*(){var n;const i=crypto.randomUUID(),o=(new TextEncoder).encode(e).byteLength,a=null===(n=null==t?void 0:t.attachments)||void 0===n?void 0:n.map((()=>crypto.randomUUID())),r=new Array(a?a.length+1:1).fill(0),s=(e,n)=>{var i;r[n]=e;const o=r.reduce(((e,t)=>e+t),0);null===(i=null==t?void 0:t.onProgress)||void 0===i||i.call(t,o)},l=yield this.streamText({streamId:i,totalSize:o,destinationIdentities:null==t?void 0:t.destinationIdentities,topic:null==t?void 0:t.topic,attachedStreamIds:a,attributes:null==t?void 0:t.attributes});return yield l.write(e),s(1,0),yield l.close(),(null==t?void 0:t.attachments)&&a&&(yield Promise.all(t.attachments.map(((e,n)=>vl(this,void 0,void 0,(function*(){return this._sendFile(a[n],e,{topic:t.topic,mimeType:e.type,onProgress:e=>{s(e,n+1)}})})))))),l.info}))}streamText(e){return vl(this,void 0,void 0,(function*(){var t,n;const i=null!==(t=null==e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),o={id:i,mimeType:"text/plain",timestamp:Date.now(),topic:null!==(n=null==e?void 0:e.topic)&&void 0!==n?n:"",size:null==e?void 0:e.totalSize,attributes:null==e?void 0:e.attributes},a=new os({streamId:i,mimeType:o.mimeType,topic:o.topic,timestamp:Gu(o.timestamp),totalLength:Gu(null==e?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new ns({version:null==e?void 0:e.version,attachedStreamIds:null==e?void 0:e.attachedStreamIds,replyToStreamId:null==e?void 0:e.replyToStreamId,operationType:"update"===(null==e?void 0:e.type)?ts.UPDATE:ts.CREATE})}}),r=null==e?void 0:e.destinationIdentities,s=new Mr({destinationIdentities:r,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(s,Rr.RELIABLE);let l=0;const c=this,u=new WritableStream({write(e){return vl(this,void 0,void 0,(function*(){for(const t of function(e){const t=[];let n=(new TextEncoder).encode(e);for(;n.length>15e3;){let e=15e3;for(;e>0;){const t=n[e];if(void 0!==t&&128!=(192&t))break;e--}t.push(n.slice(0,e)),n=n.slice(e)}return n.length>0&&t.push(n),t}(e)){yield c.engine.waitForBufferStatusLow(Rr.RELIABLE);const e=new as({content:t,streamId:i,chunkIndex:Gu(l)}),n=new Mr({destinationIdentities:r,value:{case:"streamChunk",value:e}});yield c.engine.sendDataPacket(n,Rr.RELIABLE),l+=1}}))},close(){return vl(this,void 0,void 0,(function*(){const e=new rs({streamId:i}),t=new Mr({destinationIdentities:r,value:{case:"streamTrailer",value:e}});yield c.engine.sendDataPacket(t,Rr.RELIABLE)}))},abort(e){console.log("Sink error:",e)}});let d=()=>vl(this,void 0,void 0,(function*(){yield p.close()}));c.engine.once(Lc.Closing,d);const p=new Fp(u,o,(()=>this.engine.off(Lc.Closing,d)));return p}))}sendFile(e,t){return vl(this,void 0,void 0,(function*(){const n=crypto.randomUUID();return yield this._sendFile(n,e,t),{id:n}}))}_sendFile(e,t,n){return vl(this,void 0,void 0,(function*(){var i;const o=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:null!==(i=null==n?void 0:n.mimeType)&&void 0!==i?i:t.type,topic:null==n?void 0:n.topic,destinationIdentities:null==n?void 0:n.destinationIdentities}),a=t.stream().getReader();for(;;){const{done:e,value:t}=yield a.read();if(e)break;yield o.write(t)}return yield o.close(),o.info}))}streamBytes(e){return vl(this,void 0,void 0,(function*(){var t,n,i,o,a;const r=null!==(t=null==e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),s=null==e?void 0:e.destinationIdentities,l={id:r,mimeType:null!==(n=null==e?void 0:e.mimeType)&&void 0!==n?n:"application/octet-stream",topic:null!==(i=null==e?void 0:e.topic)&&void 0!==i?i:"",timestamp:Date.now(),attributes:null==e?void 0:e.attributes,size:null==e?void 0:e.totalSize,name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:"unknown"},c=new os({totalLength:Gu(null!==(a=l.size)&&void 0!==a?a:0),mimeType:l.mimeType,streamId:r,topic:l.topic,timestamp:Gu(Date.now()),attributes:l.attributes,contentHeader:{case:"byteHeader",value:new is({name:l.name})}}),u=new Mr({destinationIdentities:s,value:{case:"streamHeader",value:c}});yield this.engine.sendDataPacket(u,Rr.RELIABLE);let d=0;const p=new Ro,h=this.engine,g=this.log,m=new WritableStream({write(e){return vl(this,void 0,void 0,(function*(){const t=yield p.lock();let n=0;try{for(;n<e.byteLength;){const t=e.slice(n,n+15e3);yield h.waitForBufferStatusLow(Rr.RELIABLE);const i=new Mr({destinationIdentities:s,value:{case:"streamChunk",value:new as({content:t,streamId:r,chunkIndex:Gu(d)})}});yield h.sendDataPacket(i,Rr.RELIABLE),d+=1,n+=t.byteLength}}finally{t()}}))},close(){return vl(this,void 0,void 0,(function*(){const e=new rs({streamId:r}),t=new Mr({destinationIdentities:s,value:{case:"streamTrailer",value:e}});yield h.sendDataPacket(t,Rr.RELIABLE)}))},abort(e){g.error("Sink error:",e)}});return new zp(m,l)}))}performRpc(e){return vl(this,arguments,void 0,(function(e){var t=this;let{destinationIdentity:n,method:i,payload:o,responseTimeout:a=1e4}=e;return function*(){return new Promise(((e,r)=>vl(t,void 0,void 0,(function*(){var t,s,l,c;if(ep(o)>15360)return void r(Xd.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null===(s=null===(t=this.engine.latestJoinResponse)||void 0===t?void 0:t.serverInfo)||void 0===s?void 0:s.version)&&Nu(null===(c=null===(l=this.engine.latestJoinResponse)||void 0===l?void 0:l.serverInfo)||void 0===c?void 0:c.version,"1.8.0")<0)return void r(Xd.builtIn("UNSUPPORTED_SERVER"));const u=crypto.randomUUID();yield this.publishRpcRequest(n,u,i,o,a-2e3);const d=setTimeout((()=>{this.pendingAcks.delete(u),r(Xd.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(u),clearTimeout(p)}),2e3);this.pendingAcks.set(u,{resolve:()=>{clearTimeout(d)},participantIdentity:n});const p=setTimeout((()=>{this.pendingResponses.delete(u),r(Xd.builtIn("RESPONSE_TIMEOUT"))}),a);this.pendingResponses.set(u,{resolve:(t,n)=>{clearTimeout(p),this.pendingAcks.has(u)&&(console.warn("RPC response received before ack",u),this.pendingAcks.delete(u),clearTimeout(d)),n?r(n):e(null!=t?t:"")},participantIdentity:n})}))))}()}))}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,n){const i=this.pendingResponses.get(e);i?(i.resolve(t,n),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,n,i,o){return vl(this,void 0,void 0,(function*(){const a=new Mr({destinationIdentities:[e],kind:Rr.RELIABLE,value:{case:"rpcRequest",value:new Br({id:t,method:n,payload:i,responseTimeoutMs:o,version:1})}});yield this.engine.sendDataPacket(a,Rr.RELIABLE)}))}handleParticipantDisconnected(e){for(const[t,{participantIdentity:n}]of this.pendingAcks)n===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:n,resolve:i}]of this.pendingResponses)n===e&&(i(null,Xd.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter((e=>"video"===e.mime.split("/")[0].toLowerCase()))}updateInfo(e){return!!super.updateInfo(e)&&(e.tracks.forEach((e=>{var t,n;const i=this.trackPublications.get(e.sid);if(i){const o=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;o!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),ud(i)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(e.sid,o))}})),!0)}setActiveAgent(e){var t,n,i,o;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?null===(n=null===(t=this.activeAgentFuture)||void 0===t?void 0:t.resolve)||void 0===n||n.call(t,e):null===(o=null===(i=this.activeAgentFuture)||void 0===i?void 0:i.reject)||void 0===o||o.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Bu),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach((n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(Zu(i)||Yu(i))&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))})),t}waitForPendingPublicationOfSource(e){return vl(this,void 0,void 0,(function*(){const t=Date.now();for(;Date.now()<t+1e4;){const t=Array.from(this.pendingPublishPromises.entries()).find((t=>{let[n]=t;return n.source===e}));if(t)return t[1];yield vu(20)}}))}}class Yp extends Wp{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=e=>{this.setTrack(void 0),this.emit(Fc.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.visible=e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensionsAdaptiveStream=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new ws({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Wr({participantSid:"",trackSids:[this.trackSid]})]});this.emit(Fc.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?Wp.SubscriptionStatus.Unsubscribed:super.isSubscribed?Wp.SubscriptionStatus.Subscribed:Wp.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Wp.PermissionStatus.Allowed:Wp.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(e){this.isManualOperationAllowed()&&this.requestedDisabled!==!e&&(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.requestedMaxQuality!==e&&(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.requestedVideoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.requestedVideoDimensions)||void 0===n?void 0:n.height)===e.height||(td(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&td(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return null!==(e=this.requestedMaxQuality)&&void 0!==e?e:iu.HIGH}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(Fc.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(Fc.VisibilityChanged,this.handleVisibilityChange),i.off(Fc.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(Fc.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(Fc.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(Fc.VisibilityChanged,this.handleVisibilityChange),e.on(Fc.Ended,this.handleEnded),this.emit(Fc.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(Fc.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?Fc.Muted:Fc.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(Fc.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(Fc.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return td(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Ts({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===ou.Kind.Video){let o=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(o)pd(this.videoDimensionsAdaptiveStream,o)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),o=this.videoDimensionsAdaptiveStream);else if(void 0!==this.requestedMaxQuality&&this.trackInfo){const e=(t=this.trackInfo,n=this.requestedMaxQuality,null===(i=t.layers)||void 0===i?void 0:i.find((e=>e.quality===n)));e&&pd(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),o=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),o=this.videoDimensionsAdaptiveStream;o?(e.width=Math.ceil(o.width),e.height=Math.ceil(o.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:iu.HIGH})),e.quality=iu.HIGH)}var t,n,i;this.emit(Fc.UpdateSettings,e)}}class Zp extends Jp{static fromParticipantInfo(e,t,n){return new Zp(e,t.sid,t.identity,t.name,t.metadata,t.attributes,n,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,n,i,o,a,r){super(t,n||"",i,o,a,r,arguments.length>7&&void 0!==arguments[7]?arguments[7]:Ir.STANDARD),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(Fc.UpdateSettings,(t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),ud(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)})),e.on(Fc.UpdateSubscription,(e=>{e.participantTracks.forEach((e=>{e.participantSid=this.sid})),this.signalClient.sendUpdateSubscription(e)})),e.on(Fc.SubscriptionPermissionChanged,(t=>{this.emit(Dc.TrackSubscriptionPermissionChanged,e,t)})),e.on(Fc.SubscriptionStatusChanged,(t=>{this.emit(Dc.TrackSubscriptionStatusChanged,e,t)})),e.on(Fc.Subscribed,(t=>{this.emit(Dc.TrackSubscribed,t,e)})),e.on(Fc.Unsubscribed,(t=>{this.emit(Dc.TrackUnsubscribed,t,e)})),e.on(Fc.SubscriptionFailed,(t=>{this.emit(Dc.TrackSubscriptionFailed,e.trackSid,t)}))}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ou.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrackPublication(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ou.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,o,a){let r,s=this.getTrackPublicationBySid(t);return s||t.startsWith("TR")||this.trackPublications.forEach((t=>{s||e.kind!==t.kind.toString()||(s=t)})),s?"ended"===e.readyState?(this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),ud(s))),void this.emit(Dc.TrackSubscriptionFailed,t)):(r="video"===e.kind?new Bp(e,t,i,o):new Vp(e,t,i,this.audioContext,this.audioOutput),r.source=s.source,r.isMuted=s.isMuted,r.setMediaStream(n),r.start(),s.setTrack(r),this.volumeMap.has(s.source)&&Xu(r)&&Ju(r)&&r.setVolume(this.volumeMap.get(s.source)),s):0===a?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(Dc.TrackSubscriptionFailed,t)):(void 0===a&&(a=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,n,i,o,a-1)}),150))}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach((e=>{var i,o;let a=this.getTrackPublicationBySid(e.sid);if(a)a.updateInfo(e);else{const t=ou.kindFromProto(e.type);if(!t)return;a=new Yp(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(o=this.loggerOptions)||void 0===o?void 0:o.loggerName}),a.updateInfo(e),n.set(e.sid,a);const r=Array.from(this.trackPublications.values()).find((e=>e.source===(null==a?void 0:a.source)));r&&a.source!==ou.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:ud(r),newTrack:ud(a)})),this.addTrackPublication(a)}t.set(e.sid,a)})),this.trackPublications.forEach((e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),ud(e))),this.unpublishTrack(e.trackSid,!0))})),n.forEach((e=>{this.emit(Dc.TrackPublished,e)})),!0}unpublishTrack(e,t){const n=this.trackPublications.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.trackPublications.delete(e),n.kind){case ou.Kind.Audio:this.audioTrackPublications.delete(e);break;case ou.Kind.Video:this.videoTrackPublications.delete(e)}t&&this.emit(Dc.TrackUnpublished,n)}setAudioOutput(e){return vl(this,void 0,void 0,(function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach((n=>{var i;Ju(n.track)&&Xu(n.track)&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))})),yield Promise.all(t)}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting"}(Ep||(Ep={}));class Xp extends Sl.EventEmitter{constructor(e){var t,n,i,o;if(super(),t=this,this.state=Ep.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=dl,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(e,t,n)=>vl(this,void 0,void 0,(function*(){var i;if("undefined"==typeof RTCPeerConnection||!yu()&&!bu())throw Iu()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const o=yield this.disconnectLock.lock();if(this.state===Ep.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),o(),Promise.resolve();if(this.connectFuture)return o(),this.connectFuture.promise;this.setAndEmitConnectionState(Ep.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Au(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new Mp(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().then((e=>{var t;null===(t=this.regionUrlProvider)||void 0===t||t.setServerReportedRegions(e)})).catch((e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))})));const a=(i,r,s)=>vl(this,void 0,void 0,(function*(){var l,c;this.abortController&&this.abortController.abort();const u=new AbortController;this.abortController=u,null==o||o();try{yield this.attemptConnection(null!=s?s:e,t,n,u),this.abortController=void 0,i()}catch(e){if(this.regionUrlProvider&&e instanceof Vc&&e.reason!==Nc.Cancelled&&e.reason!==Nc.NotAllowed){let t=null;try{t=yield this.regionUrlProvider.getNextBestRegionUrl(null===(l=this.abortController)||void 0===l?void 0:l.signal)}catch(e){if(e instanceof Vc&&(401===e.status||e.reason===Nc.Cancelled))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void r(e)}t&&!(null===(c=this.abortController)||void 0===c?void 0:c.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(e.message,". Retrying with another region: ").concat(t),this.logContext),this.recreateEngine(),yield a(i,r,t)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Hu(e)),r(e))}else{let t=yr.UNKNOWN_REASON;e instanceof Vc&&(t=Hu(e)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t),r(e)}}})),r=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Bu(((e,t)=>{a(e,t,r)}),(()=>{this.clearConnectionFutures()})),this.connectFuture.promise})),this.connectSignal=(e,t,n,i,o,a)=>vl(this,void 0,void 0,(function*(){var r,s,l;const c=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,adaptiveStream:"object"==typeof o.adaptiveStream||o.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout},a.signal);let u=c.serverInfo;if(u||(u={version:c.serverVersion,region:c.serverRegion}),this.serverInfo=u,this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map((e=>{let[t,n]=e;return"".concat(t,": ").concat(n)})).join(", ")),{room:null===(r=c.room)||void 0===r?void 0:r.name,roomSid:null===(s=c.room)||void 0===s?void 0:s.sid,identity:null===(l=c.participant)||void 0===l?void 0:l.identity}),!u.version)throw new Kc("unknown server version");return"0.15.1"===u.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),o.dynacast=!1),c})),this.applyJoinResponse=e=>{const t=e.participant;if(this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.localParticipant.setEnabledPublishCodecs(e.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(e.sifTrailer)}catch(e){this.log.error(e instanceof Error?e.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:e}))}this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room)},this.attemptConnection=(e,t,n,i)=>vl(this,void 0,void 0,(function*(){var o,a;this.state===Ep.Reconnecting||this.isResuming||(null===(o=this.engine)||void 0===o?void 0:o.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(a=this.regionUrlProvider)||void 0===a?void 0:a.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Qd),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(jc.SignalConnected)}catch(e){yield this.engine.close(),this.recreateEngine();const t=new Vc("could not establish signal connection",Nc.ServerUnreachable);throw e instanceof Error&&(t.message="".concat(t.message,": ").concat(e.message)),e instanceof Vc&&(t.reason=e.reason,t.status=e.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:e})),t}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Vc("Connection attempt aborted",Nc.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(e){throw yield this.engine.close(),this.recreateEngine(),e}xu()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),xu()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ep.Connected),this.emit(jc.Connected),this.registerConnectionReconcile()})),this.disconnect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return vl(t,[...n],void 0,(function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i,o,a;const r=yield e.disconnectLock.lock();try{if(e.state===Ep.Disconnected)return void e.log.debug("already disconnected",e.logContext);e.log.info("disconnect from room",Object.assign({},e.logContext)),(e.state===Ep.Connecting||e.state===Ep.Reconnecting||e.isResuming)&&(e.log.warn("abort connection attempt",e.logContext),null===(n=e.abortController)||void 0===n||n.abort(),null===(o=null===(i=e.connectFuture)||void 0===i?void 0:i.reject)||void 0===o||o.call(i,new Vc("Client initiated disconnect",Nc.Cancelled)),e.connectFuture=void 0),(null===(a=e.engine)||void 0===a?void 0:a.client.isDisconnected)||(yield e.engine.client.sendLeave()),e.engine&&(yield e.engine.close()),e.handleDisconnect(t,yr.CLIENT_INITIATED),e.engine=void 0}finally{r()}}()}))},this.onPageLeave=()=>vl(this,void 0,void 0,(function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()})),this.startAudio=()=>vl(this,void 0,void 0,(function*(){const e=[],t=Yc();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=Vu();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",(()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))})),document.body.append(n),this.once(jc.Disconnected,(()=>{null==n||n.remove(),n=null}))}e.push(n)}this.remoteParticipants.forEach((t=>{t.audioTrackPublications.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all([this.acquireAudioContext(),...e.map((e=>(e.muted=!1,e.play())))]),this.handleAudioPlaybackStarted()}catch(e){throw this.handleAudioPlaybackFailed(e),e}})),this.startVideo=()=>vl(this,void 0,void 0,(function*(){const e=[];for(const t of this.remoteParticipants.values())t.videoTrackPublications.forEach((t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach((t=>{e.includes(t)||e.push(t)}))}));yield Promise.all(e.map((e=>e.play()))).then((()=>{this.handleVideoPlaybackStarted()})).catch((e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)}))})),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const e of this.remoteParticipants.values())this.handleParticipantDisconnected(e.identity,e);this.setAndEmitConnectionState(Ep.Reconnecting)&&this.emit(jc.Reconnecting)},this.handleSignalRestarted=e=>vl(this,void 0,void 0,(function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(e){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:e}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(e){return}this.setAndEmitConnectionState(Ep.Connected),this.emit(jc.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()})),this.handleParticipantUpdates=e=>{e.forEach((e=>{var t;if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);""===e.identity&&(e.identity=null!==(t=this.sidToIdentity.get(e.sid))&&void 0!==t?t:"");let n=this.remoteParticipants.get(e.identity);e.state===xr.DISCONNECTED?this.handleParticipantDisconnected(e.identity,n):n=this.getOrCreateParticipant(e.identity,e)}))},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach((e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.getRemoteParticipantBySid(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}})),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach((e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emitWhenConnected(jc.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{const n=this.remoteParticipants.get(e.identity);n&&n.sid!==e.sid||t.set(e.sid,e)})),e.forEach((e=>{let n=this.getRemoteParticipantBySid(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))}));const n=Array.from(t.values());n.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=n,this.emitWhenConnected(jc.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);if(!n||!n.track)return;const i=ou.streamStateFromProto(e.state);i!==n.track.streamState&&(n.track.streamState=i,t.emit(Dc.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(jc.TrackStreamStateChanged,n,n.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.remoteParticipants.values()).find((t=>t.trackPublications.has(e.trackSid)));if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=e=>{const t=this.remoteParticipants.get(e.participantIdentity);if("user"===e.value.case)this.handleUserPacket(t,e.value.value,e.kind);else if("transcription"===e.value.case)this.handleTranscription(t,e.value.value);else if("sipDtmf"===e.value.case)this.handleSipDtmf(t,e.value.value);else if("chatMessage"===e.value.case)this.handleChatMessage(t,e.value.value);else if("metrics"===e.value.case)this.handleMetrics(e.value.value,t);else if("streamHeader"===e.value.case)this.handleStreamHeader(e.value.value,e.participantIdentity);else if("streamChunk"===e.value.case)this.handleStreamChunk(e.value.value);else if("streamTrailer"===e.value.case)this.handleStreamTrailer(e.value.value);else if("rpcRequest"===e.value.case){const t=e.value.value;this.handleIncomingRpcRequest(e.participantIdentity,t.id,t.method,t.payload,t.responseTimeoutMs,t.version)}},this.handleUserPacket=(e,t,n)=>{this.emit(jc.DataReceived,t.payload,e,n,t.topic),null==e||e.emit(Dc.DataReceived,t.payload,n)},this.handleSipDtmf=(e,t)=>{this.emit(jc.SipDTMFReceived,t,e),null==e||e.emit(Dc.SipDTMFReceived,t)},this.bufferedSegments=new Map,this.handleTranscription=(e,t)=>{const n=t.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(t.transcribedParticipantIdentity),i=null==n?void 0:n.trackPublications.get(t.trackId),o=function(e,t){return e.segments.map((e=>{let{id:n,text:i,language:o,startTime:a,endTime:r,final:s}=e;var l;const c=null!==(l=t.get(n))&&void 0!==l?l:Date.now(),u=Date.now();return s?t.delete(n):t.set(n,c),{id:n,text:i,startTime:Number.parseInt(a.toString()),endTime:Number.parseInt(r.toString()),final:s,language:o,firstReceivedTime:c,lastReceivedTime:u}}))}(t,this.transcriptionReceivedTimes);null==i||i.emit(Fc.TranscriptionReceived,o),null==n||n.emit(Dc.TranscriptionReceived,o,i),this.emit(jc.TranscriptionReceived,o,n,i)},this.handleChatMessage=(e,t)=>{const n=function(e){const{id:t,timestamp:n,message:i,editTimestamp:o}=e;return{id:t,timestamp:Number.parseInt(n.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:i}}(t);this.emit(jc.ChatMessage,n,e)},this.handleMetrics=(e,t)=>{this.emit(jc.MetricsReceived,e,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(jc.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(jc.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(jc.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(jc.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>vl(this,void 0,void 0,(function*(){var e;"iOS"!==(null===(e=Yc())||void 0===e?void 0:e.os)&&(yield this.selectDefaultDevices()),this.emit(jc.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(jc.RoomMetadataChanged,e.metadata),(null==t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(jc.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.getRemoteParticipantBySid(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.onLocalParticipantMetadataChanged=e=>{this.emit(jc.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(jc.ParticipantNameChanged,e,this.localParticipant)},this.onLocalAttributesChanged=e=>{this.emit(jc.ParticipantAttributesChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(jc.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(jc.TrackUnmuted,e,this.localParticipant)},this.onTrackProcessorUpdate=e=>{var t;null===(t=null==e?void 0:e.onPublish)||void 0===t||t.call(e,this)},this.onLocalTrackPublished=e=>vl(this,void 0,void 0,(function*(){var t,n,i,o,a,r;null===(t=e.track)||void 0===t||t.on(Fc.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.on(Fc.Restarted,this.onLocalTrackRestarted),null===(a=null===(o=null===(i=e.track)||void 0===i?void 0:i.getProcessor())||void 0===o?void 0:o.onPublish)||void 0===a||a.call(o,this),this.emit(jc.LocalTrackPublished,e,this.localParticipant),Zu(e.track)&&(yield e.track.checkForSilence())&&this.emit(jc.LocalAudioSilenceDetected,e);const s=yield null===(r=e.track)||void 0===r?void 0:r.getDeviceId(!1),l=sd(e.source);l&&s&&s!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,s),this.emit(jc.ActiveDeviceChanged,l,s))})),this.onLocalTrackUnpublished=e=>{var t,n;null===(t=e.track)||void 0===t||t.off(Fc.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.off(Fc.Restarted,this.onLocalTrackRestarted),this.emit(jc.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalTrackRestarted=e=>vl(this,void 0,void 0,(function*(){const t=yield e.getDeviceId(!1),n=sd(e.source);n&&t&&t!==this.localParticipant.activeDeviceMap.get(n)&&(this.log.debug("local track restarted, setting ".concat(n," ").concat(t," active"),this.logContext),this.localParticipant.activeDeviceMap.set(n,t),this.emit(jc.ActiveDeviceChanged,n,t))})),this.onLocalConnectionQualityChanged=e=>{this.emit(jc.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=(e,t)=>{this.emit(jc.MediaDevicesError,e,t)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(jc.ParticipantPermissionsChanged,e,this.localParticipant)},this.onLocalChatMessageSent=e=>{this.emit(jc.ChatMessage,e,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},Jd),e),this.log=hl(null!==(n=this.options.loggerName)&&void 0!==n?n:rl.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Gd),null==e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},$d),null==e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Wd),null==e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Ro,this.localParticipant=new Qp("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",qu(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",qu(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",qu(this.options.audioOutput.deviceId)).catch((e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext))),this.options.e2ee&&this.setupE2EE(),xu()){const e=new AbortController;null===(o=navigator.mediaDevices)||void 0===o||o.addEventListener("devicechange",this.handleDeviceChange,{signal:e.signal}),Xp.cleanupRegistry&&Xp.cleanupRegistry.register(this,(()=>{e.abort()}))}}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,t,n,i,o,a){return vl(this,void 0,void 0,(function*(){if(yield this.engine.publishRpcAck(e,t),1!==a)return void(yield this.engine.publishRpcResponse(e,t,null,Xd.builtIn("UNSUPPORTED_VERSION")));const r=this.rpcHandlers.get(n);if(!r)return void(yield this.engine.publishRpcResponse(e,t,null,Xd.builtIn("UNSUPPORTED_METHOD")));let s=null,l=null;try{const a=yield r({requestId:t,callerIdentity:e,payload:i,responseTimeout:o});ep(a)>15360?(s=Xd.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(n))):l=a}catch(e){e instanceof Xd?s=e:(console.warn("Uncaught error returned by RPC handler for ".concat(n,". Returning APPLICATION_ERROR instead."),e),s=Xd.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,l,s)}))}setE2EEEnabled(e){return vl(this,void 0,void 0,(function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)}))}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new hd(this.options.e2ee),this.e2eeManager.on(Oc.ParticipantEncryptionStatusChanged,((e,t)=>{t.isLocal&&(this.isE2EEEnabled=e),this.emit(jc.ParticipantEncryptionStatusChanged,e,t)})),this.e2eeManager.on(Oc.EncryptionError,(e=>this.emit(jc.EncryptionError,e))),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:null===(e=this.roomInfo)||void 0===e?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}getSid(){return vl(this,void 0,void 0,(function*(){return this.state===Ep.Disconnected?"":this.roomInfo&&""!==this.roomInfo.sid?this.roomInfo.sid:new Promise(((e,t)=>{const n=t=>{""!==t.sid&&(this.engine.off(Lc.RoomUpdate,n),e(t.sid))};this.engine.on(Lc.RoomUpdate,n),this.once(jc.Disconnected,(()=>{this.engine.off(Lc.RoomUpdate,n),t("Room disconnected before room server id was available")}))}))}))}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new _p(this.options),this.engine.on(Lc.ParticipantUpdate,this.handleParticipantUpdates).on(Lc.RoomUpdate,this.handleRoomUpdate).on(Lc.SpeakersChanged,this.handleSpeakersChanged).on(Lc.StreamStateChanged,this.handleStreamStateUpdate).on(Lc.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Lc.SubscriptionError,this.handleSubscriptionError).on(Lc.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Lc.MediaTrackAdded,((e,t,n)=>{this.onTrackAdded(e,t,n)})).on(Lc.Disconnected,(e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)})).on(Lc.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Lc.DataPacketReceived,this.handleDataPacket).on(Lc.Resuming,(()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ep.SignalReconnecting)&&this.emit(jc.SignalReconnecting)})).on(Lc.Resumed,(()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ep.Connected)&&this.emit(jc.Reconnected)})).on(Lc.SignalResumed,(()=>{this.bufferedEvents=[],(this.state===Ep.Reconnecting||this.isResuming)&&this.sendSyncState()})).on(Lc.Restarting,this.handleRestarting).on(Lc.SignalRestarted,this.handleSignalRestarted).on(Lc.Offline,(()=>{this.setAndEmitConnectionState(Ep.Reconnecting)&&this.emit(jc.Reconnecting)})).on(Lc.DCBufferStatusChanged,((e,t)=>{this.emit(jc.DCBufferStatusChanged,e,t)})).on(Lc.LocalTrackSubscribed,(e=>{const t=this.localParticipant.getTrackPublications().find((t=>{let{trackSid:n}=t;return n===e}));t?(this.localParticipant.emit(Dc.LocalTrackSubscribed,t),this.emitWhenConnected(jc.LocalTrackSubscribed,t,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)})).on(Lc.RoomMoved,(e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach(((e,t)=>{this.handleParticipantDisconnected(t,e)})),this.emit(jc.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)})),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return md.getInstance().getDevices(e,t)}prepareConnection(e,t){return vl(this,void 0,void 0,(function*(){if(this.state===Ep.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Au(new URL(e))&&t){this.regionUrlProvider=new Mp(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===Ep.Disconnected&&(this.regionUrl=n,yield fetch(Ku(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(Ku(e),{method:"HEAD"})}catch(e){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:e}))}}}))}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return vl(this,void 0,void 0,(function*(){let n,i=()=>{};switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new Gs({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new Gs({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new Gs({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new Gs({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>vl(this,void 0,void 0,(function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")})),n=new Gs({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>vl(this,void 0,void 0,(function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")})),n=new Gs({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new Gs({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>vl(this,void 0,void 0,(function*(){const e=this.engine.client.onLeave;e&&e(new xs({reason:yr.CLIENT_INITIATED,action:Is.RECONNECT}))}));break;case"subscriber-bandwidth":if(void 0===t||"number"!=typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new Gs({scenario:{case:"subscriberBandwidth",value:Gu(t)}});break;case"leave-full-reconnect":n=new Gs({scenario:{case:"leaveRequestFullReconnect",value:!0}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())}))}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return vl(this,arguments,void 0,(function(e,t){var n=this;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function*(){var o,a,r,s,l,c,u;let d=!0,p=!1;const h=i?{exact:t}:t;if("audioinput"===e){p=0===n.localParticipant.audioTrackPublications.size;const t=null!==(o=n.getActiveDevice(e))&&void 0!==o?o:n.options.audioCaptureDefaults.deviceId;n.options.audioCaptureDefaults.deviceId=h;const i=Array.from(n.localParticipant.audioTrackPublications.values()).filter((e=>e.source===ou.Source.Microphone));try{d=(yield Promise.all(i.map((e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(h)})))).every((e=>!0===e))}catch(e){throw n.options.audioCaptureDefaults.deviceId=t,e}const a=i.some((e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n}));d&&a&&(p=!0)}else if("videoinput"===e){p=0===n.localParticipant.videoTrackPublications.size;const t=null!==(a=n.getActiveDevice(e))&&void 0!==a?a:n.options.videoCaptureDefaults.deviceId;n.options.videoCaptureDefaults.deviceId=h;const i=Array.from(n.localParticipant.videoTrackPublications.values()).filter((e=>e.source===ou.Source.Camera));try{d=(yield Promise.all(i.map((e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(h)})))).every((e=>!0===e))}catch(e){throw n.options.videoCaptureDefaults.deviceId=t,e}const o=i.some((e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n}));d&&o&&(p=!0)}else if("audiooutput"===e){if(p=!0,!Su()&&!n.options.webAudioMix||n.options.webAudioMix&&n.audioContext&&!("setSinkId"in n.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");n.options.webAudioMix&&(t=null!==(r=yield md.getInstance().normalizeDeviceId("audiooutput",t))&&void 0!==r?r:""),null!==(s=(u=n.options).audioOutput)&&void 0!==s||(u.audioOutput={});const i=null!==(l=n.getActiveDevice(e))&&void 0!==l?l:n.options.audioOutput.deviceId;n.options.audioOutput.deviceId=t;try{n.options.webAudioMix&&(null===(c=n.audioContext)||void 0===c||c.setSinkId(t)),yield Promise.all(Array.from(n.remoteParticipants.values()).map((e=>e.setAudioOutput({deviceId:t}))))}catch(e){throw n.options.audioOutput.deviceId=i,e}}return p&&(n.localParticipant.activeDeviceMap.set(e,t),n.emit(jc.ActiveDeviceChanged,e,t)),d}()}))}setupLocalParticipantEvents(){this.localParticipant.on(Dc.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Dc.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Dc.AttributesChanged,this.onLocalAttributesChanged).on(Dc.TrackMuted,this.onLocalTrackMuted).on(Dc.TrackUnmuted,this.onLocalTrackUnmuted).on(Dc.LocalTrackPublished,this.onLocalTrackPublished).on(Dc.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Dc.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Dc.MediaDevicesError,this.onMediaDevicesError).on(Dc.AudioStreamAcquired,this.startAudio).on(Dc.ChatMessage,this.onLocalChatMessageSent).on(Dc.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===Ep.Connecting||this.state===Ep.Reconnecting){const i=()=>{this.onTrackAdded(e,t,n),o()},o=()=>{this.off(jc.Reconnected,i),this.off(jc.Connected,i),this.off(jc.Disconnected,o)};return this.once(jc.Reconnected,i),this.once(jc.Connected,i),void this.once(jc.Disconnected,o)}if(this.state===Ep.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===e.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),o=i[0];let a=i[1],r=e.id;if(a&&a.startsWith("TR")&&(r=a),o===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const s=Array.from(this.remoteParticipants.values()).find((e=>e.sid===o));if(!s)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);let l;this.options.adaptiveStream&&(l="object"==typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),s.addSubscribedMediaTrack(e,r,t,n,l)}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Ep.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach((e=>{e.trackPublications.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.trackPublications.forEach((t=>{var n,i,o;t.track&&this.localParticipant.unpublishTrack(t.track,e),e?(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop()):null===(o=t.track)||void 0===o||o.stopMonitor()})),this.localParticipant.off(Dc.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Dc.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Dc.AttributesChanged,this.onLocalAttributesChanged).off(Dc.TrackMuted,this.onLocalTrackMuted).off(Dc.TrackUnmuted,this.onLocalTrackUnmuted).off(Dc.LocalTrackPublished,this.onLocalTrackPublished).off(Dc.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Dc.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Dc.MediaDevicesError,this.onMediaDevicesError).off(Dc.AudioStreamAcquired,this.startAudio).off(Dc.ChatMessage,this.onLocalChatMessageSent).off(Dc.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"==typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),xu()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ep.Disconnected),this.emit(jc.Disconnected,t)}}}handleParticipantDisconnected(e,t){var n;this.remoteParticipants.delete(e),t&&(t.trackPublications.forEach((e=>{t.unpublishTrack(e.trackSid,!0)})),this.emit(jc.ParticipantDisconnected,t),t.setDisconnected(),null===(n=this.localParticipant)||void 0===n||n.handleParticipantDisconnected(t.identity))}handleStreamHeader(e,t){return vl(this,void 0,void 0,(function*(){var n;if("byteHeader"===e.contentHeader.case){const i=this.byteStreamHandlers.get(e.topic);if(!i)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);let o;const a={id:e.streamId,name:null!==(n=e.contentHeader.value.name)&&void 0!==n?n:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Wu(e.timestamp),attributes:e.attributes},r=new ReadableStream({start:t=>{o=t,this.byteStreamControllers.set(e.streamId,{info:a,controller:o,startTime:Date.now()})}});i(new jp(a,r,Wu(e.totalLength)),{identity:t})}else if("textHeader"===e.contentHeader.case){const n=this.textStreamHandlers.get(e.topic);if(!n)return void this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);let i;const o={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},a=new ReadableStream({start:t=>{i=t,this.textStreamControllers.set(e.streamId,{info:o,controller:i,startTime:Date.now()})}});n(new Dp(o,a,Wu(e.totalLength)),{identity:t})}}))}handleStreamChunk(e){const t=this.byteStreamControllers.get(e.streamId);t&&e.content.length>0&&t.controller.enqueue(e);const n=this.textStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e)}handleStreamTrailer(e){const t=this.textStreamControllers.get(e.streamId);t&&(t.info.attributes=Object.assign(Object.assign({},t.info.attributes),e.attributes),t.controller.close(),this.textStreamControllers.delete(e.streamId));const n=this.byteStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.byteStreamControllers.delete(e.streamId))}selectDefaultDevices(){return vl(this,void 0,void 0,(function*(){var e,t,n;const i=md.getInstance().previousDevices,o=yield md.getInstance().getDevices(void 0,!1),a=Yc();if("Chrome"===(null==a?void 0:a.name)&&"iOS"!==a.os)for(let e of o){const t=i.find((t=>t.deviceId===e.deviceId));t&&""!==t.label&&t.kind===e.kind&&t.label!==e.label&&"default"===this.getActiveDevice(e.kind)&&this.emit(jc.ActiveDeviceChanged,e.kind,e.deviceId)}const r=["audiooutput","audioinput","videoinput"];for(let a of r){const r=rd(a),s=this.localParticipant.getTrackPublication(r);if(s&&(null===(e=s.track)||void 0===e?void 0:e.isUserProvided))continue;const l=o.filter((e=>e.kind===a)),c=this.getActiveDevice(a);c===(null===(t=i.filter((e=>e.kind===a))[0])||void 0===t?void 0:t.deviceId)&&l.length>0&&(null===(n=l[0])||void 0===n?void 0:n.deviceId)!==c?yield this.switchActiveDevice(a,l[0].deviceId):"audioinput"===a&&!Cu()||"videoinput"===a||!(l.length>0)||l.find((e=>e.deviceId===this.getActiveDevice(a)))||"audiooutput"===a&&Cu()||(yield this.switchActiveDevice(a,l[0].deviceId))}}))}acquireAudioContext(){return vl(this,void 0,void 0,(function*(){var e,t;if("boolean"!=typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=ad())&&void 0!==e?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach((e=>e.setAudioContext(this.audioContext))),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),vu(200)])}catch(e){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:e}))}const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(jc.AudioPlaybackStatusChanged,n))}))}createParticipant(e,t){var n;let i;return i=t?Zp.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new Zp(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch((e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext))),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const n=this.remoteParticipants.get(e);return t&&n.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),n}const n=this.createParticipant(e,t);return this.remoteParticipants.set(e,n),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(jc.ParticipantConnected,n),n.on(Dc.TrackPublished,(e=>{this.emitWhenConnected(jc.TrackPublished,e,n)})).on(Dc.TrackSubscribed,((e,t)=>{e.kind===ou.Kind.Audio?(e.on(Fc.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(Fc.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===ou.Kind.Video&&(e.on(Fc.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(Fc.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(jc.TrackSubscribed,e,t,n)})).on(Dc.TrackUnpublished,(e=>{this.emit(jc.TrackUnpublished,e,n)})).on(Dc.TrackUnsubscribed,((e,t)=>{this.emit(jc.TrackUnsubscribed,e,t,n)})).on(Dc.TrackMuted,(e=>{this.emitWhenConnected(jc.TrackMuted,e,n)})).on(Dc.TrackUnmuted,(e=>{this.emitWhenConnected(jc.TrackUnmuted,e,n)})).on(Dc.ParticipantMetadataChanged,(e=>{this.emitWhenConnected(jc.ParticipantMetadataChanged,e,n)})).on(Dc.ParticipantNameChanged,(e=>{this.emitWhenConnected(jc.ParticipantNameChanged,e,n)})).on(Dc.AttributesChanged,(e=>{this.emitWhenConnected(jc.ParticipantAttributesChanged,e,n)})).on(Dc.ConnectionQualityChanged,(e=>{this.emitWhenConnected(jc.ConnectionQualityChanged,e,n)})).on(Dc.ParticipantPermissionsChanged,(e=>{this.emitWhenConnected(jc.ParticipantPermissionsChanged,e,n)})).on(Dc.TrackSubscriptionStatusChanged,((e,t)=>{this.emitWhenConnected(jc.TrackSubscriptionStatusChanged,e,t,n)})).on(Dc.TrackSubscriptionFailed,((e,t)=>{this.emit(jc.TrackSubscriptionFailed,e,n,t)})).on(Dc.TrackSubscriptionPermissionChanged,((e,t)=>{this.emitWhenConnected(jc.TrackSubscriptionPermissionChanged,e,t,n)})).on(Dc.Active,(()=>{this.emitWhenConnected(jc.ParticipantActive,n),n.kind===Ir.AGENT&&this.localParticipant.setActiveAgent(n)})),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce(((e,t)=>(e.push(...t.getTrackPublications()),e)),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&ed(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=tu.setInterval((()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,yr.STATE_MISMATCH)))}),4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&tu.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(jc.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach((e=>{let[t,n]=e;this.emit(t,...n)})),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.state===Ep.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,n]);else if(this.state===Ep.Connected)return this.emit(e,...n);return!1}simulateParticipants(e){return vl(this,void 0,void 0,(function*(){var t,n;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new wr({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:ea.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Pr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(jc.SignalConnected),this.emit(jc.Connected),this.setAndEmitConnectionState(Ep.Connected),i.video){const e=new Gp(ou.Kind.Video,new _r({source:gr.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:hr.AUDIO,name:"video-dummy"}),new kp(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Uu(160*(null!==(t=o.aspectRatios[0])&&void 0!==t?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Dc.LocalTrackPublished,e)}if(i.audio){const e=new Gp(ou.Kind.Audio,new _r({source:gr.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:hr.AUDIO}),new lp(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Vu(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Dc.LocalTrackPublished,e)}for(let e=0;e<o.count-1;e+=1){let t=new Pr({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:xr.ACTIVE,tracks:[],joinedAt:ea.parse(Date.now())});const i=this.getOrCreateParticipant(t.identity,t);if(o.video){const a=Uu(160*(null!==(n=o.aspectRatios[e%o.aspectRatios.length])&&void 0!==n?n:1),160,!1,!0),r=new _r({source:gr.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:hr.AUDIO});i.addSubscribedMediaTrack(a,r.sid,new MediaStream([a]),new RTCRtpReceiver),t.tracks=[...t.tracks,r]}if(o.audio){const e=Vu(),n=new _r({source:gr.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:hr.AUDIO});i.addSubscribedMediaTrack(e,n.sid,new MediaStream([e]),new RTCRtpReceiver),t.tracks=[...t.tracks,n]}i.updateInfo(t)}}))}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==jc.ActiveSpeakersChanged&&e!==jc.TranscriptionReceived){const t=eh(n).filter((e=>void 0!==e));this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function eh(e){return e.map((e=>{if(e)return Array.isArray(e)?eh(e):"object"==typeof e?"logContext"in e?e.logContext:void 0:e}))}Xp.cleanupRegistry="undefined"!=typeof FinalizationRegistry&&new FinalizationRegistry((e=>{e()})),function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Op||(Op={})),Sl.EventEmitter,Sl.EventEmitter,new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]),function(e){for(const t of pl)t.setLevel(e)}("error");class th{static API_BASE_URL="https://api.palabra.ai";room=null;eventHandlers={};conversationItems=[];isConnectedState=!1;sessionConfig=null;currentSessionConfig=null;currentSessionId=null;audioContext=null;audioDestination=null;customAudioTrack=null;hiddenAudioElement=null;remoteAudioContext=null;remoteAudioSource=null;remoteAudioWorkletNode=null;remoteAudioStream=null;constructor(e,t){this.clientId=e,this.clientSecret=t,this.instanceId=`palabra_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static async validateApiKey(e,t){try{if(!e||""===e.trim()||!t||""===t.trim())return{valid:!1,message:Ee.t("settings.errorValidatingApiKey"),validating:!1};const n=await fetch(`${this.API_BASE_URL}/session-storage/sessions`,{method:"GET",headers:{Accept:"application/json",ClientId:e,ClientSecret:t}});if(console.info("[Sokuji] [PalabraAIClient] Validating credentials via sessions API, response status:",n.status),!n.ok){const e=await n.json().catch((()=>({})));return console.warn("[Sokuji] [PalabraAIClient] Validation failed:",e),{valid:!1,message:e.error?.message||Ee.t("settings.errorValidatingApiKey"),validating:!1}}const i=await n.json();return console.info("[Sokuji] [PalabraAIClient] Credentials validation successful, sessions retrieved:",i.sessions?.length||0),{valid:!0,message:Ee.t("settings.apiKeyValidated")+" "+Ee.t("settings.realtimeTranslationAvailable","Realtime translation service is available"),validating:!1}}catch(e){return console.error("[Sokuji] [PalabraAIClient] Validation error:",e),{valid:!1,message:e.message||Ee.t("settings.errorValidatingApiKey"),validating:!1}}}async connect(e){if(console.info("[Sokuji] [PalabraAIClient] Connecting to PalabraAI",e),!function(e){return"palabraai"===e.provider}(e))throw new Error("PalabraAIClient requires PalabraAISessionConfig");try{this.currentSessionConfig=e,await this.cleanupExistingSessions(),await this.createSession(),await this.connectToRoom(),await this.setupAudio(),await this.startTranslation(),this.isConnectedState=!0,console.info("[Sokuji] [PalabraAIClient] Connected successfully")}catch(e){throw console.error("[Sokuji] [PalabraAIClient] Connection error:",e),e}}async disconnect(){try{if(this.room&&this.isConnectedState)try{const e={message_type:"end_task",data:{}},t=JSON.stringify(e),n=(new TextEncoder).encode(t);this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"end_task",data:e}}),await this.room.localParticipant.publishData(n,{reliable:!0}),console.info("[Sokuji] [PalabraAIClient] End task sent")}catch(e){console.warn("[Sokuji] [PalabraAIClient] Error sending end_task:",e)}this.currentSessionId&&(await this.deleteSession(this.currentSessionId),this.currentSessionId=null),this.cleanupAudio(),this.cleanupRemoteAudio(),this.room&&(await this.room.disconnect(),this.room=null),this.isConnectedState=!1,this.sessionConfig=null,this.conversationItems=[],console.info("[Sokuji] [PalabraAIClient] Disconnected successfully")}catch(e){throw console.error("[Sokuji] [PalabraAIClient] Disconnect error:",e),e}}isConnected(){return this.isConnectedState&&null!==this.room}updateSession(e){this.currentSessionConfig&&(e.provider&&"palabraai"!==e.provider||(this.currentSessionConfig={...this.currentSessionConfig,...e}))}reset(){this.conversationItems=[]}appendInputAudio(e){if(this.audioContext&&this.audioDestination)try{const t=e;let n;if(t instanceof Float32Array){n=new Int16Array(t.length);for(let e=0;e<t.length;e++)n[e]=Math.max(-32768,Math.min(32767,32767*t[e]))}else if(t instanceof Int16Array)n=t;else if(t instanceof ArrayBuffer)n=new Int16Array(t);else{if(!(t&&"object"==typeof t&&t.buffer instanceof ArrayBuffer))return void console.warn("[Sokuji] [PalabraAIClient] Invalid audio data type:",typeof t,t);n=new Int16Array(t.buffer,t.byteOffset,t.byteLength/2)}if(!n||0===n.length)return void console.warn("[Sokuji] [PalabraAIClient] Empty audio data received");const i=this.audioContext.createBuffer(1,n.length,24e3),o=i.getChannelData(0);for(let e=0;e<n.length;e++)o[e]=n[e]/32768;const a=this.audioContext.createBufferSource();a.buffer=i,a.connect(this.audioDestination),a.start()}catch(e){console.error("[Sokuji] [PalabraAIClient] Error processing audio data:",e)}else console.warn("[Sokuji] [PalabraAIClient] Audio context not initialized")}createResponse(){}cancelResponse(e,t){}getConversationItems(){return[...this.conversationItems]}setEventHandlers(e){this.eventHandlers=e}getProvider(){return At.PALABRA_AI}async createSession(){const e=await fetch(`${th.API_BASE_URL}/session-storage/session`,{method:"POST",headers:{"Content-Type":"application/json",ClientId:this.clientId,ClientSecret:this.clientSecret},body:JSON.stringify({data:{subscriber_count:0,intent:"api"}})});if(!e.ok)throw new Error(`Failed to create session: ${e.statusText}`);const t=await e.json();this.sessionConfig=t.data,this.currentSessionId=this.sessionConfig?.id||null,console.info("[Sokuji] [PalabraAIClient] Session created:",this.sessionConfig)}async connectToRoom(){if(!this.sessionConfig)throw new Error("No session configuration available");this.room=new Xp,this.room.on(jc.TrackSubscribed,this.handleTrackSubscribed.bind(this)),this.room.on(jc.DataReceived,this.handleDataReceived.bind(this)),this.room.on(jc.Connected,this.handleRoomConnected.bind(this)),this.room.on(jc.Disconnected,this.handleRoomDisconnected.bind(this)),await this.room.connect(this.sessionConfig.webrtc_url,this.sessionConfig.publisher),console.info("[Sokuji] [PalabraAIClient] Connected to WebRTC room")}async setupAudio(){if(!this.room)throw new Error("Room not connected");this.audioContext=new AudioContext({sampleRate:24e3}),this.audioDestination=this.audioContext.createMediaStreamDestination();const e=this.audioDestination.stream.getAudioTracks()[0];if(!e)throw new Error("Failed to create audio track from MediaStreamAudioDestinationNode");this.customAudioTrack=new lp(e,void 0,!0,this.audioContext),await this.room.localParticipant.publishTrack(this.customAudioTrack,{dtx:!1,red:!1,audioPreset:{maxBitrate:32e3,priority:"high"}}),console.info("[Sokuji] [PalabraAIClient] Custom audio setup complete")}async startTranslation(){if(!this.room||!this.currentSessionConfig)throw new Error("Room not connected or configuration missing");const e={message_type:"set_task",data:{input_stream:{content_type:"audio",source:{type:"webrtc"}},output_stream:{content_type:"audio",target:{type:"webrtc"}},pipeline:{transcription:{source_language:this.currentSessionConfig.sourceLanguage,detectable_languages:[],segment_confirmation_silence_threshold:this.currentSessionConfig.segmentConfirmationSilenceThreshold,sentence_splitter:{enabled:this.currentSessionConfig.sentenceSplitterEnabled},verification:{auto_transcription_correction:!1,transcription_correction_style:null}},translations:[{target_language:this.currentSessionConfig.targetLanguage,translate_partial_transcriptions:this.currentSessionConfig.translatePartialTranscriptions,speech_generation:{voice_cloning:!1,voice_id:this.currentSessionConfig.voiceId,voice_timbre_detection:{enabled:!0,high_timbre_voices:["default_high"],low_timbre_voices:["default_low"]}}}],translation_queue_configs:{global:{desired_queue_level_ms:this.currentSessionConfig.desiredQueueLevelMs,max_queue_level_ms:this.currentSessionConfig.maxQueueLevelMs,auto_tempo:this.currentSessionConfig.autoTempo}},allowed_message_types:["translated_transcription","partial_transcription","partial_translated_transcription","validated_transcription"]}}},t=JSON.stringify(e),n=(new TextEncoder).encode(t);this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"set_task",data:e}}),await this.room.localParticipant.publishData(n,{reliable:!0}),console.info("[Sokuji] [PalabraAIClient] Translation started with config:",e)}handleTrackSubscribed(e,t,i){if(console.info("[Sokuji] [PalabraAIClient] Track subscribed:",e.kind),this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"session.opened",data:{trackKind:e.kind,participantSid:i.sid,participantIdentity:i.identity,publicationSource:t.source,trackSid:e.sid}}}),"audio"===e.kind){const t=e;this.hiddenAudioElement=t.attach(),this.hiddenAudioElement.muted=!0,this.hiddenAudioElement.volume=0,this.hiddenAudioElement.style.display="none",document.body.appendChild(this.hiddenAudioElement),(async()=>{try{const e=new MediaStream([t.mediaStreamTrack]);this.remoteAudioStream=e,this.remoteAudioContext=new AudioContext({sampleRate:24e3});const i="undefined"!=typeof window&&void 0!==window.chrome&&void 0!==window.chrome.runtime&&"function"==typeof window.chrome.runtime.getURL?window.chrome.runtime.getURL("worklets/palabra-audio-worklet-processor.js"):new URL(n(7464),n.b).href;await this.remoteAudioContext.audioWorklet.addModule(i),this.remoteAudioWorkletNode=new AudioWorkletNode(this.remoteAudioContext,"palabra-pcm-processor"),this.remoteAudioSource=this.remoteAudioContext.createMediaStreamSource(e),this.remoteAudioSource.connect(this.remoteAudioWorkletNode),this.remoteAudioWorkletNode.connect(this.remoteAudioContext.destination),this.remoteAudioWorkletNode.port.onmessage=e=>{const t=e.data;this.eventHandlers.onConversationUpdated?.({item:{id:this.instanceId,role:"assistant",type:"message",status:"in_progress",formatted:{audio:t}},delta:{audio:t}})}}catch(e){console.error("[Sokuji] [PalabraAIClient] Failed to set up audio worklet:",e)}})()}}handleDataReceived(e){const t=(new TextDecoder).decode(e);try{const e=JSON.parse(t);if(this.isQueueStatusMessage(e))return;switch(e.message_type){case"translated_transcription":this.handleTranslatedTranscription(e.data);break;case"partial_transcription":this.handlePartialTranscription(e.data);break;case"partial_translated_transcription":this.handlePartialTranslatedTranscription(e.data);break;case"validated_transcription":this.handleValidatedTranscription(e.data);break;case"error":this.handleError(e.data);break;default:this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"error",data:e}})}}catch(e){console.error("[Sokuji] [PalabraAIClient] Error parsing data:",e),this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"error",data:{error:e.message,rawMessage:t}}})}}isQueueStatusMessage(e){if(!e||"object"!=typeof e)return!1;const t=Object.keys(e);return 0!==t.length&&(!!t.every((e=>"string"==typeof e&&e.length>=2&&e.length<=3&&/^[a-z]+$/.test(e)))&&t.every((t=>{const n=e[t];return n&&"object"==typeof n&&(n.hasOwnProperty("current_queue_level_ms")||n.hasOwnProperty("max_queue_level_ms"))})))}handleTranslatedTranscription(e){const t="string"==typeof e?JSON.parse(e):e,n=t.transcription?.text||"",i=t.transcription?.transcription_id||`fallback_${Date.now()}`;if(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"translated_transcription",data:t}}),n){const e=`translated_${i}`;if(!this.conversationItems.find((t=>t.id===e))){const t={id:e,role:"assistant",type:"message",status:"completed",formatted:{transcript:n}};this.conversationItems.push(t),this.eventHandlers.onConversationUpdated?.({item:t})}}}handlePartialTranscription(e){const t="string"==typeof e?JSON.parse(e):e,n=t.transcription?.text||"",i=t.transcription?.transcription_id||`fallback_${Date.now()}`;if(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"partial_transcription",data:t}}),n){const e=`validated_${i}`,t=this.conversationItems.find((t=>t.id===e));if(t)return;const o=`partial_${i}`;let a=this.conversationItems.find((e=>e.id===o));a?(a.formatted={transcript:n},a.status="in_progress",this.eventHandlers.onConversationUpdated?.({item:a})):(a={id:o,role:"user",type:"message",status:"in_progress",formatted:{transcript:n}},this.conversationItems.push(a),this.eventHandlers.onConversationUpdated?.({item:a}))}}handlePartialTranslatedTranscription(e){const t="string"==typeof e?JSON.parse(e):e,n=t.transcription?.text||"",i=t.transcription?.transcription_id||`fallback_${Date.now()}`;if(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"partial_translated_transcription",data:t}}),n){const e=`translated_${i}`,t=this.conversationItems.find((t=>t.id===e));if(t)return;const o=`partial_translated_${i}`;let a=this.conversationItems.find((e=>e.id===o));a?(a.formatted={transcript:n},a.status="in_progress",this.eventHandlers.onConversationUpdated?.({item:a})):(a={id:o,role:"assistant",type:"message",status:"in_progress",formatted:{transcript:n}},this.conversationItems.push(a),this.eventHandlers.onConversationUpdated?.({item:a}))}}handleValidatedTranscription(e){const t="string"==typeof e?JSON.parse(e):e,n=t.transcription?.text||"",i=t.transcription?.transcription_id||`fallback_${Date.now()}`;if(this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"validated_transcription",data:t}}),n){const e=`partial_${i}`,t=`validated_${i}`;if(!this.conversationItems.find((e=>e.id===t))){const i=this.conversationItems.find((t=>t.id===e&&"in_progress"===t.status));if(i)i.status="completed",i.id=t,i.formatted={transcript:n},this.eventHandlers.onConversationUpdated?.({item:i});else{const e={id:t,role:"user",type:"message",status:"completed",formatted:{transcript:n}};this.conversationItems.push(e),this.eventHandlers.onConversationUpdated?.({item:e})}}}}handleError(e){const t="string"==typeof e?JSON.parse(e):e;this.eventHandlers.onRealtimeEvent?.({source:"server",event:{type:"error",data:t}}),console.error("[Sokuji] [PalabraAIClient] Received error:",t)}handleRoomConnected(){console.info("[Sokuji] [PalabraAIClient] Room connected"),this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.opened",data:{sessionId:this.currentSessionId}}}),this.eventHandlers.onOpen&&this.eventHandlers.onOpen()}handleRoomDisconnected(){console.info("[Sokuji] [PalabraAIClient] Room disconnected"),this.eventHandlers.onRealtimeEvent?.({source:"client",event:{type:"session.closed",data:{sessionId:this.currentSessionId}}}),this.eventHandlers.onClose&&this.eventHandlers.onClose(null)}cleanupAudio(){this.audioDestination&&(this.audioDestination.disconnect(),this.audioDestination=null),this.customAudioTrack&&(this.customAudioTrack.stop(),this.customAudioTrack=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.cleanupRemoteAudio()}async getUserSessions(){try{const e=await fetch(`${th.API_BASE_URL}/session-storage/sessions`,{method:"GET",headers:{Accept:"application/json",ClientId:this.clientId,ClientSecret:this.clientSecret}});if(!e.ok)return console.warn("[Sokuji] [PalabraAIClient] Failed to get sessions:",e.statusText),[];const t=await e.json();let n=[];if(t&&Array.isArray(t))n=t;else if(t&&t.data&&Array.isArray(t.data))n=t.data;else if(t&&t.sessions)n=t.sessions;else{if(!(t&&t.data&&"sessions"in t.data))return console.warn("[Sokuji] [PalabraAIClient] Unexpected response structure:",t),[];n=t.data.sessions}return console.info("[Sokuji] [PalabraAIClient] Retrieved existing sessions:",(n||[]).length),n||[]}catch(e){return console.error("[Sokuji] [PalabraAIClient] Error getting sessions:",e),[]}}async deleteSession(e){try{const t=await fetch(`${th.API_BASE_URL}/session-storage/sessions/${e}`,{method:"DELETE",headers:{ClientId:this.clientId,ClientSecret:this.clientSecret}});t.ok||204===t.status?console.info("[Sokuji] [PalabraAIClient] Session deleted successfully:",e):console.warn("[Sokuji] [PalabraAIClient] Failed to delete session:",e,t.statusText)}catch(t){console.error("[Sokuji] [PalabraAIClient] Error deleting session:",e,t)}}async cleanupExistingSessions(){try{const e=await this.getUserSessions();if(!e||!Array.isArray(e)||0===e.length)return void console.info("[Sokuji] [PalabraAIClient] No existing sessions to clean up");console.info("[Sokuji] [PalabraAIClient] Cleaning up existing sessions:",e.length);const t=e.map((e=>e&&e.id?this.deleteSession(e.id):(console.warn("[Sokuji] [PalabraAIClient] Invalid session object:",e),Promise.resolve())));await Promise.all(t),console.info("[Sokuji] [PalabraAIClient] Cleanup completed")}catch(e){console.error("[Sokuji] [PalabraAIClient] Error during cleanup:",e)}}cleanupRemoteAudio(){this.hiddenAudioElement&&(this.hiddenAudioElement.remove(),this.hiddenAudioElement=null),this.remoteAudioWorkletNode&&(this.remoteAudioWorkletNode.port.onmessage=null,this.remoteAudioWorkletNode.disconnect(),this.remoteAudioWorkletNode=null),this.remoteAudioSource&&(this.remoteAudioSource.disconnect(),this.remoteAudioSource=null),this.remoteAudioContext&&(this.remoteAudioContext.close(),this.remoteAudioContext=null),this.remoteAudioStream=null}}class nh{static async validateApiKeyAndFetchModels(e,t,n){switch(t){case At.OPENAI:return await Nt.validateApiKeyAndFetchModels(e);case At.COMET_API:return await Nt.validateApiKeyAndFetchModels(e,"https://api.cometapi.com");case At.GEMINI:return await Oo.validateApiKeyAndFetchModels(e);case At.PALABRA_AI:if(!n||!e)throw new Error(`Client id and Client secret are required for ${t} provider`);return{validation:await th.validateApiKey(e,n),models:[{id:"realtime-translation",type:"realtime",created:Date.now()/1e3}]};default:throw new Error(`Unsupported provider: ${t}`)}}static getLatestRealtimeModel(e,t){switch(t){case At.OPENAI:case At.COMET_API:return Nt.getLatestRealtimeModel(e);case At.GEMINI:return Oo.getLatestRealtimeModel(e);case At.PALABRA_AI:return"realtime-translation";default:throw new Error(`Unsupported provider: ${t}`)}}static getSupportedProviders(){return Et}static isSupportedProvider(e){return Et.includes(e)}}class ih{async getSetting(e,t){try{return await window.electron.config.get(e,t)}catch(n){return console.error(`[Sokuji] [ElectronSettings] Error getting setting ${e}:`,n),t}}async setSetting(e,t){try{return await window.electron.config.set(e,t),{success:!0,message:Ee.t("settings.settingSavedSuccessfully",{key:e})}}catch(t){return{success:!1,error:t.message||Ee.t("settings.failedToSaveSetting",{key:e})}}}async loadAllSettings(e){try{const t={...e};for(const n of Object.keys(e)){const i=`settings.${n}`,o=e[n];t[n]=await this.getSetting(i,o)}return t}catch(t){return console.error("[Sokuji] [ElectronSettings] Error loading all settings:",t),e}}async saveAllSettings(e){try{for(const t of Object.keys(e)){const n=`settings.${t}`,i=e[t];await this.setSetting(n,i)}return{success:!0,message:Ee.t("settings.settingsSavedSuccessfully")}}catch(e){return{success:!1,error:e.message||Ee.t("settings.failedToSaveSettings")}}}async getSettingsPath(){try{return await window.electron.config.getPath()}catch(e){return console.error("[Sokuji] [ElectronSettings] Error getting settings path:",e),{configDir:"",configFile:""}}}async validateApiKeyAndFetchModels(e,t,n){try{return await nh.validateApiKeyAndFetchModels(e,t,n)}catch(e){return console.error(`[Sokuji] [ElectronSettings] Error validating API key and fetching models for ${t}:`,e),{validation:{valid:!1,message:e.message||"Validation failed",validating:!1},models:[]}}}}class oh{async getSetting(e,t){try{return new Promise((n=>{chrome.storage.sync.get(e,(i=>{chrome.runtime.lastError?(console.error(`[Sokuji] [BrowserSettings] Error getting setting ${e}:`,chrome.runtime.lastError),n(t)):n(void 0!==i[e]?i[e]:t)}))}))}catch(n){return console.error(`[Sokuji] [BrowserSettings] Error getting setting ${e}:`,n),t}}async setSetting(e,t){try{return new Promise((n=>{chrome.storage.sync.set({[e]:t},(()=>{chrome.runtime.lastError?n({success:!1,error:chrome.runtime.lastError.message||Ee.t("settings.failedToSaveSetting",{key:e})}):n({success:!0,message:Ee.t("settings.settingSavedSuccessfully",{key:e})})}))}))}catch(t){return{success:!1,error:t.message||Ee.t("settings.failedToSaveSetting",{key:e})}}}async loadAllSettings(e){try{const t=Object.keys(e).map((e=>`settings.${e}`));return new Promise((n=>{chrome.storage.sync.get(t,(t=>{if(chrome.runtime.lastError)console.error("[Sokuji] [BrowserSettings] Error loading all settings:",chrome.runtime.lastError),n(e);else{const i={...e};for(const n of Object.keys(e)){const o=`settings.${n}`,a=e[n];i[n]=void 0!==t[o]?t[o]:a}n(i)}}))}))}catch(t){return console.error("[Sokuji] [BrowserSettings] Error loading all settings:",t),e}}async saveAllSettings(e){try{const t={};for(const n of Object.keys(e))t[`settings.${n}`]=e[n];return new Promise((e=>{chrome.storage.sync.set(t,(()=>{chrome.runtime.lastError?e({success:!1,error:chrome.runtime.lastError.message||Ee.t("settings.failedToSaveSettings")}):e({success:!0,message:Ee.t("settings.settingsSavedSuccessfully")})}))}))}catch(e){return{success:!1,error:e.message||Ee.t("settings.failedToSaveSettings")}}}async getSettingsPath(){return{configDir:"chrome-storage",configFile:"sync-storage"}}async validateApiKeyAndFetchModels(e,t,n){try{return await nh.validateApiKeyAndFetchModels(e,t,n)}catch(e){return console.error(`[Sokuji] [BrowserSettings] Error validating API key and fetching models for ${t}:`,e),{validation:{valid:!1,message:e.message||"Validation failed",validating:!1},models:[]}}}}class ah{static audioServiceInstance=null;static settingsServiceInstance=null;static isElectron(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}static isBrowserExtension(){return!("undefined"==typeof chrome||void 0===chrome.runtime||!chrome.runtime.id)||!("undefined"==typeof browser||void 0===browser.runtime||!browser.runtime.id)}static getAudioService(){return ah.audioServiceInstance||(ah.isElectron()?(console.info("[Sokuji] [ServiceFactory] Creating Electron audio service"),ah.audioServiceInstance=new vt):(console.info("[Sokuji] [ServiceFactory] Creating Browser audio service"),ah.audioServiceInstance=new bt)),ah.audioServiceInstance}static getSettingsService(){return ah.settingsServiceInstance||(ah.isElectron()?(console.info("[Sokuji] [ServiceFactory] Creating Electron settings service"),ah.settingsServiceInstance=new ih):(console.info("[Sokuji] [ServiceFactory] Creating Browser settings service"),ah.settingsServiceInstance=new oh)),ah.settingsServiceInstance}}class rh{static LANGUAGES=[{name:"",value:"ar",englishName:"Arabic"},{name:"",value:"am",englishName:"Amharic"},{name:"",value:"bg",englishName:"Bulgarian"},{name:"",value:"bn",englishName:"Bengali"},{name:"Catal",value:"ca",englishName:"Catalan"},{name:"etina",value:"cs",englishName:"Czech"},{name:"Dansk",value:"da",englishName:"Danish"},{name:"Deutsch",value:"de",englishName:"German"},{name:"",value:"el",englishName:"Greek"},{name:"English",value:"en",englishName:"English"},{name:"English (Australia)",value:"en_AU",englishName:"English (Australia)"},{name:"English (Great Britain)",value:"en_GB",englishName:"English (Great Britain)"},{name:"English (USA)",value:"en_US",englishName:"English (USA)"},{name:"Espaol",value:"es",englishName:"Spanish"},{name:"Espaol (Latinoamrica)",value:"es_419",englishName:"Spanish (Latin America and Caribbean)"},{name:"Eesti",value:"et",englishName:"Estonian"},{name:"",value:"fa",englishName:"Persian"},{name:"Suomi",value:"fi",englishName:"Finnish"},{name:"Filipino",value:"fil",englishName:"Filipino"},{name:"Franais",value:"fr",englishName:"French"},{name:"",value:"gu",englishName:"Gujarati"},{name:"",value:"he",englishName:"Hebrew"},{name:"",value:"hi",englishName:"Hindi"},{name:"Hrvatski",value:"hr",englishName:"Croatian"},{name:"Magyar",value:"hu",englishName:"Hungarian"},{name:"Bahasa Indonesia",value:"id",englishName:"Indonesian"},{name:"Italiano",value:"it",englishName:"Italian"},{name:"",value:"ja",englishName:"Japanese"},{name:"",value:"kn",englishName:"Kannada"},{name:"",value:"ko",englishName:"Korean"},{name:"Lietuvi",value:"lt",englishName:"Lithuanian"},{name:"Latvieu",value:"lv",englishName:"Latvian"},{name:"",value:"ml",englishName:"Malayalam"},{name:"",value:"mr",englishName:"Marathi"},{name:"Bahasa Melayu",value:"ms",englishName:"Malay"},{name:"Nederlands",value:"nl",englishName:"Dutch"},{name:"Norsk",value:"no",englishName:"Norwegian"},{name:"Polski",value:"pl",englishName:"Polish"},{name:"Portugus (Brasil)",value:"pt_BR",englishName:"Portuguese (Brazil)"},{name:"Portugus (Portugal)",value:"pt_PT",englishName:"Portuguese (Portugal)"},{name:"Romn",value:"ro",englishName:"Romanian"},{name:"",value:"ru",englishName:"Russian"},{name:"Slovenina",value:"sk",englishName:"Slovak"},{name:"Slovenina",value:"sl",englishName:"Slovenian"},{name:"",value:"sr",englishName:"Serbian"},{name:"Svenska",value:"sv",englishName:"Swedish"},{name:"Kiswahili",value:"sw",englishName:"Swahili"},{name:"",value:"ta",englishName:"Tamil"},{name:"",value:"te",englishName:"Telugu"},{name:"",value:"th",englishName:"Thai"},{name:"Trke",value:"tr",englishName:"Turkish"},{name:"",value:"uk",englishName:"Ukrainian"},{name:"Ting Vit",value:"vi",englishName:"Vietnamese"},{name:" ()",value:"zh_CN",englishName:"Chinese (China)"},{name:" ()",value:"zh_TW",englishName:"Chinese (Taiwan)"}];static VOICES=[{name:"Alloy",value:"alloy"},{name:"Ash",value:"ash"},{name:"Ballad",value:"ballad"},{name:"Coral",value:"coral"},{name:"Echo",value:"echo"},{name:"Sage",value:"sage"},{name:"Shimmer",value:"shimmer"},{name:"Verse",value:"verse"}];static MODELS=[{id:"gpt-4o-realtime-preview",type:"realtime"},{id:"gpt-4o-mini-realtime-preview",type:"realtime"}];getConfig(){return{id:"openai",displayName:"OpenAI",apiKeyLabel:"OpenAI API Key",apiKeyPlaceholder:"Enter your OpenAI API key",languages:rh.LANGUAGES,voices:rh.VOICES,models:rh.MODELS,noiseReductionModes:["None","Near field","Far field"],transcriptModels:["gpt-4o-mini-transcribe","gpt-4o-transcribe","whisper-1"],capabilities:{hasTemplateMode:!0,hasTurnDetection:!0,hasVoiceSettings:!0,hasNoiseReduction:!0,hasModelConfiguration:!0,turnDetection:{modes:["Normal","Semantic","Disabled"],hasThreshold:!0,hasPrefixPadding:!0,hasSilenceDuration:!0,hasSemanticEagerness:!0},temperatureRange:{min:.6,max:1.2,step:.01},maxTokensRange:{min:1,max:4096,step:1}},defaults:{model:"gpt-4o-realtime-preview",voice:"alloy",temperature:.8,maxTokens:4096,sourceLanguage:"en",targetLanguage:"zh_CN",turnDetectionMode:"Normal",threshold:.5,prefixPadding:.3,silenceDuration:.8,semanticEagerness:"Auto",noiseReduction:"None",transcriptModel:"gpt-4o-mini-transcribe"}}}}class sh{static LANGUAGES=[{name:"English (United States)",value:"en-US",englishName:"English (United States)"},{name:"English (Australia)",value:"en-AU",englishName:"English (Australia)"},{name:"English (United Kingdom)",value:"en-GB",englishName:"English (United Kingdom)"},{name:"English (India)",value:"en-IN",englishName:"English (India)"},{name:"Espaol (Estados Unidos)",value:"es-US",englishName:"Spanish (United States)"},{name:"Deutsch (Deutschland)",value:"de-DE",englishName:"German (Germany)"},{name:"Franais (France)",value:"fr-FR",englishName:"French (France)"},{name:" ()",value:"hi-IN",englishName:"Hindi (India)"},{name:"Portugus (Brasil)",value:"pt-BR",englishName:"Portuguese (Brazil)"},{name:" ()",value:"ar-XA",englishName:"Arabic (Standard)"},{name:"Espaol (Espaa)",value:"es-ES",englishName:"Spanish (Spain)"},{name:"Franais (Canada)",value:"fr-CA",englishName:"French (Canada)"},{name:"Bahasa Indonesia (Indonesia)",value:"id-ID",englishName:"Indonesian (Indonesia)"},{name:"Italiano (Italia)",value:"it-IT",englishName:"Italian (Italy)"},{name:" ()",value:"ja-JP",englishName:"Japanese (Japan)"},{name:"Trke (Trkiye)",value:"tr-TR",englishName:"Turkish (Turkey)"},{name:"Ting Vit (Vit Nam)",value:"vi-VN",englishName:"Vietnamese (Vietnam)"},{name:" ()",value:"bn-IN",englishName:"Bengali (India)"},{name:" ()",value:"gu-IN",englishName:"Gujarati (India)"},{name:" ()",value:"kn-IN",englishName:"Kannada (India)"},{name:" ()",value:"ml-IN",englishName:"Malayalam (India)"},{name:" ()",value:"mr-IN",englishName:"Marathi (India)"},{name:" ()",value:"ta-IN",englishName:"Tamil (India)"},{name:" ()",value:"te-IN",englishName:"Telugu (India)"},{name:"Nederlands (Belgi)",value:"nl-BE",englishName:"Dutch (Belgium)"},{name:"Nederlands (Nederland)",value:"nl-NL",englishName:"Dutch (Netherlands)"},{name:" ()",value:"ko-KR",englishName:"Korean (South Korea)"},{name:" ()",value:"cmn-CN",englishName:"Mandarin Chinese (China)"},{name:"Polski (Polska)",value:"pl-PL",englishName:"Polish (Poland)"},{name:" ()",value:"ru-RU",englishName:"Russian (Russia)"},{name:"Kiswahili (Kenya)",value:"sw-KE",englishName:"Swahili (Kenya)"},{name:" ()",value:"th-TH",englishName:"Thai (Thailand)"},{name:" ()",value:"ur-IN",englishName:"Urdu (India)"},{name:" ()",value:"uk-UA",englishName:"Ukrainian (Ukraine)"}];static VOICES=[{name:"Aoede",value:"Aoede"},{name:"Puck",value:"Puck"},{name:"Charon",value:"Charon"},{name:"Kore",value:"Kore"},{name:"Fenrir",value:"Fenrir"},{name:"Leda",value:"Leda"},{name:"Orus",value:"Orus"},{name:"Zephyr",value:"Zephyr"},{name:"Achird",value:"Achird"},{name:"Algenib",value:"Algenib"},{name:"Algieba",value:"Algieba"},{name:"Alnilam",value:"Alnilam"},{name:"Autonoe",value:"Autonoe"},{name:"Callirrhoe",value:"Callirrhoe"},{name:"Despina",value:"Despina"},{name:"Enceladus",value:"Enceladus"},{name:"Erinome",value:"Erinome"},{name:"Gacrux",value:"Gacrux"},{name:"Iapetus",value:"Iapetus"},{name:"Laomedeia",value:"Laomedeia"},{name:"Pulcherrima",value:"Pulcherrima"},{name:"Rasalgethi",value:"Rasalgethi"},{name:"Sadachbia",value:"Sadachbia"},{name:"Sadaltager",value:"Sadaltager"},{name:"Schedar",value:"Schedar"},{name:"Sulafat",value:"Sulafat"},{name:"Umbriel",value:"Umbriel"},{name:"Vindemiatrix",value:"Vindemiatrix"},{name:"Zubenelgenubi",value:"Zubenelgenubi"},{name:"Achernar",value:"Achernar"}];static MODELS=[{id:"gemini-2.0-flash-live-001",type:"realtime"},{id:"gemini-2.5-flash-preview-native-audio-dialog",type:"realtime"}];getConfig(){return{id:"gemini",displayName:"Gemini",apiKeyLabel:"Gemini API Key",apiKeyPlaceholder:"Enter your Gemini API key",languages:sh.LANGUAGES,voices:sh.VOICES,models:sh.MODELS,noiseReductionModes:[],transcriptModels:[],capabilities:{hasTemplateMode:!0,hasTurnDetection:!1,hasVoiceSettings:!0,hasNoiseReduction:!1,hasModelConfiguration:!0,turnDetection:{modes:[],hasThreshold:!1,hasPrefixPadding:!1,hasSilenceDuration:!1,hasSemanticEagerness:!1},temperatureRange:{min:0,max:2,step:.1},maxTokensRange:{min:1,max:8192,step:1}},defaults:{model:"gemini-2.0-flash-live-001",voice:"Aoede",temperature:1,maxTokens:8192,sourceLanguage:"en-US",targetLanguage:"ja-JP",turnDetectionMode:"Auto",threshold:.5,prefixPadding:0,silenceDuration:0,semanticEagerness:"Auto",noiseReduction:"None",transcriptModel:"auto"}}}}class lh extends rh{getConfig(){return{...super.getConfig(),id:At.COMET_API,displayName:"CometAPI",apiKeyLabel:"CometAPI Key",apiKeyPlaceholder:"Enter your CometAPI key..."}}}class ch{static SOURCE_LANGUAGES=[{name:"",value:"ar",englishName:"Arabic"},{name:" ",value:"ba",englishName:"Bashkir"},{name:"",value:"be",englishName:"Belarusian"},{name:"",value:"bg",englishName:"Bulgarian"},{name:"",value:"bn",englishName:"Bengali"},{name:"Catal",value:"ca",englishName:"Catalan"},{name:"",value:"zh",englishName:"Chinese"},{name:"etina",value:"cs",englishName:"Czech"},{name:"Cymraeg",value:"cy",englishName:"Welsh"},{name:"Dansk",value:"da",englishName:"Danish"},{name:"Deutsch",value:"de",englishName:"German"},{name:"",value:"el",englishName:"Greek"},{name:"English",value:"en",englishName:"English"},{name:"Esperanto",value:"eo",englishName:"Esperanto"},{name:"Espaol",value:"es",englishName:"Spanish"},{name:"Eesti",value:"et",englishName:"Estonian"},{name:"Euskera",value:"eu",englishName:"Basque"},{name:"",value:"fa",englishName:"Persian"},{name:"Suomi",value:"fi",englishName:"Finnish"},{name:"Franais",value:"fr",englishName:"French"},{name:"Gaeilge",value:"ga",englishName:"Irish"},{name:"Galego",value:"gl",englishName:"Galician"},{name:"",value:"he",englishName:"Hebrew"},{name:"",value:"hi",englishName:"Hindi"},{name:"Hrvatski",value:"hr",englishName:"Croatian"},{name:"Magyar",value:"hu",englishName:"Hungarian"},{name:"Interlingua",value:"ia",englishName:"Interlingua"},{name:"Bahasa Indonesia",value:"id",englishName:"Indonesian"},{name:"Italiano",value:"it",englishName:"Italian"},{name:"",value:"ja",englishName:"Japanese"},{name:"",value:"ko",englishName:"Korean"},{name:"Lietuvi",value:"lt",englishName:"Lithuanian"},{name:"Latvieu",value:"lv",englishName:"Latvian"},{name:"",value:"mn",englishName:"Mongolian"},{name:"",value:"mr",englishName:"Marathi"},{name:"Bahasa Melayu",value:"ms",englishName:"Malay"},{name:"Malti",value:"mt",englishName:"Maltese"},{name:"Nederlands",value:"nl",englishName:"Dutch"},{name:"Norsk",value:"no",englishName:"Norwegian"},{name:"Polski",value:"pl",englishName:"Polish"},{name:"Portugus",value:"pt",englishName:"Portuguese"},{name:"Romn",value:"ro",englishName:"Romanian"},{name:"",value:"ru",englishName:"Russian"},{name:"Slovenina",value:"sk",englishName:"Slovak"},{name:"Slovenina",value:"sl",englishName:"Slovenian"},{name:"Svenska",value:"sv",englishName:"Swedish"},{name:"Kiswahili",value:"sw",englishName:"Swahili"},{name:"",value:"ta",englishName:"Tamil"},{name:"",value:"th",englishName:"Thai"},{name:"Trke",value:"tr",englishName:"Turkish"},{name:"",value:"ug",englishName:"Uyghur"},{name:"",value:"uk",englishName:"Ukrainian"},{name:"",value:"ur",englishName:"Urdu"},{name:"Ting Vit",value:"vi",englishName:"Vietnamese"}];static TARGET_LANGUAGES=[{name:" ()",value:"ar-sa",englishName:"Arabic (Saudi)"},{name:" ()",value:"ar-ae",englishName:"Arabic (UAE)"},{name:"Azrbaycan",value:"az",englishName:"Azerbaijani"},{name:"",value:"bg",englishName:"Bulgarian"},{name:" ()",value:"zh",englishName:"Chinese (Simplified)"},{name:" ()",value:"zh-hant",englishName:"Chinese (Traditional)"},{name:"etina",value:"cs",englishName:"Czech"},{name:"Dansk",value:"da",englishName:"Danish"},{name:"Deutsch",value:"de",englishName:"German"},{name:"",value:"el",englishName:"Greek"},{name:"English (US)",value:"en-us",englishName:"English (US)"},{name:"English (Australia)",value:"en-au",englishName:"English (Australia)"},{name:"English (Canada)",value:"en-ca",englishName:"English (Canada)"},{name:"Espaol",value:"es",englishName:"Spanish (Spain)"},{name:"Espaol (Mxico)",value:"es-mx",englishName:"Spanish (Mexico)"},{name:"Filipino",value:"fil",englishName:"Filipino"},{name:"Suomi",value:"fi",englishName:"Finnish"},{name:"Franais",value:"fr",englishName:"French (France)"},{name:"Franais (Canada)",value:"fr-ca",englishName:"French (Canada)"},{name:"",value:"he",englishName:"Hebrew"},{name:"",value:"hi",englishName:"Hindi"},{name:"Hrvatski",value:"hr",englishName:"Croatian"},{name:"Magyar",value:"hu",englishName:"Hungarian"},{name:"Bahasa Indonesia",value:"id",englishName:"Indonesian"},{name:"Italiano",value:"it",englishName:"Italian"},{name:"",value:"ja",englishName:"Japanese"},{name:"",value:"ko",englishName:"Korean"},{name:"Bahasa Melayu",value:"ms",englishName:"Malay"},{name:"Nederlands",value:"nl",englishName:"Dutch"},{name:"Norsk",value:"no",englishName:"Norwegian"},{name:"Polski",value:"pl",englishName:"Polish"},{name:"Portugus",value:"pt",englishName:"Portuguese (Portugal)"},{name:"Portugus (Brasil)",value:"pt-br",englishName:"Portuguese (Brazil)"},{name:"Romn",value:"ro",englishName:"Romanian"},{name:"",value:"ru",englishName:"Russian"},{name:"Slovenina",value:"sk",englishName:"Slovak"},{name:"Svenska",value:"sv",englishName:"Swedish"},{name:"",value:"ta",englishName:"Tamil"},{name:"Trke",value:"tr",englishName:"Turkish"},{name:"",value:"uk",englishName:"Ukrainian"},{name:"Ting Vit",value:"vn",englishName:"Vietnamese"}];static LANGUAGES=(()=>ch.SOURCE_LANGUAGES)();static getTargetLanguagesForSource(e){return ch.TARGET_LANGUAGES}static VOICES=[{name:"Default Low",value:"default_low"},{name:"Default High",value:"default_high"}];static MODELS=[{id:"realtime-translation",type:"realtime"}];getConfig(){return{id:"palabraai",displayName:"PalabraAI",apiKeyLabel:"Client ID",apiKeyPlaceholder:"Enter your PalabraAI Client ID",languages:ch.LANGUAGES,voices:ch.VOICES,models:ch.MODELS,noiseReductionModes:[],transcriptModels:[],capabilities:{hasTemplateMode:!1,hasTurnDetection:!1,hasVoiceSettings:!0,hasNoiseReduction:!1,hasModelConfiguration:!1,turnDetection:{modes:[],hasThreshold:!1,hasPrefixPadding:!1,hasSilenceDuration:!1,hasSemanticEagerness:!1},temperatureRange:{min:0,max:1,step:.1},maxTokensRange:{min:1,max:4096,step:1}},defaults:{model:"",voice:"default_low",temperature:.8,maxTokens:4096,sourceLanguage:"en",targetLanguage:"es",turnDetectionMode:"Auto",threshold:.5,prefixPadding:0,silenceDuration:0,semanticEagerness:"Auto",noiseReduction:"None",transcriptModel:"auto"}}}}class uh{static configs=(()=>new Map)();static#e=(()=>{uh.configs.set(At.OPENAI,new rh),uh.configs.set(At.GEMINI,new sh),uh.configs.set(At.COMET_API,new lh),uh.configs.set(At.PALABRA_AI,new ch)})();static getConfig(e){const t=this.configs.get(e);if(!t)throw new Error(`Unsupported provider: ${e}`);return t.getConfig()}static getAllConfigs(){return Array.from(this.configs.values()).map((e=>e.getConfig()))}static getAvailableProviders(){return Array.from(this.configs.keys())}static isProviderSupported(e){return this.configs.has(e)}static registerProvider(e,t){this.configs.set(e,t)}static getConfigInstance(e){const t=this.configs.get(e);if(!t)throw new Error(`Unsupported provider: ${e}`);return t}}var dh=n(2540);function ph(e,t){return{provider:"openai",model:e.model,voice:e.voice,instructions:t,temperature:e.temperature,maxTokens:e.maxTokens,turnDetection:"Disabled"===e.turnDetectionMode?{type:"none"}:"Normal"===e.turnDetectionMode?{type:"server_vad",createResponse:!0,interruptResponse:!1,prefixPadding:e.prefixPadding,silenceDuration:e.silenceDuration,threshold:e.threshold}:{type:"semantic_vad",createResponse:!0,interruptResponse:!1,eagerness:e.semanticEagerness?.toLowerCase()},inputAudioNoiseReduction:e.noiseReduction&&"None"!==e.noiseReduction?{type:"Near field"===e.noiseReduction?"near_field":"far_field"}:void 0,inputAudioTranscription:e.transcriptModel?{model:e.transcriptModel}:void 0}}const hh={provider:At.OPENAI,uiLanguage:"en",systemInstructions:"You are a professional simultaneous interpreter. Translate the following speech naturally and accurately, maintaining the speaker's tone and intent. Provide only the translation without additional commentary.",templateSystemInstructions:"You are a professional simultaneous interpreter. Translate the following speech from {{SOURCE_LANGUAGE}} to {{TARGET_LANGUAGE}} naturally and accurately, maintaining the speaker's tone and intent. Provide only the translation without additional commentary.",useTemplateMode:!0},gh={apiKey:"",model:"gpt-4o-mini-realtime-preview",voice:"alloy",sourceLanguage:"en",targetLanguage:"zh_CN",turnDetectionMode:"Normal",threshold:.49,prefixPadding:.5,silenceDuration:.5,semanticEagerness:"Auto",temperature:.8,maxTokens:4096,transcriptModel:"gpt-4o-mini-transcribe",noiseReduction:"None"},mh=gh,fh=gh,vh={apiKey:"",model:"gemini-2.0-flash-exp",voice:"Aoede",sourceLanguage:"en-US",targetLanguage:"ja-JP",temperature:.8,maxTokens:4096},yh={clientId:"",clientSecret:"",sourceLanguage:"en",targetLanguage:"es",voiceId:"default_low",subscriberCount:0,publisherCanSubscribe:!0,segmentConfirmationSilenceThreshold:.7,sentenceSplitterEnabled:!0,translatePartialTranscriptions:!1,desiredQueueLevelMs:8e3,maxQueueLevelMs:24e3,autoTempo:!1},bh=(0,i.createContext)(null),kh=()=>{const e=(0,i.useContext)(bh);if(!e)throw new Error("useSettings must be used within a SettingsProvider");return e},Sh=e=>{let{children:t}=e;const n=ah.getSettingsService(),[o,a]=(0,i.useState)(hh),[r,s]=(0,i.useState)(mh),[l,c]=(0,i.useState)(fh),[u,d]=(0,i.useState)(vh),[p,h]=(0,i.useState)(yh),[g,m]=(0,i.useState)(!1),[f,v]=(0,i.useState)([]),[y,b]=(0,i.useState)(!1),[k,S]=(0,i.useState)(new Map),w=(0,i.useCallback)((()=>{try{return uh.getConfig(o.provider)}catch(e){return console.warn(`[SettingsContext] Unknown provider: ${o.provider}, falling back to OpenAI`),uh.getConfig(At.OPENAI)}}),[o.provider]),T=(0,i.useCallback)((()=>{switch(o.provider){case At.OPENAI:return r;case At.COMET_API:return l;case At.GEMINI:return u;case At.PALABRA_AI:return p;default:return r}}),[o.provider,r,l,u,p]),C=(0,i.useCallback)((()=>{switch(o.provider){case At.OPENAI:return r.apiKey;case At.COMET_API:return l.apiKey;case At.GEMINI:return u.apiKey;case At.PALABRA_AI:return p.clientId;default:return r.apiKey}}),[o.provider,r.apiKey,l.apiKey,u.apiKey,p.clientId]),P=(0,i.useCallback)((()=>{const e=C();return o.provider===At.PALABRA_AI?`${o.provider}:${e}:${p.clientSecret}`:`${o.provider}:${e}`}),[o.provider,C,p.clientSecret]),x=(0,i.useCallback)((e=>Date.now()-e<3e5),[]),I=(0,i.useCallback)((async()=>{const e=C(),t=P(),i=k.get(t);if(i&&x(i.timestamp))return console.info("[Settings] Using cached validation and models result"),{validation:i.validation,models:i.models};if(!e||""===e.trim())return{validation:{valid:!1,message:"API key cannot be empty",validating:!1},models:[]};try{console.info("[Settings] Validating API key and fetching models...");const i=o.provider===At.PALABRA_AI?p.clientSecret:void 0,a=await n.validateApiKeyAndFetchModels(e,o.provider,i);return k.set(t,{validation:a.validation,models:a.models,timestamp:Date.now()}),a}catch(e){return console.error("[Settings] Error validating API key and fetching models:",e),{validation:{valid:!1,message:e instanceof Error?e.message:"Validation failed",validating:!1},models:[]}}}),[o.provider,C,P,k,x,n,p.clientSecret]),A=(0,i.useCallback)((()=>{if(o.useTemplateMode){const e=w(),t=T(),n=e.languages.find((e=>e.value===t.sourceLanguage)),i=e.languages.find((e=>e.value===t.targetLanguage)),a=n?.englishName||t.sourceLanguage||"SOURCE_LANGUAGE",r=i?.englishName||t.targetLanguage||"TARGET_LANGUAGE";return o.templateSystemInstructions.replace(/\{\{SOURCE_LANGUAGE\}\}/g,a).replace(/\{\{TARGET_LANGUAGE\}\}/g,r)}return o.systemInstructions}),[o.useTemplateMode,o.templateSystemInstructions,o.systemInstructions,w,T]),E=(0,i.useCallback)((async()=>{try{const e=await I();return m(Boolean(e.validation.valid)),v(e.models),e.validation}catch(e){return console.error("[Sokuji] [Settings] Error validating API key:",e),{valid:!1,message:e instanceof Error?e.message:"Error validating API key",validating:!1}}}),[I]),O=(0,i.useCallback)((e=>{a((t=>{const i={...t,...e};for(const t of Object.keys(e)){const i=`settings.common.${t}`,o=e[t];n.setSetting(i,o).catch((e=>console.error(`[Settings] Error saving common setting ${t}:`,e)))}return i}))}),[n]),_=(0,i.useCallback)((e=>{s((t=>{const i={...t,...e};for(const t of Object.keys(e)){const i=`settings.openai.${t}`,o=e[t];n.setSetting(i,o).catch((e=>console.error(`[Settings] Error saving OpenAI setting ${t}:`,e)))}return i}))}),[n]),N=(0,i.useCallback)((e=>{c((t=>{const i={...t,...e};for(const t of Object.keys(e)){const i=`settings.cometapi.${t}`,o=e[t];n.setSetting(i,o).catch((e=>console.error(`[Settings] Error saving CometAPI setting ${t}:`,e)))}return i}))}),[n]),M=(0,i.useCallback)((e=>{d((t=>{const i={...t,...e};for(const t of Object.keys(e)){const i=`settings.gemini.${t}`,o=e[t];n.setSetting(i,o).catch((e=>console.error(`[Settings] Error saving Gemini setting ${t}:`,e)))}return i}))}),[n]),R=(0,i.useCallback)((e=>{h((t=>{const i={...t,...e};for(const t of Object.keys(e)){const i=`settings.palabraai.${t}`,o=e[t];n.setSetting(i,o).catch((e=>console.error(`[Settings] Error saving PalabraAI setting ${t}:`,e)))}return i}))}),[n]),j=(0,i.useCallback)((async()=>{try{const e={};for(const t of Object.keys(hh)){const i=`settings.common.${t}`,o=hh[t];e[t]=await n.getSetting(i,o)}a(e);const t={};for(const e of Object.keys(mh)){const i=`settings.openai.${e}`,o=mh[e];t[e]=await n.getSetting(i,o)}s(t);const i={};for(const e of Object.keys(fh)){const t=`settings.cometapi.${e}`,o=fh[e];i[e]=await n.getSetting(t,o)}c(i);const o={};for(const e of Object.keys(vh)){const t=`settings.gemini.${e}`,i=vh[e];o[e]=await n.getSetting(t,i)}d(o);const r={};for(const e of Object.keys(yh)){const t=`settings.palabraai.${e}`,i=yh[e];r[e]=await n.getSetting(t,i)}h(r),console.info("[Settings] Loaded settings successfully")}catch(e){console.error("[Settings] Error loading settings:",e)}}),[n]),D=(0,i.useCallback)((async()=>{try{b(!0);const e=await I();m(Boolean(e.validation.valid)),v(e.models),console.info("[Settings] Fetched available models:",e.models)}catch(e){console.error("[Settings] Error fetching available models:",e),v([]),m(!1)}finally{b(!1)}}),[I]),L=(0,i.useCallback)((()=>{v([]),S(new Map)}),[]);(0,i.useEffect)((()=>{j()}),[j]),(0,i.useEffect)((()=>{const e=C();if(e&&""!==e.trim()){console.info("[Settings] Provider or API key changed, auto-validating...");const e=setTimeout((async()=>{try{b(!0);const e=await I();m(Boolean(e.validation.valid)),v(e.models),e.validation.valid?console.info("[Settings] API key is valid, models loaded:",e.models):console.warn("[Settings] API key validation failed:",e.validation.message)}catch(e){console.error("[Settings] Error auto-validating API key and fetching models:",e),m((e=>!e&&e)),v((e=>e.length>0?[]:e)),S((e=>e.size>0?new Map:e))}finally{b(!1)}}),1e3);return()=>clearTimeout(e)}console.info("[Settings] No API key found, clearing validation state"),m((e=>!e&&e)),v((e=>e.length>0?[]:e)),S((e=>e.size>0?new Map:e))}),[o.provider,r.apiKey,l.apiKey,u.apiKey,p.clientId,p.clientSecret,C,I]);const F=(0,i.useCallback)((e=>{switch(o.provider){case At.OPENAI:return ph(r,e);case At.COMET_API:return function(e,t){return{provider:"cometapi",model:e.model,voice:e.voice,instructions:t,temperature:e.temperature,maxTokens:e.maxTokens,turnDetection:"Disabled"===e.turnDetectionMode?{type:"none"}:"Normal"===e.turnDetectionMode?{type:"server_vad",createResponse:!0,interruptResponse:!1,prefixPadding:e.prefixPadding,silenceDuration:e.silenceDuration,threshold:e.threshold}:{type:"semantic_vad",createResponse:!0,interruptResponse:!1,eagerness:e.semanticEagerness?.toLowerCase()},inputAudioNoiseReduction:e.noiseReduction&&"None"!==e.noiseReduction?{type:"Near field"===e.noiseReduction?"near_field":"far_field"}:void 0,inputAudioTranscription:e.transcriptModel?{model:e.transcriptModel}:void 0}}(l,e);case At.GEMINI:return function(e,t){return{provider:"gemini",model:e.model,voice:e.voice,instructions:t,temperature:e.temperature,maxTokens:e.maxTokens}}(u,e);case At.PALABRA_AI:return function(e,t){return{provider:"palabraai",model:"realtime-translation",voice:e.voiceId,instructions:t,temperature:.8,maxTokens:"inf",sourceLanguage:e.sourceLanguage,targetLanguage:e.targetLanguage,voiceId:e.voiceId,segmentConfirmationSilenceThreshold:e.segmentConfirmationSilenceThreshold,sentenceSplitterEnabled:e.sentenceSplitterEnabled,translatePartialTranscriptions:e.translatePartialTranscriptions,desiredQueueLevelMs:e.desiredQueueLevelMs,maxQueueLevelMs:e.maxQueueLevelMs,autoTempo:e.autoTempo}}(p,e);default:return ph(r,e)}}),[o.provider,r,l,u,p]);return(0,dh.jsx)(bh.Provider,{value:{commonSettings:o,updateCommonSettings:O,openAISettings:r,cometAPISettings:l,geminiSettings:u,palabraAISettings:p,updateOpenAISettings:_,updateCometAPISettings:N,updateGeminiSettings:M,updatePalabraAISettings:R,getCurrentProviderSettings:T,createSessionConfig:F,reloadSettings:j,isApiKeyValid:g,validateApiKey:E,getProcessedSystemInstructions:A,availableModels:f,loadingModels:y,fetchAvailableModels:D,clearAvailableModels:L,getCurrentProviderConfig:w},children:t})},wh=(0,i.createContext)(null),Th=()=>{const e=(0,i.useContext)(wh);if(!e)throw new Error("useSession must be used within a SessionProvider");return e},Ch=e=>{let{children:t}=e;const[n,o]=(0,i.useState)(!1),[a,r]=(0,i.useState)(null),[s,l]=(0,i.useState)(null),[c,u]=(0,i.useState)(0);return(0,dh.jsx)(wh.Provider,{value:{isSessionActive:n,setIsSessionActive:o,sessionId:a,setSessionId:r,sessionStartTime:s,setSessionStartTime:l,translationCount:c,setTranslationCount:u},children:t})},Ph=(0,i.createContext)(void 0),xh=()=>{const e=(0,i.useContext)(Ph);if(void 0===e)throw new Error("useAudioContext must be used within an AudioProvider");return e},Ih=e=>{let{children:t}=e;const n=(0,i.useRef)(ah.getAudioService()),[o,a]=(0,i.useState)([]),[r,s]=(0,i.useState)([]),[l,c]=(0,i.useState)(null),[u,d]=(0,i.useState)(null),[p,h]=(0,i.useState)(!0),[g,m]=(0,i.useState)(!1),[f,v]=(0,i.useState)(!0),[y,b]=(0,i.useState)(!1),[k,S]=(0,i.useState)(.2),w=(0,i.useCallback)((async()=>{v(!0);try{const e=await n.current.getDevices();if(a(e.inputs),s(e.outputs),e.inputs.length>0&&(null===l||!e.inputs.some((e=>e.deviceId===l?.deviceId)))){const t=e.inputs.filter((e=>!e.isVirtual));t.length>0?c(t[0]):e.inputs.length>0&&c(e.inputs[0])}if(e.outputs.length>0&&(null===u||!e.outputs.some((e=>e.deviceId===u?.deviceId)))){const t=e.outputs.filter((e=>!e.isVirtual));t.length>0?d(t[0]):e.outputs.length>0&&d(e.outputs[0])}if(e.outputs.some((e=>e.isVirtual)))console.info("[Sokuji] [AudioContext] Virtual audio device detected");else if(n.current.supportsVirtualDevices()){console.info("[Sokuji] [AudioContext] Creating virtual audio devices...");const e=await(n.current.createVirtualDevices?.());e&&e.success?(console.info("[Sokuji] [AudioContext] Successfully created virtual audio devices:",e.message),await w()):console.error("[Sokuji] [AudioContext] Failed to create virtual audio devices:",e?.error)}}catch(e){console.error("[Sokuji] [AudioContext] Error refreshing audio devices:",e)}finally{v(!1)}}),[l,u]);(0,i.useEffect)((()=>{(async()=>{try{await n.current.initialize(),await w(),g&&u&&(console.info("[Sokuji] [AudioContext] Initialization complete, actively connecting monitor device:",u.deviceId),n.current.connectMonitoringDevice(u.deviceId,u.label).then((e=>{e.success?console.info("[Sokuji] [AudioContext] Successfully connected virtual speaker to monitor device during initialization:",e.message):console.error("[Sokuji] [AudioContext] Failed to connect virtual speaker to monitor device during initialization:",e.error)})).catch((e=>{console.error("[Sokuji] [AudioContext] Error connecting monitor device during initialization:",e)})))}catch(e){console.error("[Sokuji] [AudioContext] Failed to initialize audio service:",e)}finally{v(!1)}})()}),[w,g]);const T=(0,i.useCallback)((e=>{console.info(`[Sokuji] [AudioContext] Selected monitor device: ${e.label} (${e.deviceId})`),d((t=>(console.info(`[Sokuji] [AudioContext] Monitor device changed: ${t?.label} (${t?.deviceId}) -> ${e.label} (${e.deviceId})`),g&&e&&e.deviceId&&(console.info(`[Sokuji] [AudioContext] Connecting virtual speaker to monitor device: ${e.label}`),n.current.connectMonitoringDevice(e.deviceId,e.label).then((e=>{e.success?console.info("[Sokuji] [AudioContext] Successfully connected virtual speaker to monitor device:",e.message):console.error("[Sokuji] [AudioContext] Failed to connect virtual speaker to monitor device:",e.error)})).catch((e=>{console.error("[Sokuji] [AudioContext] Error connecting virtual speaker to monitor device:",e)}))),e)))}),[g]),C=(0,i.useCallback)((()=>{h(!p)}),[p]),P=(0,i.useCallback)((()=>{console.info("[Sokuji] [AudioContext] Toggling monitor device state");const e=!g;m(e),e?u?(console.info(`[Sokuji] [AudioContext] Connecting virtual speaker to monitor device: ${u.label}`),n.current.connectMonitoringDevice(u.deviceId,u.label).then((e=>{e.success?console.info("[Sokuji] [AudioContext] Successfully connected virtual speaker to monitor device:",e.message):console.error("[Sokuji] [AudioContext] Failed to connect virtual speaker to monitor device:",e.error)})).catch((e=>{console.error("[Sokuji] [AudioContext] Error connecting virtual speaker to monitor device:",e)}))):console.warn("[Sokuji] [AudioContext] Cannot connect monitor device: No monitor device selected"):(console.info("[Sokuji] [AudioContext] Disconnecting virtual speaker from all outputs"),n.current.disconnectMonitoringDevices().then((e=>{e.success?console.info("[Sokuji] [AudioContext] Successfully disconnected virtual speaker from all outputs:",e.message):console.error("[Sokuji] [AudioContext] Failed to disconnect virtual speaker from outputs:",e.error)})).catch((e=>{console.error("[Sokuji] [AudioContext] Error disconnecting virtual speaker from outputs:",e)})))}),[g,u]),x=(0,i.useCallback)((()=>{console.info("[Sokuji] [AudioContext] Toggling real voice passthrough"),b(!y)}),[y]),I=(0,i.useCallback)((e=>{const t=Math.max(0,Math.min(.6,e));console.info("[Sokuji] [AudioContext] Setting real voice passthrough volume:",t),S(t)}),[]);return(0,dh.jsx)(Ph.Provider,{value:{audioInputDevices:o,audioMonitorDevices:r,selectedInputDevice:l,selectedMonitorDevice:u,isInputDeviceOn:p,isMonitorDeviceOn:g,isLoading:f,isRealVoicePassthroughEnabled:y,realVoicePassthroughVolume:k,selectInputDevice:e=>c(e),selectMonitorDevice:T,toggleInputDeviceState:C,toggleMonitorDeviceState:P,toggleRealVoicePassthrough:x,setRealVoicePassthroughVolume:I,refreshDevices:w},children:t})},Ah=(0,i.createContext)(void 0),Eh=()=>{const e=(0,i.useContext)(Ah);if(!e)throw new Error("useLog must be used within a LogProvider");return e},Oh=e=>{let{children:t}=e;const[n,o]=(0,i.useState)([]);return(0,dh.jsx)(Ah.Provider,{value:{logs:n,addLog:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const n=(new Date).toLocaleTimeString();o((i=>[...i,{timestamp:n,message:e,type:t}]))},addRealtimeEvent:(e,t,n)=>{const i=(new Date).toLocaleTimeString(),a=`${t}: ${n}`;let r;"input_audio_buffer.append"===n?r="input_audio_buffer":n.includes("delta")?r=n:"serverContent.modelTurn"===n||"serverContent.outputTranscription"===n?r="gemini_model_turn":"serverContent.interrupted"===n?r="gemini_interrupted":"serverContent.turnComplete"===n?r="gemini_turn_complete":"serverContent.generationComplete"===n?r="gemini_generation_complete":"usageMetadata"===n?r="gemini_usage_metadata":"serverContent.inputTranscription"===n?r="gemini_input_transcription":"partial_transcription"===n?r="palabraai_partial_transcription":"partial_translated_transcription"===n?r="palabraai_partial_translated_transcription":"validated_transcription"===n?r="palabraai_validated_transcription":"translated_transcription"===n?r="palabraai_translated_transcription":"output_audio_data"===n?r="palabraai_output_audio_data":"input_audio_data"===n?r="palabraai_input_audio_data":"set_task"===n||"end_task"===n||"get_task"===n||"pause_task"===n||"tts_task"===n?r="palabraai_task_management":"current_task"===n?r="palabraai_current_task":e.conversation?.item?.id?r=e.conversation.item.id:e.item?.id?r=e.item.id:e.item_id&&(r=e.item_id),o((o=>{if(o.length>0){const a=o[o.length-1];if(a.eventType===n&&a.source===t&&a.groupingKey===r&&void 0!==r)return[...o.slice(0,-1),{...a,timestamp:i,events:[...a.events||[],e]}]}return[...o,{timestamp:i,message:a,type:"info",events:[e],source:t,eventType:n,groupingKey:r}]}))},clearLogs:()=>{o([])}},children:t})};class _h{static createClient(e,t,n,i){if(!n)throw new Error(`API key is required for ${t} provider`);switch(t){case At.OPENAI:return new Nt(n);case At.COMET_API:return new Nt(n,"https://api.cometapi.com");case At.GEMINI:return new Oo(n);case At.PALABRA_AI:if(!i)throw new Error(`Client secret is required for ${t} provider`);return new th(n,i);default:throw new Error(`Unsupported provider: ${t}`)}}}const Nh=new WeakMap,Mh=function(e,t,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];o=Math.floor(Math.min(o,(e.width-r)/(Math.max(a,1)+r))),o||(o=Math.floor((e.width-r)/(Math.max(a,1)+r))),a||(a=(e.width-r)/o-r);const l=function(e,t){let n,i,o,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r&&(i=t.toString(),o=a.toString(),n=Nh.has(e)?Nh.get(e):{},Nh.set(e,n),n[i]=n[i]||{},n[i][o]))return n[i][o];const s=e.length,l=new Array(t);if(t<=s){l.fill(0);const n=new Array(t).fill(0);for(let i=0;i<s;i++){const o=Math.floor(i*(t/s));a?l[o]=Math.max(l[o],Math.abs(e[i])):l[o]+=Math.abs(e[i]),n[o]++}if(!a)for(let e=0;e<l.length;e++)l[e]=l[e]/n[e]}else for(let n=0;n<t;n++){const i=n*(s-1)/(t-1),o=Math.floor(i),a=Math.ceil(i),r=i-o;l[n]=a>=s?e[s-1]:e[o]*(1-r)+e[a]*r}return r&&(n[i][o]=l),l}(n,o,!0);for(let n=0;n<o;n++){const o=Math.abs(l[n]),c=Math.max(1,o*e.height),u=r+n*(a+r),d=s?(e.height-c)/2:e.height-c;t.fillStyle=i,t.fillRect(u,d,a,c)}};var Rh=n(7540),jh=n(5323);const Dh={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Lh;const Fh=new Uint8Array(16),zh=[];for(let e=0;e<256;++e)zh.push((e+256).toString(16).slice(1));const Uh=function(e,t,n){if(Dh.randomUUID&&!t&&!e)return Dh.randomUUID();const i=(e=e||{}).random??e.rng?.()??function(){if(!Lh){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Lh=crypto.getRandomValues.bind(crypto)}return Lh(Fh)}();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(zh[e[t+0]]+zh[e[t+1]]+zh[e[t+2]]+zh[e[t+3]]+"-"+zh[e[t+4]]+zh[e[t+5]]+"-"+zh[e[t+6]]+zh[e[t+7]]+"-"+zh[e[t+8]]+zh[e[t+9]]+"-"+zh[e[t+10]]+zh[e[t+11]]+zh[e[t+12]]+zh[e[t+13]]+zh[e[t+14]]+zh[e[t+15]]).toLowerCase()}(i)},Vh=je("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var Bh=n(1948),qh={};qh.styleTagTransform=tt(),qh.setAttributes=Ye(),qh.insert=Je().bind(null,"head"),qh.domAPI=Ge(),qh.insertStyleElement=Xe(),He()(Bh.A,qh),Bh.A&&Bh.A.locals&&Bh.A.locals;const Kh=e=>{let{isVisible:t,inputDeviceLabel:n,outputDeviceLabel:i,recommendedAction:o,onDismiss:a}=e;const{t:r}=le();return t?(0,dh.jsx)("div",{className:"audio-feedback-warning",children:(0,dh.jsxs)("div",{className:"warning-content",children:[(0,dh.jsxs)("div",{className:"warning-header",children:[(0,dh.jsx)(Vh,{size:20,className:"warning-icon"}),(0,dh.jsx)("span",{className:"warning-title",children:r("audioFeedback.title")}),(0,dh.jsx)("button",{className:"dismiss-button",onClick:a,children:""})]}),(0,dh.jsxs)("div",{className:"warning-body",children:[(0,dh.jsx)("p",{className:"warning-description",children:r("audioFeedback.description")}),n&&i&&(0,dh.jsxs)("div",{className:"device-info",children:[(0,dh.jsxs)("div",{className:"device-row",children:[(0,dh.jsx)(ze,{size:16,className:"device-icon"}),(0,dh.jsxs)("span",{className:"device-label",children:[r("audioFeedback.inputDevice"),": ",n]})]}),(0,dh.jsxs)("div",{className:"device-row",children:[(0,dh.jsx)(Le,{size:16,className:"device-icon"}),(0,dh.jsxs)("span",{className:"device-label",children:[r("audioFeedback.outputDevice"),": ",i]})]})]}),o&&(0,dh.jsxs)("div",{className:"recommended-action",children:[(0,dh.jsxs)("strong",{children:[r("audioFeedback.recommendation"),":"]}),(0,dh.jsx)("p",{children:o})]}),(0,dh.jsxs)("div",{className:"feedback-solutions",children:[(0,dh.jsx)("h4",{children:r("audioFeedback.solutions.title")}),(0,dh.jsxs)("ul",{children:[(0,dh.jsx)("li",{children:r("audioFeedback.solutions.differentDevices")}),(0,dh.jsx)("li",{children:r("audioFeedback.solutions.useHeadphones")}),(0,dh.jsx)("li",{children:r("audioFeedback.solutions.adjustDistance")}),(0,dh.jsx)("li",{children:r("audioFeedback.solutions.disablePassthrough")})]})]})]})]})}):null},Hh=(e,t,n)=>n?((e,t)=>{if(!e||!t)return!1;const n=e.label.toLowerCase(),i=t.label.toLowerCase();if(e.deviceId===t.deviceId)return!0;if(n===i)return!0;if(n.includes("default")&&i.includes("default"))return!0;if(i.includes("sokuji")||i.includes("virtual")||n.includes("sokuji")||n.includes("virtual"))return!0;const o=e=>e.replace(/^(default\s-\s)?/,"").replace(/\s\((.*)\)$/,"").replace(/\s-\s.*$/,"").toLowerCase(),a=o(n);return a===o(i)&&a.length>0})(e,t)?{safePassthroughEnabled:!1,recommendedAction:"Please select different input and output devices to enable real voice passthrough"}:{safePassthroughEnabled:!0}:{safePassthroughEnabled:!1},Wh=()=>{const{t:e}=le(),{trackEvent:t}=(0,Rh.useAnalytics)(),[n,o]=(0,i.useState)(!1),[a,r]=(0,i.useState)([]),[s,l]=(0,i.useState)(!1),{commonSettings:c,openAISettings:u,cometAPISettings:d,geminiSettings:p,palabraAISettings:h,getCurrentProviderSettings:g,isApiKeyValid:m,getProcessedSystemInstructions:f,availableModels:v,loadingModels:y,createSessionConfig:b}=kh(),{isSessionActive:k,setIsSessionActive:S,sessionId:w,setSessionId:T,sessionStartTime:C,setSessionStartTime:P,translationCount:x,setTranslationCount:I}=Th(),{addRealtimeEvent:A}=Eh(),{selectedInputDevice:E,selectedMonitorDevice:O,isInputDeviceOn:_,isMonitorDeviceOn:N,isRealVoicePassthroughEnabled:M,realVoicePassthroughVolume:R,selectMonitorDevice:j}=xh(),[D,L]=(0,i.useState)(!1),F=(0,i.useRef)(null),[z,U]=(0,i.useState)(!1),[V,B]=(0,i.useState)(null),[q,K]=(0,i.useState)(!1),[H,W]=(0,i.useState)(!1),G=(0,i.useCallback)((()=>{const e=f();return b(e)}),[f,b]),$=(0,i.useCallback)((async()=>{try{const e=ah.getAudioService();return await e.setupVirtualAudioOutput()}catch(e){return console.error("[Sokuji] [MainPanel] Failed to set up virtual audio output:",e),!1}}),[]);(0,i.useEffect)((()=>((async()=>{try{const e=ah.getAudioService();Y.current=e,await e.initialize(),await $()}catch(e){console.error("[Sokuji] [MainPanel] Failed to initialize audio service:",e)}})(),()=>{})),[$]),(0,i.useEffect)((()=>{const e=J.current;if(e&&Y.current){const t=Y.current.getWavStreamPlayer();if(t){const n=M&&(()=>{if(E&&O){const e=E.label.toLowerCase(),t=O.label.toLowerCase();if(e===t||e.includes("default")&&t.includes("default"))return console.warn("[Sokuji] [MainPanel] Passthrough disabled: same input/output device detected"),!1}if(O){const e=O.label.toLowerCase();if(e.includes("sokuji")||e.includes("virtual"))return console.warn("[Sokuji] [MainPanel] Passthrough disabled: virtual device detected as output"),!1}return!0})();e.setupPassthrough(t,n,R),n?console.info("[Sokuji] [MainPanel] Updated passthrough settings: enabled=",n,"volume=",R):M&&console.warn("[Sokuji] [MainPanel] Passthrough disabled for safety - potential feedback loop detected")}}}),[M,R,E,O]),(0,i.useEffect)((()=>{if(H||!M)return void K(!1);const e=Hh(E,O,M);!e.safePassthroughEnabled&&e.recommendedAction?K(!0):K(!1)}),[M,E,O,H]);const J=(0,i.useRef)(new ft({sampleRate:24e3})),Q=(0,i.useRef)(null),Y=(0,i.useRef)(null),Z=(0,i.useRef)(null),X=(0,i.useRef)(null),ee=(0,i.useCallback)((async()=>{const e=Q.current,t=Y.current;if(!e||!t)return;const n={onRealtimeEvent:e=>{A(e.event,e.source,e.event?.type||"unknown")},onError:e=>{console.error("[Sokuji] [MainPanel]",e)},onClose:async e=>{console.info("[Sokuji] [MainPanel] Connection closed, cleaning up session",e),S(!1);const t=J.current;if(t.recording)try{await t.pause(),await t.end()}catch(e){console.warn("[Sokuji] [MainPanel] Error cleaning up recorder on close:",e)}const n=Y.current;n&&await n.interruptAudio()},onConversationInterrupted:async()=>{},onConversationUpdated:async n=>{let{item:i,delta:o}=n;if(o?.audio&&t.addAudioData(o.audio,i.id),"completed"===i.status&&i.formatted?.audio){const e=await ft.decode(i.formatted.audio,24e3,24e3);i.formatted&&(i.formatted.file=e)}"completed"===i.status&&"assistant"===i.role&&(i.formatted?.audio||i.formatted?.text||i.formatted?.transcript)&&I(x+1),r(e.getConversationItems())}};e.setEventHandlers(n),r(e.getConversationItems())}),[A,x]),te=(0,i.useCallback)((async()=>{S(!1);const e=J.current;if(e.recording)try{await e.pause()}catch(e){console.warn("[Sokuji] [MainPanel] Error pausing recorder during disconnect:",e)}await new Promise((e=>setTimeout(e,100)));const t=Q.current;t&&(await t.disconnect(),t.reset());try{await e.end()}catch(e){console.warn("[Sokuji] [MainPanel] Error ending recorder:",e)}const n=Y.current;n&&await n.interruptAudio()}),[]),ne=(0,i.useCallback)((async()=>{try{l(!0),Y.current||(Y.current=ah.getAudioService(),await Y.current.initialize());const e=g();let t;switch(c.provider){case At.OPENAI:t=u.apiKey;break;case At.COMET_API:t=d.apiKey;break;case At.GEMINI:t=p.apiKey;break;case At.PALABRA_AI:t=h.clientId;break;default:throw new Error(`Unsupported provider: ${c.provider}`)}const n=c.provider===At.PALABRA_AI?"realtime-translation":e.model;c.provider===At.PALABRA_AI?Q.current=_h.createClient(n,c.provider,t,h.clientSecret):Q.current=_h.createClient(n,c.provider,t),await ee();const i=Q.current,o=J.current;if(_t(c.provider)){const e=c.provider===At.OPENAI?u:d;L("Disabled"===e.turnDetectionMode)}else L(!1);if(_)if(E){if(await o.begin(E.deviceId),M&&Y.current){const e=Y.current.getWavStreamPlayer();if(e){const t=M&&(()=>{if(E&&O){const e=E.label.toLowerCase(),t=O.label.toLowerCase();if(e===t||e.includes("default")&&t.includes("default"))return console.warn("[Sokuji] [MainPanel] Passthrough disabled: same input/output device detected"),!1}if(O){const e=O.label.toLowerCase();if(e.includes("sokuji")||e.includes("virtual"))return console.warn("[Sokuji] [MainPanel] Passthrough disabled: virtual device detected as output"),!1}return!0})();o.setupPassthrough(e,t,R),t?console.info("[Sokuji] [MainPanel] Real voice passthrough enabled with volume:",R):console.warn("[Sokuji] [MainPanel] Real voice passthrough disabled for safety - potential feedback loop detected")}}}else console.warn("[Sokuji] [MainPanel] No input device selected, cannot connect to microphone");else console.info("[Sokuji] [MainPanel] Input device is turned off, not connecting to microphone");N&&O&&!O.label.toLowerCase().includes("sokuji_virtual")&&!O.label.includes("Sokuji Virtual Output")&&(console.info("[Sokuji] [MainPanel] Setting up monitor device to:",O.label),j(O));const a=G();await i.connect(a);let s=!1;_t(c.provider)&&(s="Disabled"===(c.provider===At.OPENAI?u:d).turnDetectionMode),!s&&_&&await o.record((e=>{i&&i.appendInputAudio(e.mono)})),S(!0),r(i.getConversationItems())}catch(e){console.error("[Sokuji] [MainPanel] Failed to initialize session:",e),await te()}finally{l(!1)}}),[c,u,p,d,h,g,G,ee,E,_,N,O,j,M,R]),ie=(0,i.useCallback)((async()=>{if(!_)return void console.info("[Sokuji] [MainPanel] Input device is turned off, not starting recording");if(n)return;o(!0);const e=Q.current,t=J.current;try{t.recording&&(console.warn("[Sokuji] [MainPanel] WavRecorder was already recording, pausing first"),await t.pause()),await t.record((t=>{e&&e.appendInputAudio(t.mono)}))}catch(e){console.error("[Sokuji] [MainPanel] Error starting recording:",e),o(!1)}}),[_,n]),oe=(0,i.useCallback)((async()=>{if(!n)return;o(!1);const e=Q.current,t=J.current;try{t.recording&&(await t.pause(),e&&e.createResponse())}catch(e){console.error("[Sokuji] [MainPanel] Error stopping recording:",e),o(!1)}}),[n]),ae=(0,i.useCallback)((async e=>{try{const t=Y.current;if(!t)return void console.error("[Sokuji] [MainPanel] Audio service not available");if(V&&(await t.interruptAudio(),B(null)),V===e.id)return;if(t.clearInterruptedTracks(),!e.formatted?.audio)return void console.error("[Sokuji] [MainPanel] No audio data found in the item");const n=t.getWavStreamPlayer().interruptedTrackIds||{};"object"==typeof n&&n[e.id]&&delete n[e.id],N&&O&&!O.label.toLowerCase().includes("sokuji_virtual")&&!O.label.includes("Sokuji Virtual Output")&&j(O);const i=e.formatted.audio;if(i instanceof Int16Array)t.addAudioData(i,e.id);else{if(!(i instanceof ArrayBuffer))return void console.error("[Sokuji] [MainPanel] Unsupported audio data type");t.addAudioData(new Int16Array(i),e.id)}const o=e.id;B(o);let a=0;const r=e.formatted.audio;r instanceof Int16Array?(a=r.length,console.debug("[Sokuji] [MainPanel] Audio is Int16Array with length: "+a)):r&&"object"==typeof r&&("byteLength"in r&&"number"==typeof r.byteLength?(a=r.byteLength/2,console.debug("[Sokuji] [MainPanel] Audio has byteLength: "+r.byteLength+", calculated length: "+a)):"length"in r&&"number"==typeof r.length?(a=r.length,console.debug("[Sokuji] [MainPanel] Audio has length property: "+a)):(a=Object.keys(r).length,console.debug("[Sokuji] [MainPanel] Audio length calculated from object keys: "+a)));const s=a/24e3*1e3;console.debug("[Sokuji] [MainPanel] Audio duration: "+s+"ms");const l=Math.max(s,1e3);setTimeout((()=>{B((e=>e===o?null:e))}),l+50),console.info("[Sokuji] [MainPanel] Playing audio from item "+e.id)}catch(e){console.error("[Sokuji] [MainPanel] Error playing audio:",e),B(null)}}),[N,O,j,V]),re=(0,i.useCallback)((async()=>{try{const e=Y.current;if(!e)return void console.error("[Sokuji] [MainPanel] Audio service not available");if(z)return await e.interruptAudio(),U(!1),void console.info("[Sokuji] [MainPanel] Stopped test tone");e.clearInterruptedTracks();const t=e.getWavStreamPlayer();console.debug("[Sokuji] [MainPanel] WavStreamPlayer before playing test tone: "+t);const n=t.interruptedTrackIds||{};console.debug("[Sokuji] [MainPanel] WavStreamPlayer interruptedTrackIds: "+JSON.stringify(n)),"object"==typeof n&&n["test-tone"]&&(console.debug("[Sokuji] [MainPanel] Manually clearing test-tone from WavStreamPlayer.interruptedTrackIds"),delete n["test-tone"]),console.debug("[Sokuji] [MainPanel] Cleared interrupted tracks before playing test tone");let i="/assets/test-tone.mp3";if("undefined"!=typeof window){const e=window.chrome?.runtime;e?.getURL&&(i=e.getURL("assets/test-tone.mp3"))}const o=await fetch(i),a=await o.arrayBuffer(),r=24e3,s=new AudioContext({sampleRate:r}),l=await s.decodeAudioData(a);console.debug(`[Sokuji] [MainPanel] Test tone audio info - Sample rate: ${l.sampleRate}Hz, Duration: ${l.duration}s, Channels: ${l.numberOfChannels}`);let c,u=l;if(l.sampleRate!==r){console.debug(`[Sokuji] [MainPanel] Resampling from ${l.sampleRate}Hz to ${r}Hz`);const e=new OfflineAudioContext(l.numberOfChannels,l.duration*r,r),t=e.createBufferSource();t.buffer=l,t.connect(e.destination),t.start(0),u=await e.startRendering()}if(u.numberOfChannels>1){console.debug("[Sokuji] [MainPanel] Converting stereo to mono"),c=new Float32Array(u.length);const e=new Float32Array(u.length),t=new Float32Array(u.length);u.copyFromChannel(e,0),u.copyFromChannel(t,1);for(let n=0;n<u.length;n++)c[n]=(e[n]+t[n])/2}else c=new Float32Array(u.length),u.copyFromChannel(c,0);const d=new Int16Array(c.length);for(let e=0;e<c.length;e++){const t=.9*c[e];d[e]=Math.max(-32768,Math.min(32767,Math.floor(32767*t)))}e.addAudioData(d,"test-tone"),U(!0),N&&O&&!O.label.toLowerCase().includes("sokuji_virtual")&&!O.label.includes("Sokuji Virtual Output")&&(console.info("[Sokuji] [MainPanel] Test tone: Ensuring monitor device is connected:",O.label),j(O)),console.info("[Sokuji] [MainPanel] Playing test tone")}catch(e){console.error("[Sokuji] [MainPanel] Error playing test tone:",e),U(!1)}}),[N,O,j,z]);return(0,i.useEffect)((()=>{let e=!0;const t=J.current,n=Z.current;let i=null;Y.current||(Y.current=ah.getAudioService());const o=Y.current,a=X.current;let r=null;const s=()=>{if(e){if(n&&(n.width&&n.height||(n.width=n.offsetWidth,n.height=n.offsetHeight),i=i||n.getContext("2d"),i)){i.clearRect(0,0,n.width,n.height);const e=t.recording?t.getFrequencies("voice"):{values:new Float32Array([0])};Mh(n,i,e.values,"#0099ff",10,0,8)}if(a&&o&&(a.width&&a.height||(a.width=a.offsetWidth,a.height=a.offsetHeight),r=r||a.getContext("2d"),r)){r.clearRect(0,0,a.width,a.height);try{const e=o.getWavStreamPlayer();if(e&&e.context&&"running"===e.context.state&&e.analyser){const t=e.getFrequencies();Mh(a,r,t.values,"#ff9900",10,0,8)}else Mh(a,r,new Float32Array([0]),"#ff9900",10,0,8)}catch(e){Mh(a,r,new Float32Array([0]),"#ff9900",10,0,8),console.warn("[Sokuji] [MainPanel] Error getting frequencies from WavStreamPlayer:",e)}}requestAnimationFrame(s)}};return s(),()=>{e=!1}}),[]),(0,i.useEffect)((()=>{F.current&&requestAnimationFrame((()=>{setTimeout((()=>{if(F.current){const e=F.current;e.scrollTop=e.scrollHeight}}),100)}))}),[a]),(0,i.useEffect)((()=>{if(!k)return;const e=J.current,t=Q.current;(async()=>{try{if(_){if(!e.processor){console.info("[Sokuji] [MainPanel] Input device turned on - initializing recorder with selected device");try{await e.begin(E?.deviceId)}catch(e){return void console.error("[Sokuji] [MainPanel] Error initializing recorder:",e)}}let n=!1;_t(c.provider)&&(n="Disabled"===(c.provider===At.OPENAI?u:d).turnDetectionMode),n||(console.info("[Sokuji] [MainPanel] Input device turned on - resuming recording in automatic mode"),e.recording||await e.record((e=>{t&&t.appendInputAudio(e.mono)})))}else console.info("[Sokuji] [MainPanel] Input device turned off - pausing recording"),e.recording&&(await e.pause(),o(!1))}catch(e){console.error("[Sokuji] [MainPanel] Error updating recording state:",e)}})()}),[_,k,c.provider,u.turnDetectionMode,d.turnDetectionMode,E]),(0,i.useEffect)((()=>{Y.current&&(async()=>{try{if(O?.label.toLowerCase().includes("sokuji_virtual")||O?.label.includes("Sokuji Virtual Output"))return void console.info("[Sokuji] [MainPanel] Selected monitor device is a virtual device - not using as monitor");N&&O&&(console.info(`[Sokuji] [MainPanel] Setting up monitor output to: ${O.label}`),j(O))}catch(e){console.error("[Sokuji] [MainPanel] Error setting up monitor device:",e)}})()}),[O,N,k,j]),(0,i.useEffect)((()=>{const e=k&&D,t=t=>{e&&!t.repeat&&"Space"===t.code&&(t.preventDefault(),ie())},i=t=>{e&&"Space"===t.code&&(t.preventDefault(),oe())},o=()=>{e&&n&&oe()};return window.addEventListener("keydown",t),window.addEventListener("keyup",i),window.addEventListener("blur",o),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",i),window.removeEventListener("blur",o)}}),[k,D,ie,oe,n]),(0,i.useEffect)((()=>{(async()=>{try{await $()}catch(e){console.error("[Sokuji] [MainPanel] Failed to initialize audio:",e)}})()}),[$]),(0,i.useEffect)((()=>{if(k){if(null===w){const e=Uh(),n=Date.now();T(e),P(n),I(0);const i=g();t("translation_session_start",{source_language:i.sourceLanguage,target_language:i.targetLanguage,session_id:e})}}else if(null!==w){const e=Date.now()-(C||Date.now());t("translation_session_end",{session_id:w,duration:e,translation_count:x}),T(null),P(null),I(0)}}),[k,w,C,x,g,T,P,I,t]),(0,dh.jsxs)("div",{className:"main-panel",children:[(0,dh.jsx)("div",{className:"conversation-container",ref:F,children:(0,dh.jsx)("div",{className:"conversation-content","data-conversation-content":!0,children:a.length>0?a.map(((t,n)=>(0,dh.jsxs)("div",{className:`conversation-item ${t.role}`,style:{position:"relative"},children:[(0,dh.jsxs)("div",{className:"conversation-item-role",children:[t.role,(0,jh.yz)()&&"completed"===t.status&&t.formatted?.audio&&(0,dh.jsx)("button",{className:"inline-play-button "+(V===t.id?"playing":""),onClick:()=>ae(t),disabled:null!==V,children:(0,dh.jsx)(De,{size:10})})]}),(0,dh.jsx)("div",{className:"conversation-item-content",children:(()=>{if(t.formatted&&t.formatted.text)return(0,dh.jsx)("div",{className:"content-item text",children:t.formatted.text});if(t.formatted&&t.formatted.transcript)return(0,dh.jsx)("div",{className:"content-item transcript",children:(0,dh.jsx)("div",{className:"transcript-content",children:t.formatted.transcript})});if(t.formatted&&t.formatted.audio)return(0,dh.jsx)("div",{className:"content-item audio",children:(0,dh.jsxs)("div",{className:"audio-indicator",children:[(0,dh.jsx)("span",{className:"audio-icon",children:(0,dh.jsx)(Le,{size:16})}),(0,dh.jsx)("span",{className:"audio-text",children:e("mainPanel.audioContent")})]})});if(("user"===t.role||"assistant"===t.role||"system"===t.role)&&"content"in t){const n=t;if(Array.isArray(n.content))return n.content.map(((t,n)=>(0,dh.jsxs)("div",{className:`content-item ${t.type}`,children:["text"===t.type&&t.text,"input_text"===t.type&&t.text,"audio"===t.type&&(0,dh.jsxs)("div",{className:"audio-indicator",children:[(0,dh.jsx)("span",{className:"audio-icon",children:(0,dh.jsx)(Le,{size:16})}),(0,dh.jsx)("span",{className:"audio-text",children:e("mainPanel.audioContent")})]}),"input_audio"===t.type&&t.transcript&&(0,dh.jsx)("span",{className:"transcript",children:t.transcript})]},n)))}if(t.formatted&&t.formatted.tool){const n=t.formatted.tool.arguments;let i=n;try{const e=JSON.parse(n);i=JSON.stringify(e,null,2)}catch(e){}return(0,dh.jsxs)("div",{className:"content-item tool-call",children:[(0,dh.jsxs)("div",{className:"tool-name",children:[e("mainPanel.function"),": ",t.formatted.tool.name]}),(0,dh.jsx)("div",{className:"tool-args",children:(0,dh.jsx)("pre",{children:i})})]})}if(t.formatted&&t.formatted.output){let e=t.formatted.output;try{const n=JSON.parse(t.formatted.output);e=JSON.stringify(n,null,2)}catch(e){}return(0,dh.jsx)("div",{className:"content-item tool-output",children:(0,dh.jsx)("div",{className:"output-content",children:(0,dh.jsx)("pre",{children:e})})})}return(0,dh.jsx)("div",{className:"content-item",children:(0,dh.jsx)("pre",{children:JSON.stringify(t,null,2)})})})()})]},n))):(0,dh.jsx)("div",{className:"conversation-placeholder",children:(0,dh.jsxs)("div",{className:"placeholder-content",children:[(0,dh.jsx)("div",{className:"icon-container",children:(0,dh.jsx)(Fe,{size:24})}),(0,dh.jsx)("span",{children:e("mainPanel.conversationPlaceholder")})]})})})}),(0,dh.jsxs)("div",{className:"audio-visualization",children:[(0,dh.jsxs)("div",{className:"visualization-container",children:[(0,dh.jsx)("div",{className:"visualization-label",children:e("mainPanel.input")}),(0,dh.jsx)("canvas",{ref:Z,className:"visualization-canvas client-canvas"})]}),(0,dh.jsxs)("div",{className:"controls-container",children:[k&&D&&(0,dh.jsx)("button",{className:`push-to-talk-button ${n?"recording":""} ${_?"":"disabled"}`,onMouseDown:ie,onMouseUp:oe,disabled:!k||!D||!_,children:(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsx)(ze,{size:14}),(0,dh.jsx)("span",{children:e(n?"mainPanel.release":_?"mainPanel.pushToTalk":"mainPanel.inputDeviceOff")})]})}),(0,dh.jsx)("button",{className:"session-button "+(k?"active":""),onClick:k?te:ne,disabled:!k&&(!m||0===v.length||y)||s,children:s?(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsx)(Ue,{size:14,className:"spinner"}),(0,dh.jsx)("span",{children:e("mainPanel.initializing")})]}):k?(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsx)(Ve,{size:14}),(0,dh.jsx)("span",{children:e("mainPanel.endSession")})]}):(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsx)(Be,{size:14}),(0,dh.jsx)("span",{children:e("mainPanel.startSession")}),!m&&(0,dh.jsx)("span",{className:"tooltip",children:e("mainPanel.apiKeyRequired")}),m&&0===v.length&&!y&&(0,dh.jsx)("span",{className:"tooltip",children:e("mainPanel.modelsRequired")}),m&&y&&(0,dh.jsx)("span",{className:"tooltip",children:e("mainPanel.modelsLoading")})]})}),(0,jh.yz)()&&(0,dh.jsxs)("button",{className:"debug-button "+(z?"active":""),onClick:re,children:[(0,dh.jsx)(qe,{size:14}),(0,dh.jsx)("span",{children:e(z?"mainPanel.stopDebug":"mainPanel.debug")})]})]}),(0,dh.jsxs)("div",{className:"visualization-container",children:[(0,dh.jsx)("div",{className:"visualization-label",children:e("mainPanel.output")}),(0,dh.jsx)("canvas",{ref:X,className:"visualization-canvas server-canvas"})]})]}),(0,dh.jsx)(Kh,{isVisible:q,inputDeviceLabel:E?.label,outputDeviceLabel:O?.label,recommendedAction:Hh(E,O,M).recommendedAction,onDismiss:()=>{K(!1),W(!0)}})]})},Gh=je("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),$h=je("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Jh=je("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Qh=je("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Yh=je("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Zh=je("flask-conical",[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]]),Xh=je("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),eg=je("circle-help",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var tg=n(2900),ng={};ng.styleTagTransform=tt(),ng.setAttributes=Ye(),ng.insert=Je().bind(null,"head"),ng.domAPI=Ge(),ng.insertStyleElement=Xe(),He()(tg.A,ng),tg.A&&tg.A.locals&&tg.A.locals;const ig=(0,i.createContext)(void 0),og="sokuji_onboarding_completed",ag="1.0.0",rg=e=>{let{children:t}=e;const{t:n}=le(),{trackEvent:o}=(0,Rh.useAnalytics)(),[a,r]=(0,i.useState)(!1),[s,l]=(0,i.useState)(0),[c,u]=(0,i.useState)(!1),[d,p]=(0,i.useState)(null),h=(e=>[{target:"body",content:e("onboarding.steps.welcome.content","Welcome to Sokuji! This guide will help you set up the extension for live speech translation. Let's get started!"),title:e("onboarding.steps.welcome.title","Welcome to Sokuji"),placement:"center",disableBeacon:!0,styles:{options:{primaryColor:"#007bff"}}},{target:".settings-button",content:e("onboarding.steps.settings.content","First, let's configure your settings. Click here to open the Settings panel where you can set up your OpenAI API key and customize system instructions."),title:e("onboarding.steps.settings.title","Step 1: Open Settings"),placement:"bottom"},{target:".api-key-section",content:(0,dh.jsxs)("span",{children:[e("onboarding.steps.apiKey.content","Enter your OpenAI API key here. You can get one from the")," ",(0,dh.jsx)("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"underline"},children:e("onboarding.steps.apiKey.linkText","OpenAI page")}),". ",e("onboarding.steps.apiKey.required","This is required for the speech translation to work.")]}),title:e("onboarding.steps.apiKey.title","Step 2: Configure API Key"),placement:"left"},{target:".system-instructions-section",content:e("onboarding.steps.systemInstructions.content","Customize the system instructions to control how the AI responds. You can modify the translation behavior and add specific requirements here."),title:e("onboarding.steps.systemInstructions.title","Step 3: System Instructions"),placement:"left"},{target:".voice-settings-section",content:e("onboarding.steps.voiceSettings.content","Configure the voice type that will be used for speech synthesis. Choose from different voice options to match your preference."),title:e("onboarding.steps.voiceSettings.title","Step 4: Voice Settings"),placement:"left"},{target:".turn-detection-section",content:e("onboarding.steps.turnDetection.content","Configure automatic turn detection settings including detection mode, threshold, and audio parameters for optimal speech recognition performance."),title:e("onboarding.steps.turnDetection.title","Step 5: Turn Detection"),placement:"left"},{target:".audio-button",content:e("onboarding.steps.audioSettings.content","Next, let's configure your audio settings. Click here to open the Audio panel and set up your microphone and speakers."),title:e("onboarding.steps.audioSettings.title","Step 6: Audio Settings"),placement:"bottom"},{target:".microphone-section",content:e("onboarding.steps.microphoneSetup.content","Select your microphone device here. Make sure to choose the correct input device for the best audio quality."),title:e("onboarding.steps.microphoneSetup.title","Step 7: Microphone Setup"),placement:"left"},{target:".speaker-section",content:e("onboarding.steps.speakerSetup.content","Select a monitoring device to listen to the translated audio and verify if it meets your requirements. It is recommended to use headphones for monitoring to avoid interference with microphone input. When you are satisfied with the translation settings, it is suggested to turn off monitoring so you can focus more on your expression without microphone interference."),title:e("onboarding.steps.speakerSetup.title","Step 8: Speaker Setup"),placement:"left"},{target:".session-button",content:e("onboarding.steps.startSession.content",'Click the "Start Session" button to begin using Sokuji. Once started, you can speak naturally for live translation. If Automatic turn detection is disabled, use "Push to Talk" (Space key) to speak.'),title:e("onboarding.steps.startSession.title","Step 9: Start Session"),placement:"top"},{target:"body",content:e("onboarding.steps.complete.content","Great! You're all set up. Remember to grant microphone permissions when prompted, and you can restart this guide anytime from the settings."),title:e("onboarding.steps.complete.title","Setup Complete!"),placement:"center",disableBeacon:!0}])(n),g=()=>{const e=Date.now();p(e),l(0),r(!0),o("onboarding_started",{is_first_time_user:c,onboarding_version:ag});const t=h[0];o("onboarding_step_viewed",{step_index:0,step_target:t.target,step_title:"string"==typeof t.title?t.title:"Step"})};(0,i.useEffect)((()=>{const e=localStorage.getItem(og);if(e)try{JSON.parse(e).version!==ag&&u(!0)}catch(e){console.error("Error parsing onboarding data:",e),u(!0)}else u(!0),setTimeout((()=>{g()}),1e3)}),[]);const m=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t={completed:!0,version:ag,completedAt:(new Date).toISOString()};if(localStorage.setItem(og,JSON.stringify(t)),r(!1),u(!1),l(0),e){const e=d?Date.now()-d:0;o("onboarding_completed",{completion_method:"finished",steps_completed:s+1,total_steps:h.length,duration_ms:e,onboarding_version:ag})}},f={isOnboardingActive:a,currentStepIndex:s,steps:h,startOnboarding:g,stopOnboarding:()=>{r(!1),l(0)},nextStep:()=>{if(s<h.length-1){const e=s+1;l(e);const t=h[e];o("onboarding_step_viewed",{step_index:e,step_target:t.target,step_title:"string"==typeof t.title?t.title:"Step"})}else m()},prevStep:()=>{if(s>0){const e=s-1;l(e);const t=h[e];o("onboarding_step_viewed",{step_index:e,step_target:t.target,step_title:"string"==typeof t.title?t.title:"Step"})}},skipOnboarding:()=>{const e=d?Date.now()-d:0;o("onboarding_completed",{completion_method:"skipped",steps_completed:s,total_steps:h.length,duration_ms:e,onboarding_version:ag}),m(!1)},isFirstTimeUser:c,markOnboardingComplete:m};return(0,dh.jsx)(ig.Provider,{value:f,children:t})},sg=()=>{const e=(0,i.useContext)(ig);if(!e)throw new Error("useOnboarding must be used within an OnboardingProvider");return e},lg=je("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),cg=je("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ug=je("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),dg=e=>{let{config:t,isSessionActive:n,isPreviewExpanded:o,setIsPreviewExpanded:a,getProcessedSystemInstructions:r,availableModels:s,loadingModels:l,fetchAvailableModels:c}=e;const{commonSettings:u,updateCommonSettings:d,openAISettings:p,cometAPISettings:h,geminiSettings:g,palabraAISettings:m,updateOpenAISettings:f,updateCometAPISettings:v,updateGeminiSettings:y,updatePalabraAISettings:b,getCurrentProviderSettings:k}=kh(),{t:S}=le(),w=k(),T=(e,t)=>{u.provider===At.OPENAI?f({[e]:t}):u.provider===At.COMET_API?v({[e]:t}):u.provider===At.GEMINI?y({[e]:t}):u.provider===At.PALABRA_AI?b({[e]:t}):console.warn("[Sokuji][ProviderSpecificSettings] Unsupported provider:",u.provider)},C=()=>_t(u.provider),P=()=>u.provider===At.OPENAI?p:u.provider===At.COMET_API?h:null,x=e=>{u.provider===At.OPENAI?f(e):u.provider===At.COMET_API&&v(e)};return(0,dh.jsxs)(i.Fragment,{children:[t.capabilities.hasTemplateMode&&(0,dh.jsxs)("div",{className:"settings-section system-instructions-section",children:[(0,dh.jsx)("h2",{children:S("settings.systemInstructions")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsxs)("div",{className:"turn-detection-options",children:[(0,dh.jsx)("button",{className:"option-button "+(u.useTemplateMode?"active":""),onClick:()=>d({useTemplateMode:!0}),disabled:n,children:S("settings.simple")}),(0,dh.jsx)("button",{className:"option-button "+(u.useTemplateMode?"":"active"),onClick:()=>d({useTemplateMode:!1}),disabled:n,children:S("settings.advanced")})]})}),u.useTemplateMode?(0,dh.jsxs)(dh.Fragment,{children:[(()=>{if(!t.capabilities.hasTemplateMode||!u.useTemplateMode)return null;const e=w;return(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.sourceLanguage")})}),(0,dh.jsx)("select",{className:"select-dropdown",value:e.sourceLanguage,onChange:n=>{const i=n.target.value;if(i===e.targetLanguage){const e=t.languages.find((e=>e.value!==i))?.value||t.defaults.targetLanguage;T("sourceLanguage",i),T("targetLanguage",e)}else T("sourceLanguage",i)},disabled:n,children:t.languages.map((e=>(0,dh.jsx)("option",{value:e.value,children:e.name},e.value)))})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.targetLanguage")})}),(0,dh.jsx)("select",{className:"select-dropdown",value:e.targetLanguage,onChange:e=>T("targetLanguage",e.target.value),disabled:n,children:t.languages.filter((t=>t.value!==e.sourceLanguage)).map((e=>(0,dh.jsx)("option",{value:e.value,children:e.name},e.value)))})]})]})})(),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.preview")}),(0,dh.jsx)("div",{className:"preview-toggle",onClick:()=>a(!o),children:o?(0,dh.jsx)(cg,{size:16}):(0,dh.jsx)(ug,{size:16})})]}),o&&(0,dh.jsx)("div",{className:"system-instructions-preview",children:(0,dh.jsx)("div",{className:"preview-content",children:r()})})]})]}):(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsx)("textarea",{className:"system-instructions",placeholder:S("settings.enterCustomInstructions"),value:u.systemInstructions,onChange:e=>d({systemInstructions:e.target.value}),disabled:n})})]}),t.capabilities.hasVoiceSettings&&u.provider!==At.PALABRA_AI?(0,dh.jsxs)("div",{className:"settings-section voice-settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.voice")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsx)("select",{className:"select-dropdown",value:w.voice,onChange:e=>T("voice",e.target.value),disabled:n,children:t.voices.map((e=>(0,dh.jsx)("option",{value:e.value,children:e.name},e.value)))})})]}):null,(()=>{if(!t.capabilities.hasTurnDetection)return null;const{turnDetection:e}=t.capabilities;if(!C())return null;const i=P();return(0,dh.jsxs)("div",{className:"settings-section turn-detection-section",children:[(0,dh.jsx)("h2",{children:S("settings.automaticTurnDetection")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsx)("div",{className:"turn-detection-options",children:e.modes.map((e=>(0,dh.jsx)("button",{className:"option-button "+(i?.turnDetectionMode===e?"active":""),onClick:()=>x({turnDetectionMode:e}),disabled:n,children:S(`settings.${e.toLowerCase()}`)},e)))})}),"Normal"===i?.turnDetectionMode&&e.hasThreshold&&(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.threshold")}),(0,dh.jsx)("span",{className:"setting-value",children:i?.threshold.toFixed(2)})]}),(0,dh.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:i?.threshold||0,onChange:e=>x({threshold:parseFloat(e.target.value)}),className:"slider",disabled:n})]}),e.hasPrefixPadding&&(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.prefixPadding")}),(0,dh.jsxs)("span",{className:"setting-value",children:[i?.prefixPadding.toFixed(1),"s"]})]}),(0,dh.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:i?.prefixPadding||0,onChange:e=>x({prefixPadding:parseFloat(e.target.value)}),className:"slider",disabled:n})]}),e.hasSilenceDuration&&(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.silenceDuration")}),(0,dh.jsxs)("span",{className:"setting-value",children:[i?.silenceDuration.toFixed(1),"s"]})]}),(0,dh.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:i?.silenceDuration||0,onChange:e=>x({silenceDuration:parseFloat(e.target.value)}),className:"slider",disabled:n})]})]}),"Semantic"===i?.turnDetectionMode&&e.hasSemanticEagerness&&(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.eagerness")})}),(0,dh.jsxs)("select",{className:"select-dropdown",value:i?.semanticEagerness,onChange:e=>x({semanticEagerness:e.target.value}),disabled:n,children:[(0,dh.jsx)("option",{value:"Auto",children:S("settings.auto")}),(0,dh.jsx)("option",{value:"Low",children:S("settings.low")}),(0,dh.jsx)("option",{value:"Medium",children:S("settings.medium")}),(0,dh.jsx)("option",{value:"High",children:S("settings.high")})]})]})]})})(),(()=>{if(u.provider===At.PALABRA_AI)return null;const e=s.length>0?s.filter((e=>"realtime"===e.type)):t.models.filter((e=>"realtime"===e.type));return(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.model")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"model-selection-container",children:[(0,dh.jsx)("select",{className:"select-dropdown",value:w.model,onChange:e=>T("model",e.target.value),disabled:n,children:e.map((e=>(0,dh.jsx)("option",{value:e.id,children:e.id},e.id)))}),(0,dh.jsx)("button",{className:"refresh-models-button",onClick:async()=>{try{await c()}catch(e){console.error("[Sokuji][ProviderSpecificSettings] Error refreshing models:",e)}},disabled:n||l,title:S("settings.refreshModels","Refresh available models"),children:(0,dh.jsx)("span",{className:l?"loading":"",children:(0,dh.jsx)(lg,{size:16})})})]}),l&&(0,dh.jsx)("div",{className:"loading-status",children:S("settings.loadingModels","Loading available models...")}),s.length>0&&!l&&(0,dh.jsx)("div",{className:"models-info",children:S("settings.modelsFound","Found {{count}} available models",{count:e.length})})]})]})})(),(()=>{if(0===t.transcriptModels.length)return null;if(!C())return null;const e=P();return(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.userTranscriptModel")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsx)("select",{className:"select-dropdown",value:e?.transcriptModel,onChange:e=>x({transcriptModel:e.target.value}),disabled:n,children:t.transcriptModels.map((e=>(0,dh.jsx)("option",{value:e,children:e},e)))})})]})})(),(()=>{if(!t.capabilities.hasNoiseReduction||0===t.noiseReductionModes.length)return null;if(!C())return null;const e=P();return(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.noiseReduction")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsx)("select",{className:"select-dropdown",value:e?.noiseReduction,onChange:e=>x({noiseReduction:e.target.value}),disabled:n,children:t.noiseReductionModes.map((e=>(0,dh.jsx)("option",{value:e,children:e},e)))})})]})})(),(()=>{if(!t.capabilities.hasModelConfiguration||u.provider===At.PALABRA_AI)return null;const{temperatureRange:e,maxTokensRange:i}=t.capabilities;return(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.modelConfiguration")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.temperature")}),(0,dh.jsx)("span",{className:"setting-value",children:w.temperature.toFixed(2)})]}),(0,dh.jsx)("input",{type:"range",min:e.min,max:e.max,step:e.step,value:w.temperature,onChange:e=>T("temperature",parseFloat(e.target.value)),className:"slider",disabled:n})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.maxTokens")}),(0,dh.jsx)("span",{className:"setting-value",children:w.maxTokens})]}),(0,dh.jsx)("input",{type:"range",min:i.min,max:i.max,step:i.step,value:"number"==typeof w.maxTokens?w.maxTokens:i.max,onChange:e=>T("maxTokens",parseInt(e.target.value)),className:"slider",disabled:n})]})]})})(),u.provider!==At.PALABRA_AI?null:(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.languageSettings","Language Settings")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.sourceLanguage")})}),(0,dh.jsx)("select",{className:"select-dropdown",value:m.sourceLanguage,onChange:e=>{const t=e.target.value;b({sourceLanguage:t})},disabled:n,children:t.languages.map((e=>(0,dh.jsx)("option",{value:e.value,children:e.name},e.value)))})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.targetLanguage")})}),(0,dh.jsxs)("select",{className:"select-dropdown",value:m.targetLanguage,onChange:e=>b({targetLanguage:e.target.value}),disabled:n,children:[(0,dh.jsx)("option",{value:"ar-sa",children:" ()"}),(0,dh.jsx)("option",{value:"ar-ae",children:" ()"}),(0,dh.jsx)("option",{value:"az",children:"Azrbaycan"}),(0,dh.jsx)("option",{value:"bg",children:""}),(0,dh.jsx)("option",{value:"zh",children:" ()"}),(0,dh.jsx)("option",{value:"zh-hant",children:" ()"}),(0,dh.jsx)("option",{value:"cs",children:"etina"}),(0,dh.jsx)("option",{value:"da",children:"Dansk"}),(0,dh.jsx)("option",{value:"de",children:"Deutsch"}),(0,dh.jsx)("option",{value:"el",children:""}),(0,dh.jsx)("option",{value:"en-us",children:"English (US)"}),(0,dh.jsx)("option",{value:"en-au",children:"English (Australia)"}),(0,dh.jsx)("option",{value:"en-ca",children:"English (Canada)"}),(0,dh.jsx)("option",{value:"es",children:"Espaol"}),(0,dh.jsx)("option",{value:"es-mx",children:"Espaol (Mxico)"}),(0,dh.jsx)("option",{value:"fil",children:"Filipino"}),(0,dh.jsx)("option",{value:"fi",children:"Suomi"}),(0,dh.jsx)("option",{value:"fr",children:"Franais"}),(0,dh.jsx)("option",{value:"fr-ca",children:"Franais (Canada)"}),(0,dh.jsx)("option",{value:"he",children:""}),(0,dh.jsx)("option",{value:"hi",children:""}),(0,dh.jsx)("option",{value:"hr",children:"Hrvatski"}),(0,dh.jsx)("option",{value:"hu",children:"Magyar"}),(0,dh.jsx)("option",{value:"id",children:"Bahasa Indonesia"}),(0,dh.jsx)("option",{value:"it",children:"Italiano"}),(0,dh.jsx)("option",{value:"ja",children:""}),(0,dh.jsx)("option",{value:"ko",children:""}),(0,dh.jsx)("option",{value:"ms",children:"Bahasa Melayu"}),(0,dh.jsx)("option",{value:"nl",children:"Nederlands"}),(0,dh.jsx)("option",{value:"no",children:"Norsk"}),(0,dh.jsx)("option",{value:"pl",children:"Polski"}),(0,dh.jsx)("option",{value:"pt",children:"Portugus"}),(0,dh.jsx)("option",{value:"pt-br",children:"Portugus (Brasil)"}),(0,dh.jsx)("option",{value:"ro",children:"Romn"}),(0,dh.jsx)("option",{value:"ru",children:""}),(0,dh.jsx)("option",{value:"sk",children:"Slovenina"}),(0,dh.jsx)("option",{value:"sv",children:"Svenska"}),(0,dh.jsx)("option",{value:"ta",children:""}),(0,dh.jsx)("option",{value:"tr",children:"Trke"}),(0,dh.jsx)("option",{value:"uk",children:""}),(0,dh.jsx)("option",{value:"vn",children:"Ting Vit"})]})]})]}),(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.voiceSettings","Voice Settings")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.voice")})}),(0,dh.jsx)("select",{className:"select-dropdown",value:m.voiceId,onChange:e=>b({voiceId:e.target.value}),disabled:n,children:t.voices.map((e=>(0,dh.jsx)("option",{value:e.value,children:e.name},e.value)))})]})]}),(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.speechProcessing","Speech Processing")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:S("settings.silenceThreshold","Silence Threshold")}),(0,dh.jsxs)("span",{className:"setting-value",children:[m.segmentConfirmationSilenceThreshold.toFixed(2),"s"]})]}),(0,dh.jsx)("input",{type:"range",min:"0.1",max:"2.0",step:"0.01",value:m.segmentConfirmationSilenceThreshold,onChange:e=>b({segmentConfirmationSilenceThreshold:parseFloat(e.target.value)}),className:"slider",disabled:n})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.sentenceSplitter","Sentence Splitter")})}),(0,dh.jsxs)("div",{className:"turn-detection-options",children:[(0,dh.jsx)("button",{className:"option-button "+(m.sentenceSplitterEnabled?"active":""),onClick:()=>b({sentenceSplitterEnabled:!0}),disabled:n,children:S("settings.enabled","Enabled")}),(0,dh.jsx)("button",{className:"option-button "+(m.sentenceSplitterEnabled?"":"active"),onClick:()=>b({sentenceSplitterEnabled:!1}),disabled:n,children:S("settings.disabled","Disabled")})]})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:S("settings.translatePartialTranscriptions","Translate Partial Transcriptions")})}),(0,dh.jsxs)("div",{className:"turn-detection-options",children:[(0,dh.jsx)("button",{className:"option-button "+(m.translatePartialTranscriptions?"active":""),onClick:()=>b({translatePartialTranscriptions:!0}),disabled:n,children:S("settings.enabled","Enabled")}),(0,dh.jsx)("button",{className:"option-button "+(m.translatePartialTranscriptions?"":"active"),onClick:()=>b({translatePartialTranscriptions:!1}),disabled:n,children:S("settings.disabled","Disabled")})]})]})]}),(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:S("settings.queueConfiguration","Audio Buffer Configuration")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[S("settings.desiredQueueLevel","Target Audio Buffer"),(0,dh.jsx)("span",{title:"Desired average TTS buffer size. The system will try to maintain this amount of translated audio ready for playback. Recommended: 6-8 seconds for optimal performance.",style:{display:"flex",alignItems:"center",cursor:"help"},children:(0,dh.jsx)(Jh,{size:14,style:{color:"#aaa"}})})]}),(0,dh.jsxs)("span",{className:"setting-value",children:[(m.desiredQueueLevelMs/1e3).toFixed(1),"s"]})]}),(0,dh.jsx)("input",{type:"range",min:"3000",max:"15000",step:"1000",value:m.desiredQueueLevelMs,onChange:e=>b({desiredQueueLevelMs:parseInt(e.target.value)}),className:"slider",disabled:n})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[S("settings.maxQueueLevel","Max Audio Buffer"),(0,dh.jsx)("span",{title:"Maximum TTS queue size. If the buffer grows beyond this limit, older audio will be dropped to prevent excessive delay. Should be 2-3x larger than the target buffer size.",style:{display:"flex",alignItems:"center",cursor:"help"},children:(0,dh.jsx)(Jh,{size:14,style:{color:"#aaa"}})})]}),(0,dh.jsxs)("span",{className:"setting-value",children:[(m.maxQueueLevelMs/1e3).toFixed(1),"s"]})]}),(0,dh.jsx)("input",{type:"range",min:"12000",max:"60000",step:"3000",value:m.maxQueueLevelMs,onChange:e=>b({maxQueueLevelMs:parseInt(e.target.value)}),className:"slider",disabled:n})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[S("settings.autoTempo","Adaptive Speech Speed"),(0,dh.jsx)("span",{title:"Automatically adjust speech tempo based on the audio buffer state. When enabled, the system will speed up or slow down speech to maintain optimal buffer levels.",style:{display:"flex",alignItems:"center",cursor:"help"},children:(0,dh.jsx)(Jh,{size:14,style:{color:"#aaa"}})})]})}),(0,dh.jsxs)("div",{className:"turn-detection-options",children:[(0,dh.jsx)("button",{className:"option-button "+(m.autoTempo?"active":""),onClick:()=>b({autoTempo:!0}),disabled:n,children:S("settings.enabled","Enabled")}),(0,dh.jsx)("button",{className:"option-button "+(m.autoTempo?"":"active"),onClick:()=>b({autoTempo:!1}),disabled:n,children:S("settings.disabled","Disabled")})]})]})]})]})]})},pg=e=>{let{toggleSettings:t}=e;const{commonSettings:n,updateCommonSettings:o,openAISettings:a,cometAPISettings:r,geminiSettings:s,palabraAISettings:l,updateOpenAISettings:c,updateCometAPISettings:u,updateGeminiSettings:d,updatePalabraAISettings:p,getCurrentProviderConfig:h,isApiKeyValid:g,validateApiKey:m,getProcessedSystemInstructions:f,availableModels:v,loadingModels:y,fetchAvailableModels:b,clearAvailableModels:k}=kh(),{startOnboarding:S}=sg(),{t:w,i18n:T}=le(),{isSessionActive:C}=Th(),P=(0,i.useMemo)((()=>{try{return uh.getConfig(n.provider||At.OPENAI)}catch(e){return console.warn(`[SettingsPanel] Unknown provider: ${n.provider}, falling back to OpenAI`),uh.getConfig(At.OPENAI)}}),[n.provider]),x=(0,i.useMemo)((()=>uh.getAllConfigs()),[]),[I,A]=(h(),(0,i.useState)({valid:null,validating:!1,message:""})),[E,O]=(0,i.useState)(!1),[_,N]=(0,i.useState)({type:null,message:""}),[M,R]=(0,i.useState)(!1),j=async()=>{A({valid:null,message:w("settings.validatingApiKey"),validating:!0});const e=await m();return A({valid:!0===e.valid,message:e.message,validating:!1}),!0===e.valid};return(0,dh.jsxs)("div",{className:"settings-panel",children:[(0,dh.jsxs)("div",{className:"settings-panel-header",children:[(0,dh.jsx)("h2",{children:w("settings.title")}),(0,dh.jsxs)("div",{className:"header-actions",children:[(0,dh.jsxs)("button",{className:"save-all-button",onClick:async()=>{O(!0),N({type:null,message:""});try{n.provider===At.OPENAI?c(a):n.provider===At.COMET_API?u(r):n.provider===At.PALABRA_AI?p(l):d(s),o(n),console.info("[Settings] All settings saved successfully"),N({type:"success",message:w("settings.settingsSavedSuccessfully")})}catch(e){console.error("[Settings] Error saving settings:",e),N({type:"error",message:w("settings.failedToSaveSettings")})}finally{O(!1)}},disabled:E||C,children:[(0,dh.jsx)(Qh,{size:16}),(0,dh.jsx)("span",{children:w(E?"settings.saving":"common.save")})]}),(()=>{if(!_.type)return null;switch(_.type){case"success":return(0,dh.jsx)("span",{className:"status-icon-wrapper success",title:_.message,children:(0,dh.jsx)(Gh,{size:16,className:"status-icon"})});case"error":return(0,dh.jsx)("span",{className:"status-icon-wrapper error",title:_.message,children:(0,dh.jsx)($h,{size:16,className:"status-icon"})});case"warning":return(0,dh.jsx)("span",{className:"status-icon-wrapper warning",title:_.message,children:(0,dh.jsx)(Vh,{size:16,className:"status-icon"})});case"info":return(0,dh.jsx)("span",{className:"status-icon-wrapper info",title:_.message,children:(0,dh.jsx)(Jh,{size:16,className:"status-icon"})});default:return null}})(),(0,dh.jsxs)("button",{className:"close-settings-button",onClick:t,children:[(0,dh.jsx)(Yh,{size:16}),(0,dh.jsx)("span",{children:w("common.close")})]})]})]}),(0,dh.jsxs)("div",{className:"settings-content",children:[C&&(0,dh.jsxs)("div",{className:"session-active-notice",children:[(0,dh.jsx)(Jh,{size:16}),(0,dh.jsx)("span",{children:w("settings.sessionActiveNotice","Settings are locked while session is active. Please end the session to modify settings.")})]}),(0,dh.jsxs)("div",{className:"settings-section api-key-section",children:[(0,dh.jsx)("h2",{children:w("settings.provider","Service Provider")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:w("settings.providerType","Provider")})}),(0,dh.jsxs)("div",{className:"provider-selection-wrapper",children:[(0,dh.jsx)("select",{className:"select-dropdown",value:n.provider||At.OPENAI,onChange:e=>{const t=e.target.value;o({provider:t}),A({valid:null,message:"",validating:!1}),k()},disabled:C,children:x.map((e=>(0,dh.jsx)("option",{value:e.id,children:e.displayName},e.id)))}),(n.provider===At.GEMINI||n.provider===At.COMET_API||n.provider===At.PALABRA_AI)&&(0,dh.jsxs)("div",{className:"experimental-icon-wrapper",children:[(0,dh.jsx)(Zh,{size:16,className:"experimental-icon"}),(0,dh.jsx)("div",{className:"experimental-tooltip",children:w("settings.experimentalFeatureTooltip","This is an experimental feature and may be unstable.")})]})]})]}),n.provider===At.PALABRA_AI?(0,dh.jsxs)(dh.Fragment,{children:[(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:w("settings.clientId","Client ID")})}),(0,dh.jsx)("div",{className:"api-key-container",children:(0,dh.jsx)("input",{value:l.clientId,onChange:e=>{p({clientId:e.target.value}),A({valid:null,message:"",validating:!1})},placeholder:"Enter your PalabraAI Client ID",className:"text-input api-key-input "+(!0===I.valid?"valid":!1===I.valid?"invalid":""),disabled:C})})]}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:w("settings.clientSecret","Client Secret")})}),(0,dh.jsxs)("div",{className:"api-key-container",children:[(0,dh.jsx)("input",{type:"password",value:l.clientSecret,onChange:e=>{p({clientSecret:e.target.value}),A({valid:null,message:"",validating:!1})},placeholder:"Enter your PalabraAI Client Secret",className:"text-input api-key-input "+(!0===I.valid?"valid":!1===I.valid?"invalid":""),disabled:C}),(0,dh.jsxs)("button",{className:"validate-key-button",onClick:j,disabled:I.validating||!l.clientId||!l.clientSecret||C,children:[(0,dh.jsx)(Xh,{size:16}),(0,dh.jsx)("span",{children:I.validating?w("settings.validating"):w("settings.validate")})]})]})]})]}):(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:w("settings.apiKey","API Key")})}),(0,dh.jsxs)("div",{className:"api-key-container",children:[(0,dh.jsx)("input",{value:n.provider===At.OPENAI?a.apiKey:n.provider===At.COMET_API?r.apiKey:s.apiKey,onChange:e=>{n.provider===At.OPENAI?c({apiKey:e.target.value}):n.provider===At.COMET_API?u({apiKey:e.target.value}):d({apiKey:e.target.value}),A({valid:null,message:"",validating:!1})},placeholder:P.apiKeyPlaceholder,className:"text-input api-key-input "+(!0===I.valid?"valid":!1===I.valid?"invalid":""),disabled:C}),(0,dh.jsxs)("button",{className:"validate-key-button",onClick:j,disabled:I.validating||(n.provider===At.OPENAI?!a.apiKey:n.provider===At.COMET_API?!r.apiKey:!s.apiKey)||C,children:[(0,dh.jsx)(Xh,{size:16}),(0,dh.jsx)("span",{children:I.validating?w("settings.validating"):w("settings.validate")})]})]})]}),I.message&&(0,dh.jsx)("div",{className:"api-key-status "+(!0===I.valid?"success":!1===I.valid?"error":"info"),children:I.message})]}),(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:w("settings.language")}),(0,dh.jsxs)("div",{className:"setting-item",children:[(0,dh.jsx)("div",{className:"setting-label",children:(0,dh.jsx)("span",{children:w("settings.uiLanguage")})}),(0,dh.jsxs)("select",{className:"select-dropdown",value:T.language,onChange:e=>{T.changeLanguage(e.target.value),o({uiLanguage:e.target.value})},disabled:C,children:[(0,dh.jsx)("option",{value:"en",children:" English"}),(0,dh.jsx)("option",{value:"zh_CN",children:"  ()"}),(0,dh.jsx)("option",{value:"hi",children:" "}),(0,dh.jsx)("option",{value:"es",children:" Espaol"}),(0,dh.jsx)("option",{value:"fr",children:" Franais"}),(0,dh.jsx)("option",{value:"ar",children:" "}),(0,dh.jsx)("option",{value:"bn",children:" "}),(0,dh.jsx)("option",{value:"pt_BR",children:" Portugus (Brasil)"}),(0,dh.jsx)("option",{value:"ru",children:" "}),(0,dh.jsx)("option",{value:"ja",children:" "}),(0,dh.jsx)("option",{value:"de",children:" Deutsch"}),(0,dh.jsx)("option",{value:"ko",children:" "}),(0,dh.jsx)("option",{value:"fa",children:" "}),(0,dh.jsx)("option",{value:"tr",children:" Trke"}),(0,dh.jsx)("option",{value:"vi",children:" Ting Vit"}),(0,dh.jsx)("option",{value:"it",children:" Italiano"}),(0,dh.jsx)("option",{value:"th",children:" "}),(0,dh.jsx)("option",{value:"pl",children:" Polski"}),(0,dh.jsx)("option",{value:"id",children:" Bahasa Indonesia"}),(0,dh.jsx)("option",{value:"ms",children:" Bahasa Melayu"}),(0,dh.jsx)("option",{value:"nl",children:" Nederlands"}),(0,dh.jsx)("option",{value:"zh_TW",children:"  ()"}),(0,dh.jsx)("option",{value:"pt_PT",children:" Portugus (Portugal)"}),(0,dh.jsx)("option",{value:"uk",children:" "}),(0,dh.jsx)("option",{value:"ta",children:" "}),(0,dh.jsx)("option",{value:"te",children:" "}),(0,dh.jsx)("option",{value:"he",children:" "}),(0,dh.jsx)("option",{value:"fil",children:" Filipino"}),(0,dh.jsx)("option",{value:"sv",children:" Svenska"}),(0,dh.jsx)("option",{value:"fi",children:" Suomi"})]})]})]}),(0,dh.jsx)(dg,{config:P,isSessionActive:C,isPreviewExpanded:M,setIsPreviewExpanded:R,getProcessedSystemInstructions:f,availableModels:v,loadingModels:y,fetchAvailableModels:b}),(0,dh.jsxs)("div",{className:"settings-section",children:[(0,dh.jsx)("h2",{children:w("settings.help","Help")}),(0,dh.jsx)("div",{className:"setting-item",children:(0,dh.jsxs)("button",{className:"restart-onboarding-button",onClick:()=>{S(),t&&t()},children:[(0,dh.jsx)(eg,{size:16}),(0,dh.jsx)("span",{children:w("onboarding.restartTour","Restart Setup Guide")})]})})]})]})]})},hg=je("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),gg=je("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),mg=je("fast-forward",[["polygon",{points:"13 19 22 12 13 5 13 19",key:"587y9g"}],["polygon",{points:"2 19 11 12 2 5 2 19",key:"3pweh0"}]]),fg=je("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),vg=je("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);var yg=n(440),bg={};bg.styleTagTransform=tt(),bg.setAttributes=Ye(),bg.insert=Je().bind(null,"head"),bg.domAPI=Ge(),bg.insertStyleElement=Xe(),He()(yg.A,bg),yg.A&&yg.A.locals&&yg.A.locals;const kg=e=>{let{logEntry:t}=e;const{t:n}=le(),[o,a]=(0,i.useState)(!1),{events:r,source:s,timestamp:l,eventType:c}=t;if(!r||!r.length||!s)return null;const u="client"===s,d=c||n("logsPanel.unknown"),p=r.length>1,h=r[r.length-1];return(0,dh.jsxs)("div",{className:"event-entry",children:[(0,dh.jsxs)("div",{className:"event-header",onClick:()=>a(!o),children:[(0,dh.jsx)("span",{className:"log-timestamp",children:l}),u?(0,dh.jsx)(hg,{className:"client-icon"}):(0,dh.jsx)(gg,{className:"server-icon"}),(0,dh.jsxs)("div",{className:"event-info",children:[(0,dh.jsxs)("span",{className:"source-label",children:[n(u?"logsPanel.client":"logsPanel.server"),":"]}),(0,dh.jsx)("span",{className:"event-type",children:d}),p&&(0,dh.jsxs)("span",{className:"event-count",children:["(",r.length,")"]})]})]}),o&&(0,dh.jsx)("div",{className:"event-details",children:p?(0,dh.jsx)("div",{className:"grouped-events",children:r.map(((e,t)=>(0,dh.jsxs)("div",{className:"grouped-event",children:[(0,dh.jsx)("div",{className:"grouped-event-header",children:(0,dh.jsxs)("span",{className:"grouped-event-index",children:[n("logsPanel.event")," ",t+1," ",n("logsPanel.of")," ",r.length]})}),(0,dh.jsx)("pre",{children:JSON.stringify(e,null,2)})]},t)))}):(0,dh.jsx)("pre",{children:JSON.stringify(h,null,2)})})]})},Sg=e=>{let{toggleLogs:t}=e;const{t:n}=le(),{logs:o,clearLogs:a}=Eh(),[r,s]=(0,i.useState)(!0),l=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(r&&l.current){const{current:e}=l;e.scrollTop=e.scrollHeight}}),[o,r]),(0,dh.jsxs)("div",{className:"logs-panel",children:[(0,dh.jsxs)("div",{className:"logs-panel-header",children:[(0,dh.jsx)("h2",{children:n("logsPanel.title")}),(0,dh.jsxs)("div",{className:"header-actions",children:[(0,dh.jsxs)("button",{className:"auto-scroll-button "+(r?"active":""),onClick:()=>{s(!r)},title:n(r?"logsPanel.disableAutoScroll":"logsPanel.enableAutoScroll"),children:[(0,dh.jsx)(mg,{size:16}),(0,dh.jsx)("span",{children:n(r?"logsPanel.autoScrollOn":"logsPanel.autoScrollOff")})]}),o.length>0&&(0,dh.jsxs)("button",{className:"clear-logs-button",onClick:a,children:[(0,dh.jsx)(fg,{size:16}),(0,dh.jsx)("span",{children:n("common.clear")})]}),(0,dh.jsxs)("button",{className:"close-logs-button",onClick:t,children:[(0,dh.jsx)(Yh,{size:16}),(0,dh.jsx)("span",{children:n("common.close")})]})]})]}),(0,dh.jsx)("div",{className:"logs-content",ref:l,children:o.length>0?o.map(((e,t)=>e.events&&e.events.length>0&&e.source?(0,dh.jsx)(kg,{logEntry:e},t):(0,dh.jsxs)("div",{className:`log-entry ${e.type||""}`,children:[(0,dh.jsx)("span",{className:"log-timestamp",children:e.timestamp}),(0,dh.jsx)("span",{className:"log-message",children:e.message})]},t))):(0,dh.jsx)("div",{className:"logs-placeholder",children:(0,dh.jsxs)("div",{className:"placeholder-content",children:[(0,dh.jsx)("div",{className:"icon-container",children:(0,dh.jsx)(vg,{size:24})}),(0,dh.jsx)("span",{children:n("logsPanel.logsPlaceholder")})]})})})]})},wg=je("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Tg=je("audio-lines",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]);var Cg=n(6006),Pg={};Pg.styleTagTransform=tt(),Pg.setAttributes=Ye(),Pg.insert=Je().bind(null,"head"),Pg.domAPI=Ge(),Pg.insertStyleElement=Xe(),He()(Cg.A,Pg),Cg.A&&Cg.A.locals&&Cg.A.locals;var xg=n(4628),Ig={};Ig.styleTagTransform=tt(),Ig.setAttributes=Ye(),Ig.insert=Je().bind(null,"head"),Ig.domAPI=Ge(),Ig.insertStyleElement=Xe(),He()(xg.A,Ig),xg.A&&xg.A.locals&&xg.A.locals;const Ag=e=>{let{isOpen:t,onClose:n,title:i,children:o}=e;return t?(0,dh.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,dh.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,dh.jsxs)("div",{className:"modal-header",children:[(0,dh.jsx)("h3",{children:i}),(0,dh.jsx)("button",{className:"close-button",onClick:n,children:(0,dh.jsx)(Ve,{size:18})})]}),(0,dh.jsx)("div",{className:"modal-body",children:o})]})}):null},Eg=e=>{let{toggleAudio:t}=e;const{t:n}=le(),[o,a]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),{audioInputDevices:l,audioMonitorDevices:c,selectedInputDevice:u,selectedMonitorDevice:d,isInputDeviceOn:p,isMonitorDeviceOn:h,isLoading:g,isRealVoicePassthroughEnabled:m,realVoicePassthroughVolume:f,selectInputDevice:v,selectMonitorDevice:y,toggleInputDeviceState:b,toggleMonitorDeviceState:k,toggleRealVoicePassthrough:S,setRealVoicePassthroughVolume:w,refreshDevices:T}=xh(),C=e=>e.label.toLowerCase().includes("sokuji_virtual_mic"),P=e=>e.label.toLowerCase().includes("sokuji_virtual_speaker");return(0,dh.jsxs)("div",{className:"audio-panel",children:[(0,dh.jsx)(Ag,{isOpen:o,onClose:()=>a(!1),title:n("audioPanel.virtualMicrophoneNotice"),children:(0,dh.jsxs)("div",{className:"virtual-mic-warning",children:[(0,dh.jsx)("div",{className:"warning-icon",children:(0,dh.jsx)(Vh,{size:24,color:"#f0ad4e"})}),(0,dh.jsx)("p",{children:(0,dh.jsx)("strong",{children:n("audioPanel.virtualMicWarningTitle")})}),(0,dh.jsx)("p",{children:n("audioPanel.virtualMicWarningText1")}),(0,dh.jsx)("p",{children:n("audioPanel.virtualMicWarningText2")}),(0,dh.jsx)("button",{className:"understand-button",onClick:()=>a(!1),children:n("audioPanel.iUnderstand")})]})}),(0,dh.jsx)(Ag,{isOpen:r,onClose:()=>s(!1),title:n("audioPanel.virtualSpeakerNotice"),children:(0,dh.jsxs)("div",{className:"virtual-mic-warning",children:[(0,dh.jsx)("div",{className:"warning-icon",children:(0,dh.jsx)(Vh,{size:24,color:"#f0ad4e"})}),(0,dh.jsx)("p",{children:(0,dh.jsx)("strong",{children:n("audioPanel.virtualSpeakerWarningTitle")})}),(0,dh.jsx)("p",{children:n("audioPanel.virtualSpeakerWarningText1")}),(0,dh.jsx)("p",{children:n("audioPanel.virtualSpeakerWarningText2")}),(0,dh.jsx)("p",{children:n("audioPanel.virtualSpeakerWarningText3")}),(0,dh.jsx)("p",{children:n("audioPanel.virtualSpeakerWarningText4")}),(0,dh.jsx)("button",{className:"understand-button",onClick:()=>s(!1),children:n("audioPanel.iUnderstand")})]})}),(0,dh.jsxs)("div",{className:"audio-panel-header",children:[(0,dh.jsx)("h2",{children:n("audioPanel.title")}),(0,dh.jsxs)("button",{className:"close-audio-button",onClick:t,children:[(0,dh.jsx)(Yh,{size:16}),(0,dh.jsx)("span",{children:n("common.close")})]})]}),(0,dh.jsxs)("div",{className:"audio-content",children:[(0,dh.jsxs)("div",{className:"audio-section microphone-section",children:[(0,dh.jsx)("h3",{children:n("audioPanel.audioInputDevice")}),(0,dh.jsxs)("div",{className:"device-selector",children:[(0,dh.jsxs)("div",{className:"device-status",children:[(0,dh.jsx)("div",{className:"device-icon "+(p?"active":"inactive"),children:(0,dh.jsx)(ze,{size:18})}),(0,dh.jsx)("div",{className:"device-info",children:(0,dh.jsx)("div",{className:"device-name",children:g?n("audioPanel.loadingDevices"):u?.label||n("audioPanel.noDeviceSelected")})})]}),(0,dh.jsx)("button",{className:"device-toggle-button "+(p?"on":"off"),onClick:b,children:n(p?"audioPanel.turnOff":"audioPanel.turnOn")})]}),(0,dh.jsxs)("div",{className:"device-list",children:[(0,dh.jsxs)("div",{className:"device-list-header",children:[(0,dh.jsx)("h4",{children:n("audioPanel.availableInputDevices")}),(0,dh.jsx)("button",{className:"refresh-button",onClick:()=>T(),disabled:g,title:n("audioPanel.refreshInputDevices"),children:(0,dh.jsx)(wg,{size:14})})]}),l.map(((e,t)=>(0,dh.jsxs)("div",{className:"device-option "+(u?.deviceId===e.deviceId?"selected":""),onClick:()=>(e=>{C(e)?a(!0):v(e)})(e),children:[(0,dh.jsx)("span",{children:e.label}),C(e)&&(0,dh.jsx)("div",{className:"virtual-indicator",title:n("audioPanel.virtualMicrophone"),children:(0,dh.jsx)(Vh,{size:14,color:"#f0ad4e"})}),u?.deviceId===e.deviceId&&(0,dh.jsx)("div",{className:"selected-indicator"})]},t)))]})]}),(0,dh.jsxs)("div",{className:"audio-section speaker-section",children:[(0,dh.jsx)("h3",{children:n("audioPanel.virtualSpeakerMonitorDevice")}),(0,dh.jsxs)("div",{className:"device-selector",children:[(0,dh.jsxs)("div",{className:"device-status",children:[(0,dh.jsx)("div",{className:"device-icon "+(h?"active":"inactive"),children:(0,dh.jsx)(Le,{size:18})}),(0,dh.jsx)("div",{className:"device-info",children:(0,dh.jsx)("div",{className:"device-name",children:g?n("audioPanel.loadingDevices"):d?.label||n("audioPanel.noDeviceSelected")})})]}),(0,dh.jsx)("button",{className:"device-toggle-button "+(h?"on":"off"),onClick:k,children:n(h?"audioPanel.turnOff":"audioPanel.turnOn")})]}),(0,dh.jsxs)("div",{className:"device-list",children:[(0,dh.jsxs)("div",{className:"device-list-header",children:[(0,dh.jsx)("h4",{children:n("audioPanel.availableMonitorDevices")}),(0,dh.jsx)("button",{className:"refresh-button",onClick:()=>T(),disabled:g,title:n("audioPanel.refreshMonitorDevices"),children:(0,dh.jsx)(wg,{size:14})})]}),c.map(((e,t)=>(0,dh.jsxs)("div",{className:"device-option "+(d?.deviceId===e.deviceId?"selected":""),onClick:()=>(e=>{P(e)?s(!0):y(e)})(e),children:[(0,dh.jsx)("span",{children:e.label}),P(e)&&(0,dh.jsx)("div",{className:"virtual-indicator",title:n("audioPanel.virtualSpeaker"),children:(0,dh.jsx)(Vh,{size:14,color:"#f0ad4e"})}),d?.deviceId===e.deviceId&&(0,dh.jsx)("div",{className:"selected-indicator"})]},t)))]})]}),(0,dh.jsxs)("div",{className:"audio-section voice-passthrough-section",children:[(0,dh.jsx)("h3",{children:n("audioPanel.realVoicePassthrough")}),(0,dh.jsxs)("div",{className:"device-selector",children:[(0,dh.jsxs)("div",{className:"device-status",children:[(0,dh.jsx)("div",{className:"device-icon "+(m?"active":"inactive"),children:(0,dh.jsx)(Tg,{size:18})}),(0,dh.jsxs)("div",{className:"device-info",children:[(0,dh.jsx)("div",{className:"device-name",children:n("audioPanel.enableRealVoicePassthrough")}),(0,dh.jsx)("div",{className:"device-description",children:n("audioPanel.realVoicePassthroughDescription")})]})]}),(0,dh.jsx)("button",{className:"device-toggle-button "+(m?"on":"off"),onClick:S,children:n(m?"audioPanel.turnOff":"audioPanel.turnOn")})]}),(0,dh.jsx)("div",{className:"device-list",children:(0,dh.jsxs)("div",{className:"volume-control "+(m?"":"disabled"),children:[(0,dh.jsxs)("div",{className:"setting-label",children:[(0,dh.jsx)("span",{children:n("audioPanel.realVoiceVolume")}),(0,dh.jsxs)("span",{className:"setting-value",children:[Math.round(100*f),"%"]})]}),(0,dh.jsx)("input",{type:"range",min:"0",max:"0.6",step:"0.01",value:f,onChange:e=>w(parseFloat(e.target.value)),className:"volume-slider",disabled:!m}),(0,dh.jsxs)("div",{className:"volume-limits",children:[(0,dh.jsx)("span",{children:"0%"}),(0,dh.jsx)("span",{children:"60%"})]})]})})]})]})]})};function Og(e){return t=>typeof t===e}var _g=Og("function"),Ng=e=>"RegExp"===Object.prototype.toString.call(e).slice(8,-1),Mg=e=>!Rg(e)&&!(e=>null===e)(e)&&(_g(e)||"object"==typeof e),Rg=Og("undefined");function jg(e,t){if(e===t)return!0;if(e&&Mg(e)&&t&&Mg(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return function(e,t){const{length:n}=e;if(n!==t.length)return!1;for(let i=n;0!=i--;)if(!jg(e[i],t[i]))return!1;return!0}(e,t);if(e instanceof Map&&t instanceof Map)return function(e,t){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;for(const n of e.entries())if(!jg(n[1],t.get(n[0])))return!1;return!0}(e,t);if(e instanceof Set&&t instanceof Set)return function(e,t){if(e.size!==t.size)return!1;for(const n of e.entries())if(!t.has(n[0]))return!1;return!0}(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return function(e,t){if(e.byteLength!==t.byteLength)return!1;const n=new DataView(e.buffer),i=new DataView(t.buffer);let o=e.byteLength;for(;o--;)if(n.getUint8(o)!==i.getUint8(o))return!1;return!0}(e,t);if(Ng(e)&&Ng(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(let e=n.length;0!=e--;)if(!Object.prototype.hasOwnProperty.call(t,n[e]))return!1;for(let i=n.length;0!=i--;){const o=n[i];if(!("_owner"===o&&e.$$typeof||jg(e[o],t[o])))return!1}return!0}return!(!Number.isNaN(e)||!Number.isNaN(t))||e===t}var Dg=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],Lg=["bigint","boolean","null","number","string","symbol","undefined"];function Fg(e){const t=Object.prototype.toString.call(e).slice(8,-1);return/HTML\w+Element/.test(t)?"HTMLElement":(n=t,Dg.includes(n)?t:void 0);var n}function zg(e){return t=>Fg(t)===e}function Ug(e){return t=>typeof t===e}var Vg=["innerHTML","ownerDocument","style","attributes","nodeValue"];function Bg(e){if(null===e)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Bg.array(e))return"Array";if(Bg.plainFunction(e))return"Function";return Fg(e)||"Object"}Bg.array=Array.isArray,Bg.arrayOf=(e,t)=>!(!Bg.array(e)&&!Bg.function(t))&&e.every((e=>t(e))),Bg.asyncGeneratorFunction=e=>"AsyncGeneratorFunction"===Fg(e),Bg.asyncFunction=zg("AsyncFunction"),Bg.bigint=Ug("bigint"),Bg.boolean=e=>!0===e||!1===e,Bg.date=zg("Date"),Bg.defined=e=>!Bg.undefined(e),Bg.domElement=e=>Bg.object(e)&&!Bg.plainObject(e)&&1===e.nodeType&&Bg.string(e.nodeName)&&Vg.every((t=>t in e)),Bg.empty=e=>Bg.string(e)&&0===e.length||Bg.array(e)&&0===e.length||Bg.object(e)&&!Bg.map(e)&&!Bg.set(e)&&0===Object.keys(e).length||Bg.set(e)&&0===e.size||Bg.map(e)&&0===e.size,Bg.error=zg("Error"),Bg.function=Ug("function"),Bg.generator=e=>Bg.iterable(e)&&Bg.function(e.next)&&Bg.function(e.throw),Bg.generatorFunction=zg("GeneratorFunction"),Bg.instanceOf=(e,t)=>!(!e||!t)&&Object.getPrototypeOf(e)===t.prototype,Bg.iterable=e=>!Bg.nullOrUndefined(e)&&Bg.function(e[Symbol.iterator]),Bg.map=zg("Map"),Bg.nan=e=>Number.isNaN(e),Bg.null=e=>null===e,Bg.nullOrUndefined=e=>Bg.null(e)||Bg.undefined(e),Bg.number=e=>Ug("number")(e)&&!Bg.nan(e),Bg.numericString=e=>Bg.string(e)&&e.length>0&&!Number.isNaN(Number(e)),Bg.object=e=>!Bg.nullOrUndefined(e)&&(Bg.function(e)||"object"==typeof e),Bg.oneOf=(e,t)=>!!Bg.array(e)&&e.indexOf(t)>-1,Bg.plainFunction=zg("Function"),Bg.plainObject=e=>{if("Object"!==Fg(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},Bg.primitive=e=>{return Bg.null(e)||(t=typeof e,Lg.includes(t));var t},Bg.promise=zg("Promise"),Bg.propertyOf=(e,t,n)=>{if(!Bg.object(e)||!t)return!1;const i=e[t];return Bg.function(n)?n(i):Bg.defined(i)},Bg.regexp=zg("RegExp"),Bg.set=zg("Set"),Bg.string=Ug("string"),Bg.symbol=Ug("symbol"),Bg.undefined=Ug("undefined"),Bg.weakMap=zg("WeakMap"),Bg.weakSet=zg("WeakSet");var qg=Bg;function Kg(e,t,n){const{actual:i,key:o,previous:a,type:r}=n,s=Zg(e,o),l=Zg(t,o);let c=[s,l].every(qg.number)&&("increased"===r?s<l:s>l);return qg.undefined(i)||(c=c&&l===i),qg.undefined(a)||(c=c&&s===a),c}function Hg(e,t,n){const{key:i,type:o,value:a}=n,r=Zg(e,i),s=Zg(t,i),l="added"===o?r:s,c="added"===o?s:r;return qg.nullOrUndefined(a)?[r,s].every(qg.array)?!c.every(Qg(l)):[r,s].every(qg.plainObject)?function(e,t){return t.some((t=>!e.includes(t)))}(Object.keys(l),Object.keys(c)):![r,s].every((e=>qg.primitive(e)&&qg.defined(e)))&&("added"===o?!qg.defined(r)&&qg.defined(s):qg.defined(r)&&!qg.defined(s)):qg.defined(l)?!(!qg.array(l)&&!qg.plainObject(l))&&function(e,t,n){return!!Yg(e,t)&&([e,t].every(qg.array)?!e.some($g(n))&&t.some($g(n)):[e,t].every(qg.plainObject)?!Object.entries(e).some(Gg(n))&&Object.entries(t).some(Gg(n)):t===n)}(l,c,a):jg(c,a)}function Wg(e,t,{key:n}={}){let i=Zg(e,n),o=Zg(t,n);if(!Yg(i,o))throw new TypeError("Inputs have different types");if(!function(...e){return e.every((e=>qg.string(e)||qg.array(e)||qg.plainObject(e)))}(i,o))throw new TypeError("Inputs don't have length");return[i,o].every(qg.plainObject)&&(i=Object.keys(i),o=Object.keys(o)),[i,o]}function Gg(e){return([t,n])=>qg.array(e)?jg(e,n)||e.some((e=>jg(e,n)||qg.array(n)&&Qg(n)(e))):qg.plainObject(e)&&e[t]?!!e[t]&&jg(e[t],n):jg(e,n)}function $g(e){return t=>qg.array(e)?e.some((e=>jg(e,t)||qg.array(t)&&Qg(t)(e))):jg(e,t)}function Jg(e,t){return qg.array(e)?e.some((e=>jg(e,t))):jg(e,t)}function Qg(e){return t=>e.some((e=>jg(e,t)))}function Yg(...e){return e.every(qg.array)||e.every(qg.number)||e.every(qg.plainObject)||e.every(qg.string)}function Zg(e,t){return qg.plainObject(e)||qg.array(e)?qg.string(t)?t.split(".").reduce(((e,t)=>e&&e[t]),e):qg.number(t)?e[t]:e:e}function Xg(e,t){if([e,t].some(qg.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every((e=>qg.plainObject(e)||qg.array(e))))throw new Error("Expected plain objects or array");return{added:(n,i)=>{try{return Hg(e,t,{key:n,type:"added",value:i})}catch{return!1}},changed:(n,i,o)=>{try{const a=Zg(e,n),r=Zg(t,n),s=qg.defined(i),l=qg.defined(o);if(s||l){const e=l?Jg(o,a):!Jg(i,a),t=Jg(i,r);return e&&t}return[a,r].every(qg.array)||[a,r].every(qg.plainObject)?!jg(a,r):a!==r}catch{return!1}},changedFrom:(n,i,o)=>{if(!qg.defined(n))return!1;try{const a=Zg(e,n),r=Zg(t,n),s=qg.defined(o);return Jg(i,a)&&(s?Jg(o,r):!s)}catch{return!1}},decreased:(n,i,o)=>{if(!qg.defined(n))return!1;try{return Kg(e,t,{key:n,actual:i,previous:o,type:"decreased"})}catch{return!1}},emptied:n=>{try{const[i,o]=Wg(e,t,{key:n});return!!i.length&&!o.length}catch{return!1}},filled:n=>{try{const[i,o]=Wg(e,t,{key:n});return!i.length&&!!o.length}catch{return!1}},increased:(n,i,o)=>{if(!qg.defined(n))return!1;try{return Kg(e,t,{key:n,actual:i,previous:o,type:"increased"})}catch{return!1}},removed:(n,i)=>{try{return Hg(e,t,{key:n,type:"removed",value:i})}catch{return!1}}}}var em=n(1328),tm=n(6467),nm=n(8325),im=n(9198),om=n(4156),am=n.n(om),rm=n(2688),sm=n.n(rm),lm="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,cm=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(lm&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}(),um=lm&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),cm))}};function dm(e){return e&&"[object Function]"==={}.toString.call(e)}function pm(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?n[t]:n}function hm(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function gm(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=pm(e),n=t.overflow,i=t.overflowX,o=t.overflowY;return/(auto|scroll|overlay)/.test(n+o+i)?e:gm(hm(e))}function mm(e){return e&&e.referenceNode?e.referenceNode:e}var fm=lm&&!(!window.MSInputMethodContext||!document.documentMode),vm=lm&&/MSIE 10/.test(navigator.userAgent);function ym(e){return 11===e?fm:10===e?vm:fm||vm}function bm(e){if(!e)return document.documentElement;for(var t=ym(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var i=n&&n.nodeName;return i&&"BODY"!==i&&"HTML"!==i?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===pm(n,"position")?bm(n):n:e?e.ownerDocument.documentElement:document.documentElement}function km(e){return null!==e.parentNode?km(e.parentNode):e}function Sm(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,i=n?e:t,o=n?t:e,a=document.createRange();a.setStart(i,0),a.setEnd(o,0);var r,s,l=a.commonAncestorContainer;if(e!==l&&t!==l||i.contains(o))return"BODY"===(s=(r=l).nodeName)||"HTML"!==s&&bm(r.firstElementChild)!==r?bm(l):l;var c=km(e);return c.host?Sm(c.host,t):Sm(e,km(t).host)}function wm(e){var t="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",n=e.nodeName;if("BODY"===n||"HTML"===n){var i=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||i)[t]}return e[t]}function Tm(e,t){var n="x"===t?"Left":"Top",i="Left"===n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+i+"Width"])}function Cm(e,t,n,i){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],ym(10)?parseInt(n["offset"+e])+parseInt(i["margin"+("Height"===e?"Top":"Left")])+parseInt(i["margin"+("Height"===e?"Bottom":"Right")]):0)}function Pm(e){var t=e.body,n=e.documentElement,i=ym(10)&&getComputedStyle(n);return{height:Cm("Height",t,n,i),width:Cm("Width",t,n,i)}}var xm=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Im=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Am=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function Em(e){return Am({},e,{right:e.left+e.width,bottom:e.top+e.height})}function Om(e){var t={};try{if(ym(10)){t=e.getBoundingClientRect();var n=wm(e,"top"),i=wm(e,"left");t.top+=n,t.left+=i,t.bottom+=n,t.right+=i}else t=e.getBoundingClientRect()}catch(e){}var o={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},a="HTML"===e.nodeName?Pm(e.ownerDocument):{},r=a.width||e.clientWidth||o.width,s=a.height||e.clientHeight||o.height,l=e.offsetWidth-r,c=e.offsetHeight-s;if(l||c){var u=pm(e);l-=Tm(u,"x"),c-=Tm(u,"y"),o.width-=l,o.height-=c}return Em(o)}function _m(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=ym(10),o="HTML"===t.nodeName,a=Om(e),r=Om(t),s=gm(e),l=pm(t),c=parseFloat(l.borderTopWidth),u=parseFloat(l.borderLeftWidth);n&&o&&(r.top=Math.max(r.top,0),r.left=Math.max(r.left,0));var d=Em({top:a.top-r.top-c,left:a.left-r.left-u,width:a.width,height:a.height});if(d.marginTop=0,d.marginLeft=0,!i&&o){var p=parseFloat(l.marginTop),h=parseFloat(l.marginLeft);d.top-=c-p,d.bottom-=c-p,d.left-=u-h,d.right-=u-h,d.marginTop=p,d.marginLeft=h}return(i&&!n?t.contains(s):t===s&&"BODY"!==s.nodeName)&&(d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=wm(t,"top"),o=wm(t,"left"),a=n?-1:1;return e.top+=i*a,e.bottom+=i*a,e.left+=o*a,e.right+=o*a,e}(d,t)),d}function Nm(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===pm(e,"position"))return!0;var n=hm(e);return!!n&&Nm(n)}function Mm(e){if(!e||!e.parentElement||ym())return document.documentElement;for(var t=e.parentElement;t&&"none"===pm(t,"transform");)t=t.parentElement;return t||document.documentElement}function Rm(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a={top:0,left:0},r=o?Mm(e):Sm(e,mm(t));if("viewport"===i)a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,i=_m(e,n),o=Math.max(n.clientWidth,window.innerWidth||0),a=Math.max(n.clientHeight,window.innerHeight||0),r=t?0:wm(n),s=t?0:wm(n,"left");return Em({top:r-i.top+i.marginTop,left:s-i.left+i.marginLeft,width:o,height:a})}(r,o);else{var s=void 0;"scrollParent"===i?"BODY"===(s=gm(hm(t))).nodeName&&(s=e.ownerDocument.documentElement):s="window"===i?e.ownerDocument.documentElement:i;var l=_m(s,r,o);if("HTML"!==s.nodeName||Nm(r))a=l;else{var c=Pm(e.ownerDocument),u=c.height,d=c.width;a.top+=l.top-l.marginTop,a.bottom=u+l.top,a.left+=l.left-l.marginLeft,a.right=d+l.left}}var p="number"==typeof(n=n||0);return a.left+=p?n:n.left||0,a.top+=p?n:n.top||0,a.right-=p?n:n.right||0,a.bottom-=p?n:n.bottom||0,a}function jm(e,t,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var r=Rm(n,i,a,o),s={top:{width:r.width,height:t.top-r.top},right:{width:r.right-t.right,height:r.height},bottom:{width:r.width,height:r.bottom-t.bottom},left:{width:t.left-r.left,height:r.height}},l=Object.keys(s).map((function(e){return Am({key:e},s[e],{area:(t=s[e],t.width*t.height)});var t})).sort((function(e,t){return t.area-e.area})),c=l.filter((function(e){var t=e.width,i=e.height;return t>=n.clientWidth&&i>=n.clientHeight})),u=c.length>0?c[0].key:l[0].key,d=e.split("-")[1];return u+(d?"-"+d:"")}function Dm(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _m(n,i?Mm(t):Sm(t,mm(n)),i)}function Lm(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),i=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+i,height:e.offsetHeight+n}}function Fm(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function zm(e,t,n){n=n.split("-")[0];var i=Lm(e),o={width:i.width,height:i.height},a=-1!==["right","left"].indexOf(n),r=a?"top":"left",s=a?"left":"top",l=a?"height":"width",c=a?"width":"height";return o[r]=t[r]+t[l]/2-i[l]/2,o[s]=n===s?t[s]-i[c]:t[Fm(s)],o}function Um(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function Vm(e,t,n){return(void 0===n?e:e.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===n}));var i=Um(e,(function(e){return e[t]===n}));return e.indexOf(i)}(e,"name",n))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=e.function||e.fn;e.enabled&&dm(n)&&(t.offsets.popper=Em(t.offsets.popper),t.offsets.reference=Em(t.offsets.reference),t=n(t,e))})),t}function Bm(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=Dm(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=jm(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=zm(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=Vm(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function qm(e,t){return e.some((function(e){var n=e.name;return e.enabled&&n===t}))}function Km(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),i=0;i<t.length;i++){var o=t[i],a=o?""+o+n:e;if(void 0!==document.body.style[a])return a}return null}function Hm(){return this.state.isDestroyed=!0,qm(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Km("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function Wm(e){var t=e.ownerDocument;return t?t.defaultView:window}function Gm(e,t,n,i){var o="BODY"===e.nodeName,a=o?e.ownerDocument.defaultView:e;a.addEventListener(t,n,{passive:!0}),o||Gm(gm(a.parentNode),t,n,i),i.push(a)}function $m(e,t,n,i){n.updateBound=i,Wm(e).addEventListener("resize",n.updateBound,{passive:!0});var o=gm(e);return Gm(o,"scroll",n.updateBound,n.scrollParents),n.scrollElement=o,n.eventsEnabled=!0,n}function Jm(){this.state.eventsEnabled||(this.state=$m(this.reference,this.options,this.state,this.scheduleUpdate))}function Qm(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,Wm(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function Ym(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function Zm(e,t){Object.keys(t).forEach((function(n){var i="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&Ym(t[n])&&(i="px"),e.style[n]=t[n]+i}))}var Xm=lm&&/Firefox/i.test(navigator.userAgent);function ef(e,t,n){var i=Um(e,(function(e){return e.name===t})),o=!!i&&e.some((function(e){return e.name===n&&e.enabled&&e.order<i.order}));if(!o){var a="`"+t+"`",r="`"+n+"`";console.warn(r+" modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return o}var tf=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],nf=tf.slice(3);function of(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=nf.indexOf(e),i=nf.slice(n+1).concat(nf.slice(0,n));return t?i.reverse():i}var af={shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],i=t.split("-")[1];if(i){var o=e.offsets,a=o.reference,r=o.popper,s=-1!==["bottom","top"].indexOf(n),l=s?"left":"top",c=s?"width":"height",u={start:Im({},l,a[l]),end:Im({},l,a[l]+a[c]-r[c])};e.offsets.popper=Am({},r,u[i])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n,i=t.offset,o=e.placement,a=e.offsets,r=a.popper,s=a.reference,l=o.split("-")[0];return n=Ym(+i)?[+i,0]:function(e,t,n,i){var o=[0,0],a=-1!==["right","left"].indexOf(i),r=e.split(/(\+|\-)/).map((function(e){return e.trim()})),s=r.indexOf(Um(r,(function(e){return-1!==e.search(/,|\s/)})));r[s]&&-1===r[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,c=-1!==s?[r.slice(0,s).concat([r[s].split(l)[0]]),[r[s].split(l)[1]].concat(r.slice(s+1))]:[r];return(c=c.map((function(e,i){var o=(1===i?!a:a)?"height":"width",r=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,r=!0,e):r?(e[e.length-1]+=t,r=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,n,i){var o=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+o[1],r=o[2];return a?0===r.indexOf("%")?Em("%p"===r?n:i)[t]/100*a:"vh"===r||"vw"===r?("vh"===r?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a:e}(e,o,t,n)}))}))).forEach((function(e,t){e.forEach((function(n,i){Ym(n)&&(o[t]+=n*("-"===e[i-1]?-1:1))}))})),o}(i,r,s,l),"left"===l?(r.top+=n[0],r.left-=n[1]):"right"===l?(r.top+=n[0],r.left+=n[1]):"top"===l?(r.left+=n[0],r.top-=n[1]):"bottom"===l&&(r.left+=n[0],r.top+=n[1]),e.popper=r,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||bm(e.instance.popper);e.instance.reference===n&&(n=bm(n));var i=Km("transform"),o=e.instance.popper.style,a=o.top,r=o.left,s=o[i];o.top="",o.left="",o[i]="";var l=Rm(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);o.top=a,o.left=r,o[i]=s,t.boundaries=l;var c=t.priority,u=e.offsets.popper,d={primary:function(e){var n=u[e];return u[e]<l[e]&&!t.escapeWithReference&&(n=Math.max(u[e],l[e])),Im({},e,n)},secondary:function(e){var n="right"===e?"left":"top",i=u[n];return u[e]>l[e]&&!t.escapeWithReference&&(i=Math.min(u[n],l[e]-("right"===e?u.width:u.height))),Im({},n,i)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";u=Am({},u,d[t](e))})),e.offsets.popper=u,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,i=t.reference,o=e.placement.split("-")[0],a=Math.floor,r=-1!==["top","bottom"].indexOf(o),s=r?"right":"bottom",l=r?"left":"top",c=r?"width":"height";return n[s]<a(i[l])&&(e.offsets.popper[l]=a(i[l])-n[c]),n[l]>a(i[s])&&(e.offsets.popper[l]=a(i[s])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var n;if(!ef(e.instance.modifiers,"arrow","keepTogether"))return e;var i=t.element;if("string"==typeof i){if(!(i=e.instance.popper.querySelector(i)))return e}else if(!e.instance.popper.contains(i))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var o=e.placement.split("-")[0],a=e.offsets,r=a.popper,s=a.reference,l=-1!==["left","right"].indexOf(o),c=l?"height":"width",u=l?"Top":"Left",d=u.toLowerCase(),p=l?"left":"top",h=l?"bottom":"right",g=Lm(i)[c];s[h]-g<r[d]&&(e.offsets.popper[d]-=r[d]-(s[h]-g)),s[d]+g>r[h]&&(e.offsets.popper[d]+=s[d]+g-r[h]),e.offsets.popper=Em(e.offsets.popper);var m=s[d]+s[c]/2-g/2,f=pm(e.instance.popper),v=parseFloat(f["margin"+u]),y=parseFloat(f["border"+u+"Width"]),b=m-e.offsets.popper[d]-v-y;return b=Math.max(Math.min(r[c]-g,b),0),e.arrowElement=i,e.offsets.arrow=(Im(n={},d,Math.round(b)),Im(n,p,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(qm(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=Rm(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),i=e.placement.split("-")[0],o=Fm(i),a=e.placement.split("-")[1]||"",r=[];switch(t.behavior){case"flip":r=[i,o];break;case"clockwise":r=of(i);break;case"counterclockwise":r=of(i,!0);break;default:r=t.behavior}return r.forEach((function(s,l){if(i!==s||r.length===l+1)return e;i=e.placement.split("-")[0],o=Fm(i);var c=e.offsets.popper,u=e.offsets.reference,d=Math.floor,p="left"===i&&d(c.right)>d(u.left)||"right"===i&&d(c.left)<d(u.right)||"top"===i&&d(c.bottom)>d(u.top)||"bottom"===i&&d(c.top)<d(u.bottom),h=d(c.left)<d(n.left),g=d(c.right)>d(n.right),m=d(c.top)<d(n.top),f=d(c.bottom)>d(n.bottom),v="left"===i&&h||"right"===i&&g||"top"===i&&m||"bottom"===i&&f,y=-1!==["top","bottom"].indexOf(i),b=!!t.flipVariations&&(y&&"start"===a&&h||y&&"end"===a&&g||!y&&"start"===a&&m||!y&&"end"===a&&f),k=!!t.flipVariationsByContent&&(y&&"start"===a&&g||y&&"end"===a&&h||!y&&"start"===a&&f||!y&&"end"===a&&m),S=b||k;(p||v||S)&&(e.flipped=!0,(p||v)&&(i=r[l+1]),S&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=i+(a?"-"+a:""),e.offsets.popper=Am({},e.offsets.popper,zm(e.instance.popper,e.offsets.reference,e.placement)),e=Vm(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],i=e.offsets,o=i.popper,a=i.reference,r=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return o[r?"left":"top"]=a[n]-(s?o[r?"width":"height"]:0),e.placement=Fm(t),e.offsets.popper=Em(o),e}},hide:{order:800,enabled:!0,fn:function(e){if(!ef(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=Um(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,i=t.y,o=e.offsets.popper,a=Um(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var r,s,l=void 0!==a?a:t.gpuAcceleration,c=bm(e.instance.popper),u=Om(c),d={position:o.position},p=function(e,t){var n=e.offsets,i=n.popper,o=n.reference,a=Math.round,r=Math.floor,s=function(e){return e},l=a(o.width),c=a(i.width),u=-1!==["left","right"].indexOf(e.placement),d=-1!==e.placement.indexOf("-"),p=t?u||d||l%2==c%2?a:r:s,h=t?a:s;return{left:p(l%2==1&&c%2==1&&!d&&t?i.left-1:i.left),top:h(i.top),bottom:h(i.bottom),right:p(i.right)}}(e,window.devicePixelRatio<2||!Xm),h="bottom"===n?"top":"bottom",g="right"===i?"left":"right",m=Km("transform");if(s="bottom"===h?"HTML"===c.nodeName?-c.clientHeight+p.bottom:-u.height+p.bottom:p.top,r="right"===g?"HTML"===c.nodeName?-c.clientWidth+p.right:-u.width+p.right:p.left,l&&m)d[m]="translate3d("+r+"px, "+s+"px, 0)",d[h]=0,d[g]=0,d.willChange="transform";else{var f="bottom"===h?-1:1,v="right"===g?-1:1;d[h]=s*f,d[g]=r*v,d.willChange=h+", "+g}var y={"x-placement":e.placement};return e.attributes=Am({},y,e.attributes),e.styles=Am({},d,e.styles),e.arrowStyles=Am({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return Zm(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach((function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&Zm(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,i,o){var a=Dm(o,t,e,n.positionFixed),r=jm(n.placement,a,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",r),Zm(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}},rf={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:af},sf=function(){function e(t,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=um(this.update.bind(this)),this.options=Am({},e.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(Am({},e.Defaults.modifiers,o.modifiers)).forEach((function(t){i.options.modifiers[t]=Am({},e.Defaults.modifiers[t]||{},o.modifiers?o.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return Am({name:e},i.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&dm(e.onLoad)&&e.onLoad(i.reference,i.popper,i.options,e,i.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return xm(e,[{key:"update",value:function(){return Bm.call(this)}},{key:"destroy",value:function(){return Hm.call(this)}},{key:"enableEventListeners",value:function(){return Jm.call(this)}},{key:"disableEventListeners",value:function(){return Qm.call(this)}}]),e}();sf.Utils=("undefined"!=typeof window?window:n.g).PopperUtils,sf.placements=tf,sf.Defaults=rf;const lf=sf;var cf=["innerHTML","ownerDocument","style","attributes","nodeValue"],uf=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],df=["bigint","boolean","null","number","string","symbol","undefined"];function pf(e){var t,n=Object.prototype.toString.call(e).slice(8,-1);return/HTML\w+Element/.test(n)?"HTMLElement":(t=n,uf.includes(t)?n:void 0)}function hf(e){return function(t){return pf(t)===e}}function gf(e){return function(t){return typeof t===e}}function mf(e){if(null===e)return"null";switch(typeof e){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}return mf.array(e)?"Array":mf.plainFunction(e)?"Function":pf(e)||"Object"}mf.array=Array.isArray,mf.arrayOf=function(e,t){return!(!mf.array(e)&&!mf.function(t))&&e.every((function(e){return t(e)}))},mf.asyncGeneratorFunction=function(e){return"AsyncGeneratorFunction"===pf(e)},mf.asyncFunction=hf("AsyncFunction"),mf.bigint=gf("bigint"),mf.boolean=function(e){return!0===e||!1===e},mf.date=hf("Date"),mf.defined=function(e){return!mf.undefined(e)},mf.domElement=function(e){return mf.object(e)&&!mf.plainObject(e)&&1===e.nodeType&&mf.string(e.nodeName)&&cf.every((function(t){return t in e}))},mf.empty=function(e){return mf.string(e)&&0===e.length||mf.array(e)&&0===e.length||mf.object(e)&&!mf.map(e)&&!mf.set(e)&&0===Object.keys(e).length||mf.set(e)&&0===e.size||mf.map(e)&&0===e.size},mf.error=hf("Error"),mf.function=gf("function"),mf.generator=function(e){return mf.iterable(e)&&mf.function(e.next)&&mf.function(e.throw)},mf.generatorFunction=hf("GeneratorFunction"),mf.instanceOf=function(e,t){return!(!e||!t)&&Object.getPrototypeOf(e)===t.prototype},mf.iterable=function(e){return!mf.nullOrUndefined(e)&&mf.function(e[Symbol.iterator])},mf.map=hf("Map"),mf.nan=function(e){return Number.isNaN(e)},mf.null=function(e){return null===e},mf.nullOrUndefined=function(e){return mf.null(e)||mf.undefined(e)},mf.number=function(e){return gf("number")(e)&&!mf.nan(e)},mf.numericString=function(e){return mf.string(e)&&e.length>0&&!Number.isNaN(Number(e))},mf.object=function(e){return!mf.nullOrUndefined(e)&&(mf.function(e)||"object"==typeof e)},mf.oneOf=function(e,t){return!!mf.array(e)&&e.indexOf(t)>-1},mf.plainFunction=hf("Function"),mf.plainObject=function(e){if("Object"!==pf(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},mf.primitive=function(e){return mf.null(e)||(t=typeof e,df.includes(t));var t},mf.promise=hf("Promise"),mf.propertyOf=function(e,t,n){if(!mf.object(e)||!t)return!1;var i=e[t];return mf.function(n)?n(i):mf.defined(i)},mf.regexp=hf("RegExp"),mf.set=hf("Set"),mf.string=gf("string"),mf.symbol=gf("symbol"),mf.undefined=gf("undefined"),mf.weakMap=hf("WeakMap"),mf.weakSet=hf("WeakSet");const ff=mf;function vf(e){return function(t){return typeof t===e}}var yf=vf("function"),bf=function(e){return"RegExp"===Object.prototype.toString.call(e).slice(8,-1)},kf=function(e){return!Sf(e)&&!function(e){return null===e}(e)&&(yf(e)||"object"==typeof e)},Sf=vf("undefined"),wf=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Tf(e,t){if(e===t)return!0;if(e&&kf(e)&&t&&kf(t)){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)&&Array.isArray(t))return function(e,t){var n=e.length;if(n!==t.length)return!1;for(var i=n;0!=i--;)if(!Tf(e[i],t[i]))return!1;return!0}(e,t);if(e instanceof Map&&t instanceof Map)return function(e,t){var n,i,o,a;if(e.size!==t.size)return!1;try{for(var r=wf(e.entries()),s=r.next();!s.done;s=r.next()){var l=s.value;if(!t.has(l[0]))return!1}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}try{for(var c=wf(e.entries()),u=c.next();!u.done;u=c.next())if(!Tf((l=u.value)[1],t.get(l[0])))return!1}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return!0}(e,t);if(e instanceof Set&&t instanceof Set)return function(e,t){var n,i;if(e.size!==t.size)return!1;try{for(var o=wf(e.entries()),a=o.next();!a.done;a=o.next()){var r=a.value;if(!t.has(r[0]))return!1}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!0}(e,t);if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e.buffer),i=new DataView(t.buffer),o=e.byteLength;o--;)if(n.getUint8(o)!==i.getUint8(o))return!1;return!0}(e,t);if(bf(e)&&bf(t))return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=n.length;0!=o--;)if(!Object.prototype.hasOwnProperty.call(t,n[o]))return!1;for(o=n.length;0!=o--;){var a=n[o];if(!("_owner"===a&&e.$$typeof||Tf(e[a],t[a])))return!1}return!0}return!(!Number.isNaN(e)||!Number.isNaN(t))||e===t}function Cf(e,t,n){var i=n.actual,o=n.key,a=n.previous,r=n.type,s=Nf(e,o),l=Nf(t,o),c=[s,l].every(ff.number)&&("increased"===r?s<l:s>l);return ff.undefined(i)||(c=c&&l===i),ff.undefined(a)||(c=c&&s===a),c}function Pf(e,t,n){var i=n.key,o=n.type,a=n.value,r=Nf(e,i),s=Nf(t,i),l="added"===o?r:s,c="added"===o?s:r;return ff.nullOrUndefined(a)?[r,s].every(ff.array)?!c.every(Of(l)):[r,s].every(ff.plainObject)?function(e,t){return t.some((function(t){return!e.includes(t)}))}(Object.keys(l),Object.keys(c)):![r,s].every((function(e){return ff.primitive(e)&&ff.defined(e)}))&&("added"===o?!ff.defined(r)&&ff.defined(s):ff.defined(r)&&!ff.defined(s)):ff.defined(l)?!(!ff.array(l)&&!ff.plainObject(l))&&function(e,t,n){return!!_f(e,t)&&([e,t].every(ff.array)?!e.some(Af(n))&&t.some(Af(n)):[e,t].every(ff.plainObject)?!Object.entries(e).some(If(n))&&Object.entries(t).some(If(n)):t===n)}(l,c,a):Tf(c,a)}function xf(e,t,n){var i=(void 0===n?{}:n).key,o=Nf(e,i),a=Nf(t,i);if(!_f(o,a))throw new TypeError("Inputs have different types");if(!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every((function(e){return ff.string(e)||ff.array(e)||ff.plainObject(e)}))}(o,a))throw new TypeError("Inputs don't have length");return[o,a].every(ff.plainObject)&&(o=Object.keys(o),a=Object.keys(a)),[o,a]}function If(e){return function(t){var n=t[0],i=t[1];return ff.array(e)?Tf(e,i)||e.some((function(e){return Tf(e,i)||ff.array(i)&&Of(i)(e)})):ff.plainObject(e)&&e[n]?!!e[n]&&Tf(e[n],i):Tf(e,i)}}function Af(e){return function(t){return ff.array(e)?e.some((function(e){return Tf(e,t)||ff.array(t)&&Of(t)(e)})):Tf(e,t)}}function Ef(e,t){return ff.array(e)?e.some((function(e){return Tf(e,t)})):Tf(e,t)}function Of(e){return function(t){return e.some((function(e){return Tf(e,t)}))}}function _f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(ff.array)||e.every(ff.number)||e.every(ff.plainObject)||e.every(ff.string)}function Nf(e,t){return ff.plainObject(e)||ff.array(e)?ff.string(t)?t.split(".").reduce((function(e,t){return e&&e[t]}),e):ff.number(t)?e[t]:e:e}function Mf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Rf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mf(Object(n),!0).forEach((function(t){Ff(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Df(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Hf(i.key),i)}}function Lf(e,t,n){return t&&Df(e.prototype,t),n&&Df(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ff(e,t,n){return(t=Hf(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zf(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vf(e,t)}function Uf(e){return Uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Uf(e)}function Vf(e,t){return Vf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vf(e,t)}function Bf(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function qf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Uf(e);if(t){var o=Uf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qf(e)}(this,n)}}function Hf(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var Wf={flip:{padding:20},preventOverflow:{padding:10}};function Gf(e,t,n){return function(e,t){if("function"!=typeof e)throw new TypeError("The typeValidator argument must be a function with the signature function(props, propName, componentName).");if(Boolean(t)&&"string"!=typeof t)throw new TypeError("The error message is optional, but must be a string if provided.")}(e,n),function(i,o,a){for(var r=arguments.length,s=new Array(r>3?r-3:0),l=3;l<r;l++)s[l-3]=arguments[l];return function(e,t,n,i){return"boolean"==typeof e?e:"function"==typeof e?e(t,n,i):!0===Boolean(e)&&Boolean(e)}(t,i,o,a)?function(e,t){return Object.hasOwnProperty.call(e,t)}(i,o)?e.apply(void 0,[i,o,a].concat(s)):function(e,t,n,i){return i?new Error(i):new Error("Required ".concat(e[t]," `").concat(t,"` was not specified in `").concat(n,"`."))}(i,o,a,n):e.apply(void 0,[i,o,a].concat(s))}}var $f={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},Jf=void 0!==nm.createPortal;function Qf(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}function Yf(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function Zf(e){var t=e.title,n=e.data,i=e.warn,o=void 0!==i&&i,a=e.debug,r=void 0!==a&&a,s=o?console.warn||console.error:console.log;r&&t&&n&&(console.groupCollapsed("%creact-floater: ".concat(t),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(n)?n.forEach((function(e){ff.plainObject(e)&&e.key?s.apply(console,[e.key,e.value]):s.apply(console,[e])})):s.apply(console,[n]),console.groupEnd())}function Xf(){}var ev=function(e){zf(n,e);var t=Kf(n);function n(){return jf(this,n),t.apply(this,arguments)}return Lf(n,[{key:"componentDidMount",value:function(){Qf()&&(this.node||this.appendNode(),Jf||this.renderPortal())}},{key:"componentDidUpdate",value:function(){Qf()&&(Jf||this.renderPortal())}},{key:"componentWillUnmount",value:function(){Qf()&&this.node&&(Jf||nm.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var e=this.props,t=e.id,n=e.zIndex;this.node||(this.node=document.createElement("div"),t&&(this.node.id=t),n&&(this.node.style.zIndex=n),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!Qf())return null;var e=this.props,t=e.children,n=e.setRef;return this.node||this.appendNode(),Jf?nm.createPortal(t,this.node):(n(nm.unstable_renderSubtreeIntoContainer(this,t.length>1?i.createElement("div",null,t):t[0],this.node)),null)}},{key:"renderReact16",value:function(){var e=this.props,t=e.hasChildren,n=e.placement,i=e.target;return t||i||"center"===n?this.renderPortal():null}},{key:"render",value:function(){return Jf?this.renderReact16():null}}]),n}(i.Component);Ff(ev,"propTypes",{children:sm().oneOfType([sm().element,sm().array]),hasChildren:sm().bool,id:sm().oneOfType([sm().string,sm().number]),placement:sm().string,setRef:sm().func.isRequired,target:sm().oneOfType([sm().object,sm().string]),zIndex:sm().number});var tv=function(e){zf(n,e);var t=Kf(n);function n(){return jf(this,n),t.apply(this,arguments)}return Lf(n,[{key:"parentStyle",get:function(){var e=this.props,t=e.placement,n=e.styles.arrow.length,i={pointerEvents:"none",position:"absolute",width:"100%"};return t.startsWith("top")?(i.bottom=0,i.left=0,i.right=0,i.height=n):t.startsWith("bottom")?(i.left=0,i.right=0,i.top=0,i.height=n):t.startsWith("left")?(i.right=0,i.top=0,i.bottom=0):t.startsWith("right")&&(i.left=0,i.top=0),i}},{key:"render",value:function(){var e,t=this.props,n=t.placement,o=t.setArrowRef,a=t.styles.arrow,r=a.color,s=a.display,l=a.length,c=a.margin,u=a.position,d=a.spread,p={display:s,position:u},h=d,g=l;return n.startsWith("top")?(e="0,0 ".concat(h/2,",").concat(g," ").concat(h,",0"),p.bottom=0,p.marginLeft=c,p.marginRight=c):n.startsWith("bottom")?(e="".concat(h,",").concat(g," ").concat(h/2,",0 0,").concat(g),p.top=0,p.marginLeft=c,p.marginRight=c):n.startsWith("left")?(g=d,e="0,0 ".concat(h=l,",").concat(g/2," 0,").concat(g),p.right=0,p.marginTop=c,p.marginBottom=c):n.startsWith("right")&&(g=d,e="".concat(h=l,",").concat(g," ").concat(h,",0 0,").concat(g/2),p.left=0,p.marginTop=c,p.marginBottom=c),i.createElement("div",{className:"__floater__arrow",style:this.parentStyle},i.createElement("span",{ref:o,style:p},i.createElement("svg",{width:h,height:g,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},i.createElement("polygon",{points:e,fill:r}))))}}]),n}(i.Component);Ff(tv,"propTypes",{placement:sm().string.isRequired,setArrowRef:sm().func.isRequired,styles:sm().object.isRequired});var nv=["color","height","width"];function iv(e){var t=e.handleClick,n=e.styles,o=n.color,a=n.height,r=n.width,s=Bf(n,nv);return i.createElement("button",{"aria-label":"close",onClick:t,style:s,type:"button"},i.createElement("svg",{width:"".concat(r,"px"),height:"".concat(a,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},i.createElement("g",null,i.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:o}))))}function ov(e){var t=e.content,n=e.footer,o=e.handleClick,a=e.open,r=e.positionWrapper,s=e.showCloseButton,l=e.title,c=e.styles,u={content:i.isValidElement(t)?t:i.createElement("div",{className:"__floater__content",style:c.content},t)};return l&&(u.title=i.isValidElement(l)?l:i.createElement("div",{className:"__floater__title",style:c.title},l)),n&&(u.footer=i.isValidElement(n)?n:i.createElement("div",{className:"__floater__footer",style:c.footer},n)),!s&&!r||ff.boolean(a)||(u.close=i.createElement(iv,{styles:c.close,handleClick:o})),i.createElement("div",{className:"__floater__container",style:c.container},u.close,u.title,u.content,u.footer)}iv.propTypes={handleClick:sm().func.isRequired,styles:sm().object.isRequired},ov.propTypes={content:sm().node.isRequired,footer:sm().node,handleClick:sm().func.isRequired,open:sm().bool,positionWrapper:sm().bool.isRequired,showCloseButton:sm().bool.isRequired,styles:sm().object.isRequired,title:sm().node};var av=function(e){zf(n,e);var t=Kf(n);function n(){return jf(this,n),t.apply(this,arguments)}return Lf(n,[{key:"style",get:function(){var e=this.props,t=e.disableAnimation,n=e.component,i=e.placement,o=e.hideArrow,a=e.status,r=e.styles,s=r.arrow.length,l=r.floater,c=r.floaterCentered,u=r.floaterClosing,d=r.floaterOpening,p=r.floaterWithAnimation,h=r.floaterWithComponent,g={};return o||(i.startsWith("top")?g.padding="0 0 ".concat(s,"px"):i.startsWith("bottom")?g.padding="".concat(s,"px 0 0"):i.startsWith("left")?g.padding="0 ".concat(s,"px 0 0"):i.startsWith("right")&&(g.padding="0 0 0 ".concat(s,"px"))),-1!==[$f.OPENING,$f.OPEN].indexOf(a)&&(g=Rf(Rf({},g),d)),a===$f.CLOSING&&(g=Rf(Rf({},g),u)),a!==$f.OPEN||t||(g=Rf(Rf({},g),p)),"center"===i&&(g=Rf(Rf({},g),c)),n&&(g=Rf(Rf({},g),h)),Rf(Rf({},l),g)}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.handleClick,o=e.hideArrow,a=e.setFloaterRef,r=e.status,s={},l=["__floater"];return s.content=t?i.isValidElement(t)?i.cloneElement(t,{closeFn:n}):t({closeFn:n}):i.createElement(ov,this.props),r===$f.OPEN&&l.push("__floater__open"),o||(s.arrow=i.createElement(tv,this.props)),i.createElement("div",{ref:a,className:l.join(" "),style:this.style},i.createElement("div",{className:"__floater__body"},s.content,s.arrow))}}]),n}(i.Component);Ff(av,"propTypes",{component:sm().oneOfType([sm().func,sm().element]),content:sm().node,disableAnimation:sm().bool.isRequired,footer:sm().node,handleClick:sm().func.isRequired,hideArrow:sm().bool.isRequired,open:sm().bool,placement:sm().string.isRequired,positionWrapper:sm().bool.isRequired,setArrowRef:sm().func.isRequired,setFloaterRef:sm().func.isRequired,showCloseButton:sm().bool,status:sm().string.isRequired,styles:sm().object.isRequired,title:sm().node});var rv=function(e){zf(n,e);var t=Kf(n);function n(){return jf(this,n),t.apply(this,arguments)}return Lf(n,[{key:"render",value:function(){var e,t=this.props,n=t.children,o=t.handleClick,a=t.handleMouseEnter,r=t.handleMouseLeave,s=t.setChildRef,l=t.setWrapperRef,c=t.style,u=t.styles;if(n)if(1===i.Children.count(n))if(i.isValidElement(n)){var d=ff.function(n.type)?"innerRef":"ref";e=i.cloneElement(i.Children.only(n),Ff({},d,s))}else e=i.createElement("span",null,n);else e=n;return e?i.createElement("span",{ref:l,style:Rf(Rf({},u),c),onClick:o,onMouseEnter:a,onMouseLeave:r},e):null}}]),n}(i.Component);Ff(rv,"propTypes",{children:sm().node,handleClick:sm().func.isRequired,handleMouseEnter:sm().func.isRequired,handleMouseLeave:sm().func.isRequired,setChildRef:sm().func.isRequired,setWrapperRef:sm().func.isRequired,style:sm().object,styles:sm().object.isRequired});var sv={zIndex:100},lv=["arrow","flip","offset"],cv=["position","top","right","bottom","left"],uv=function(e){zf(n,e);var t=Kf(n);function n(e){var i;return jf(this,n),Ff(qf(i=t.call(this,e)),"setArrowRef",(function(e){i.arrowRef=e})),Ff(qf(i),"setChildRef",(function(e){i.childRef=e})),Ff(qf(i),"setFloaterRef",(function(e){i.floaterRef=e})),Ff(qf(i),"setWrapperRef",(function(e){i.wrapperRef=e})),Ff(qf(i),"handleTransitionEnd",(function(){var e=i.state.status,t=i.props.callback;i.wrapperPopper&&i.wrapperPopper.instance.update(),i.setState({status:e===$f.OPENING?$f.OPEN:$f.IDLE},(function(){var e=i.state.status;t(e===$f.OPEN?"open":"close",i.props)}))})),Ff(qf(i),"handleClick",(function(){var e=i.props,t=e.event,n=e.open;if(!ff.boolean(n)){var o=i.state,a=o.positionWrapper,r=o.status;("click"===i.event||"hover"===i.event&&a)&&(Zf({title:"click",data:[{event:t,status:r===$f.OPEN?"closing":"opening"}],debug:i.debug}),i.toggle())}})),Ff(qf(i),"handleMouseEnter",(function(){var e=i.props,t=e.event,n=e.open;if(!ff.boolean(n)&&!Yf()){var o=i.state.status;"hover"===i.event&&o===$f.IDLE&&(Zf({title:"mouseEnter",data:[{key:"originalEvent",value:t}],debug:i.debug}),clearTimeout(i.eventDelayTimeout),i.toggle())}})),Ff(qf(i),"handleMouseLeave",(function(){var e=i.props,t=e.event,n=e.eventDelay,o=e.open;if(!ff.boolean(o)&&!Yf()){var a=i.state,r=a.status,s=a.positionWrapper;"hover"===i.event&&(Zf({title:"mouseLeave",data:[{key:"originalEvent",value:t}],debug:i.debug}),n?-1===[$f.OPENING,$f.OPEN].indexOf(r)||s||i.eventDelayTimeout||(i.eventDelayTimeout=setTimeout((function(){delete i.eventDelayTimeout,i.toggle()}),1e3*n)):i.toggle($f.IDLE))}})),i.state={currentPlacement:e.placement,needsUpdate:!1,positionWrapper:e.wrapperOptions.position&&!!e.target,status:$f.INIT,statusWrapper:$f.INIT},i._isMounted=!1,i.hasMounted=!1,Qf()&&window.addEventListener("load",(function(){i.popper&&i.popper.instance.update(),i.wrapperPopper&&i.wrapperPopper.instance.update()})),i}return Lf(n,[{key:"componentDidMount",value:function(){if(Qf()){var e=this.state.positionWrapper,t=this.props,n=t.children,i=t.open,o=t.target;this._isMounted=!0,Zf({title:"init",data:{hasChildren:!!n,hasTarget:!!o,isControlled:ff.boolean(i),positionWrapper:e,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!n&&o&&ff.boolean(i)}}},{key:"componentDidUpdate",value:function(e,t){if(Qf()){var n,i=this.props,o=i.autoOpen,a=i.open,r=i.target,s=i.wrapperOptions,l=function(e,t){if([e,t].some(ff.nullOrUndefined))throw new Error("Missing required parameters");if(![e,t].every((function(e){return ff.plainObject(e)||ff.array(e)})))throw new Error("Expected plain objects or array");var n=function(n,i,o){try{var a=Nf(e,n),r=Nf(t,n),s=ff.defined(i),l=ff.defined(o);if(s||l){var c=l?Ef(o,a):!Ef(i,a),u=Ef(i,r);return c&&u}return[a,r].every(ff.array)||[a,r].every(ff.plainObject)?!Tf(a,r):a!==r}catch(e){return!1}};return{added:function(n,i){try{return Pf(e,t,{key:n,type:"added",value:i})}catch(e){return!1}},changed:n,changedFrom:function(n,i,o){if(!ff.defined(n))return!1;try{var a=Nf(e,n),r=Nf(t,n),s=ff.defined(o);return Ef(i,a)&&(s?Ef(o,r):!s)}catch(e){return!1}},changedTo:function(e,t){return!!ff.defined(e)&&n(e,t)},decreased:function(n,i,o){if(!ff.defined(n))return!1;try{return Cf(e,t,{key:n,actual:i,previous:o,type:"decreased"})}catch(e){return!1}},emptied:function(n){try{var i=xf(e,t,{key:n}),o=i[0],a=i[1];return!!o.length&&!a.length}catch(e){return!1}},filled:function(n){try{var i=xf(e,t,{key:n}),o=i[0],a=i[1];return!o.length&&!!a.length}catch(e){return!1}},increased:function(n,i,o){if(!ff.defined(n))return!1;try{return Cf(e,t,{key:n,actual:i,previous:o,type:"increased"})}catch(e){return!1}},removed:function(n,i){try{return Pf(e,t,{key:n,type:"removed",value:i})}catch(e){return!1}}}}(t,this.state),c=l.changedFrom,u=l.changed;e.open!==a&&(ff.boolean(a)&&(n=a?$f.OPENING:$f.CLOSING),this.toggle(n)),e.wrapperOptions.position===s.position&&e.target===r||this.changeWrapperPosition(this.props),(u("status",$f.IDLE)&&a||c("status",$f.INIT,$f.IDLE)&&o)&&this.toggle($f.OPEN),this.popper&&u("status",$f.OPENING)&&this.popper.instance.update(),this.floaterRef&&(u("status",$f.OPENING)||u("status",$f.CLOSING))&&function(e,t,n){var i;i=function(o){n(o),function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.removeEventListener(t,n,i)}(e,t,i)},function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,n,i)}(e,t,i,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(this.floaterRef,"transitionend",this.handleTransitionEnd),u("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){Qf()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.target,n=this.state.positionWrapper,i=this.props,o=i.disableFlip,a=i.getPopper,r=i.hideArrow,s=i.offset,l=i.placement,c=i.wrapperOptions,u="top"===l||"bottom"===l?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if("center"===l)this.setState({status:$f.IDLE});else if(t&&this.floaterRef){var d=this.options,p=d.arrow,h=d.flip,g=d.offset,m=Bf(d,lv);new lf(t,this.floaterRef,{placement:l,modifiers:Rf({arrow:Rf({enabled:!r,element:this.arrowRef},p),flip:Rf({enabled:!o,behavior:u},h),offset:Rf({offset:"0, ".concat(s,"px")},g)},m),onCreate:function(t){var n;e.popper=t,null!==(n=e.floaterRef)&&void 0!==n&&n.isConnected?(a(t,"floater"),e._isMounted&&e.setState({currentPlacement:t.placement,status:$f.IDLE}),l!==t.placement&&setTimeout((function(){t.instance.update()}),1)):e.setState({needsUpdate:!0})},onUpdate:function(t){e.popper=t;var n=e.state.currentPlacement;e._isMounted&&t.placement!==n&&e.setState({currentPlacement:t.placement})}})}if(n){var f=ff.undefined(c.offset)?0:c.offset;new lf(this.target,this.wrapperRef,{placement:c.placement||l,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(f,"px")},flip:{enabled:!1}},onCreate:function(t){e.wrapperPopper=t,e._isMounted&&e.setState({statusWrapper:$f.IDLE}),a(t,"wrapper"),l!==t.placement&&setTimeout((function(){t.instance.update()}),1)}})}}},{key:"rebuildPopper",value:function(){var e=this;this.floaterRefInterval=setInterval((function(){var t;null!==(t=e.floaterRef)&&void 0!==t&&t.isConnected&&(clearInterval(e.floaterRefInterval),e.setState({needsUpdate:!1}),e.initPopper())}),50)}},{key:"changeWrapperPosition",value:function(e){var t=e.target,n=e.wrapperOptions;this.setState({positionWrapper:n.position&&!!t})}},{key:"toggle",value:function(e){var t=this.state.status===$f.OPEN?$f.CLOSING:$f.OPENING;ff.undefined(e)||(t=e),this.setState({status:t})}},{key:"debug",get:function(){return this.props.debug||Qf()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var e=this.props,t=e.disableHoverToClick,n=e.event;return"hover"===n&&Yf()&&!t?"click":n}},{key:"options",get:function(){var e=this.props.options;return am()(Wf,e||{})}},{key:"styles",get:function(){var e,t=this,n=this.state,i=n.status,o=n.positionWrapper,a=n.statusWrapper,r=this.props.styles,s=am()(function(e){var t=am()(sv,e.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:t.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:t.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:t}}(r),r);if(o&&(e=-1===[$f.IDLE].indexOf(i)||-1===[$f.IDLE].indexOf(a)?s.wrapperPosition:this.wrapperPopper.styles,s.wrapper=Rf(Rf({},s.wrapper),e)),this.target){var l=window.getComputedStyle(this.target);this.wrapperStyles?s.wrapper=Rf(Rf({},s.wrapper),this.wrapperStyles):-1===["relative","static"].indexOf(l.position)&&(this.wrapperStyles={},o||(cv.forEach((function(e){t.wrapperStyles[e]=l[e]})),s.wrapper=Rf(Rf({},s.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return s}},{key:"target",get:function(){if(!Qf())return null;var e=this.props.target;return e?ff.domElement(e)?e:document.querySelector(e):this.childRef||this.wrapperRef}},{key:"render",value:function(){var e=this.state,t=e.currentPlacement,n=e.positionWrapper,o=e.status,a=this.props,r=a.children,s=a.component,l=a.content,c=a.disableAnimation,u=a.footer,d=a.hideArrow,p=a.id,h=a.open,g=a.showCloseButton,m=a.style,f=a.target,v=a.title,y=i.createElement(rv,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:m,styles:this.styles.wrapper},r),b={};return n?b.wrapperInPortal=y:b.wrapperAsChildren=y,i.createElement("span",null,i.createElement(ev,{hasChildren:!!r,id:p,placement:t,setRef:this.setFloaterRef,target:f,zIndex:this.styles.options.zIndex},i.createElement(av,{component:s,content:l,disableAnimation:c,footer:u,handleClick:this.handleClick,hideArrow:d||"center"===t,open:h,placement:t,positionWrapper:n,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:g,status:o,styles:this.styles,title:v}),b.wrapperInPortal),b.wrapperAsChildren)}}]),n}(i.Component);Ff(uv,"propTypes",{autoOpen:sm().bool,callback:sm().func,children:sm().node,component:Gf(sm().oneOfType([sm().func,sm().element]),(function(e){return!e.content})),content:Gf(sm().node,(function(e){return!e.component})),debug:sm().bool,disableAnimation:sm().bool,disableFlip:sm().bool,disableHoverToClick:sm().bool,event:sm().oneOf(["hover","click"]),eventDelay:sm().number,footer:sm().node,getPopper:sm().func,hideArrow:sm().bool,id:sm().oneOfType([sm().string,sm().number]),offset:sm().number,open:sm().bool,options:sm().object,placement:sm().oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:sm().bool,style:sm().object,styles:sm().object,target:sm().oneOfType([sm().object,sm().string]),title:sm().node,wrapperOptions:sm().shape({offset:sm().number,placement:sm().oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:sm().bool})}),Ff(uv,"defaultProps",{autoOpen:!1,callback:Xf,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:Xf,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var dv=Object.defineProperty,pv=(e,t,n)=>((e,t,n)=>t in e?dv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),hv="start",gv="stop",mv="reset",fv="prev",vv="next",yv="close",bv="skip",kv="update",Sv="step:after",wv="error:target_not_found",Tv={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},Cv={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function Pv(){var e;return!("undefined"==typeof window||!(null==(e=window.document)?void 0:e.createElement))}function xv(e){return e?e.getBoundingClientRect():null}function Iv(e=!1){const{body:t,documentElement:n}=document;if(!t||!n)return 0;if(e){const e=[t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight].sort(((e,t)=>e-t)),i=Math.floor(e.length/2);return e.length%2==0?(e[i-1]+e[i])/2:e[i]}return Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight)}function Av(e){if("string"==typeof e)try{return document.querySelector(e)}catch(e){return null}return e}function Ev(e,t,n){if(!e)return Nv();const i=tm(e);if(i){if(i.isSameNode(Nv()))return n?document:Nv();if(!(i.scrollHeight>i.offsetHeight||t))return i.style.overflow="initial",Nv()}return i}function Ov(e,t){if(!e)return!1;const n=Ev(e,t);return!!n&&!n.isSameNode(Nv())}function _v(e,t="fixed"){if(!(e&&e instanceof HTMLElement))return!1;const{nodeName:n}=e,i=function(e){return e&&1===e.nodeType?getComputedStyle(e):null}(e);return"BODY"!==n&&"HTML"!==n&&(!(!i||i.position!==t)||!!e.parentNode&&_v(e.parentNode,t))}function Nv(){var e;return null!=(e=document.scrollingElement)?e:document.documentElement}var Mv=void 0!==nm.createPortal;function Rv(e=navigator.userAgent){let t=e;return"undefined"==typeof window?t="node":document.documentMode?t="ie":/Edge/.test(e)?t="edge":Boolean(window.opera)||e.includes(" OPR/")?t="opera":void 0!==window.InstallTrigger?t="firefox":window.chrome?t="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(e)&&(t="safari"),t}function jv(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function Dv(e,t={}){const{defaultValue:n,step:o,steps:a}=t;let r=im(e);return r?(r.includes("{step}")||r.includes("{steps}"))&&o&&a&&(r=r.replace("{step}",o.toString()).replace("{steps}",a.toString())):r=(0,i.isValidElement)(e)&&!Object.values(e.props).length&&"function"===jv(e.type)?Dv(e.type({}),t):im(n),r}function Lv(e){const t=e.replace(/^#?([\da-f])([\da-f])([\da-f])$/i,((e,t,n,i)=>t+t+n+n+i+i)),n=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(t);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:[]}function Fv(e){return e.disableBeacon||"center"===e.placement}function zv(){return!["chrome","safari","firefox","opera"].includes(Rv())}function Uv({data:e,debug:t=!1,title:n,warn:i=!1}){const o=i?console.warn||console.error:console.log;t&&(n&&e?(console.groupCollapsed(`%creact-joyride: ${n}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(e)?e.forEach((e=>{qg.plainObject(e)&&e.key?o.apply(console,[e.key,e.value]):o.apply(console,[e])})):o.apply(console,[e]),console.groupEnd()):console.error("Missing title or data props"))}function Vv(e,...t){if(!qg.plainObject(e))throw new TypeError("Expected an object");const n={};for(const i in e)({}).hasOwnProperty.call(e,i)&&(t.includes(i)||(n[i]=e[i]));return n}function Bv(e,t,n){const o=e=>e.replace("{step}",String(t)).replace("{steps}",String(n));if("string"===jv(e))return o(e);if(!(0,i.isValidElement)(e))return e;const{children:a}=e.props;return"string"===jv(a)&&a.includes("{step}")?(0,i.cloneElement)(e,{children:o(a)}):Array.isArray(a)?(0,i.cloneElement)(e,{children:a.map((e=>"string"==typeof e?o(e):Bv(e,t,n)))}):"function"!==jv(e.type)||Object.values(e.props).length?e:Bv(e.type({}),t,n)}var qv={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},Kv={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},Hv={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:Kv,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},Wv={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},Gv={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},$v={borderRadius:4,position:"absolute"};function Jv(e){return function(e,...t){if(!qg.plainObject(e))throw new TypeError("Expected an object");if(!t.length)return e;const n={};for(const i in e)({}).hasOwnProperty.call(e,i)&&t.includes(i)&&(n[i]=e[i]);return n}(e,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function Qv(e,t){var n,i,o,a,r,s;const l=null!=t?t:{},c=om.all([Hv,Jv(e),l],{isMergeableObject:qg.plainObject}),u=function(e,t){var n,i,o,a,r;const{floaterProps:s,styles:l}=e,c=om(null!=(n=t.floaterProps)?n:{},null!=s?s:{}),u=om(null!=l?l:{},null!=(i=t.styles)?i:{}),d=om(Wv,u.options||{}),p="center"===t.placement||t.disableBeacon;let{width:h}=d;window.innerWidth>480&&(h=380),"width"in d&&(h="number"==typeof d.width&&window.innerWidth<d.width?window.innerWidth-30:d.width);const g={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:d.zIndex},m={beacon:{...Gv,display:p?"none":"inline-block",height:d.beaconSize,position:"relative",width:d.beaconSize,zIndex:d.zIndex},beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:d.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${Lv(d.primaryColor).join(",")}, 0.2)`,border:`2px solid ${d.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:d.backgroundColor,borderRadius:5,boxSizing:"border-box",color:d.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:h},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:{...Gv,backgroundColor:d.primaryColor,borderRadius:4,color:"#fff"},buttonBack:{...Gv,color:d.primaryColor,marginLeft:"auto",marginRight:5},buttonClose:{...Gv,color:d.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14},buttonSkip:{...Gv,color:d.textColor,fontSize:14},overlay:{...g,backgroundColor:d.overlayColor,mixBlendMode:"hard-light"},overlayLegacy:{...g},overlayLegacyCenter:{...g,backgroundColor:d.overlayColor},spotlight:{...$v,backgroundColor:"gray"},spotlightLegacy:{...$v,boxShadow:`0 0 0 9999px ${d.overlayColor}, ${d.spotlightShadow}`},floaterStyles:{arrow:{color:null!=(r=null==(a=null==(o=null==c?void 0:c.styles)?void 0:o.arrow)?void 0:a.color)?r:d.arrowColor},options:{zIndex:d.zIndex+100}},options:d};return om(m,u)}(e,c),d=Ov(Av(c.target),c.disableScrollParentFix),p=om.all([qv,null!=(n=e.floaterProps)?n:{},null!=(i=c.floaterProps)?i:{}]);return p.offset=c.offset,p.styles=om(null!=(o=p.styles)?o:{},u.floaterStyles),p.offset+=null!=(r=null!=(a=e.spotlightPadding)?a:c.spotlightPadding)?r:0,c.placementBeacon&&p.wrapperOptions&&(p.wrapperOptions.placement=c.placementBeacon),d&&p.options.preventOverflow&&(p.options.preventOverflow.boundariesElement="window"),{...c,locale:om.all([Kv,null!=(s=e.locale)?s:{},c.locale||{}]),floaterProps:p,styles:Vv(u,"floaterStyles")}}function Yv(e,t=!1){return qg.plainObject(e)?!!e.target||(Uv({title:"validateStep",data:"target is missing from the step",warn:!0,debug:t}),!1):(Uv({title:"validateStep",data:"step must be an object",warn:!0,debug:t}),!1)}function Zv(e,t=!1){return qg.array(e)?e.every((e=>Yv(e,t))):(Uv({title:"validateSteps",data:"steps must be an array",warn:!0,debug:t}),!1)}var Xv,ey={action:"init",controlled:!1,index:0,lifecycle:Tv.INIT,origin:null,size:0,status:Cv.IDLE},ty=(Xv=Vv(ey,"controlled","size"),Object.keys(Xv)),ny=class{constructor(e){pv(this,"beaconPopper"),pv(this,"tooltipPopper"),pv(this,"data",new Map),pv(this,"listener"),pv(this,"store",new Map),pv(this,"addListener",(e=>{this.listener=e})),pv(this,"setSteps",(e=>{const{size:t,status:n}=this.getState(),i={size:e.length,status:n};this.data.set("steps",e),n===Cv.WAITING&&!t&&e.length&&(i.status=Cv.RUNNING),this.setState(i)})),pv(this,"getPopper",(e=>"beacon"===e?this.beaconPopper:this.tooltipPopper)),pv(this,"setPopper",((e,t)=>{"beacon"===e?this.beaconPopper=t:this.tooltipPopper=t})),pv(this,"cleanupPoppers",(()=>{this.beaconPopper=null,this.tooltipPopper=null})),pv(this,"close",((e=null)=>{const{index:t,status:n}=this.getState();n===Cv.RUNNING&&this.setState({...this.getNextState({action:yv,index:t+1,origin:e})})})),pv(this,"go",(e=>{const{controlled:t,status:n}=this.getState();if(t||n!==Cv.RUNNING)return;const i=this.getSteps()[e];this.setState({...this.getNextState({action:"go",index:e}),status:i?n:Cv.FINISHED})})),pv(this,"info",(()=>this.getState())),pv(this,"next",(()=>{const{index:e,status:t}=this.getState();t===Cv.RUNNING&&this.setState(this.getNextState({action:vv,index:e+1}))})),pv(this,"open",(()=>{const{status:e}=this.getState();e===Cv.RUNNING&&this.setState({...this.getNextState({action:kv,lifecycle:Tv.TOOLTIP})})})),pv(this,"prev",(()=>{const{index:e,status:t}=this.getState();t===Cv.RUNNING&&this.setState({...this.getNextState({action:fv,index:e-1})})})),pv(this,"reset",((e=!1)=>{const{controlled:t}=this.getState();t||this.setState({...this.getNextState({action:mv,index:0}),status:e?Cv.RUNNING:Cv.READY})})),pv(this,"skip",(()=>{const{status:e}=this.getState();e===Cv.RUNNING&&this.setState({action:bv,lifecycle:Tv.INIT,status:Cv.SKIPPED})})),pv(this,"start",(e=>{const{index:t,size:n}=this.getState();this.setState({...this.getNextState({action:hv,index:qg.number(e)?e:t},!0),status:n?Cv.RUNNING:Cv.WAITING})})),pv(this,"stop",((e=!1)=>{const{index:t,status:n}=this.getState();[Cv.FINISHED,Cv.SKIPPED].includes(n)||this.setState({...this.getNextState({action:gv,index:t+(e?1:0)}),status:Cv.PAUSED})})),pv(this,"update",(e=>{var t,n,i,o;if(i=e,o=ty,!(qg.plainObject(i)&&qg.array(o)&&Object.keys(i).every((e=>o.includes(e)))))throw new Error(`State is not valid. Valid keys: ${ty.join(", ")}`);this.setState({...this.getNextState({...this.getState(),...e,action:null!=(t=e.action)?t:kv,origin:null!=(n=e.origin)?n:null},!0)})}));const{continuous:t=!1,stepIndex:n,steps:i=[]}=null!=e?e:{};this.setState({action:"init",controlled:qg.number(n),continuous:t,index:qg.number(n)?n:0,lifecycle:Tv.INIT,origin:null,status:i.length?Cv.READY:Cv.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(i)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:{...ey}}getNextState(e,t=!1){var n,i,o,a,r;const{action:s,controlled:l,index:c,size:u,status:d}=this.getState(),p=qg.number(e.index)?e.index:c,h=l&&!t?c:Math.min(Math.max(p,0),u);return{action:null!=(n=e.action)?n:s,controlled:l,index:h,lifecycle:null!=(i=e.lifecycle)?i:Tv.INIT,origin:null!=(o=e.origin)?o:null,size:null!=(a=e.size)?a:u,status:h===u?Cv.FINISHED:null!=(r=e.status)?r:d}}getSteps(){const e=this.data.get("steps");return Array.isArray(e)?e:[]}hasUpdatedState(e){return JSON.stringify(e)!==JSON.stringify(this.getState())}setState(e,t=!1){const n=this.getState(),{action:i,index:o,lifecycle:a,origin:r=null,size:s,status:l}={...n,...e};this.store.set("action",i),this.store.set("index",o),this.store.set("lifecycle",a),this.store.set("origin",r),this.store.set("size",s),this.store.set("status",l),t&&(this.store.set("controlled",e.controlled),this.store.set("continuous",e.continuous)),this.listener&&this.hasUpdatedState(n)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}},iy=function({styles:e}){return i.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:e})},oy=class extends i.Component{constructor(){super(...arguments),pv(this,"isActive",!1),pv(this,"resizeTimeout"),pv(this,"scrollTimeout"),pv(this,"scrollParent"),pv(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),pv(this,"hideSpotlight",(()=>{const{continuous:e,disableOverlay:t,lifecycle:n}=this.props,i=[Tv.INIT,Tv.BEACON,Tv.COMPLETE,Tv.ERROR];return t||(e?i.includes(n):n!==Tv.TOOLTIP)})),pv(this,"handleMouseMove",(e=>{const{mouseOverSpotlight:t}=this.state,{height:n,left:i,position:o,top:a,width:r}=this.spotlightStyles,s="fixed"===o?e.clientY:e.pageY,l="fixed"===o?e.clientX:e.pageX,c=l>=i&&l<=i+r&&s>=a&&s<=a+n;c!==t&&this.updateState({mouseOverSpotlight:c})})),pv(this,"handleScroll",(()=>{const{target:e}=this.props,t=Av(e);if(this.scrollParent!==document){const{isScrolling:e}=this.state;e||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout((()=>{this.updateState({isScrolling:!1,showSpotlight:!0})}),50)}else _v(t,"sticky")&&this.updateState({})})),pv(this,"handleResize",(()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout((()=>{this.isActive&&this.forceUpdate()}),100)}))}componentDidMount(){const{debug:e,disableScrolling:t,disableScrollParentFix:n=!1,target:i}=this.props,o=Av(i);this.scrollParent=Ev(null!=o?o:document.body,n,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){var t;const{disableScrollParentFix:n,lifecycle:i,spotlightClicks:o,target:a}=this.props,{changed:r}=Xg(e,this.props);if(r("target")||r("disableScrollParentFix")){const e=Av(a);this.scrollParent=Ev(null!=e?e:document.body,n,!0)}r("lifecycle",Tv.TOOLTIP)&&(null==(t=this.scrollParent)||t.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout((()=>{const{isScrolling:e}=this.state;e||this.updateState({showSpotlight:!0})}),100)),(r("spotlightClicks")||r("disableOverlay")||r("lifecycle"))&&(o&&i===Tv.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):i!==Tv.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var e;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),null==(e=this.scrollParent)||e.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:e}=this.state,{disableOverlayClose:t,placement:n,styles:i}=this.props;let o=i.overlay;return zv()&&(o="center"===n?i.overlayLegacyCenter:i.overlayLegacy),{cursor:t?"default":"pointer",height:Iv(),pointerEvents:e?"none":"auto",...o}}get spotlightStyles(){var e,t,n;const{showSpotlight:i}=this.state,{disableScrollParentFix:o=!1,spotlightClicks:a,spotlightPadding:r=0,styles:s,target:l}=this.props,c=Av(l),u=xv(c),d=_v(c),p=function(e,t,n){var i,o,a;const r=xv(e),s=Ev(e,n),l=Ov(e,n),c=_v(e);let u=0,d=null!=(i=null==r?void 0:r.top)?i:0;return l&&c?d=(null!=(o=null==e?void 0:e.offsetTop)?o:0)-(null!=(a=null==s?void 0:s.scrollTop)?a:0):s instanceof HTMLElement&&(u=s.scrollTop,l||_v(e)||(d+=u),s.isSameNode(Nv())||(d+=Nv().scrollTop)),Math.floor(d-t)}(c,r,o);return{...zv()?s.spotlightLegacy:s.spotlight,height:Math.round((null!=(e=null==u?void 0:u.height)?e:0)+2*r),left:Math.round((null!=(t=null==u?void 0:u.left)?t:0)-r),opacity:i?1:0,pointerEvents:a?"none":"auto",position:d?"fixed":"absolute",top:p,transition:"opacity 0.2s",width:Math.round((null!=(n=null==u?void 0:u.width)?n:0)+2*r)}}updateState(e){this.isActive&&this.setState((t=>({...t,...e})))}render(){const{showSpotlight:e}=this.state,{onClickOverlay:t,placement:n}=this.props,{hideSpotlight:o,overlayStyles:a,spotlightStyles:r}=this;if(o())return null;let s="center"!==n&&e&&i.createElement(iy,{styles:r});if("safari"===Rv()){const{mixBlendMode:e,zIndex:t,...n}=a;s=i.createElement("div",{style:{...n}},s),delete a.backgroundColor}return i.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:t,role:"presentation",style:a},s)}},ay=class extends i.Component{constructor(){super(...arguments),pv(this,"node",null)}componentDidMount(){const{id:e}=this.props;Pv()&&(this.node=document.createElement("div"),this.node.id=e,document.body.appendChild(this.node),Mv||this.renderReact15())}componentDidUpdate(){Pv()&&(Mv||this.renderReact15())}componentWillUnmount(){Pv()&&this.node&&(Mv||nm.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!Pv())return;const{children:e}=this.props;this.node&&nm.unstable_renderSubtreeIntoContainer(this,e,this.node)}renderReact16(){if(!Pv()||!Mv)return null;const{children:e}=this.props;return this.node?nm.createPortal(e,this.node):null}render(){return Mv?this.renderReact16():null}},ry=class{constructor(e,t){if(pv(this,"element"),pv(this,"options"),pv(this,"canBeTabbed",(e=>{const{tabIndex:t}=e;return!(null===t||t<0)&&this.canHaveFocus(e)})),pv(this,"canHaveFocus",(e=>{const t=e.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(t)&&!e.getAttribute("disabled")||"a"===t&&!!e.getAttribute("href"))&&this.isVisible(e)})),pv(this,"findValidTabElements",(()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed))),pv(this,"handleKeyDown",(e=>{const{code:t="Tab"}=this.options;e.code===t&&this.interceptTab(e)})),pv(this,"interceptTab",(e=>{e.preventDefault();const t=this.findValidTabElements(),{shiftKey:n}=e;if(!t.length)return;let i=document.activeElement?t.indexOf(document.activeElement):0;-1===i||!n&&i+1===t.length?i=0:n&&0===i?i=t.length-1:i+=n?-1:1,t[i].focus()})),pv(this,"isHidden",(e=>{const t=e.offsetWidth<=0&&e.offsetHeight<=0,n=window.getComputedStyle(e);return!(!t||e.innerHTML)||t&&"visible"!==n.getPropertyValue("overflow")||"none"===n.getPropertyValue("display")})),pv(this,"isVisible",(e=>{let t=e;for(;t;)if(t instanceof HTMLElement){if(t===document.body)break;if(this.isHidden(t))return!1;t=t.parentNode}return!0})),pv(this,"removeScope",(()=>{window.removeEventListener("keydown",this.handleKeyDown)})),pv(this,"checkFocus",(e=>{document.activeElement!==e&&(e.focus(),window.requestAnimationFrame((()=>this.checkFocus(e))))})),pv(this,"setFocus",(()=>{const{selector:e}=this.options;if(!e)return;const t=this.element.querySelector(e);t&&window.requestAnimationFrame((()=>this.checkFocus(t)))})),!(e instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=e,this.options=t,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},sy=class extends i.Component{constructor(e){if(super(e),pv(this,"beacon",null),pv(this,"setBeaconRef",(e=>{this.beacon=e})),e.beaconComponent)return;const t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id="joyride-beacon-animation",e.nonce&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("\n        @keyframes joyride-beacon-inner {\n          20% {\n            opacity: 0.9;\n          }\n        \n          90% {\n            opacity: 0.7;\n          }\n        }\n        \n        @keyframes joyride-beacon-outer {\n          0% {\n            transform: scale(1);\n          }\n        \n          45% {\n            opacity: 0.7;\n            transform: scale(0.75);\n          }\n        \n          100% {\n            opacity: 0.9;\n            transform: scale(1);\n          }\n        }\n      ")),t.appendChild(n)}componentDidMount(){const{shouldFocus:e}=this.props;setTimeout((()=>{qg.domElement(this.beacon)&&e&&this.beacon.focus()}),0)}componentWillUnmount(){const e=document.getElementById("joyride-beacon-animation");(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)}render(){const{beaconComponent:e,continuous:t,index:n,isLastStep:o,locale:a,onClickOrHover:r,size:s,step:l,styles:c}=this.props,u=Dv(a.open),d={"aria-label":u,onClick:r,onMouseEnter:r,ref:this.setBeaconRef,title:u};let p;if(e){const a=e;p=i.createElement(a,{continuous:t,index:n,isLastStep:o,size:s,step:l,...d})}else p=i.createElement("button",{key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:c.beacon,type:"button",...d},i.createElement("span",{style:c.beaconInner}),i.createElement("span",{style:c.beaconOuter}));return p}},ly=function({styles:e,...t}){const{color:n,height:o,width:a,...r}=e;return i.createElement("button",{style:r,type:"button",...t},i.createElement("svg",{height:"number"==typeof o?`${o}px`:o,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:"number"==typeof a?`${a}px`:a,xmlns:"http://www.w3.org/2000/svg"},i.createElement("g",null,i.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))},cy=function(e){const{backProps:t,closeProps:n,index:o,isLastStep:a,primaryProps:r,skipProps:s,step:l,tooltipProps:c}=e,{content:u,hideBackButton:d,hideCloseButton:p,hideFooter:h,showSkipButton:g,styles:m,title:f}=l,v={};return v.primary=i.createElement("button",{"data-test-id":"button-primary",style:m.buttonNext,type:"button",...r}),g&&!a&&(v.skip=i.createElement("button",{"aria-live":"off","data-test-id":"button-skip",style:m.buttonSkip,type:"button",...s})),!d&&o>0&&(v.back=i.createElement("button",{"data-test-id":"button-back",style:m.buttonBack,type:"button",...t})),v.close=!p&&i.createElement(ly,{"data-test-id":"button-close",styles:m.buttonClose,...n}),i.createElement("div",{key:"JoyrideTooltip","aria-label":Dv(null!=f?f:u),className:"react-joyride__tooltip",style:m.tooltip,...c},i.createElement("div",{style:m.tooltipContainer},f&&i.createElement("h1",{"aria-label":Dv(f),style:m.tooltipTitle},f),i.createElement("div",{style:m.tooltipContent},u)),!h&&i.createElement("div",{style:m.tooltipFooter},i.createElement("div",{style:m.tooltipFooterSpacer},v.skip),v.back,v.primary),v.close)},uy=class extends i.Component{constructor(){super(...arguments),pv(this,"handleClickBack",(e=>{e.preventDefault();const{helpers:t}=this.props;t.prev()})),pv(this,"handleClickClose",(e=>{e.preventDefault();const{helpers:t}=this.props;t.close("button_close")})),pv(this,"handleClickPrimary",(e=>{e.preventDefault();const{continuous:t,helpers:n}=this.props;t?n.next():n.close("button_primary")})),pv(this,"handleClickSkip",(e=>{e.preventDefault();const{helpers:t}=this.props;t.skip()})),pv(this,"getElementsProps",(()=>{const{continuous:e,index:t,isLastStep:n,setTooltipRef:i,size:o,step:a}=this.props,{back:r,close:s,last:l,next:c,nextLabelWithProgress:u,skip:d}=a.locale,p=Dv(r),h=Dv(s),g=Dv(l),m=Dv(c),f=Dv(d);let v=s,y=h;if(e){if(v=c,y=m,a.showProgress&&!n){const e=Dv(u,{step:t+1,steps:o});v=Bv(u,t+1,o),y=e}n&&(v=l,y=g)}return{backProps:{"aria-label":p,children:r,"data-action":"back",onClick:this.handleClickBack,role:"button",title:p},closeProps:{"aria-label":h,children:s,"data-action":"close",onClick:this.handleClickClose,role:"button",title:h},primaryProps:{"aria-label":y,children:v,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:y},skipProps:{"aria-label":f,children:d,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:f},tooltipProps:{"aria-modal":!0,ref:i,role:"alertdialog"}}}))}render(){const{continuous:e,index:t,isLastStep:n,setTooltipRef:o,size:a,step:r}=this.props,{beaconComponent:s,tooltipComponent:l,...c}=r;let u;if(l){const r={...this.getElementsProps(),continuous:e,index:t,isLastStep:n,size:a,step:c,setTooltipRef:o},s=l;u=i.createElement(s,{...r})}else u=i.createElement(cy,{...this.getElementsProps(),continuous:e,index:t,isLastStep:n,size:a,step:r});return u}},dy=class extends i.Component{constructor(){super(...arguments),pv(this,"scope",null),pv(this,"tooltip",null),pv(this,"handleClickHoverBeacon",(e=>{const{step:t,store:n}=this.props;"mouseenter"===e.type&&"hover"!==t.event||n.update({lifecycle:Tv.TOOLTIP})})),pv(this,"setTooltipRef",(e=>{this.tooltip=e})),pv(this,"setPopper",((e,t)=>{var n;const{action:i,lifecycle:o,step:a,store:r}=this.props;"wrapper"===t?r.setPopper("beacon",e):r.setPopper("tooltip",e),r.getPopper("beacon")&&(r.getPopper("tooltip")||"center"===a.placement)&&o===Tv.INIT&&r.update({action:i,lifecycle:Tv.READY}),(null==(n=a.floaterProps)?void 0:n.getPopper)&&a.floaterProps.getPopper(e,t)})),pv(this,"renderTooltip",(e=>{const{continuous:t,helpers:n,index:o,size:a,step:r}=this.props;return i.createElement(uy,{continuous:t,helpers:n,index:o,isLastStep:o+1===a,setTooltipRef:this.setTooltipRef,size:a,step:r,...e})}))}componentDidMount(){const{debug:e,index:t}=this.props;Uv({title:`step:${t}`,data:[{key:"props",value:this.props}],debug:e})}componentDidUpdate(e){var t;const{action:n,callback:i,continuous:o,controlled:a,debug:r,helpers:s,index:l,lifecycle:c,shouldScroll:u,status:d,step:p,store:h}=this.props,{changed:g,changedFrom:m}=Xg(e,this.props),f=s.info(),v=o&&n!==yv&&(l>0||n===fv),y=g("action")||g("index")||g("lifecycle")||g("status"),b=m("lifecycle",[Tv.TOOLTIP,Tv.INIT],Tv.INIT),k=g("action",[vv,fv,bv,yv]),S=a&&l===e.index;if(k&&(b||S)&&i({...f,index:e.index,lifecycle:Tv.COMPLETE,step:e.step,type:Sv}),"center"===p.placement&&d===Cv.RUNNING&&g("index")&&n!==hv&&c===Tv.INIT&&h.update({lifecycle:Tv.READY}),y){const e=Av(p.target),t=!!e,o=t&&function(e){var t;if(!e)return!1;let n=e;for(;n&&n!==document.body;){if(n instanceof HTMLElement){const{display:e,visibility:t}=getComputedStyle(n);if("none"===e||"hidden"===t)return!1}n=null!=(t=n.parentElement)?t:null}return!0}(e);o?(m("status",Cv.READY,Cv.RUNNING)||m("lifecycle",Tv.INIT,Tv.READY))&&i({...f,step:p,type:"step:before"}):(console.warn(t?"Target not visible":"Target not mounted",p),i({...f,type:wv,step:p}),a||h.update({index:l+(n===fv?-1:1)}))}m("lifecycle",Tv.INIT,Tv.READY)&&h.update({lifecycle:Fv(p)||v?Tv.TOOLTIP:Tv.BEACON}),g("index")&&Uv({title:`step:${c}`,data:[{key:"props",value:this.props}],debug:r}),g("lifecycle",Tv.BEACON)&&i({...f,step:p,type:"beacon"}),g("lifecycle",Tv.TOOLTIP)&&(i({...f,step:p,type:"tooltip"}),u&&this.tooltip&&(this.scope=new ry(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),m("lifecycle",[Tv.TOOLTIP,Tv.INIT],Tv.INIT)&&(null==(t=this.scope)||t.removeScope(),h.cleanupPoppers())}componentWillUnmount(){var e;null==(e=this.scope)||e.removeScope()}get open(){const{lifecycle:e,step:t}=this.props;return Fv(t)||e===Tv.TOOLTIP}render(){const{continuous:e,debug:t,index:n,nonce:o,shouldScroll:a,size:r,step:s}=this.props,l=Av(s.target);return Yv(s)&&qg.domElement(l)?i.createElement("div",{key:`JoyrideStep-${n}`,className:"react-joyride__step"},i.createElement(uv,{...s.floaterProps,component:this.renderTooltip,debug:t,getPopper:this.setPopper,id:`react-joyride-step-${n}`,open:this.open,placement:s.placement,target:s.target},i.createElement(sy,{beaconComponent:s.beaconComponent,continuous:e,index:n,isLastStep:n+1===r,locale:s.locale,nonce:o,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:a,size:r,step:s,styles:s.styles}))):null}},py=class extends i.Component{constructor(e){super(e),pv(this,"helpers"),pv(this,"store"),pv(this,"callback",(e=>{const{callback:t}=this.props;qg.function(t)&&t(e)})),pv(this,"handleKeyboard",(e=>{const{index:t,lifecycle:n}=this.state,{steps:i}=this.props,o=i[t];n===Tv.TOOLTIP&&"Escape"===e.code&&o&&!o.disableCloseOnEsc&&this.store.close("keyboard")})),pv(this,"handleClickOverlay",(()=>{const{index:e}=this.state,{steps:t}=this.props;Qv(this.props,t[e]).disableOverlayClose||this.helpers.close("overlay")})),pv(this,"syncState",(e=>{this.setState(e)}));const{debug:t,getHelpers:n,run:i=!0,stepIndex:o}=e;this.store=function(e){return new ny(e)}({...e,controlled:i&&qg.number(o)}),this.helpers=this.store.getHelpers();const{addListener:a}=this.store;Uv({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:t}),a(this.syncState),n&&n(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!Pv())return;const{debug:e,disableCloseOnEsc:t,run:n,steps:i}=this.props,{start:o}=this.store;Zv(i,e)&&n&&o(),t||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(e,t){if(!Pv())return;const{action:n,controlled:i,index:o,status:a}=this.state,{debug:r,run:s,stepIndex:l,steps:c}=this.props,{stepIndex:u,steps:d}=e,{reset:p,setSteps:h,start:g,stop:m,update:f}=this.store,{changed:v}=Xg(e,this.props),{changed:y,changedFrom:b}=Xg(t,this.state),k=Qv(this.props,c[o]),S=!jg(d,c),w=qg.number(l)&&v("stepIndex"),T=Av(k.target);if(S&&(Zv(c,r)?h(c):console.warn("Steps are not valid",c)),v("run")&&(s?g(l):m()),w){let e=qg.number(u)&&u<l?vv:fv;n===gv&&(e=hv),[Cv.FINISHED,Cv.SKIPPED].includes(a)||f({action:n===yv?yv:e,index:l,lifecycle:Tv.INIT})}i||a!==Cv.RUNNING||0!==o||T||(this.store.update({index:o+1}),this.callback({...this.state,type:wv,step:k}));const C={...this.state,index:o,step:k};if(y("action",[vv,fv,bv,yv])&&y("status",Cv.PAUSED)){const e=Qv(this.props,c[t.index]);this.callback({...C,index:t.index,lifecycle:Tv.COMPLETE,step:e,type:Sv})}if(y("status",[Cv.FINISHED,Cv.SKIPPED])){const e=Qv(this.props,c[t.index]);i||this.callback({...C,index:t.index,lifecycle:Tv.COMPLETE,step:e,type:Sv}),this.callback({...C,type:"tour:end",step:e,index:t.index}),p()}else b("status",[Cv.IDLE,Cv.READY],Cv.RUNNING)?this.callback({...C,type:"tour:start"}):(y("status")||y("action",mv))&&this.callback({...C,type:"tour:status"});this.scrollToStep(t)}componentWillUnmount(){const{disableCloseOnEsc:e}=this.props;e||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(e){const{index:t,lifecycle:n,status:i}=this.state,{debug:o,disableScrollParentFix:a=!1,scrollDuration:r,scrollOffset:s=20,scrollToFirstStep:l=!1,steps:c}=this.props,u=Qv(this.props,c[t]),d=Av(u.target),p=function(e){const{isFirstStep:t,lifecycle:n,previousLifecycle:i,scrollToFirstStep:o,step:a,target:r}=e;return!a.disableScrolling&&(!t||o||n===Tv.TOOLTIP)&&"center"!==a.placement&&(!a.isFixed||!_v(r))&&i!==n&&[Tv.BEACON,Tv.TOOLTIP].includes(n)}({isFirstStep:0===t,lifecycle:n,previousLifecycle:e.lifecycle,scrollToFirstStep:l,step:u,target:d});if(i===Cv.RUNNING&&p){const e=Ov(d,a),l=Ev(d,a);let c=Math.floor(function(e,t,n){var i;if(!e)return 0;const{offsetTop:o=0,scrollTop:a=0}=null!=(i=tm(e))?i:{};let r=e.getBoundingClientRect().top+a;o&&(Ov(e,n)||function(e){return e.offsetParent!==document.body}(e))&&(r-=o);const s=Math.floor(r-t);return s<0?0:s}(d,s,a))||0;Uv({title:"scrollToStep",data:[{key:"index",value:t},{key:"lifecycle",value:n},{key:"status",value:i}],debug:o});const p=this.store.getPopper("beacon"),h=this.store.getPopper("tooltip");if(n===Tv.BEACON&&p){const{offsets:t,placement:n}=p;["bottom"].includes(n)||e||(c=Math.floor(t.popper.top-s))}else if(n===Tv.TOOLTIP&&h){const{flipped:t,offsets:n,placement:i}=h;!["top","right","left"].includes(i)||t||e?c-=u.spotlightPadding:c=Math.floor(n.popper.top-s)}c=c>=0?c:0,i===Cv.RUNNING&&function(e,t){const{duration:n,element:i}=t;return new Promise(((t,o)=>{const{scrollTop:a}=i,r=e>a?e-a:a-e;em.top(i,e,{duration:r<100?50:n},(e=>e&&"Element already at target scroll position"!==e.message?o(e):t()))}))}(c,{element:l,duration:r}).then((()=>{setTimeout((()=>{var e;null==(e=this.store.getPopper("tooltip"))||e.instance.update()}),10)}))}}render(){if(!Pv())return null;const{index:e,lifecycle:t,status:n}=this.state,{continuous:o=!1,debug:a=!1,nonce:r,scrollToFirstStep:s=!1,steps:l}=this.props,c={};if(n===Cv.RUNNING&&l[e]){const n=Qv(this.props,l[e]);c.step=i.createElement(dy,{...this.state,callback:this.callback,continuous:o,debug:a,helpers:this.helpers,nonce:r,shouldScroll:!n.disableScrolling&&(0!==e||s),step:n,store:this.store}),c.overlay=i.createElement(ay,{id:"react-joyride-portal"},i.createElement(oy,{...n,continuous:o,debug:a,lifecycle:t,onClickOverlay:this.handleClickOverlay}))}return i.createElement("div",{className:"react-joyride"},c.step,c.overlay)}};pv(py,"defaultProps",{continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]});var hy=py,gy=n(6336),my={};my.styleTagTransform=tt(),my.setAttributes=Ye(),my.insert=Je().bind(null,"head"),my.domAPI=Ge(),my.insertStyleElement=Xe(),He()(gy.A,my),gy.A&&gy.A.locals&&gy.A.locals;const fy=()=>{const{t:e}=le(),{isOnboardingActive:t,currentStepIndex:n,steps:o,nextStep:a,prevStep:r,skipOnboarding:s,markOnboardingComplete:l}=sg();(0,i.useEffect)((()=>{if(!t)return;const e=e=>{const t=e.target;if(1===n){const e=t.classList.contains("react-joyride__spotlight")||t.closest(".react-joyride__spotlight"),n=t.closest(".settings-button");if(e||n){const e=document.querySelector(".settings-button");return e&&!n&&e.click(),void setTimeout((()=>{a()}),200)}}if(6===n){const e=t.classList.contains("react-joyride__spotlight")||t.closest(".react-joyride__spotlight"),n=t.closest(".audio-button");if(e||n){const e=document.querySelector(".audio-button");return e&&!n&&e.click(),void setTimeout((()=>{a()}),200)}}};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}}),[t,n,a]);const c=(0,i.useCallback)((e=>{const{status:t,type:i,action:s,index:c}=e;if([Cv.FINISHED,Cv.SKIPPED].includes(t))l();else if(i===Sv)if(s===vv){if(1===n){const e=document.querySelector(".settings-button");return e&&e.click(),void setTimeout((()=>{a()}),200)}if(6===n){const e=document.querySelector(".audio-button");return e&&e.click(),void setTimeout((()=>{a()}),200)}a()}else s===fv&&r();else i===wv&&(console.warn("[Onboarding] Target not found for step:",c,o[c]?.target),s===vv?a():s===fv&&r())}),[a,r,l,n,o]);return t?(0,dh.jsx)(hy,{callback:c,continuous:!0,hideCloseButton:!1,run:t,scrollToFirstStep:!0,showProgress:!0,showSkipButton:!0,stepIndex:n,steps:o,disableOverlayClose:!0,disableCloseOnEsc:!1,disableScrolling:!1,styles:{options:{primaryColor:"#007bff",backgroundColor:"#ffffff",textColor:"#333333",overlayColor:"rgba(0, 0, 0, 0.4)",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",beaconSize:36,zIndex:1e4},tooltip:{borderRadius:8,fontSize:14,padding:20,maxWidth:400},tooltipContainer:{textAlign:"left"},tooltipTitle:{fontSize:18,fontWeight:"bold",marginBottom:10,color:"#007bff"},tooltipContent:{lineHeight:1.5,marginBottom:15},buttonNext:{backgroundColor:"#007bff",borderRadius:4,color:"#ffffff",fontSize:14,fontWeight:"bold",padding:"8px 16px",border:"none",cursor:"pointer"},buttonBack:{backgroundColor:"transparent",border:"1px solid #007bff",borderRadius:4,color:"#007bff",fontSize:14,fontWeight:"bold",padding:"8px 16px",cursor:"pointer",marginRight:8},buttonSkip:{backgroundColor:"transparent",border:"none",color:"#666666",fontSize:14,padding:"8px 16px",cursor:"pointer"},buttonClose:{backgroundColor:"transparent",border:"none",color:"#666666",fontSize:18,padding:4,cursor:"pointer",position:"absolute",right:8,top:8},spotlight:{borderRadius:4},beacon:{backgroundColor:"#007bff",border:"2px solid #ffffff",borderRadius:"50%",boxShadow:"0 0 10px rgba(0, 123, 255, 0.5)"}},locale:{back:e("onboarding.back","Back"),close:e("onboarding.close","Close"),last:e("onboarding.finish","Finish"),next:e("onboarding.next","Next"),nextLabelWithProgress:e("onboarding.nextWithProgress","Next ({step}/{steps})"),open:e("onboarding.open","Open the dialog"),skip:e("onboarding.skip","Skip tour")},floaterProps:{disableAnimation:!0}}):null},vy=je("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var yy=n(1284),by={};by.styleTagTransform=tt(),by.setAttributes=Ye(),by.insert=Je().bind(null,"head"),by.domAPI=Ge(),by.insertStyleElement=Xe(),He()(yy.A,by),yy.A&&yy.A.locals&&yy.A.locals;const ky=()=>{const{t:e}=le(),[t,n]=(0,i.useState)(!1),[o,a]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),l=()=>{r?s(!1):(s(!0),n(!1),a(!1))},c=()=>{t?n(!1):(n(!0),s(!1),a(!1))},u=()=>{o?a(!1):(a(!0),s(!1),n(!1))};return(0,dh.jsxs)("div",{className:"main-layout",children:[(0,dh.jsxs)("div",{className:"main-content "+(t||o||r?"with-panel":"full-width"),children:[(0,dh.jsxs)("header",{className:"main-panel-header",children:[(0,dh.jsx)("h1",{children:e("app.title")}),(0,dh.jsxs)("div",{className:"header-controls",children:[(0,dh.jsxs)("button",{className:"settings-button "+(o?"active":""),onClick:u,children:[(0,dh.jsx)(vy,{size:16}),(0,dh.jsx)("span",{children:e("settings.title")})]}),(0,dh.jsxs)("button",{className:"audio-button "+(r?"active":""),onClick:l,children:[(0,dh.jsx)(Le,{size:16}),(0,dh.jsx)("span",{children:e("settings.audio")})]}),(0,dh.jsxs)("button",{className:"logs-button "+(t?"active":""),onClick:c,children:[(0,dh.jsx)(vg,{size:16}),(0,dh.jsx)("span",{children:e("common.logs")})]})]})]}),(0,dh.jsx)("div",{className:"main-panel-container",children:(0,dh.jsx)(Wh,{})})]}),(t||o||r)&&(0,dh.jsxs)("div",{className:"settings-panel-container",children:[t&&(0,dh.jsx)(Sg,{toggleLogs:c}),o&&(0,dh.jsx)(pg,{toggleSettings:u}),r&&(0,dh.jsx)(Eg,{toggleAudio:l})]}),(0,dh.jsx)(fy,{})]})},Sy=function(){const{trackEvent:e}=(0,Rh.useAnalytics)();return(0,i.useEffect)((()=>{e("app_startup",{});const t=()=>{const t=sessionStorage.getItem("session_start"),n=t?Date.now()-parseInt(t,10):0;e("app_shutdown",{session_duration:n})};return sessionStorage.getItem("session_start")||sessionStorage.setItem("session_start",Date.now().toString()),window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[e]),(0,dh.jsx)("div",{className:"App",children:(0,dh.jsx)(Sh,{children:(0,dh.jsx)(Oh,{children:(0,dh.jsx)(Ih,{children:(0,dh.jsx)(Ch,{children:(0,dh.jsx)(rg,{children:(0,dh.jsx)(ky,{})})})})})})})};var wy,Ty,Cy,Py,xy,Iy,Ay,Ey,Oy,_y,Ny,My="4.1.0";!function(e){e.AnonymousId="anonymous_id",e.DistinctId="distinct_id",e.Props="props",e.FeatureFlagDetails="feature_flag_details",e.FeatureFlags="feature_flags",e.FeatureFlagPayloads="feature_flag_payloads",e.BootstrapFeatureFlagDetails="bootstrap_feature_flag_details",e.BootstrapFeatureFlags="bootstrap_feature_flags",e.BootstrapFeatureFlagPayloads="bootstrap_feature_flag_payloads",e.OverrideFeatureFlags="override_feature_flags",e.Queue="queue",e.OptedOut="opted_out",e.SessionId="session_id",e.SessionStartTimestamp="session_start_timestamp",e.SessionLastTimestamp="session_timestamp",e.PersonProperties="person_properties",e.GroupProperties="group_properties",e.InstalledAppBuild="installed_app_build",e.InstalledAppVersion="installed_app_version",e.SessionReplay="session_replay",e.SurveyLastSeenDate="survey_last_seen_date",e.SurveysSeen="surveys_seen",e.Surveys="surveys",e.RemoteConfig="remote_config",e.FlagsEndpointWasHit="flags_endpoint_was_hit"}(wy||(wy={})),function(e){e.GZipJS="gzip-js",e.Base64="base64"}(Ty||(Ty={})),function(e){e.Left="left",e.Right="right",e.Center="center"}(Cy||(Cy={})),function(e){e.Button="button",e.Tab="tab",e.Selector="selector"}(Py||(Py={})),function(e){e.Popover="popover",e.API="api",e.Widget="widget"}(xy||(xy={})),function(e){e.Html="html",e.Text="text"}(Iy||(Iy={})),function(e){e.Number="number",e.Emoji="emoji"}(Ay||(Ay={})),function(e){e.Open="open",e.MultipleChoice="multiple_choice",e.SingleChoice="single_choice",e.Rating="rating",e.Link="link"}(Ey||(Ey={})),function(e){e.NextQuestion="next_question",e.End="end",e.ResponseBased="response_based",e.SpecificQuestion="specific_question"}(Oy||(Oy={})),function(e){e.Regex="regex",e.NotRegex="not_regex",e.Exact="exact",e.IsNot="is_not",e.Icontains="icontains",e.NotIcontains="not_icontains"}(_y||(_y={})),function(e){e.Contains="contains",e.Exact="exact",e.Regex="regex"}(Ny||(Ny={}));const Ry=e=>{if("flags"in e){const t=Dy(e.flags),n=Ly(e.flags);return{...e,featureFlags:t,featureFlagPayloads:n}}{const t=e.featureFlags??{},n=Object.fromEntries(Object.entries(e.featureFlagPayloads||{}).map((([e,t])=>[e,zy(t)]))),i=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,jy(e,t,n[e])])));return{...e,featureFlags:t,featureFlagPayloads:n,flags:i}}};function jy(e,t,n){return{key:e,enabled:"string"==typeof t||t,variant:"string"==typeof t?t:void 0,reason:void 0,metadata:{id:void 0,version:void 0,payload:n?JSON.stringify(n):void 0,description:void 0}}}const Dy=e=>Object.fromEntries(Object.entries(e??{}).map((([e,t])=>[e,Fy(t)])).filter((([,e])=>void 0!==e))),Ly=e=>{const t=e??{};return Object.fromEntries(Object.keys(t).filter((e=>{const n=t[e];return n.enabled&&n.metadata&&void 0!==n.metadata.payload})).map((e=>{const n=t[e].metadata?.payload;return[e,n?zy(n):void 0]})))},Fy=e=>void 0===e?void 0:e.variant??e.enabled,zy=e=>{if("string"!=typeof e)return e;try{return JSON.parse(e)}catch{return e}},Uy=(e,t)=>{const n=[...new Set([...Object.keys(e??{}),...Object.keys(t??{})])].filter((n=>!!e[n]||!!t[n])).reduce(((t,n)=>(t[n]=e[n]??!0,t)),{});return Ry({featureFlags:n,featureFlagPayloads:t??{}})};function Vy(e){return"string"==typeof e||e}function By(e){return"string"==typeof e?e:void 0}function qy(){return(new Date).toISOString()}function Ky(e,t){const n=setTimeout(e,t);return n?.unref&&n?.unref(),n}const Hy=e=>e instanceof Error;function Wy(e){return Promise.all(e.map((e=>(e??Promise.resolve()).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))}async function Gy(e,t=!0){try{const t=new Blob([e],{type:"text/plain"}).stream().pipeThrough(new CompressionStream("gzip"));return await new Response(t).blob()}catch(e){return t&&console.error("Failed to gzip compress data",e),null}}class $y{constructor(){this.events={},this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.events[e]=this.events[e].filter((e=>e!==t))}}emit(e,t){for(const n of this.events[e]||[])n(t);for(const n of this.events["*"]||[])n(e,t)}}const Jy="0123456789abcdef";class Qy{constructor(e){this.bytes=e}static ofInner(e){if(16!==e.length)throw new TypeError("not 128-bit length");return new Qy(e)}static fromFieldsV7(e,t,n,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(i)||e<0||t<0||n<0||i<0||e>0xffffffffffff||t>4095||n>1073741823||i>4294967295)throw new RangeError("invalid field value");const o=new Uint8Array(16);return o[0]=e/2**40,o[1]=e/2**32,o[2]=e/2**24,o[3]=e/65536,o[4]=e/256,o[5]=e,o[6]=112|t>>>8,o[7]=t,o[8]=128|n>>>24,o[9]=n>>>16,o[10]=n>>>8,o[11]=n,o[12]=i>>>24,o[13]=i>>>16,o[14]=i>>>8,o[15]=i,new Qy(o)}static parse(e){let t;switch(e.length){case 32:t=/^[0-9a-f]{32}$/i.exec(e)?.[0];break;case 36:t=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e)?.slice(1,6).join("");break;case 38:t=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(e)?.slice(1,6).join("");break;case 45:t=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e)?.slice(1,6).join("")}if(t){const e=new Uint8Array(16);for(let n=0;n<16;n+=4){const i=parseInt(t.substring(2*n,2*n+8),16);e[n+0]=i>>>24,e[n+1]=i>>>16,e[n+2]=i>>>8,e[n+3]=i}return new Qy(e)}throw new SyntaxError("could not parse UUID string")}toString(){let e="";for(let t=0;t<this.bytes.length;t++)e+=Jy.charAt(this.bytes[t]>>>4),e+=Jy.charAt(15&this.bytes[t]),3!==t&&5!==t&&7!==t&&9!==t||(e+="-");return e}toHex(){let e="";for(let t=0;t<this.bytes.length;t++)e+=Jy.charAt(this.bytes[t]>>>4),e+=Jy.charAt(15&this.bytes[t]);return e}toJSON(){return this.toString()}getVariant(){const e=this.bytes[8]>>>4;if(e<0)throw new Error("unreachable");if(e<=7)return this.bytes.every((e=>0===e))?"NIL":"VAR_0";if(e<=11)return"VAR_10";if(e<=13)return"VAR_110";if(e<=15)return this.bytes.every((e=>255===e))?"MAX":"VAR_RESERVED";throw new Error("unreachable")}getVersion(){return"VAR_10"===this.getVariant()?this.bytes[6]>>>4:void 0}clone(){return new Qy(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(let t=0;t<16;t++){const n=this.bytes[t]-e.bytes[t];if(0!==n)return Math.sign(n)}return 0}}class Yy{constructor(e){this.timestamp=0,this.counter=0,this.random=e??Zy()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(e,t){let n=this.generateOrAbortCore(e,t);return void 0===n&&(this.timestamp=0,n=this.generateOrAbortCore(e,t)),n}generateOrAbortCore(e,t){if(!Number.isInteger(e)||e<1||e>0xffffffffffff)throw new RangeError("`unixTsMs` must be a 48-bit positive integer");if(t<0||t>0xffffffffffff)throw new RangeError("`rollbackAllowance` out of reasonable range");if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+t>=this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Qy.fromFieldsV7(this.timestamp,Math.trunc(this.counter/2**30),this.counter&2**30-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}generateV4(){const e=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return e[6]=64|e[6]>>>4,e[8]=128|e[8]>>>2,Qy.ofInner(e)}}const Zy=()=>({nextUint32:()=>65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random())});let Xy;const eb=()=>tb().toString(),tb=()=>(Xy||(Xy=new Yy)).generate();class nb extends Error{constructor(e,t){super("HTTP error while fetching PostHog: status="+e.status+", reqByteLength="+t),this.response=e,this.reqByteLength=t,this.name="PostHogFetchHttpError"}get status(){return this.response.status}get text(){return this.response.text()}get json(){return this.response.json()}}class ib extends Error{constructor(e){super("Network error while fetching PostHog",e instanceof Error?{cause:e}:{}),this.error=e,this.name="PostHogFetchNetworkError"}}const ob=(e,t)=>void 0!==t?{[e]:t}:{};async function ab(e){if(e instanceof nb){let t="";try{t=await e.text}catch{}console.error(`Error while flushing PostHog: message=${e.message}, response body=${t}`,e)}else console.error("Error while flushing PostHog",e);return Promise.resolve()}function rb(e){return"object"==typeof e&&(e instanceof nb||e instanceof ib)}function sb(e){return"object"==typeof e&&e instanceof nb&&413===e.status}var lb;!function(e){e.FeatureFlags="feature_flags",e.Recordings="recordings"}(lb||(lb={}));class cb{constructor(e,t){var n;this.flushPromise=null,this.shutdownPromise=null,this.pendingPromises={},this._events=new $y,this._isInitialized=!1,function(e){if(!e||"string"!=typeof e||function(e){return 0===e.trim().length}(e))throw new Error("You must pass your PostHog project's api key.")}(e),this.apiKey=e,this.host=(n=t?.host||"https://us.i.posthog.com",n?.replace(/\/+$/,"")),this.flushAt=t?.flushAt?Math.max(t?.flushAt,1):20,this.maxBatchSize=Math.max(this.flushAt,t?.maxBatchSize??100),this.maxQueueSize=Math.max(this.flushAt,t?.maxQueueSize??1e3),this.flushInterval=t?.flushInterval??1e4,this.preloadFeatureFlags=t?.preloadFeatureFlags??!0,this.defaultOptIn=t?.defaultOptIn??!0,this.disableSurveys=t?.disableSurveys??!1,this._retryOptions={retryCount:t?.fetchRetryCount??3,retryDelay:t?.fetchRetryDelay??3e3,retryCheck:rb},this.requestTimeout=t?.requestTimeout??1e4,this.featureFlagsRequestTimeoutMs=t?.featureFlagsRequestTimeoutMs??3e3,this.remoteConfigRequestTimeoutMs=t?.remoteConfigRequestTimeoutMs??3e3,this.disableGeoip=t?.disableGeoip??!0,this.disabled=t?.disabled??!1,this.historicalMigration=t?.historicalMigration??!1,this._initPromise=Promise.resolve(),this._isInitialized=!0,this.disableCompression=!("CompressionStream"in globalThis)||(t?.disableCompression??!1)}logMsgIfDebug(e){this.isDebug&&e()}wrap(e){if(!this.disabled)return this._isInitialized?e():void this._initPromise.then((()=>e()));this.logMsgIfDebug((()=>console.warn("[PostHog] The client is disabled")))}getCommonEventProperties(){return{$lib:this.getLibraryId(),$lib_version:this.getLibraryVersion()}}get optedOut(){return this.getPersistedProperty(wy.OptedOut)??!this.defaultOptIn}async optIn(){this.wrap((()=>{this.setPersistedProperty(wy.OptedOut,!1)}))}async optOut(){this.wrap((()=>{this.setPersistedProperty(wy.OptedOut,!0)}))}on(e,t){return this._events.on(e,t)}debug(e=!0){if(this.removeDebugCallback?.(),e){const e=this.on("*",((e,t)=>console.log("PostHog Debug",e,t)));this.removeDebugCallback=()=>{e(),this.removeDebugCallback=void 0}}}get isDebug(){return!!this.removeDebugCallback}get isDisabled(){return this.disabled}buildPayload(e){return{distinct_id:e.distinct_id,event:e.event,properties:{...e.properties||{},...this.getCommonEventProperties()}}}addPendingPromise(e){const t=eb();return this.pendingPromises[t]=e,e.catch((()=>{})).finally((()=>{delete this.pendingPromises[t]})),e}identifyStateless(e,t,n){this.wrap((()=>{const i={...this.buildPayload({distinct_id:e,event:"$identify",properties:t})};this.enqueue("identify",i,n)}))}async identifyStatelessImmediate(e,t,n){const i={...this.buildPayload({distinct_id:e,event:"$identify",properties:t})};await this.sendImmediate("identify",i,n)}captureStateless(e,t,n,i){this.wrap((()=>{const o=this.buildPayload({distinct_id:e,event:t,properties:n});this.enqueue("capture",o,i)}))}async captureStatelessImmediate(e,t,n,i){const o=this.buildPayload({distinct_id:e,event:t,properties:n});await this.sendImmediate("capture",o,i)}aliasStateless(e,t,n,i){this.wrap((()=>{const o=this.buildPayload({event:"$create_alias",distinct_id:t,properties:{...n||{},distinct_id:t,alias:e}});this.enqueue("alias",o,i)}))}async aliasStatelessImmediate(e,t,n,i){const o=this.buildPayload({event:"$create_alias",distinct_id:t,properties:{...n||{},distinct_id:t,alias:e}});await this.sendImmediate("alias",o,i)}groupIdentifyStateless(e,t,n,i,o,a){this.wrap((()=>{const r=this.buildPayload({distinct_id:o||`$${e}_${t}`,event:"$groupidentify",properties:{$group_type:e,$group_key:t,$group_set:n||{},...a||{}}});this.enqueue("capture",r,i)}))}async getRemoteConfig(){await this._initPromise;let e=this.host;"https://us.i.posthog.com"===e?e="https://us-assets.i.posthog.com":"https://eu.i.posthog.com"===e&&(e="https://eu-assets.i.posthog.com");const t=`${e}/array/${this.apiKey}/config`,n={method:"GET",headers:{...this.getCustomHeaders(),"Content-Type":"application/json"}};return this.fetchWithRetry(t,n,{retryCount:0},this.remoteConfigRequestTimeoutMs).then((e=>e.json())).catch((e=>{this.logMsgIfDebug((()=>console.error("Remote config could not be loaded",e))),this._events.emit("error",e)}))}async getFlags(e,t={},n={},i={},o={}){await this._initPromise;const a=`${this.host}/flags/?v=2&config=true`,r={method:"POST",headers:{...this.getCustomHeaders(),"Content-Type":"application/json"},body:JSON.stringify({token:this.apiKey,distinct_id:e,groups:t,person_properties:n,group_properties:i,...o})};return this.logMsgIfDebug((()=>console.log("PostHog Debug","Flags URL",a))),this.fetchWithRetry(a,r,{retryCount:0},this.featureFlagsRequestTimeoutMs).then((e=>e.json())).then((e=>Ry(e))).catch((e=>{this._events.emit("error",e)}))}async getFeatureFlagStateless(e,t,n={},i={},o={},a){await this._initPromise;const r=await this.getFeatureFlagDetailStateless(e,t,n,i,o,a);if(void 0===r)return{response:void 0,requestId:void 0};let s=Fy(r.response);return void 0===s&&(s=!1),{response:s,requestId:r.requestId}}async getFeatureFlagDetailStateless(e,t,n={},i={},o={},a){await this._initPromise;const r=await this.getFeatureFlagDetailsStateless(t,n,i,o,a,[e]);if(void 0!==r)return{response:r.flags[e],requestId:r.requestId}}async getFeatureFlagPayloadStateless(e,t,n={},i={},o={},a){await this._initPromise;const r=await this.getFeatureFlagPayloadsStateless(t,n,i,o,a,[e]);if(!r)return;const s=r[e];return void 0===s?null:s}async getFeatureFlagPayloadsStateless(e,t={},n={},i={},o,a){return await this._initPromise,(await this.getFeatureFlagsAndPayloadsStateless(e,t,n,i,o,a)).payloads}async getFeatureFlagsStateless(e,t={},n={},i={},o,a){return await this._initPromise,await this.getFeatureFlagsAndPayloadsStateless(e,t,n,i,o,a)}async getFeatureFlagsAndPayloadsStateless(e,t={},n={},i={},o,a){await this._initPromise;const r=await this.getFeatureFlagDetailsStateless(e,t,n,i,o,a);return r?{flags:r.featureFlags,payloads:r.featureFlagPayloads,requestId:r.requestId}:{flags:void 0,payloads:void 0,requestId:void 0}}async getFeatureFlagDetailsStateless(e,t={},n={},i={},o,a){await this._initPromise;const r={};(o??this.disableGeoip)&&(r.geoip_disable=!0),a&&(r.flag_keys_to_evaluate=a);const s=await this.getFlags(e,t,n,i,r);if(void 0!==s)return s.errorsWhileComputingFlags&&console.error("[FEATURE FLAGS] Error while computing feature flags, some flags may be missing or incorrect. Learn more at https://posthog.com/docs/feature-flags/best-practices"),s.quotaLimited?.includes(lb.FeatureFlags)?(console.warn("[FEATURE FLAGS] Feature flags quota limit exceeded - feature flags unavailable. Learn more about billing limits at https://posthog.com/docs/billing/limits-alerts"),{flags:{},featureFlags:{},featureFlagPayloads:{},requestId:s?.requestId}):s}async getSurveysStateless(){if(await this._initPromise,!0===this.disableSurveys)return this.logMsgIfDebug((()=>console.log("PostHog Debug","Loading surveys is disabled."))),[];const e=`${this.host}/api/surveys/?token=${this.apiKey}`,t={method:"GET",headers:{...this.getCustomHeaders(),"Content-Type":"application/json"}},n=await this.fetchWithRetry(e,t).then((e=>{if(200!==e.status||!e.json){const t=`Surveys API could not be loaded: ${e.status}`,n=new Error(t);return this.logMsgIfDebug((()=>console.error(n))),void this._events.emit("error",new Error(t))}return e.json()})).catch((e=>{this.logMsgIfDebug((()=>console.error("Surveys API could not be loaded",e))),this._events.emit("error",e)})),i=n?.surveys;return i&&this.logMsgIfDebug((()=>console.log("PostHog Debug","Surveys fetched from API: ",JSON.stringify(i)))),i??[]}get props(){return this._props||(this._props=this.getPersistedProperty(wy.Props)),this._props||{}}set props(e){this._props=e}async register(e){this.wrap((()=>{this.props={...this.props,...e},this.setPersistedProperty(wy.Props,this.props)}))}async unregister(e){this.wrap((()=>{delete this.props[e],this.setPersistedProperty(wy.Props,this.props)}))}enqueue(e,t,n){this.wrap((()=>{if(this.optedOut)return void this._events.emit(e,"Library is disabled. Not sending event. To re-enable, call posthog.optIn()");const i=this.prepareMessage(e,t,n),o=this.getPersistedProperty(wy.Queue)||[];o.length>=this.maxQueueSize&&(o.shift(),this.logMsgIfDebug((()=>console.info("Queue is full, the oldest event is dropped.")))),o.push({message:i}),this.setPersistedProperty(wy.Queue,o),this._events.emit(e,i),o.length>=this.flushAt&&this.flushBackground(),this.flushInterval&&!this._flushTimer&&(this._flushTimer=Ky((()=>this.flushBackground()),this.flushInterval))}))}async sendImmediate(e,t,n){if(this.disabled)return void this.logMsgIfDebug((()=>console.warn("[PostHog] The client is disabled")));if(this._isInitialized||await this._initPromise,this.optedOut)return void this._events.emit(e,"Library is disabled. Not sending event. To re-enable, call posthog.optIn()");const i={api_key:this.apiKey,batch:[this.prepareMessage(e,t,n)],sent_at:qy()};this.historicalMigration&&(i.historical_migration=!0);const o=JSON.stringify(i),a=`${this.host}/batch/`,r=this.disableCompression?null:await Gy(o,this.isDebug),s={method:"POST",headers:{...this.getCustomHeaders(),"Content-Type":"application/json",...null!==r&&{"Content-Encoding":"gzip"}},body:r||o};try{await this.fetchWithRetry(a,s)}catch(e){this._events.emit("error",e)}}prepareMessage(e,t,n){const i={...t,type:e,library:this.getLibraryId(),library_version:this.getLibraryVersion(),timestamp:n?.timestamp?n?.timestamp:qy(),uuid:n?.uuid?n.uuid:eb()};return(n?.disableGeoip??this.disableGeoip)&&(i.properties||(i.properties={}),i.properties.$geoip_disable=!0),i.distinctId&&(i.distinct_id=i.distinctId,delete i.distinctId),i}clearFlushTimer(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=void 0)}flushBackground(){this.flush().catch((async e=>{await ab(e)}))}async flush(){const e=Wy([this.flushPromise]).then((()=>this._flush()));return this.flushPromise=e,this.addPendingPromise(e),Wy([e]).then((()=>{this.flushPromise===e&&(this.flushPromise=null)})),e}getCustomHeaders(){const e=this.getCustomUserAgent(),t={};return e&&""!==e&&(t["User-Agent"]=e),t}async _flush(){this.clearFlushTimer(),await this._initPromise;let e=this.getPersistedProperty(wy.Queue)||[];if(!e.length)return;const t=[],n=e.length;for(;e.length>0&&t.length<n;){const n=e.slice(0,this.maxBatchSize),i=n.map((e=>e.message)),o=()=>{const t=(this.getPersistedProperty(wy.Queue)||[]).slice(n.length);this.setPersistedProperty(wy.Queue,t),e=t},a={api_key:this.apiKey,batch:i,sent_at:qy()};this.historicalMigration&&(a.historical_migration=!0);const r=JSON.stringify(a),s=`${this.host}/batch/`,l=this.disableCompression?null:await Gy(r,this.isDebug),c={method:"POST",headers:{...this.getCustomHeaders(),"Content-Type":"application/json",...null!==l&&{"Content-Encoding":"gzip"}},body:l||r},u={retryCheck:e=>!sb(e)&&rb(e)};try{await this.fetchWithRetry(s,c,u)}catch(e){if(sb(e)&&i.length>1){this.maxBatchSize=Math.max(1,Math.floor(i.length/2)),this.logMsgIfDebug((()=>console.warn(`Received 413 when sending batch of size ${i.length}, reducing batch size to ${this.maxBatchSize}`)));continue}throw e instanceof ib||o(),this._events.emit("error",e),e}o(),t.push(...i)}this._events.emit("flush",t)}async fetchWithRetry(e,t,n,i){var o;(o=AbortSignal).timeout??(o.timeout=function(e){const t=new AbortController;return setTimeout((()=>t.abort()),e),t.signal});const a=t.body?t.body:"";let r=-1;try{r=a instanceof Blob?a.size:Buffer.byteLength(a,"utf8")}catch{if(a instanceof Blob)r=a.size;else{const e=(new TextEncoder).encode(a);r=e.length}}return await async function(e,t){let n=null;for(let i=0;i<t.retryCount+1;i++){i>0&&await new Promise((e=>setTimeout(e,t.retryDelay)));try{return await e()}catch(e){if(n=e,!t.retryCheck(e))throw e}}throw n}((async()=>{let n=null;try{n=await this.fetch(e,{signal:AbortSignal.timeout(i??this.requestTimeout),...t})}catch(e){throw new ib(e)}if("no-cors"!==t.mode&&(n.status<200||n.status>=400))throw new nb(n,r);return n}),{...this._retryOptions,...n})}async _shutdown(e=3e4){await this._initPromise;let t=!1;return this.clearFlushTimer(),Promise.race([new Promise(((n,i)=>{Ky((()=>{this.logMsgIfDebug((()=>console.error("Timed out while shutting down PostHog"))),t=!0,i("Timeout while shutting down PostHog. Some events may not have been sent.")}),e)})),(async()=>{try{for(await Promise.all(Object.values(this.pendingPromises));0!==(this.getPersistedProperty(wy.Queue)||[]).length&&(await this.flush(),!t););}catch(e){if(!rb(e))throw e;await ab(e)}})()])}async shutdown(e=3e4){return this.shutdownPromise?this.logMsgIfDebug((()=>console.warn("shutdown() called while already shutting down. shutdown() is meant to be called once before process exit - use flush() for per-request cleanup"))):this.shutdownPromise=this._shutdown(e).finally((()=>{this.shutdownPromise=null})),this.shutdownPromise}}class ub extends cb{constructor(e,t){const n=t?.disableGeoip??!1,i=t?.featureFlagsRequestTimeoutMs??1e4;super(e,{...t,disableGeoip:n,featureFlagsRequestTimeoutMs:i}),this.flagCallReported={},this._sessionMaxLengthSeconds=86400,this.sessionProps={},this.sendFeatureFlagEvent=t?.sendFeatureFlagEvent??!0,this._sessionExpirationTimeSeconds=t?.sessionExpirationTimeSeconds??1800}setupBootstrap(e){const t=e?.bootstrap;if(!t)return;t.distinctId&&(t.isIdentifiedId?this.getPersistedProperty(wy.DistinctId)||this.setPersistedProperty(wy.DistinctId,t.distinctId):this.getPersistedProperty(wy.AnonymousId)||this.setPersistedProperty(wy.AnonymousId,t.distinctId));const n=t.featureFlags,i=t.featureFlagPayloads??{};if(n&&Object.keys(n).length){const e=Uy(n,i);if(Object.keys(e.flags).length>0){this.setBootstrappedFeatureFlagDetails(e);const t=this.getKnownFeatureFlagDetails()||{flags:{},requestId:void 0},n={flags:{...e.flags,...t.flags},requestId:e.requestId};this.setKnownFeatureFlagDetails(n)}}}clearProps(){this.props=void 0,this.sessionProps={},this.flagCallReported={}}on(e,t){return this._events.on(e,t)}reset(e){this.wrap((()=>{const t=[wy.Queue,...e||[]];this.clearProps();for(const e of Object.keys(wy))t.includes(wy[e])||this.setPersistedProperty(wy[e],null);this.reloadFeatureFlags()}))}getCommonEventProperties(){const e=this.getFeatureFlags(),t={};if(e)for(const[n,i]of Object.entries(e))t[`$feature/${n}`]=i;return{...ob("$active_feature_flags",e?Object.keys(e):void 0),...t,...super.getCommonEventProperties()}}enrichProperties(e){return{...this.props,...this.sessionProps,...e||{},...this.getCommonEventProperties(),$session_id:this.getSessionId()}}getSessionId(){if(!this._isInitialized)return"";let e=this.getPersistedProperty(wy.SessionId);const t=this.getPersistedProperty(wy.SessionLastTimestamp)||0,n=this.getPersistedProperty(wy.SessionStartTimestamp)||0,i=Date.now(),o=i-n;return(!e||i-t>1e3*this._sessionExpirationTimeSeconds||o>1e3*this._sessionMaxLengthSeconds)&&(e=eb(),this.setPersistedProperty(wy.SessionId,e),this.setPersistedProperty(wy.SessionStartTimestamp,i)),this.setPersistedProperty(wy.SessionLastTimestamp,i),e}resetSessionId(){this.wrap((()=>{this.setPersistedProperty(wy.SessionId,null),this.setPersistedProperty(wy.SessionLastTimestamp,null),this.setPersistedProperty(wy.SessionStartTimestamp,null)}))}getAnonymousId(){if(!this._isInitialized)return"";let e=this.getPersistedProperty(wy.AnonymousId);return e||(e=eb(),this.setPersistedProperty(wy.AnonymousId,e)),e}getDistinctId(){return this._isInitialized?this.getPersistedProperty(wy.DistinctId)||this.getAnonymousId():""}registerForSession(e){this.sessionProps={...this.sessionProps,...e}}unregisterForSession(e){delete this.sessionProps[e]}identify(e,t,n){this.wrap((()=>{const i=this.getDistinctId();e=e||i,t?.$groups&&this.groups(t.$groups);const o=t?.$set_once;delete t?.$set_once;const a=t?.$set||t,r=this.enrichProperties({$anon_distinct_id:this.getAnonymousId(),...ob("$set",a),...ob("$set_once",o)});e!==i&&(this.setPersistedProperty(wy.AnonymousId,i),this.setPersistedProperty(wy.DistinctId,e),this.reloadFeatureFlags()),super.identifyStateless(e,r,n)}))}capture(e,t,n){this.wrap((()=>{const i=this.getDistinctId();t?.$groups&&this.groups(t.$groups);const o=this.enrichProperties(t);super.captureStateless(i,e,o,n)}))}alias(e){this.wrap((()=>{const t=this.getDistinctId(),n=this.enrichProperties({});super.aliasStateless(e,t,n)}))}autocapture(e,t,n={},i){this.wrap((()=>{const o={distinct_id:this.getDistinctId(),event:"$autocapture",properties:{...this.enrichProperties(n),$event_type:e,$elements:t}};this.enqueue("autocapture",o,i)}))}groups(e){this.wrap((()=>{const t=this.props.$groups||{};this.register({$groups:{...t,...e}}),Object.keys(e).find((n=>t[n]!==e[n]))&&this.reloadFeatureFlags()}))}group(e,t,n,i){this.wrap((()=>{this.groups({[e]:t}),n&&this.groupIdentify(e,t,n,i)}))}groupIdentify(e,t,n,i){this.wrap((()=>{const o=this.getDistinctId(),a=this.enrichProperties({});super.groupIdentifyStateless(e,t,n,i,o,a)}))}setPersonPropertiesForFlags(e){this.wrap((()=>{const t=this.getPersistedProperty(wy.PersonProperties)||{};this.setPersistedProperty(wy.PersonProperties,{...t,...e})}))}resetPersonPropertiesForFlags(){this.wrap((()=>{this.setPersistedProperty(wy.PersonProperties,null)}))}setGroupPropertiesForFlags(e){this.wrap((()=>{const t=this.getPersistedProperty(wy.GroupProperties)||{};0!==Object.keys(t).length&&Object.keys(t).forEach((n=>{t[n]={...t[n],...e[n]},delete e[n]})),this.setPersistedProperty(wy.GroupProperties,{...t,...e})}))}resetGroupPropertiesForFlags(){this.wrap((()=>{this.setPersistedProperty(wy.GroupProperties,null)}))}async remoteConfigAsync(){return await this._initPromise,this._remoteConfigResponsePromise?this._remoteConfigResponsePromise:this._remoteConfigAsync()}async flagsAsync(e=!0){return await this._initPromise,this._flagsResponsePromise?this._flagsResponsePromise:this._flagsAsync(e)}cacheSessionReplay(e,t){const n=t?.sessionRecording;n?(this.setPersistedProperty(wy.SessionReplay,n),this.logMsgIfDebug((()=>console.log("PostHog Debug",`Session replay config from ${e}: `,JSON.stringify(n))))):"boolean"==typeof n&&!1===n&&(this.logMsgIfDebug((()=>console.info("PostHog Debug",`Session replay config from ${e} disabled.`))),this.setPersistedProperty(wy.SessionReplay,null))}async _remoteConfigAsync(){return this._remoteConfigResponsePromise=this._initPromise.then((()=>{let e=this.getPersistedProperty(wy.RemoteConfig);return this.logMsgIfDebug((()=>console.log("PostHog Debug","Cached remote config: ",JSON.stringify(e)))),super.getRemoteConfig().then((t=>{if(t){const n={...t};if(delete n.surveys,this.logMsgIfDebug((()=>console.log("PostHog Debug","Fetched remote config: ",JSON.stringify(n)))),!1===this.disableSurveys){const e=t.surveys;let n=!0;Array.isArray(e)?this.logMsgIfDebug((()=>console.log("PostHog Debug","Surveys fetched from remote config: ",JSON.stringify(e)))):(this.logMsgIfDebug((()=>console.log("PostHog Debug","There are no surveys."))),n=!1),n?this.setPersistedProperty(wy.Surveys,e):this.setPersistedProperty(wy.Surveys,null)}else this.setPersistedProperty(wy.Surveys,null);this.setPersistedProperty(wy.RemoteConfig,n),this.cacheSessionReplay("remote config",t),!1===t.hasFeatureFlags?(this.setKnownFeatureFlagDetails({flags:{}}),this.logMsgIfDebug((()=>console.warn("Remote config has no feature flags, will not load feature flags.")))):!1!==this.preloadFeatureFlags&&this.reloadFeatureFlags(),t.supportedCompression?.includes(Ty.GZipJS)||(this.disableCompression=!0),e=t}return e}))})).finally((()=>{this._remoteConfigResponsePromise=void 0})),this._remoteConfigResponsePromise}async _flagsAsync(e=!0){return this._flagsResponsePromise=this._initPromise.then((async()=>{const t=this.getDistinctId(),n=this.props.$groups||{},i=this.getPersistedProperty(wy.PersonProperties)||{},o=this.getPersistedProperty(wy.GroupProperties)||{},a={$anon_distinct_id:e?this.getAnonymousId():void 0},r=await super.getFlags(t,n,i,o,a);if(r?.quotaLimited?.includes(lb.FeatureFlags))return this.setKnownFeatureFlagDetails(null),console.warn("[FEATURE FLAGS] Feature flags quota limit exceeded - unsetting all flags. Learn more about billing limits at https://posthog.com/docs/billing/limits-alerts"),r;if(r?.featureFlags){this.sendFeatureFlagEvent&&(this.flagCallReported={});let e=r;if(r.errorsWhileComputingFlags){const t=this.getKnownFeatureFlagDetails();this.logMsgIfDebug((()=>console.log("PostHog Debug","Cached feature flags: ",JSON.stringify(t)))),e={...r,flags:{...t?.flags,...r.flags}}}this.setKnownFeatureFlagDetails(e),this.setPersistedProperty(wy.FlagsEndpointWasHit,!0),this.cacheSessionReplay("flags",r)}return r})).finally((()=>{this._flagsResponsePromise=void 0})),this._flagsResponsePromise}setKnownFeatureFlagDetails(e){this.wrap((()=>{this.setPersistedProperty(wy.FeatureFlagDetails,e),this._events.emit("featureflags",Dy(e?.flags??{}))}))}getKnownFeatureFlagDetails(){const e=this.getPersistedProperty(wy.FeatureFlagDetails);if(!e){const e=this.getPersistedProperty(wy.FeatureFlags),t=this.getPersistedProperty(wy.FeatureFlagPayloads);if(void 0===e&&void 0===t)return;return Uy(e??{},t??{})}return Ry(e)}getKnownFeatureFlags(){const e=this.getKnownFeatureFlagDetails();if(e)return Dy(e.flags)}getKnownFeatureFlagPayloads(){const e=this.getKnownFeatureFlagDetails();if(e)return Ly(e.flags)}getBootstrappedFeatureFlagDetails(){const e=this.getPersistedProperty(wy.BootstrapFeatureFlagDetails);if(e)return e}setBootstrappedFeatureFlagDetails(e){this.setPersistedProperty(wy.BootstrapFeatureFlagDetails,e)}getBootstrappedFeatureFlags(){const e=this.getBootstrappedFeatureFlagDetails();if(e)return Dy(e.flags)}getBootstrappedFeatureFlagPayloads(){const e=this.getBootstrappedFeatureFlagDetails();if(e)return Ly(e.flags)}getFeatureFlag(e){const t=this.getFeatureFlagDetails();if(!t)return;const n=t.flags[e];let i=Fy(n);if(void 0===i&&(i=!1),this.sendFeatureFlagEvent&&!this.flagCallReported[e]){const o=this.getBootstrappedFeatureFlags()?.[e],a=this.getBootstrappedFeatureFlagPayloads()?.[e];this.flagCallReported[e]=!0,this.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:i,...ob("$feature_flag_id",n?.metadata?.id),...ob("$feature_flag_version",n?.metadata?.version),...ob("$feature_flag_reason",n?.reason?.description??n?.reason?.code),...ob("$feature_flag_bootstrapped_response",o),...ob("$feature_flag_bootstrapped_payload",a),$used_bootstrap_value:!this.getPersistedProperty(wy.FlagsEndpointWasHit),...ob("$feature_flag_request_id",t.requestId)})}return i}getFeatureFlagPayload(e){const t=this.getFeatureFlagPayloads();if(!t)return;const n=t[e];return void 0===n?null:n}getFeatureFlagPayloads(){return this.getFeatureFlagDetails()?.featureFlagPayloads}getFeatureFlags(){return this.getFeatureFlagDetails()?.featureFlags}getFeatureFlagDetails(){let e=this.getKnownFeatureFlagDetails();const t=this.getPersistedProperty(wy.OverrideFeatureFlags);if(!t)return e;e=e??{featureFlags:{},featureFlagPayloads:{},flags:{}};const n=e.flags??{};for(const e in t)t[e]?n[e]=(i=n[e],o=t[e],{...i,enabled:Vy(o),variant:By(o)}):delete n[e];var i,o;const a={...e,flags:n};return Ry(a)}getFeatureFlagsAndPayloads(){return{flags:this.getFeatureFlags(),payloads:this.getFeatureFlagPayloads()}}isFeatureEnabled(e){const t=this.getFeatureFlag(e);if(void 0!==t)return!!t}reloadFeatureFlags(e){this.flagsAsync(!0).then((t=>{e?.cb?.(void 0,t?.featureFlags)})).catch((t=>{e?.cb?.(t,void 0),e?.cb||this.logMsgIfDebug((()=>console.log("PostHog Debug","Error reloading feature flags",t)))}))}async reloadRemoteConfigAsync(){return await this.remoteConfigAsync()}async reloadFeatureFlagsAsync(e){return(await this.flagsAsync(e??!0))?.featureFlags}onFeatureFlags(e){return this.on("featureflags",(async()=>{const t=this.getFeatureFlags();t&&e(t)}))}onFeatureFlag(e,t){return this.on("featureflags",(async()=>{const n=this.getFeatureFlag(e);void 0!==n&&t(n)}))}async overrideFeatureFlag(e){this.wrap((()=>null===e?this.setPersistedProperty(wy.OverrideFeatureFlags,null):this.setPersistedProperty(wy.OverrideFeatureFlags,e)))}captureException(e,t){const n={$exception_level:"error",$exception_list:[{type:Hy(e)?e.name:"Error",value:Hy(e)?e.message:e,mechanism:{handled:!0,synthetic:!1}}],...t};n.$exception_personURL=new URL(`/project/${this.apiKey}/person/${this.getDistinctId()}`,this.host).toString(),this.capture("$exception",n)}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_feedback_text:t,$ai_trace_id:String(e)})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_metric_name:t,$ai_metric_value:String(n),$ai_trace_id:String(e)})}}function db(e){let t={};if(e?.navigator){const n=e.navigator.userAgent,i=function(e){if(!e?.navigator)return;const t=e.navigator.userAgent;return/Windows/i.test(t)?/Phone/.test(t)||/WPDesktop/.test(t)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(t)?"iOS":/Android/.test(t)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":/Mac/i.test(t)?"Mac OS X":/Linux/.test(t)?"Linux":/CrOS/.test(t)?"Chrome OS":void 0}(e);t={...t,...void 0!==i&&{$os:i},$browser:hb(n,e.navigator.vendor,!!e.opera),$referrer:e.document.referrer,$referring_domain:fb(e.document.referrer),$device:mb(n),$current_url:e.location.href,$host:e.location.host,$pathname:e.location.pathname,$browser_version:gb(n,e.navigator.vendor,!!e.opera),$screen_height:e.screen.height,$screen_width:e.screen.width,$screen_dpr:e.devicePixelRatio}}return t={...t,$lib:"js",$lib_version:My,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:(new Date).getTime()/1e3},t}function pb(e,t){return e.indexOf(t)>=0}function hb(e,t,n){return t=t||"",n||pb(e," OPR/")?pb(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":pb(e,"IEMobile")||pb(e,"WPDesktop")?"Internet Explorer Mobile":pb(e,"SamsungBrowser/")?"Samsung Internet":pb(e,"Edge")||pb(e,"Edg/")?"Microsoft Edge":pb(e,"FBIOS")?"Facebook Mobile":pb(e,"Chrome")?"Chrome":pb(e,"CriOS")?"Chrome iOS":pb(e,"UCWEB")||pb(e,"UCBrowser")?"UC Browser":pb(e,"FxiOS")?"Firefox iOS":pb(t,"Apple")?pb(e,"Mobile")?"Mobile Safari":"Safari":pb(e,"Android")?"Android Mobile":pb(e,"Konqueror")?"Konqueror":pb(e,"Firefox")?"Firefox":pb(e,"MSIE")||pb(e,"Trident/")?"Internet Explorer":pb(e,"Gecko")?"Mozilla":""}function gb(e,t,n){const i={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge?\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Samsung Internet":/SamsungBrowser\/(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[hb(e,t,n)]||void 0;if(void 0===i)return null;const o=e.match(i);return o?parseFloat(o[o.length-2]):null}function mb(e){return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":""}function fb(e){const t=e.split("/");return t.length>=3?t[2]:""}const vb={getItem(e){try{const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}}catch(e){}return null},setItem(e,t){try{const n="",i="",o="",a=e+"="+encodeURIComponent(t)+i+"; path=/"+n+o;document.cookie=a}catch(e){return}},removeItem(e){try{vb.setItem(e,"")}catch(e){return}},clear(){document.cookie=""},getAllKeys(){const e=document.cookie.split(";"),t=[];for(let n=0;n<e.length;n++){let i=e[n];for(;" "==i.charAt(0);)i=i.substring(1,i.length);t.push(i.split("=")[0])}return t}},yb=e=>({getItem:t=>e.getItem(t),setItem(t,n){e.setItem(t,n)},removeItem(t){e.removeItem(t)},clear(){e.clear()},getAllKeys(){const e=[];for(const t in localStorage)e.push(t);return e}}),bb=(e,t="__mplssupport__")=>{try{const n="xyz";return e.setItem(t,n),e.getItem(t)===n&&(e.removeItem(t),!0)}catch(e){return!1}};let kb,Sb;const wb=()=>{const e={};return{getItem:t=>e[t],setItem(t,n){e[t]=null!==n?n:void 0},removeItem(t){delete e[t]},clear(){for(const t in e)delete e[t]},getAllKeys(){const t=[];for(const n in e)t.push(n);return t}}};function Tb(e,t,n){try{if(!(t in e))return()=>{};const i=e[t],o=n(i);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__posthog_wrapped__:{enumerable:!1,value:!0}})),e[t]=o,()=>{e[t]=i}}catch{return()=>{}}}class Cb extends ub{constructor(e,t){super(e,t),this._lastPathname="",this._storageKey=t?.persistence_name?`ph_${t.persistence_name}`:`ph_${e}_posthog`,this._storage=((e,t)=>{if(t){if(!kb){const e=yb(t.localStorage);kb=bb(e)?e:void 0}if(!Sb){const e=yb(t.sessionStorage);Sb=bb(e)?e:void 0}}switch(e){case"cookie":return vb||kb||Sb||wb();case"localStorage":return kb||Sb||wb();case"sessionStorage":return Sb||wb();default:return wb()}})(t?.persistence||"localStorage",this.getWindow()),this.setupBootstrap(t),!1!==t?.preloadFeatureFlags&&this.reloadFeatureFlags(),t?.captureHistoryEvents&&"undefined"!=typeof window&&(this._lastPathname=window?.location?.pathname||"",this.setupHistoryEventTracking())}getWindow(){return"undefined"!=typeof window?window:void 0}getPersistedProperty(e){return this._storageCache||(this._storageCache=JSON.parse(this._storage.getItem(this._storageKey)||"{}")||{}),this._storageCache[e]}setPersistedProperty(e,t){this._storageCache||(this._storageCache=JSON.parse(this._storage.getItem(this._storageKey)||"{}")||{}),null===t?delete this._storageCache[e]:this._storageCache[e]=t,this._storage.setItem(this._storageKey,JSON.stringify(this._storageCache))}fetch(e,t){const n="undefined"!=typeof fetch?fetch:void 0!==globalThis.fetch?globalThis.fetch:void 0;return n?n(e,t):Promise.reject(new Error("Fetch API is not available in this environment."))}getLibraryId(){return"posthog-js-lite"}getLibraryVersion(){return My}getCustomUserAgent(){}getCommonEventProperties(){return{...super.getCommonEventProperties(),...db(this.getWindow())}}setupHistoryEventTracking(){const e=this.getWindow();if(!e)return;const t=this;Tb(e.history,"pushState",(e=>function(n,i,o){e.call(this,n,i,o),t.captureNavigationEvent("pushState")})),Tb(e.history,"replaceState",(e=>function(n,i,o){e.call(this,n,i,o),t.captureNavigationEvent("replaceState")})),e.addEventListener("popstate",(()=>{this.captureNavigationEvent("popstate")}))}captureNavigationEvent(e){const t=this.getWindow();if(!t)return;const n=t.location.pathname;n!==this._lastPathname&&(this.capture("$pageview",{navigation_type:e}),this._lastPathname=n)}}const Pb=(0,i.createContext)(null),xb=e=>{let{client:t,children:n}=e;return(0,dh.jsx)(Pb.Provider,{value:t,children:n})},Ib=()=>{const e=(0,i.useContext)(Pb);return e||console.warn("[Sokuji] usePostHog called outside of PostHogProvider"),e},Ab=()=>{const[e,t]=(0,i.useState)(!1),[o,a]=(0,i.useState)(null);return(0,i.useEffect)((()=>{(async()=>{await(async()=>{try{await n.e(60).then(n.bind(n,2060)),await n.e(449).then(n.bind(n,4449))}catch(e){try{await Promise.resolve().then(n.bind(n,6958))}catch(e){console.warn("[Sokuji] Could not load styles:",e)}}})();const e=await(async()=>{const e=await(async()=>{try{const e=await n.e(510).then(n.t.bind(n,9510,19));return e.default||e}catch(e){return{version:"0.4.2"}}})(),t={host:jh.k2.POSTHOG_HOST,debug:(0,jh.yz)(),persistence:"localStorage",captureHistoryEvents:!0,defaultOptIn:!0,autocapture:!0,disableCompression:(0,jh.yz)(),flushAt:1,flushInterval:2e3},i=new Cb(jh.k2.POSTHOG_KEY,t);return await i.register({app_version:e.version,environment:(0,jh.uc)(),platform:(0,jh.uo)(),user_agent:navigator.userAgent}),(0,jh.yz)(),"extension"===(0,jh.uo)()&&Promise.resolve().then(n.bind(n,7540)).then((e=>{let{syncDistinctIdToBackground:t}=e;setTimeout((()=>{t(i)}),500)})).catch((e=>{console.warn("[Sokuji] [PostHog] Could not sync distinct_id to background script:",e.message)})),i})();a(e),t(!0)})()}),[]),e&&o?(0,dh.jsx)(i.StrictMode,{children:(0,dh.jsx)(xb,{client:o,children:(0,dh.jsx)(Sy,{})})}):(0,dh.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontFamily:"system-ui, -apple-system, sans-serif"},children:"Loading..."})};o.createRoot(document.getElementById("root")).render((0,dh.jsx)(Ab,{}))}},a={};function r(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,exports:{}};return o[e].call(n.exports,n,n.exports,r),n.exports}r.m=o,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var o=Object.create(null);r.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(o,a),o},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},i="sokuji-extension:",r.l=(e,t,o,a)=>{if(n[e])n[e].push(t);else{var s,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+o){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",i+o),s.src=e),n[e]=[t];var p=(t,i)=>{s.onerror=s.onload=null,clearTimeout(h);var o=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(i))),t)return t(i)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{r.b=document.baseURI||self.location.href;var e={941:0};r.f.j=(t,n)=>{var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,o)=>i=e[t]=[n,o]));n.push(i[2]=o);var a=r.p+r.u(t),s=new Error;r.l(a,(n=>{if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,o,a=n[0],s=n[1],l=n[2],c=0;if(a.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);l&&l(r)}for(t&&t(n);c<a.length;c++)o=a[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunksokuji_extension=self.webpackChunksokuji_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0,r(9666)})();